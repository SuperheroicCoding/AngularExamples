<mat-card appRaiseCard>
  <mat-card-title>Fitting data to a syntetic curve</mat-card-title>
  <mat-card-subtitle>Utilizing tensorflow.js for polynominal regretion and vega to plot<br>
  Inspired from this <a href="https://github.com/tensorflow/tfjs-examples/tree/master/polynomial-regression-core" target="_blank">Tensorflow.js example</a>
  </mat-card-subtitle>
  <mat-card-content class="drawings">
    <app-data-drawer
      caption="Training data (synthetic)"
      coeffCaption="True coefficients:"
      [coeff]="polyService.trueCoefficients"
      [data]="polyService.trainingData">
    </app-data-drawer>
    <app-data-drawer
      caption="Fit curve with random coefficients (before training)"
      coeffCaption="Random coefficients:"
      [coeff]="randomCoefficients"
      [data]="polyService.trainingData"
      [predictions]="polyService.predictionsBefore">
    </app-data-drawer>
    <app-data-drawer
      caption="Fit curve with learned coefficients (after training)"
      coeffCaption="Learned coefficients:"
      [coeff]="learnedCoefficients"
      [data]="polyService.trainingData"
      [predictions]="polyService.predictionsAfter">
    </app-data-drawer>
    <div>Current loss: {{currentLoss?.toFixed(5)}}</div>
  </mat-card-content>
  <mat-card-actions>
    <button mat-raised-button color="accent" (click)="learn()">Learn (10 iterations)</button>
  </mat-card-actions>
  <mat-card-actions>
    <button mat-raised-button color="accent" (click)="setRandomCoefficients()">Set random true coefficients</button>
  </mat-card-actions>
</mat-card>
