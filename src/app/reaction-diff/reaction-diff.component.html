<md-toolbar color="primary">
  <span>Reaction Diffusion Algorithm</span>
  <md-toolbar-row>
    <span class="mat-subheading-2">
      A simulation of two virtual chemicals reacting and diffusing on a 2D grid using the Gray-Scott model
  </span>
  </md-toolbar-row>
</md-toolbar>

<section class="diffContent">
<md-card>
  <md-card-title>Simulation
    <md-card-subtitle>Click to add fluid</md-card-subtitle>
  </md-card-title>
  <section></section>
  <app-p5-view
    [simWidth]="width"
    [simHeight]="height"
    [calcService]="calcService"
    [run]="start"
    [showFps]="showFps"
    [scale]="scale"
    (mousePressed)="addChemical($event)">
  </app-p5-view>
  <md-card-actions>
    <a md-raised-button (click)="toggleRunSim()">{{start ? 'Pause' : 'Run'}}</a>
    <a md-raised-button color="accent" (click)="reset()">Reset</a>
    <md-checkbox
      mdInput id="showFps"
      type="checkbox"
      name="showFps"
      [(ngModel)]="showFps">
      Show FPS
    </md-checkbox>
  </md-card-actions>
  <md-input-container class="small">
    <input mdInput id="width"
           placeholder="width"
           type="number"
           step="1"
           name="width"
           min="0"
           max="1000"
           [(ngModel)]="width"
           (change)="updateDimension()">
  </md-input-container>
  <md-input-container class="small">
    <input mdInput id="height"
           placeholder="height"
           type="number"
           step="1"
           name="height"
           min="0"
           max="1000"
           [(ngModel)]="height"
           (change)="updateDimension()">
  </md-input-container>
  <md-input-container class="small"  md-tooltip="Sorry, but scaling does not work yet">
    <input mdInput id="scale"
           disabled
           placeholder="Scale"
           type="number"
           step="0.1"
           name="scale"
           min="0"
           max="3"
           [(ngModel)]="scale">
  </md-input-container>
  <md-input-container class="small">
    <input mdInput id="addChemicalRadius"
           placeholder="Radius of chemical B on click"
           type="number"
           step="1"
           name="addChemicalRadius"
           min="0"
           max="50"
           [(ngModel)]="addChemicalRadius"
           (change)="updateAddChemicalRadius()">
  </md-input-container>
  <md-input-container class="small">
    <input mdInput id="numberThreads"
           placeholder="web workers to calculate"
           type="number"
           step="1"
           name="addChemicalRadius"
           min="1"
           max="16"
           [(ngModel)]="numberWebWorkers"
           (change)="updateNumberOfWebWorkers()">
  </md-input-container>

  <div>Calculation needs: {{calculationTime$ | async}}ms</div>
</md-card>

<md-card class="parameters" *ngIf="calcParams">
  <md-card-title>Parameters</md-card-title>
  <md-input-container class="small">
    <input mdInput id="diffRateA"
           placeholder="Diffusion A"
           type="number"
           step="0.05"
           name="diffRateA"
           min="0.0"
           max="1.0"
           [(ngModel)]="calcParams.diffRateA"
           (ngModelChange)="updateCalcParams(calcParams)"
    >
  </md-input-container>
  <md-input-container>
    <input mdInput id="diffRateB"
           placeholder="Diffusion B"
           type="number"
           step="0.05"
           name="diffRateB"
           min="0.0"
           max="1.0"
           [(ngModel)]="calcParams.diffRateB"
           (ngModelChange)="updateCalcParams(calcParams)"
    >
  </md-input-container>
  <md-input-container>
    <input mdInput id="feedRate"
           placeholder="Feed rate"
           type="number"
           step="0.001"
           name="feedRate"
           min="0.000"
           max="1.000"
           [(ngModel)]="calcParams.feedRate"
           (ngModelChange)="updateCalcParams(calcParams)"
    >
  </md-input-container>
  <md-input-container>
    <input mdInput id="killRate"
           placeholder="Kill Rate"
           type="number"
           step="0.001"
           name="killRate"
           min="0.000"
           max="1.000"
           [(ngModel)]="calcParams.killRate"
           (ngModelChange)="updateCalcParams(calcParams)"
    >
  </md-input-container>
  <br>
  <md-select placeholder="Example parameter config" [(ngModel)]="selectedExample " (change)="setSelection($event)">
    <md-option *ngFor="let example of examples" [value]="example">
      {{ example }}
    </md-option>
  </md-select>
</md-card>
<app-weights-config [weights]="cellWeights$ | async" (onWeightsChanged)="updateWeights($event)"></app-weights-config>
<md-card>
  <md-card-title>
    Reset parameters and weights
  </md-card-title>
  <button (click)="resetParametersWeights()"
          color="accent"
          md-raised-button>
    Set parameters to default
  </button>
</md-card>
</section>
