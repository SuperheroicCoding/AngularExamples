webpackJsonp(["tensorflow-examples.module"],{"+DWr":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("kglw");t.default={has:function(e){return"multi"===e.type&&e.toggle},signals:function(e,t,n){return n.concat({name:t.name+"_toggle",value:!1,on:[{events:t.events,update:t.toggle}]})},modifyExpr:function(e,t,n){var o=t.name+r.TUPLE,s=t.name+"_toggle";return s+" ? null : "+o+", "+("global"===t.resolve?s+" ? null : true, ":s+" ? null : {unit: "+r.unitName(e)+"}, ")+s+" ? "+o+" : null"}}},"+M68":function(e,t,n){"use strict";var r=n("TToO").__extends,o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n("xdLA"),u=n("utsZ"),l=n("gqjM"),c=n("KMAE"),d=n("rxHH"),h=n("Xq4m"),p=n("0N5v"),g=n("ivZP"),m=n("ndgZ"),v=n("6Tiz"),_=n("4TaE"),w=n("36K7"),E=n("ADrU"),O=n("OMxB"),S=n("r4me"),A=n("8YQ1"),T=n("GH2X");t.FacetModel=function(e){function t(t,n,r,o,s){var u=e.call(this,t,n,r,s,t.resolve)||this;u.type="facet",u.child=m.buildModel(t.spec,u,u.getName("child"),void 0,o,s,!1),u.children=[u.child];var l=S.replaceRepeaterInFacet(t.facet,o);return u.facet=u.initFacet(l),u}return r(t,e),t.prototype.initFacet=function(e){return u.reduce(e,function(e,t,n){return h.contains([s.ROW,s.COLUMN],n)?void 0===t.field?(c.warn(c.message.emptyFieldDef(t,n)),e):(e[n]=l.normalize(t,n),e):(c.warn(c.message.incompatibleChannel(n,"facet")),e)},{})},t.prototype.channelHasField=function(e){return!!this.facet[e]},t.prototype.fieldDef=function(e){return this.facet[e]},t.prototype.parseData=function(){this.component.data=_.parseData(this),this.child.parseData()},t.prototype.parseLayoutSize=function(){E.parseChildrenLayoutSize(this)},t.prototype.parseSelection=function(){this.child.parseSelection(),this.component.selection=this.child.component.selection},t.prototype.parseMarkGroup=function(){this.child.parseMarkGroup()},t.prototype.parseAxisAndHeader=function(){this.child.parseAxisAndHeader(),this.parseHeader("column"),this.parseHeader("row"),this.mergeChildAxis("x"),this.mergeChildAxis("y")},t.prototype.parseHeader=function(e){if(this.channelHasField(e)){var t=this.facet[e],n=t.header||{},r=void 0!==n.title?n.title:l.title(t,this.config);this.child.component.layoutHeaders[e].title&&(r+=" / "+this.child.component.layoutHeaders[e].title,this.child.component.layoutHeaders[e].title=null),this.component.layoutHeaders[e]={title:r,facetFieldDef:t,header:[this.makeHeaderComponent(e,!0)]}}},t.prototype.makeHeaderComponent=function(e,t){var n="row"===e?"height":"width";return{labels:t,sizeSignal:this.child.component.layoutSize.get(n)?this.child.getSizeSignalRef(n):void 0,axes:[]}},t.prototype.mergeChildAxis=function(e){var t=this.child;if(t.component.axes[e]){var n=this.component,r=n.layoutHeaders,o=n.resolve;if(o.axis[e]=A.parseGuideResolve(o,e),"shared"===o.axis[e])for(var s="x"===e?"column":"row",u=r[s],l=0,c=t.component.axes[e];l<c.length;l++){var d=c[l],h=w.getHeaderType(d.get("orient"));u[h]=u[h]||[this.makeHeaderComponent(s,!1)];var p=g.assembleAxis(d,"main",this.config,{header:!0});u[h][0].axes.push(p),d.mainExtracted=!0}}},t.prototype.assembleSelectionTopLevelSignals=function(e){return this.child.assembleSelectionTopLevelSignals(e)},t.prototype.assembleSelectionSignals=function(){return this.child.assembleSelectionSignals(),[]},t.prototype.assembleSelectionData=function(e){return this.child.assembleSelectionData(e)},t.prototype.getLayoutBandMixins=function(e){for(var t={},n="header"===e?"headerBand":"footerBand",r=0,o=["row","column"];r<o.length;r++){var s=o[r],u=this.component.layoutHeaders[s][e];u&&u[0]&&(this.child.component.layoutSize.get("row"===s?"height":"width")||(t[n]=t[n]||{},t[n][s]=.5))}return t},t.prototype.assembleLayout=function(){var e=this.channelHasField("column")?this.columnDistinctSignal():1;return o({padding:{row:10,column:10}},this.getLayoutBandMixins("header"),this.getLayoutBandMixins("footer"),{offset:10,columns:e,bounds:"full",align:"all"})},t.prototype.assembleLayoutSignals=function(){return this.child.assembleLayoutSignals()},t.prototype.columnDistinctSignal=function(){if(!(this.parent&&this.parent instanceof t))return{signal:"length(data('"+this.getName("column_domain")+"'))"}},t.prototype.assembleGroup=function(n){return this.parent&&this.parent instanceof t?o({},this.channelHasField("column")?{encode:{update:{columns:{field:l.vgField(this.facet.column,{prefix:"distinct"})}}}}:{},e.prototype.assembleGroup.call(this,n)):e.prototype.assembleGroup.call(this,n)},t.prototype.getCardinalityAggregateForChild=function(){var e=[],n=[];if(this.child instanceof t)this.child.channelHasField("column")&&(e.push(l.vgField(this.child.facet.column)),n.push("distinct"));else for(var r=0,o=["x","y"];r<o.length;r++){var s=o[r],u=this.child.component.scales[s];if(u&&!u.merged){var h=u.get("type"),g=u.get("range");if(d.hasDiscreteDomain(h)&&p.isVgRangeStep(g)){var m=T.assembleDomain(this.child,s),v=T.getFieldFromDomain(m);v?(e.push(v),n.push("distinct")):c.warn("Unknown field for ${channel}.  Cannot calculate view size.")}}}return e.length?{fields:e,ops:n}:void 0},t.prototype.assembleMarks=function(){var e=this.child,t=this.facet,n=this.component.data.facetRoot,r=v.assembleFacetData(n),u=this.channelHasField(s.ROW),l=this.channelHasField(s.COLUMN),c=e.assembleLayoutSize(),d={};u&&l&&(d.aggregate={cross:!0});var h=this.getCardinalityAggregateForChild();h&&(d.aggregate=o({},d.aggregate,h));var p=e.assembleTitle(),g=e.assembleGroupStyle();return[o({name:this.getName("cell"),type:"group"},p?{title:p}:{},g?{style:g}:{},{from:{facet:o({name:n.name,data:n.data,groupby:[].concat(u?[this.vgField(s.ROW)]:[],l?[this.vgField(s.COLUMN)]:[])},d)},sort:{field:[].concat(u?[this.vgField(s.ROW,{expr:"datum"})]:[],l?[this.vgField(s.COLUMN,{expr:"datum"})]:[]),order:[].concat(u?[t.row.sort||"ascending"]:[],l?[t.column.sort||"ascending"]:[])}},r.length>0?{data:r}:{},c?{encode:{update:c}}:{},e.assembleGroup())]},t.prototype.getMapping=function(){return this.facet},t}(O.ModelWithField)},"+zlj":function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("Bsgt"),s=n("xdLA"),u=n("gqjM"),l=n("KMAE"),c=n("rxHH"),d=n("0N5v"),h=n("dMOq"),p=n("KIOn");function g(e,t,n,r){if(void 0!==e.size)return{value:e.size};if(r.bar.discreteBandSize)return{value:r.bar.discreteBandSize};if(n){var s=n.get("type");if(s!==c.ScaleType.POINT)return s===c.ScaleType.BAND?p.bandRef(t):{value:r.bar.continuousBandSize};var u=n.get("range");if(d.isVgRangeStep(u)&&o.isNumber(u.step))return{value:u.step-1};l.warn(l.message.BAR_WITH_POINT_SCALE_AND_RANGESTEP_NULL)}else if(r.scale.rangeStep&&null!==r.scale.rangeStep)return{value:r.scale.rangeStep-1};return{value:20}}t.bar={vgMark:"rect",encodeEntry:function(e){return r({},h.baseEncodeEntry(e,{size:"ignore",orient:"ignore"}),function(e){var t=e.config,n=e.encoding,o=e.markDef,l=e.width,d=o.orient,m=n.size,v=n.x,_=e.scaleName(s.X),w=e.getScaleComponent(s.X);if("horizontal"===d)return r({},h.pointPosition("x",e,"zeroOrMin"),h.pointPosition2(e,"zeroOrMin"));if(u.isFieldDef(v)){var E=w.get("type");if(v.bin&&!m&&!c.hasDiscreteDomain(E))return h.binnedPosition(v,"x",e.scaleName("x"),t.bar.binSpacing,w.get("reverse"));if(E===c.ScaleType.BAND)return h.bandPosition(v,"x",e)}return h.centeredBandPosition("x",e,r({},p.mid(l)),g(o,_,w,t))}(e),function(e){var t=e.config,n=e.encoding,o=e.height,l=e.markDef,d=l.orient,m=n.size,v=n.y,_=e.scaleName(s.Y),w=e.getScaleComponent(s.Y);if("vertical"===d)return r({},h.pointPosition("y",e,"zeroOrMin"),h.pointPosition2(e,"zeroOrMin"));if(u.isFieldDef(v)){var E=w.get("type");if(v.bin&&!m&&!c.hasDiscreteDomain(E))return h.binnedPosition(v,"y",e.scaleName("y"),t.bar.binSpacing,w.get("reverse"));if(E===c.ScaleType.BAND)return h.bandPosition(v,"y",e)}return h.centeredBandPosition("y",e,p.mid(o),g(l,_,w,t))}(e))}}},"/F3B":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("IlUm");function o(e,t){return e[0]+"_"+e[1]+"_"+t}t.TextureManager=function(){function e(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.allocatedTextures=[],this.usedTextureCount={}}return e.prototype.acquireTexture=function(e,t){void 0===t&&(t=r.TextureType.FLOAT);var n=o(e,t);if(n in this.freeTextures||(this.freeTextures[n]=[]),n in this.usedTextureCount||(this.usedTextureCount[n]=0),this.usedTextureCount[n]++,this.freeTextures[n].length>0)return this.numFreeTextures--,this.numUsedTextures++,this.log(),this.freeTextures[n].shift();this.numUsedTextures++,this.log();var s=this.gpgpu.createMatrixTexture(e[0],e[1]);return this.allocatedTextures.push(s),s},e.prototype.releaseTexture=function(e,t,n){void 0===n&&(n=r.TextureType.FLOAT);var s=o(t,n);s in this.freeTextures||(this.freeTextures[s]=[]),this.freeTextures[s].push(e),this.numFreeTextures++,this.numUsedTextures--,this.usedTextureCount[s]--,this.log()},e.prototype.log=function(){this.logEnabled&&console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+(this.numFreeTextures+this.numUsedTextures)+")")},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var e=this;null!=this.allocatedTextures&&(this.allocatedTextures.forEach(function(t){e.gpgpu.deleteMatrixTexture(t)}),this.freeTextures=null,this.allocatedTextures=null,this.usedTextureCount=null,this.numUsedTextures=0,this.numFreeTextures=0)},e}()},"/KFK":function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("v/P2"),u=n("XFvI"),l=n("35G1");t.LRNOps=function(){function e(){}return e.localResponseNormalization=function(x,radius,e,t,n,r){void 0===radius&&(radius=5),void 0===e&&(e=1),void 0===t&&(t=1),void 0===n&&(n=.5),void 0===r&&(r="acrossChannels"),u.assert(4===x.rank||3===x.rank,"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+x.rank+"."),u.assert(u.isInt(radius),"Error in localResponseNormalization3D: radius must be an integer\n                     but got radius "+radius+".");var o=x,l=!1;3===x.rank&&(l=!0,o=x.as4D(1,x.shape[0],x.shape[1],x.shape[2]));var c=s.ENV.engine.runKernel(function(s){return s.localResponseNormalization4D(o,radius,e,t,n,r)},{x4D:o});return l?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c},r([o.doc({heading:"Operations",subheading:"Normalization"}),l.operation],e,"localResponseNormalization",null),e}()},"/NEo":function(e,t){var n,r,o,s=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,u={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function l(e){return s.lastIndex=0,s.test(e)?'"'+e.replace(s,function(a){var e=u[a];return"string"==typeof e?e:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}e.exports=function(value,e,t){var i;if(n="",r="","number"==typeof t)for(i=0;i<t;i+=1)r+=" ";else"string"==typeof t&&(r=t);if(o=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return function e(t,s){var i,k,u,c,d,h=n,value=s[t];switch(value&&"object"==typeof value&&"function"==typeof value.toJSON&&(value=value.toJSON(t)),"function"==typeof o&&(value=o.call(s,t,value)),typeof value){case"string":return l(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value)return"null";if(n+=r,d=[],"[object Array]"===Object.prototype.toString.apply(value)){for(c=value.length,i=0;i<c;i+=1)d[i]=e(i,value)||"null";return u=0===d.length?"[]":n?"[\n"+n+d.join(",\n"+n)+"\n"+h+"]":"["+d.join(",")+"]",n=h,u}if(o&&"object"==typeof o)for(c=o.length,i=0;i<c;i+=1)"string"==typeof(k=o[i])&&(u=e(k,value))&&d.push(l(k)+(n?": ":":")+u);else for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&(u=e(k,value))&&d.push(l(k)+(n?": ":":")+u);return u=0===d.length?"{}":n?"{\n"+n+d.join(",\n"+n)+"\n"+h+"}":"{"+d.join(",")+"}",n=h,u}}("",{"":value})}},"/u4k":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("v/P2"),o=n("XFvI"),s=n("bDWH"),u=n("IlUm");t.makeShader=function(e,t,n,u){var v=r.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?d:l,_=r.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?h:c,w=e.map(function(x){return"uniform sampler2D "+x.name+";"}).join("\n"),E=e.map(function(x){return function(e,t,n){var r,u,l,c,d,h,p=(l=(r=e).shapeInfo.texShape,c="get"+(u=r.name).charAt(0).toUpperCase()+u.slice(1)+"Flat",d=l[0],1===(h=l[1])&&1===d?"\n      float "+c+"(int index) {\n        return sampleTexture("+u+", halfCR);\n      }\n    ":1===h?"\n      float "+c+"(int index) {\n        vec2 uv = vec2(0.5, (float(index) + 0.5) / "+d+".0);\n        return sampleTexture("+u+", uv);\n      }\n    ":1===d?"\n      float "+c+"(int index) {\n        vec2 uv = vec2((float(index) + 0.5) / "+h+".0, 0.5);\n        return sampleTexture("+u+", uv);\n      }\n    ":"\n    float "+c+"(int index) {\n      vec2 uv = UVfrom1D("+d+", "+h+", index);\n      return sampleTexture("+u+", uv);\n    }\n  ");return p+=function e(t){var n,r=t.shapeInfo.logicalShape;switch(r.length){case 0:return"\n    float get"+(n=t.name).charAt(0).toUpperCase()+n.slice(1)+"() {\n      return sampleTexture("+n+", halfCR);\n    }\n  ";case 1:return function(e){var n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);return"\n    float "+r+"(int index) {\n      return "+r+"Flat(index);\n    }\n  "}();case 2:return function(t){var n=t.shapeInfo.logicalShape,r=t.shapeInfo.texShape,s=t.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),l=r[0],c=r[1];if(o.arraysEqual(n,r))return"\n    float "+u+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+c+".0, "+l+".0);\n      return sampleTexture("+s+", uv);\n    }\n  ";var d=o.squeezeShape(n),h=d.newShape,p=d.keptDims;return h.length<n.length?"\n      "+e(g(t,h))+"\n      float "+u+"(int row, int col) {\n        return "+u+"("+m(["row","col"],p)+");\n      }\n    ":1===c?"\n    float "+u+"(int row, int col) {\n      int index = row * "+n[1]+" + col;\n      vec2 uv = vec2(0.5, (float(index) + 0.5) / "+l+".0);\n      return sampleTexture("+s+", uv);\n    }\n  ":1===l?"\n    float "+u+"(int row, int col) {\n      int index = row * "+n[1]+" + col;\n      vec2 uv = vec2((float(index) + 0.5) / "+c+".0, 0.5);\n      return sampleTexture("+s+", uv);\n    }\n  ":"\n  float "+u+"(int row, int col) {\n    vec2 uv = UVfrom2D("+l+", "+c+", "+n[1]+", row, col);\n    return sampleTexture("+s+", uv);\n  }\n"}(t);case 3:return function(t){var n=t.shapeInfo.texShape,r=t.shapeInfo.logicalShape,s=t.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),l=n[0],c=n[1],d=r[1]*r[2],h=r[2],p=o.squeezeShape(r),v=p.newShape,_=p.keptDims;return v.length<r.length?"\n        "+e(g(t,v))+"\n        float "+u+"(int row, int col, int depth) {\n          return "+u+"("+m(["row","col","depth"],_)+");\n        }\n      ":c===d?"\n        float "+u+"(int row, int col, int depth) {\n          int texR = row;\n          int texC = col * "+h+" + depth;\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+c+".0, "+l+".0);\n          return sampleTexture("+s+", uv);\n        }\n      ":c===h?"\n    float "+u+"(int row, int col, int depth) {\n      int texR = row * "+r[1]+" + col;\n      int texC = depth;\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+c+".0, "+l+".0);\n      return sampleTexture("+s+", uv);\n    }\n  ":"\n      float "+u+"(int row, int col, int depth) {\n        vec2 uv = UVfrom3D(\n            "+l+", "+c+", "+d+", "+h+", row, col, depth);\n        return sampleTexture("+s+", uv);\n      }\n  "}(t);case 4:return function(t){var n=t.shapeInfo.logicalShape,r=t.shapeInfo.texShape,s=t.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),l=r[0],c=r[1],d=n[3],h=n[2]*d,p=n[1]*h,v=o.squeezeShape(n),_=v.newShape,w=v.keptDims;return _.length<n.length?"\n      "+e(g(t,_))+"\n      float "+u+"(int row, int col, int depth, int depth2) {\n        return "+u+"("+m(["row","col","depth","depth2"],w)+");\n      }\n    ":c===p?"\n      float "+u+"(int row, int col, int depth, int depth2) {\n        int texR = row;\n        int texC = col * "+h+" + depth * "+d+" + depth2;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+c+".0, "+l+".0);\n        return sampleTexture("+s+", uv);\n      }\n    ":c===d?"\n      float "+u+"(int row, int col, int depth, int depth2) {\n        int texR = row * "+n[1]*n[2]+" + col * "+n[2]+" + depth;\n        int texC = depth2;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+c+".0, "+l+".0);\n        return sampleTexture("+s+", uv);\n      }\n    ":"\n    float "+u+"(int row, int col, int depth, int depth2) {\n      vec2 uv = UVfrom4D("+l+", "+c+", "+p+", "+h+",\n          "+d+", row, col, depth, depth2);\n      return sampleTexture("+s+", uv);\n    }\n  "}(t);default:throw new Error(r.length+"-D input sampling is not yet supported")}}(e),(n||o.arraysEqual(e.shapeInfo.logicalShape,t.logicalShape))&&(p+=function(e,t,n){var r=e.shapeInfo.texShape,u=e.name,l=u.charAt(0).toUpperCase()+u.slice(1),c="get"+l+"AtOutCoords",d=s.getBroadcastDims(e.shapeInfo.logicalShape,t.logicalShape),h=n&&(t.logicalShape.length>e.shapeInfo.logicalShape.length||d.length>0),p=s.broadcastDimsAreOuter(d);if(h&&!p)return function(e,t,n,r){var o=e.shapeInfo.logicalShape.length,u=t.logicalShape.length,l="int";2===u?l="ivec2":3===u?l="ivec3":4===u&&(l="ivec4");var c=s.getBroadcastDims(e.shapeInfo.logicalShape,t.logicalShape),d=u-o;return"\n    float "+r+"() {\n      "+l+" coords = getOutputCoords();\n      "+(0===o?"":u<2&&c.length>=1?"coords = 0;":c.map(function(e){return"coords["+(e+d)+"] = 0;"}).join("\n"))+"\n      return get"+n+"("+(u<2&&o>0?"coords":e.shapeInfo.logicalShape.map(function(e,i){return"coords["+(i+d)+"]"}).join(", "))+");\n    }\n  "}(e,t,l,c);var g=t.texShape;if(o.arraysEqual(r,g))return"\n      float "+c+"() {\n        return sampleTexture("+u+", resultUV);\n      }\n    ";var m=o.sizeFromShape(r),v="";return h&&p&&(v="\n        int mainPart = index / "+m+";\n        index -= mainPart * "+m+";\n      "),"\n    float "+c+"() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+g[0]+", "+g[1]+"));\n      int index = resTexRC.x * "+g[1]+" + resTexRC.y;\n      "+v+"\n      int texR = index / "+r[1]+";\n      int texC = index - texR * "+r[1]+";\n      vec2 uv = (vec2(texC, texR) + halfCR) /\n                 vec2("+r[1]+".0, "+r[0]+".0);\n\n      return sampleTexture("+u+", uv);\n    }\n  "}(e,t,n)),p}(x,t,u)}).join("\n"),O=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return 1===t[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+t[1]+".0);\n      }\n    ":1===t[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+t[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      return resTexRC.x * "+t[1]+" + resTexRC.y;\n    }\n  ";case 2:return function(e,t){return o.arraysEqual(e,t)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+t[0]+", "+t[1]+"));\n      }\n    ":1===e[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===e[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      int r = index / "+e[1]+";\n      int c = index - r * "+e[1]+";\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+(r=t)[0]+", "+r[1]+"));\n      int index = resTexRC.x * "+r[1]+" + resTexRC.y;\n      int r = index / "+(s=(n=e)[1]*n[2])+";\n      index -= r * "+s+";\n      int c = index / "+(u=n[2])+";\n      int d = index - c * "+u+";\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(n,r){var o=e[3],s=e[2]*o,u=e[1]*s;return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      int r = index / "+u+";\n      index -= r * "+u+";\n\n      int c = index / "+s+";\n      index -= c * "+s+";\n\n      int d = index / "+o+";\n      int d2 = index - d * "+o+";\n\n      return ivec4(r, c, d, d2);\n    }\n  "}();default:throw new Error(e.length+"-D output sampling is not yet supported")}var n,r,s,u}(t.logicalShape,t.texShape);return[p,v,_,w,O,E,n].join("\n")};var l="\n  uniform float NaN;\n\n  const vec4 floatDeltas = vec4(\n      1.0,\n      1.0 / 255.0,\n      1.0 / (255.0 * 255.0),\n      1.0 / (255.0 * 255.0 * 255.0)\n  );\n  const float minValue = "+u.FLOAT_MIN+".0;\n  const float maxValue = "+u.FLOAT_MAX+".0;\n  const float range = (maxValue - minValue) / 255.0;\n  const vec2 dotRange = vec2(1.0, range);\n\n  float sampleTexture(sampler2D textureSampler, vec2 uv) {\n    vec4 sampleValue = texture2D(textureSampler, uv);\n    if (all(equal(sampleValue, vec4("+u.BYTE_NAN_VALUE+")))) {\n      return NaN;\n    }\n\n    vec4 encValue = floor(sampleValue * 255.0 + 0.5);\n    float decodedValue = dot(encValue, floatDeltas);\n    return dot(vec2(minValue, decodedValue), dotRange);\n  }\n",c="\n  const vec4 floatPowers = vec4(\n    1.0,\n    255.0,\n    255.0 * 255.0,\n    255.0 * 255.0 * 255.0\n  );\n  const vec2 recipRange = vec2(1.0/range);\n  const vec2 recipRange255 = vec2(1.0/(maxValue - minValue));\n\n  void setOutput(float decodedValue) {\n    if (isNaN(decodedValue)) {\n      gl_FragColor = vec4("+u.BYTE_NAN_VALUE+");\n      return;\n    }\n\n    float a = dot(vec2(decodedValue, -minValue), recipRange);\n    float b = fract(a) * 255.0;\n    float c = fract(b) * 255.0;\n    float d = fract(c) * 255.0;\n    gl_FragColor = floor(vec4(a, b, c, d)) / 255.0;\n\n    // TODO(dsmilkov): Version above gets better accuracy but probably slower\n    // than the version below. Benchmark to determine if the accuracy is worth\n    // the cost.\n\n    // float normValue = dot(vec2(decodedValue, -minValue), recipRange255);\n    // vec4 f = normValue * floatPowers;\n    // gl_FragColor = floor(fract(f) * 255.0) / 255.0;\n  }\n",d="\n  float sampleTexture(sampler2D textureSampler, vec2 uv) {\n    return texture2D(textureSampler, uv).r;\n  }\n",h="\n  void setOutput(float val) {\n    gl_FragColor = vec4(val, 0, 0, 0);\n  }\n",p="\n  precision highp float;\n  precision highp int;\n  varying vec2 resultUV;\n  const vec2 halfCR = vec2(0.5, 0.5);\n\n  bool isNaN(float val) {\n    float v1 = val * val;\n    float v2 = val * val;\n    return v1 == v2 ? false : true;\n  }\n\n  bool hasNaN(vec4 values) {\n    vec4 v1 = values * values;\n    vec4 v2 = values * values;\n    return any(notEqual(v1, v2));\n  }\n\n  float getNaN(vec4 values) {\n    return dot(vec4(1), values);\n  }\n\n  int round(float value) {\n    return int(floor(value + 0.5));\n  }\n\n  int imod(int x, int y) {\n    return x - y * (x / y);\n  }\n\n  const vec2 randomConst = vec2(\n    23.14069263277926, // e^pi (Gelfond's constant)\n     2.665144142690225 // 2^sqrt(2) (Gelfond\u2013Schneider constant)\n  );\n\n  float random(float seed) {\n      return fract(cos(dot(resultUV * seed, randomConst)) * 12345.6789);\n  }\n\n  \nvec2 UVfrom1D(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  \nvec2 UVfrom2D(int texNumR, int texNumC, int numC, int row, int col) {\n  int index = row * numC + col;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  \nvec2 UVfrom3D(int texNumR, int texNumC, int stride0,\n    int stride1, int row, int col, int depth) {\n  // Explicitly use integer operations as dot() only works on floats.\n  int index = row * stride0 + col * stride1 + depth;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  \nvec2 UVfrom4D(int texNumR, int texNumC, int stride0,\n    int stride1, int stride2, int row, int col, int depth,\n    int depth2) {\n  // Explicitly use integer operations as dot() only works on floats.\n  int index = row * stride0 + col * stride1 + depth * stride2 + depth2;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n";function g(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function m(e,t){return t.map(function(t){return e[t]}).join(", ")}t.getCoordsDataType=function(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";throw Error("GPU for rank "+e+" is not yet supported")}},"0LBb":function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.extractTitleConfig=function(e){var t=e.anchor,n=e.offset,s=e.orient,u=e.color,l=o(e,["anchor","offset","orient","color"]);return{mark:r({},l,u?{fill:u}:{}),nonMark:r({},t?{anchor:t}:{},n?{offset:n}:{},s?{orient:s}:{})}}},"0N5v":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Bsgt"),o=n("Xq4m");t.isVgSignalRef=function(e){return!!e.signal},t.isVgRangeStep=function(e){return!!e.step},t.isDataRefUnionedDomain=function(e){return!r.isArray(e)&&"fields"in e&&!("data"in e)},t.isFieldRefUnionDomain=function(e){return!r.isArray(e)&&"fields"in e&&"data"in e},t.isDataRefDomain=function(e){return!r.isArray(e)&&"field"in e&&"data"in e},t.isSignalRefDomain=function(e){return!r.isArray(e)&&"signal"in e},t.VG_MARK_CONFIGS=o.flagKeys({opacity:1,fill:1,fillOpacity:1,stroke:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,limit:1,dx:1,dy:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,cursor:1,href:1})},"0Ooj":function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("Bsgt"),s=n("kglw"),u=n("1dKF"),l=n("gqjM"),c=n("jfp2"),d=n("Xq4m");function h(e){return e&&e.selection}function p(e){return e&&!!e.field&&void 0!==e.equal}function g(e){return!!(e&&e.field&&o.isArray(e.range)&&2===e.range.length)}function m(e){return e&&!!e.field&&(o.isArray(e.oneOf)||o.isArray(e.in))}function v(e){return m(e)||p(e)||g(e)}function _(e,t){void 0===t&&(t=!0);var n=e.timeUnit?"time("+c.fieldExpr(e.timeUnit,e.field)+")":l.vgField(e,{expr:"datum"});if(p(e))return n+"==="+w(e.equal,e.timeUnit);if(m(e))return"indexof(["+(e.oneOf||e.in).map(function(t){return w(t,e.timeUnit)}).join(",")+"], "+n+") !== -1";if(g(e)){var r=e.range[0],o=e.range[1];if(null!==r&&null!==o&&t)return"inrange("+n+", ["+w(r,e.timeUnit)+", "+w(o,e.timeUnit)+"])";var s=[];return null!==r&&s.push(n+" >= "+w(r,e.timeUnit)),null!==o&&s.push(n+" <= "+w(o,e.timeUnit)),s.length>0?s.join(" && "):"true"}throw new Error("Invalid field predicate: "+JSON.stringify(e))}function w(e,t){if(u.isDateTime(e))return"time("+u.dateTimeExpr(e,!0)+")";if(c.isLocalSingleTimeUnit(t)){var n={};return n[t]=e,"time("+u.dateTimeExpr(n,!0)+")"}return c.isUtcSingleTimeUnit(t)?w(e,c.getLocalTimeUnit(t)):JSON.stringify(e)}t.isSelectionPredicate=h,t.isFieldEqualPredicate=p,t.isFieldRangePredicate=g,t.isFieldOneOfPredicate=m,t.isFieldPredicate=v,t.expression=function(e,t,n){return d.logicalExpr(t,function(t){return o.isString(t)?t:h(t)?s.selectionPredicate(e,t.selection,n):_(t)})},t.fieldFilterExpression=_,t.normalizePredicate=function(f){return v(f)&&f.timeUnit?r({},f,{timeUnit:c.normalizeTimeUnit(f.timeUnit)}):f}},"0vBu":function(e,t,n){"use strict";var r=n("TToO").__extends,o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n("xdLA"),u=n("KMAE"),l=n("rxHH"),c=n("0N5v"),d=n("GH2X"),h=n("FgHA");t.FacetNode=function(e){function t(t,n,r,o){var u=e.call(this,t)||this;return u.model=n,u.name=r,u.data=o,n.facet.column&&(u.columnFields=[n.vgField(s.COLUMN)],u.columnName=n.getName("column_domain"),n.fieldDef(s.COLUMN).bin&&u.columnFields.push(n.vgField(s.COLUMN,{binSuffix:"end"}))),n.facet.row&&(u.rowFields=[n.vgField(s.ROW)],u.rowName=n.getName("row_domain"),n.fieldDef(s.ROW).bin&&u.rowFields.push(n.vgField(s.ROW,{binSuffix:"end"}))),u.childModel=n.child,u}return r(t,e),Object.defineProperty(t.prototype,"fields",{get:function(){var e=[];return this.columnFields&&(e=e.concat(this.columnFields)),this.rowFields&&(e=e.concat(this.rowFields)),e},enumerable:!0,configurable:!0}),t.prototype.getSource=function(){return this.name},t.prototype.getChildIndependentFieldsWithStep=function(){for(var e={},t=0,n=["x","y"];t<n.length;t++){var r=n[t],o=this.childModel.component.scales[r];if(o&&!o.merged){var s=o.get("type"),h=o.get("range");if(l.hasDiscreteDomain(s)&&c.isVgRangeStep(h)){var p=d.assembleDomain(this.childModel,r),g=d.getFieldFromDomain(p);g?e[r]=g:u.warn("Unknown field for ${channel}.  Cannot calculate view size.")}}}return e},t.prototype.assembleRowColumnData=function(e,t,n){var r={},s="row"===e?"y":"x";return n[s]&&(r=t?{fields:["distinct_"+n[s]],ops:["max"],as:["distinct_"+n[s]]}:{fields:[n[s]],ops:["distinct"]}),{name:"row"===e?this.rowName:this.columnName,source:t||this.data,transform:[o({type:"aggregate",groupby:"row"===e?this.rowFields:this.columnFields},r)]}},t.prototype.assemble=function(){var e=[],t=null,n=this.getChildIndependentFieldsWithStep();if(this.columnName&&this.rowName&&(n.x||n.y)){t="cross_"+this.columnName+"_"+this.rowName;var r=[].concat(n.x?[n.x]:[],n.y?[n.y]:[]),o=r.map(function(){return"distinct"});e.push({name:t,source:this.data,transform:[{type:"aggregate",groupby:this.columnFields.concat(this.rowFields),fields:r,ops:o}]})}return this.columnName&&e.push(this.assembleRowColumnData("column",t,n)),this.rowName&&e.push(this.assembleRowColumnData("row",t,n)),e},t}(h.DataFlowNode)},"1HS3":function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY");t.BrowserUtil=function(){function e(){}return e.nextFrame=function(){return new Promise(function(e){return requestAnimationFrame(function(){return e()})})},r([o.doc({heading:"Performance",subheading:"Timing"})],e,"nextFrame",null),e}()},"1Z9O":function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("qmZh"),s=n("DjcB"),u=n("yJL4"),l=n("np2E"),c=n("AQHg"),d=function(e){function t(t){var n=e.call(this,t)||this;return n.layer=t.layer,n.inputMap={},n}return r(t,e),t.prototype.build=function(e){this.built=!0},Object.defineProperty(t.prototype,"trainable",{get:function(){return null!=this.layer&&this.layer.trainable},set:function(value){null!=this.layer&&(this.layer.trainable=value)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){return this.layer.getWeights()},t.prototype.setWeights=function(weights){this.layer.setWeights(weights)},t.prototype.getConfig=function(){var t={layer:{className:this.layer.constructor.name,config:this.layer.getConfig()}},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.fromConfig=function(e,t,n){void 0===n&&(n={});var r=c.deserialize(t.layer,n);delete t.layer;var o={layer:r};return Object.assign(o,t),new e(o)},t}(s.Layer);t.Wrapper=d;var h,p=function(e){function t(t){var n=e.call(this,t)||this;return n.supportsMasking=!0,n}return r(t,e),t.prototype.build=function(t){if((t=l.getExactlyOneShape(t)).length<3)throw new u.ValueError("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(t));this.inputSpec=[{shape:t}];var n=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),e.prototype.build.call(this,t)},t.prototype.computeOutputShape=function(e){var t=[(e=l.getExactlyOneShape(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t);return[n[0],e[1]].concat(n.slice(1))},t.prototype.call=function(e,t){var n=this;return e=l.getExactlyOneTensor(e),o.rnn(function(e,r){return[n.layer.call(e,t),[]]},e,[],!1,null,null,!1,e.shape[1])[1]},t}(d);t.TimeDistributed=p,l.ClassNameMap.register("TimeDistributed",p),function(e){e[e.SUM=0]="SUM",e[e.MUL=1]="MUL",e[e.CONCAT=2]="CONCAT",e[e.AVE=3]="AVE"}(h=t.BidirectionalMergeMode||(t.BidirectionalMergeMode={})),l.SerializableEnumRegistry.register("merge_mode",{sum:h.SUM,mul:h.MUL,concat:h.CONCAT,ave:h.AVE});var g=function(e){function t(t){var n=e.call(this,t)||this;n.forwardLayer=t.layer;var r=t.layer.getConfig();if(r.goBackwards=!0!==r.goBackwards,n.backwardLayer=c.deserialize({className:t.layer.constructor.name,config:r}),n.forwardLayer.name="forward_"+n.forwardLayer.name,n.backwardLayer.name="backward_"+n.backwardLayer.name,n.mergeMode=t.mergeMode,t.weights)throw new u.NotImplementedError("weights support is not implemented for Bidirectional layer yet.");return n._stateful=t.layer.stateful,n.returnSequences=t.layer.returnSequences,n.returnState=t.layer.returnState,n.supportsMasking=!0,n._trainable=!0,n.inputSpec=t.layer.inputSpec,n}return r(t,e),Object.defineProperty(t.prototype,"trainable",{get:function(){return this._trainable},set:function(value){this._trainable=value,null!=this.forwardLayer&&(this.forwardLayer.trainable=value),null!=this.backwardLayer&&(this.backwardLayer.trainable=value)},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},t.prototype.setWeights=function(weights){var e=Math.floor(weights.length/2);this.forwardLayer.setWeights(weights.slice(0,e)),this.backwardLayer.setWeights(weights.slice(e))},t.prototype.computeOutputShape=function(e){var t,n,r,o=this.forwardLayer.computeOutputShape(e);return Array.isArray(o)&&Array.isArray(o[0])||(o=[o]),o=o,this.returnState?(r=o.slice(1),t=o[0]):t=o[0],t=t,this.mergeMode===h.CONCAT?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):l.singletonOrArray(n)},t.prototype.apply=function(t,n){var r=null;if(null!=n&&(r=n.initialState),Array.isArray(t)&&(r=t.slice(1),t=t[0]),null==r||0===r.length)return e.prototype.apply.call(this,t,n);throw new u.NotImplementedError("The support for initial states is not implemented for Bidirectional layers yet.")},t.prototype.call=function(e,t){if(null!=t.mask)throw new u.NotImplementedError("The support for masking is not implemented for Bidirectional layers yet.");if(null!=t.initialState)throw new u.NotImplementedError("The support for initial states is not implemented for Bidirectional layers yet.");var n,r,y=this.forwardLayer.call(e,t),s=this.backwardLayer.call(e,t);return this.returnState&&(Array.isArray(y)&&(n=y.slice(1).concat(s.slice(1))),y=y[0],s=s[0]),this.returnSequences&&(s=o.reverse(s,1)),this.mergeMode===h.CONCAT?r=o.concatenate([y,s]):this.mergeMode===h.SUM?r=o.add(y,s):this.mergeMode===h.AVE?r=o.scalarTimesArray(o.getScalar(.5),o.add(y,s)):this.mergeMode===h.MUL?r=o.multiply(y,s):null==this.mergeMode&&(r=[y,s]),this.returnState?null==this.mergeMode?r.concat(n):[r].concat(n):r},t.prototype.resetStates=function(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},t.prototype.build=function(e){var t=this;o.nameScope(this.forwardLayer.name,function(){t.forwardLayer.build(e)}),o.nameScope(this.backwardLayer.name,function(){t.backwardLayer.build(e)}),this.built=!0},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),t}(d);t.Bidirectional=g,l.ClassNameMap.register("Bidirectional",g)},"1dKF":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Bsgt"),o=n("KMAE"),s=n("Xq4m");t.isDateTime=function(e){return!(!e||!(e.year||e.quarter||e.month||e.date||e.day||e.hours||e.minutes||e.seconds||e.milliseconds))},t.MONTHS=["january","february","march","april","may","june","july","august","september","october","november","december"],t.SHORT_MONTHS=t.MONTHS.map(function(e){return e.substr(0,3)}),t.DAYS=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],t.SHORT_DAYS=t.DAYS.map(function(e){return e.substr(0,3)}),t.dateTimeExpr=function(e,n){void 0===n&&(n=!1);var u=[];if(n&&void 0!==e.day&&s.keys(e).length>1&&(o.warn(o.message.droppedDay(e)),delete(e=s.duplicate(e)).day),u.push(void 0!==e.year?e.year:void 0!==e.day?2006:0),void 0!==e.month){var l=n?function(e){if(r.isNumber(e))return e-1+"";var n=e.toLowerCase(),s=t.MONTHS.indexOf(n);if(-1!==s)return s+"";var u=n.substr(0,3),l=t.SHORT_MONTHS.indexOf(u);if(-1!==l)return l+"";throw new Error(o.message.invalidTimeUnit("month",e))}(e.month):e.month;u.push(l)}else if(void 0!==e.quarter){var c=n?function(e){if(r.isNumber(e))return e>4&&o.warn(o.message.invalidTimeUnit("quarter",e)),e-1+"";throw new Error(o.message.invalidTimeUnit("quarter",e))}(e.quarter):e.quarter;u.push(c+"*3")}else u.push(0);if(void 0!==e.date)u.push(e.date);else if(void 0!==e.day){var d=n?function(e){if(r.isNumber(e))return e%7+"";var n=e.toLowerCase(),s=t.DAYS.indexOf(n);if(-1!==s)return s+"";var u=n.substr(0,3),l=t.SHORT_DAYS.indexOf(u);if(-1!==l)return l+"";throw new Error(o.message.invalidTimeUnit("day",e))}(e.day):e.day;u.push(d+"+1")}else u.push(1);for(var h=0,p=["hours","minutes","seconds","milliseconds"];h<p.length;h++){var g=p[h];u.push(void 0!==e[g]?e[g]:0)}return e.utc?"utc("+u.join(", ")+")":"datetime("+u.join(", ")+")"}},"2+Ke":function(e,t,n){"use strict";var r=n("TToO").__extends,o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n("xdLA"),u=n("utsZ"),l=n("utsZ"),c=n("gqjM"),d=n("D6ZG"),h=n("6xrs"),p=n("Xq4m"),g=n("vprv"),m=n("4TaE"),v=n("9d0T"),_=n("ADrU"),w=n("bMJS"),E=n("tn2z"),O=n("OMxB"),S=n("r4me"),A=n("kglw");t.UnitModel=function(e){function t(t,n,r,s,u,c,p){void 0===s&&(s={});var g=e.call(this,t,n,r,c,void 0)||this;g.fit=p,g.type="unit",g.specifiedScales={},g.specifiedAxes={},g.specifiedLegends={},g.specifiedProjection={},g.selection={},g.children=[],g.initSize(o({},s,t.width?{width:t.width}:{},t.height?{height:t.height}:{}));var m=d.isMarkDef(t.mark)?t.mark.type:t.mark,v=g.encoding=l.normalizeEncoding(S.replaceRepeaterInEncoding(t.encoding||{},u),m);return g.markDef=w.normalizeMarkDef(t.mark,v,c),g.stack=h.stack(m,v,g.config.stack),g.specifiedScales=g.initScales(m,v),g.specifiedAxes=g.initAxes(v),g.specifiedLegends=g.initLegend(v),g.specifiedProjection=t.projection,g.selection=t.selection,g}return r(t,e),t.prototype.scaleDomain=function(e){var t=this.specifiedScales[e];return t?t.domain:void 0},t.prototype.sort=function(e){return(this.getMapping()[e]||{}).sort},t.prototype.axis=function(e){return this.specifiedAxes[e]},t.prototype.legend=function(e){return this.specifiedLegends[e]},t.prototype.initScales=function(e,t){return s.SCALE_CHANNELS.reduce(function(e,n){var r,o,s=t[n];return c.isFieldDef(s)?(r=s,o=s.scale):c.hasConditionalFieldDef(s)?(r=s.condition,o=s.condition.scale):"x"===n?r=c.getFieldDef(t.x2):"y"===n&&(r=c.getFieldDef(t.y2)),r&&(e[n]=o||{}),e},{})},t.prototype.initAxes=function(e){return[s.X,s.Y].reduce(function(t,n){var r=e[n];if(c.isFieldDef(r)||n===s.X&&c.isFieldDef(e.x2)||n===s.Y&&c.isFieldDef(e.y2)){var u=c.isFieldDef(r)?r.axis:null;null!==u&&!1!==u&&(t[n]=o({},u))}return t},{})},t.prototype.initLegend=function(e){return s.NONPOSITION_SCALE_CHANNELS.reduce(function(t,n){var r=e[n];if(r){var s=c.isFieldDef(r)?r.legend:c.hasConditionalFieldDef(r)?r.condition.legend:null;null!==s&&!1!==s&&(t[n]=o({},s))}return t},{})},t.prototype.parseData=function(){this.component.data=m.parseData(this)},t.prototype.parseLayoutSize=function(){_.parseUnitLayoutSize(this)},t.prototype.parseSelection=function(){this.component.selection=A.parseUnitSelection(this,this.selection)},t.prototype.parseMarkGroup=function(){this.component.mark=E.parseMarkGroup(this)},t.prototype.parseAxisAndHeader=function(){this.component.axes=g.parseUnitAxis(this)},t.prototype.assembleSelectionTopLevelSignals=function(e){return A.assembleTopLevelSignals(this,e)},t.prototype.assembleSelectionSignals=function(){return A.assembleUnitSelectionSignals(this,[])},t.prototype.assembleSelectionData=function(e){return A.assembleUnitSelectionData(this,e)},t.prototype.assembleLayout=function(){return null},t.prototype.assembleLayoutSignals=function(){return v.assembleLayoutSignals(this)},t.prototype.assembleMarks=function(){var e=this.component.mark||[];return this.parent&&O.isLayerModel(this.parent)||(e=A.assembleUnitSelectionMarks(this,e)),e.map(this.correctDataNames)},t.prototype.assembleLayoutSize=function(){return{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")}},t.prototype.getMapping=function(){return this.encoding},t.prototype.toSpec=function(e,t){var n,r=p.duplicate(this.encoding);return n={mark:this.markDef,encoding:r},e||(n.config=p.duplicate(this.config)),t||(n.data=p.duplicate(this.data)),n},t.prototype.mark=function(){return this.markDef.type},t.prototype.channelHasField=function(e){return u.channelHasField(this.encoding,e)},t.prototype.fieldDef=function(e){return c.getFieldDef(this.encoding[e])},t}(O.ModelWithField)},"2CTY":function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("Xq4m");t.AXIS_PARTS=["domain","grid","labels","ticks","title"],t.AXIS_PROPERTY_TYPE={grid:"grid",gridScale:"grid",domain:"main",labels:"main",labelFlush:"main",labelOverlap:"main",minExtent:"main",maxExtent:"main",offset:"main",ticks:"main",title:"main",values:"both",scale:"both",zindex:"both"};var s={orient:1,domain:1,format:1,grid:1,labelBound:1,labelFlush:1,labelPadding:1,labels:1,labelOverlap:1,maxExtent:1,minExtent:1,offset:1,position:1,tickCount:1,ticks:1,tickSize:1,title:1,titlePadding:1,values:1,zindex:1},u=r({},s,{encoding:1,labelAngle:1,titleMaxLength:1}),l=r({scale:1},s,{gridScale:1,encode:1});t.isAxisProperty=function(e){return!!u[e]},t.VG_AXIS_PROPERTIES=o.flagKeys(l),t.AXIS_PROPERTIES=o.flagKeys(u)},"2EGJ":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("yJL4"),o=n("np2E"),s=n("KB5b");t.normalizeArray=function(value,e,t){if("number"==typeof value)return o.pyListRepeat(value,e);if(value.length!==e)throw new r.ValueError("The "+t+" argument must be a tuple of "+e+" integers. Received: "+value.length+" elements.");for(var i=0;i<e;++i){var n=value[i];if(!s.isInteger(n))throw new r.ValueError("The "+t+" argument must be a tuple of "+e+" integers. Received: "+JSON.stringify(value)+" including a non-integer number "+n)}return value},t.convOutputLength=function(e,t,n,r,o){return void 0===o&&(o=1),null==e?e:Math.floor((("same"===n?e:e-(t+(t-1)*(o-1))+1)+r-1)/r)},t.deconvLength=function(e,t,n,o){if(null==e)return null;if("valid"===o)e=e*t+s.max([n-t,0]);else{if("same"!==o)throw new r.ValueError("Unsupport padding mode: "+o+".");e*=t}return e}},"2bHe":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("KMAE"),o=n("Xq4m"),s=n("Qi+2");t.default={has:function(e){return void 0!==e.fields||void 0!==e.encodings},parse:function(e,t,n){var u={},l={};(t.fields||[]).forEach(function(e){return u[e]=null}),(t.encodings||[]).forEach(function(t){var n=e.fieldDef(t);if(n)if(n.timeUnit){var o=e.vgField(t);u[o]=t,l[o]={as:o,field:n.field,timeUnit:n.timeUnit}}else u[n.field]=t;else r.warn(r.message.cannotProjectOnChannelWithoutField(t))});var c=n.project||(n.project=[]);for(var d in u)u.hasOwnProperty(d)&&c.push({field:d,channel:u[d]});var h=n.fields||(n.fields={});c.filter(function(e){return e.channel}).forEach(function(e){return h[e.channel]=e.field}),o.keys(l).length&&(n.timeUnit=new s.TimeUnitNode(null,l))}}},3:function(e,t){},"35G1":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("V6aD");t.operation=function(e,t,n){var o=n.value;return n.value=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return r.tidy(t,function(){return o.apply(void 0,e)})},n}},"36K7":function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("gqjM"),s=n("Xq4m"),u=n("efV4");function l(e){return(90+(e=(e%360+360)%360))%180==0?{}:e<90||270<e?{align:{value:"right"}}:135<=e&&e<225?{align:{value:"left"}}:{}}function c(e){return 45<=(e=(e%360+360)%360)&&e<=135?{baseline:{value:"top"}}:{}}function d(e,t,n,d,h){if(h){var p=null,g=d.facetFieldDef;if(g&&h.labels){var m=g.header,v=void 0===m?{}:m,_=v.format,w=v.labelAngle,E=r({},void 0!==w?{angle:{value:w}}:{},l(w),c(w));p=r({text:u.formatSignalRef(g,_,"parent",e.config),offset:10,orient:"row"===t?"left":"top",style:"guide-label"},s.keys(E).length>0?{encode:{update:E}}:{})}var O=h.axes,S=O&&O.length>0;if(p||S){var A="row"===t?"height":"width";return r({name:e.getName(t+"_"+n),type:"group",role:t+"-"+n},d.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:{field:o.vgField(g,{expr:"datum"}),order:g.sort||"ascending"}}:{},p?{title:p}:{},h.sizeSignal?{encode:{update:(T={},T[A]=h.sizeSignal,T)}}:{},S?{axes:O}:{})}}return null;var T}t.HEADER_CHANNELS=["row","column"],t.HEADER_TYPES=["header","footer"],t.getHeaderType=function(e){return"top"===e||"left"===e?"header":"footer"},t.getTitleGroup=function(e,t){var n=r({align:{value:"center"},text:{value:e.component.layoutHeaders[t].title}},"vertical"===("row"===t?"vertical":void 0)?{angle:{value:270}}:{});return{name:e.getName(t+"_title"),role:t+"-title",type:"group",marks:[r({type:"text",role:t+"-title-text",style:"guide-title"},s.keys(n).length>0?{encode:{update:n}}:{})]}},t.getHeaderGroups=function(e,n){for(var r=e.component.layoutHeaders[n],o=[],s=0,u=t.HEADER_TYPES;s<u.length;s++){var l=u[s];if(r[l])for(var c=0,h=r[l];c<h.length;c++)o.push(d(e,n,l,r,h[c]))}return o},t.labelAlign=l,t.labelBaseline=c},"3A6A":function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var s=n("Bsgt"),u=n("xdLA"),l=n("KMAE"),c=n("rxHH"),d=n("Xq4m"),h=n("kglw"),p=n("x8nG");function g(e,t){return e.events.reduce(function(e,n){return n.between?t(e,n):(l.warn(n+" is not an ordered event stream for interval selections"),e)},[])}t.BRUSH="_brush",t.SCALE_TRIGGER="_scale_trigger",t.default={predicate:"vlInterval",scaleDomain:"vlIntervalDomain",signals:function(e,n){var r=n.name,o=p.default.has(n),d=[],m=[],v=[],_=[];if(n.translate&&!o){var w="!event.item || event.item.mark.name !== "+s.stringValue(r+t.BRUSH);g(n,function(e,t){var n=t.between[0].filter||(t.between[0].filter=[]);n.indexOf(w)<0&&n.push(w)})}return n.project.forEach(function(r){var o=r.channel;if(o===u.X||o===u.Y){var w=function(e,n,r){var o=h.channelSignalName(n,r,"visual"),l=h.channelSignalName(n,r,"data"),d=p.default.has(n),m=e.scaleName(r),v=s.stringValue(m),_=e.getScaleComponent(r),w=_?_.get("type"):void 0,E=e.getSizeSignalRef(r===u.X?"width":"height").signal,O=r+"(unit)",S=g(n,function(e,t){return e.concat({events:t.between[0],update:"["+O+", "+O+"]"},{events:t,update:"["+o+"[0], clamp("+O+", 0, "+E+")]"})});return S.push({events:{signal:n.name+t.SCALE_TRIGGER},update:c.hasContinuousDomain(w)&&!c.isBinScale(w)?"[scale("+v+", "+l+"[0]), scale("+v+", "+l+"[1])]":"[0, 0]"}),d?[{name:l,on:[]}]:[{name:o,value:[],on:S},{name:l,on:[{events:{signal:o},update:o+"[0] === "+o+"[1] ? null : invert("+v+", "+o+")"}]}]}(e,n,o),E=h.channelSignalName(n,o,"data"),O=h.channelSignalName(n,o,"visual"),S=s.stringValue(e.scaleName(o)),A=e.getScaleComponent(o).get("type"),T=c.hasContinuousDomain(A)?"+":"";d.push.apply(d,w),v.push(E),m.push("{encoding: "+s.stringValue(o)+", field: "+s.stringValue(r.field)+", extent: "+E+"}"),_.push({scaleName:e.scaleName(o),expr:"(!isArray("+E+") || ("+T+"invert("+S+", "+O+")[0] === "+T+E+"[0] && "+T+"invert("+S+", "+O+")[1] === "+T+E+"[1]))"})}else l.warn("Interval selections only support x and y encoding channels.")}),o||d.push({name:r+t.SCALE_TRIGGER,update:_.map(function(e){return e.expr}).join(" && ")+" ? "+(r+t.SCALE_TRIGGER)+" : {}"}),d.concat({name:r+h.TUPLE,on:[{events:v.map(function(e){return{signal:e}}),update:v.join(" && ")+" ? {unit: "+h.unitName(e)+", intervals: ["+m.join(", ")+"]} : null"}]})},modifyExpr:function(e,t){return t.name+h.TUPLE+", "+("global"===t.resolve?"true":"{unit: "+h.unitName(e)+"}")},marks:function(e,n,u){var l=n.name,c=h.positionalProjections(n),g=c.xi,m=c.yi,v="data("+s.stringValue(n.name+h.STORE)+")";if(p.default.has(n))return u;var _={x:null!==g?{signal:l+"_x[0]"}:{value:0},y:null!==m?{signal:l+"_y[0]"}:{value:0},x2:null!==g?{signal:l+"_x[1]"}:{field:{group:"width"}},y2:null!==m?{signal:l+"_y[1]"}:{field:{group:"height"}}};if("global"===n.resolve)for(var w=0,E=d.keys(_);w<E.length;w++){var O=E[w];_[O]=[r({test:v+".length && "+v+"[0].unit === "+h.unitName(e)},_[O]),{value:0}]}var S=n.mark,A=S.fill,T=S.fillOpacity,N=o(S,["fill","fillOpacity"]),M=d.keys(N).reduce(function(e,k){return e[k]={value:N[k]},e},{});return[{name:l+t.BRUSH+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:A},fillOpacity:{value:T}},update:_}}].concat(u,{name:l+t.BRUSH,type:"rect",clip:!0,encode:{enter:r({fill:{value:"transparent"}},M),update:_}})}}},"3IRH":function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},"3goy":function(e,t,n){"use strict";var r,o,s;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.float32="float32",e.int32="int32",e.bool="bool"}(t.DType||(t.DType={})),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4"}(t.Rank||(t.Rank={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32"}(r||(r={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool"}(o||(o={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32"}(s||(s={}));var u={float32:s,int32:r,bool:o};function l(e,t){return u[e][t]}t.upcastType=l,t.sumOutType=function(e){return l(e,"int32")}},"3kMs":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Xq4m"),o=n("qZoT");t.assembleLegends=function(e){for(var t=e.component.legends,n={},s=0,u=r.keys(t);s<u.length;s++){var l=u[s],c=e.getScaleComponent(l),d=r.stringify(c.domains);if(n[d])for(var h=0,p=n[d];h<p.length;h++)o.mergeLegendComponent(p[h],t[l])||n[d].push(t[l]);else n[d]=[t[l].clone()]}return r.flatten(r.vals(n)).map(function(e){return e.combine()})}},"3p3G":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Conv2DProgram=function(){return function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.top,n=e.padInfo.left,r=e.strideHeight,o=e.strideWidth,s=e.dilationHeight,u=e.dilationWidth,l=e.filterHeight,c=e.filterWidth,d=4*Math.floor(e.inChannels/4),h=e.inChannels%4;this.userCode="\n      const ivec2 strides = ivec2("+r+", "+o+");\n      const ivec2 pads = ivec2("+t+", "+n+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+l+"; wR++) {\n          int xR = xRCorner + wR * "+s+";\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+c+"; wC++) {\n            int xC = xCCorner + wC * "+u+";\n\n            if (xC < 0 || xC >= "+e.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+d+"; d1 += 4) {\n              vec4 xValues = vec4(\n                getX(batch, xR, xC, d1),\n                getX(batch, xR, xC, d1 + 1),\n                getX(batch, xR, xC, d1 + 2),\n                getX(batch, xR, xC, d1 + 3)\n              );\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              dotProd += dot(xValues, wValues);\n            }\n\n            if ("+(1===h)+") {\n              dotProd +=\n                getX(batch, xR, xC, "+d+") *\n                getW(wR, wC, "+d+", d2);\n            } else if ("+(2===h)+") {\n              vec2 xValues = vec2(\n                getX(batch, xR, xC, "+d+"),\n                getX(batch, xR, xC, "+d+" + 1)\n              );\n              vec2 wValues = vec2(\n                getW(wR, wC, "+d+", d2),\n                getW(wR, wC, "+d+" + 1, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            } else if ("+(3===h)+") {\n              vec3 xValues = vec3(\n                getX(batch, xR, xC, "+d+"),\n                getX(batch, xR, xC, "+d+" + 1),\n                getX(batch, xR, xC, "+d+" + 2)\n              );\n              vec3 wValues = vec3(\n                getW(wR, wC, "+d+", d2),\n                getW(wR, wC, "+d+" + 1, d2),\n                getW(wR, wC, "+d+" + 2, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}()},"3zuq":function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("aIXu");t.ScaleComponent=function(e){function t(t,n){var r=e.call(this,{},{name:t})||this;return r.merged=!1,r.domains=[],r.setWithExplicit("type",n),r}return r(t,e),t}(o.Split)},4:function(e,t){},"41KP":function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.ERRORBAR="error-bar",t.normalizeErrorBar=function(e){var t=e.encoding,n=o(e,["mark","selection","projection","encoding"]),s=o(t,["size"]),u=o(t,["x2","y2"]),l=o(u,["x","y"]);if(!t.x2&&!t.y2)throw new Error("Neither x2 or y2 provided");return r({},n,{layer:[{mark:"rule",encoding:s},{mark:"tick",encoding:u},{mark:"tick",encoding:r(t.x2?{x:t.x2,y:t.y}:{x:t.x,y:t.y2},l)}]})}},"4DJb":function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("KMAE"),s=n("P+57"),u=n("ndgZ"),l=n("ADrU");t.RepeatModel=function(e){function t(t,n,r,s,u){var l=e.call(this,t,n,r,u,t.resolve)||this;return l.type="repeat",t.resolve&&t.resolve.axis&&("shared"===t.resolve.axis.x||"shared"===t.resolve.axis.y)&&o.warn(o.message.REPEAT_CANNOT_SHARE_AXIS),l.repeat=t.repeat,l.children=l._initChildren(t,l.repeat,s,u),l}return r(t,e),t.prototype._initChildren=function(e,t,n,r){for(var o=[],s=t.column||[n?n.column:null],l=0,c=t.row||[n?n.row:null];l<c.length;l++)for(var d=c[l],h=0,p=s;h<p.length;h++){var g=p[h],m={row:d,column:g};o.push(u.buildModel(e.spec,this,this.getName("child"+(d?"_"+d:"")+(g?"_"+g:"")),void 0,m,r,!1))}return o},t.prototype.parseLayoutSize=function(){l.parseRepeatLayoutSize(this)},t.prototype.assembleLayout=function(){return{padding:{row:10,column:10},offset:10,columns:this.repeat&&this.repeat.column?this.repeat.column.length:1,bounds:"full",align:"all"}},t}(s.BaseConcatModel)},"4FW+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("xdLA"),o=n("1dKF"),s=n("rxHH"),u=n("Xq4m");t.values=function(e){var t=e.values;return t&&o.isDateTime(t[0])?t.map(function(e){return{signal:o.dateTimeExpr(e,!0)}}):t},t.type=function(e,t,n){if(r.isColorChannel(t)&&("quantitative"===e&&!s.isBinScale(n)||"temporal"===e&&u.contains(["time","utc"],n)))return"gradient"}},"4TaE":function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("Bsgt"),s=n("8Wnz"),u=n("1dKF"),l=n("KMAE"),c=n("0Ooj"),d=n("ODV5"),h=n("Xq4m"),p=n("OMxB"),g=n("kglw"),m=n("vyDb"),v=n("paLv"),_=n("MxPC"),w=n("FgHA"),E=n("0vBu"),O=n("Q2Ef"),S=n("F3d7"),A=n("LH1+"),T=n("OiDY"),N=n("QbRd"),M=n("ELZD"),C=n("yI+w"),D=n("EOrY"),R=n("mz/+"),I=n("Qi+2");function P(e,t){var n=0;return t.transforms.forEach(function(r){if(d.isCalculate(r))e=new _.CalculateNode(e,r);else if(d.isFilter(r)){var s={},p=r.filter,w=null;c.isFieldEqualPredicate(p)?w=p.equal:c.isFieldRangePredicate(p)?w=p.range[0]:c.isFieldOneOfPredicate(p)&&(w=(p.oneOf||p.in)[0]),w&&(u.isDateTime(w)?s[p.field]="date":o.isNumber(w)?s[p.field]="number":o.isString(w)&&(s[p.field]="string")),h.keys(s).length>0&&(e=new A.ParseNode(e,s)),e=new O.FilterNode(e,t,r.filter)}else if(d.isBin(r))e=v.BinNode.makeFromTransform(e,r,t);else if(d.isTimeUnit(r))e=I.TimeUnitNode.makeFromTransform(e,r);else if(d.isAggregate(r))e=m.AggregateNode.makeFromTransform(e,r),g.requiresSelectionId(t)&&(e=new M.IdentifierNode(e));else{if(!d.isLookup(r))return void l.warn(l.message.invalidTransformIgnored(r));e=C.LookupNode.make(e,t,r,n++)}}),e}t.parseTransformArray=P,t.parseData=function(e){var t=function(e,t){if(e.data||!e.parent){var n=new D.SourceNode(e.data),r=n.hash();return r in t?t[r]:(t[r]=n,n)}return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}(e,e.component.data.sources),n=e.component.data.outputNodes,o=e.component.data.outputNodeRefCounts;g.requiresSelectionId(e)&&!e.parent&&(t=new M.IdentifierNode(t));var u=e.parent&&p.isLayerModel(e.parent);(p.isUnitModel(e)||p.isFacetModel(e))&&u&&(t=v.BinNode.makeFromEncoding(t,e)||t),e.transforms.length>0&&(t=P(t,e));var l=A.ParseNode.make(t,e);l&&(t=l),p.isUnitModel(e)&&(t=T.GeoJSONNode.parseAll(t,e),t=N.GeoPointNode.parseAll(t,e)),(p.isUnitModel(e)||p.isFacetModel(e))&&(u||(t=v.BinNode.makeFromEncoding(t,e)||t),t=I.TimeUnitNode.makeFromEncoding(t,e)||t);var c=e.getName(s.RAW),d=new w.OutputNode(t,c,s.RAW,o);if(n[c]=d,t=d,p.isUnitModel(e)){var h=m.AggregateNode.makeFromEncoding(t,e);h&&(t=h,g.requiresSelectionId(e)&&(t=new M.IdentifierNode(t))),t=R.StackNode.make(t,e)||t}p.isUnitModel(e)&&(t=S.FilterInvalidNode.make(t,e)||t);var _=e.getName(s.MAIN),O=new w.OutputNode(t,_,s.MAIN,o);n[_]=O,t=O;var C=null;if(p.isFacetModel(e)){var L=e.getName("facet");C=new E.FacetNode(t,e,L,O.getSource()),n[L]=C,t=C}var z=r({},e.component.data.ancestorParse,l?l.parse:{});return r({},e.component.data,{outputNodes:n,outputNodeRefCounts:o,raw:d,main:O,facetRoot:C,ancestorParse:z})}},"4UeO":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("EflS");t.ConcatProgram=function(){return function(e,t){this.variableNames=["A","B"],this.outputShape=[],this.outputShape=r.computeOutShape(e,t,1),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        float value = 0.0;\n        if (yC < "+e[1]+") {\n          value = getA(yR, yC);\n        } else {\n          yC -= "+e[1]+";\n          value = getB(yR, yC);\n        }\n\n        setOutput(value);\n      }\n    "}}()},"4dK1":function(e,t,n){(function(e){var r;!function(e,o,s){function u(f,e){return e.a=f.a,e.b=f.b,e.c=f.c,e.d=f.d,e}function l(e,t){var n=new function(e){var t=this,n="";t.next=function(){var b=t.b,e=t.c,n=t.d,a=t.a;return b=b<<25^b>>>7^e,e=e-n|0,n=n<<24^n>>>8^a,a=a-b|0,t.b=b=b<<20^b>>>12^e,t.c=e=e-n|0,t.d=n<<16^e>>>16^a,t.a=a-b|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var k=0;k<n.length+20;k++)t.b^=0|n.charCodeAt(k),t.next()}(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&("object"==typeof r&&u(r,n),o.state=function(){return u(n,{})}),o}o&&o.exports?o.exports=l:n("LGuY")&&n("nErl")?void 0===(r=(function(){return l}).call(t,n,t,o))||(o.exports=r):this.tychei=l}(0,"object"==typeof e&&e,n("LGuY"))}).call(t,n("3IRH")(e))},"4ll/":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("qmZh");t.backend=r;var o=n("UNfQ"),s=n("K5jy");t.Callback=s.Callback,t.CallbackList=s.CallbackList,t.CustomCallback=s.CustomCallback;var u=n("MZV5");t.Model=u.Model;var l=n("msRB");t.RNN=l.RNN;var c=n("VKbu");t.Sequential=c.Sequential;var d=n("mFTl");t.SymbolicTensor=d.SymbolicTensor;var h=n("ZyY3");t.version_layers=h.version,t.model=o.ModelExports.model,t.sequential=o.ModelExports.sequential,t.loadModel=o.ModelExports.loadModel,t.input=o.ModelExports.input,t.layers=o.LayerExports,t.constraints=o.ConstraintExports,t.initializers=o.InitializerExports,t.regularizers=o.RegularizerExports},"4qyC":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Conv2DDerFilterProgram=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+e.strideHeight+" - "+e.padInfo.top+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+e.strideWidth+" - "+e.padInfo.left+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},t.Conv2DDerInputProgram=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(t-1-e.padInfo.top)+", "+(n-1-e.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, d2);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}},5:function(e,t){},"5+T6":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("/u4k");t.GatherProgram=function(){return function(e,t,n){this.variableNames=["A","indices"];var o=e.slice();o[n]=t,this.outputShape=o,this.rank=o.length;var s=r.getCoordsDataType(this.rank),u=function(e,t){var n=e.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],i=0;i<e.length;i++)o.push(i===t?"int(getIndices("+r[i]+"))":""+r[i]);return o.join()}(e,n);this.userCode="\n      void main() {\n        "+s+" resRC = getOutputCoords();\n        setOutput(getA("+u+"));\n      }\n    "}}()},"51uB":function(e,t){var n,r,o,value,s={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},u=function(e){throw{name:"SyntaxError",message:e,at:n,text:o}},l=function(e){return e&&e!==r&&u("Expected '"+e+"' instead of '"+r+"'"),r=o.charAt(n),n+=1,r},c=function(){var e,t="";for("-"===r&&(t="-",l("-"));r>="0"&&r<="9";)t+=r,l();if("."===r)for(t+=".";l()&&r>="0"&&r<="9";)t+=r;if("e"===r||"E"===r)for(t+=r,l(),"-"!==r&&"+"!==r||(t+=r,l());r>="0"&&r<="9";)t+=r,l();if(e=+t,isFinite(e))return e;u("Bad number")},d=function(){var e,i,t,n="";if('"'===r)for(;l();){if('"'===r)return l(),n;if("\\"===r)if(l(),"u"===r){for(t=0,i=0;i<4&&(e=parseInt(l(),16),isFinite(e));i+=1)t=16*t+e;n+=String.fromCharCode(t)}else{if("string"!=typeof s[r])break;n+=s[r]}else n+=r}u("Bad string")},h=function(){for(;r&&r<=" ";)l()};value=function(){switch(h(),r){case"{":return function(){var e,t={};if("{"===r){if(l("{"),h(),"}"===r)return l("}"),t;for(;r;){if(e=d(),h(),l(":"),Object.hasOwnProperty.call(t,e)&&u('Duplicate key "'+e+'"'),t[e]=value(),h(),"}"===r)return l("}"),t;l(","),h()}}u("Bad object")}();case"[":return function(){var e=[];if("["===r){if(l("["),h(),"]"===r)return l("]"),e;for(;r;){if(e.push(value()),h(),"]"===r)return l("]"),e;l(","),h()}}u("Bad array")}();case'"':return d();case"-":return c();default:return r>="0"&&r<="9"?c():function(){switch(r){case"t":return l("t"),l("r"),l("u"),l("e"),!0;case"f":return l("f"),l("a"),l("l"),l("s"),l("e"),!1;case"n":return l("n"),l("u"),l("l"),l("l"),null}u("Unexpected '"+r+"'")}()}},e.exports=function(e,t){var s;return o=e,n=0,r=" ",s=value(),h(),r&&u("Syntax error"),"function"==typeof t?function e(n,r){var k,o,value=n[r];if(value&&"object"==typeof value)for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&(void 0!==(o=e(value,k))?value[k]=o:delete value[k]);return t.call(n,r,value)}({"":s},""):s}},"5WUj":function(e,t,n){var r;(function(){var n=this,o=n._,s=Array.prototype,u=Object.prototype,l=Function.prototype,c=s.push,d=s.slice,h=u.toString,p=u.hasOwnProperty,g=Array.isArray,m=Object.keys,v=l.bind,_=Object.create,w=function(){},E=function(e){return e instanceof E?e:this instanceof E?void(this._wrapped=e):new E(e)};"undefined"!=typeof e&&e.exports&&(t=e.exports=E),t._=E,E.VERSION="1.8.3";var O=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(value){return e.call(t,value)};case 2:return function(value,n){return e.call(t,value,n)};case 3:return function(value,n,r){return e.call(t,value,n,r)};case 4:return function(n,value,r,o){return e.call(t,n,value,r,o)}}return function(){return e.apply(t,arguments)}},S=function(value,e,t){return null==value?E.identity:E.isFunction(value)?O(value,e,t):E.isObject(value)?E.matcher(value):E.property(value)};E.iteratee=function(value,e){return S(value,e,1/0)};var A=function(e,t){return function(n){var r=arguments.length;if(r<2||null==n)return n;for(var o=1;o<r;o++)for(var s=arguments[o],u=e(s),l=u.length,i=0;i<l;i++){var c=u[i];t&&void 0!==n[c]||(n[c]=s[c])}return n}},T=function(e){if(!E.isObject(e))return{};if(_)return _(e);w.prototype=e;var t=new w;return w.prototype=null,t},N=function(e){return function(t){return null==t?void 0:t[e]}},M=Math.pow(2,53)-1,C=N("length"),D=function(e){var t=C(e);return"number"==typeof t&&t>=0&&t<=M};function R(e){return function(t,n,r,o){n=O(n,o,4);var s=!D(t)&&E.keys(t),u=(s||t).length,l=e>0?0:u-1;return arguments.length<3&&(r=t[s?s[l]:l],l+=e),function(t,n,r,o,s,u){for(;s>=0&&s<u;s+=e){var l=o?o[s]:s;r=n(r,t[l],l,t)}return r}(t,n,r,s,l,u)}}E.each=E.forEach=function(e,t,n){var i,r;if(t=O(t,n),D(e))for(i=0,r=e.length;i<r;i++)t(e[i],i,e);else{var o=E.keys(e);for(i=0,r=o.length;i<r;i++)t(e[o[i]],o[i],e)}return e},E.map=E.collect=function(e,t,n){t=S(t,n);for(var r=!D(e)&&E.keys(e),o=(r||e).length,s=Array(o),u=0;u<o;u++){var l=r?r[u]:u;s[u]=t(e[l],l,e)}return s},E.reduce=E.foldl=E.inject=R(1),E.reduceRight=E.foldr=R(-1),E.find=E.detect=function(e,t,n){var r;if(void 0!==(r=D(e)?E.findIndex(e,t,n):E.findKey(e,t,n))&&-1!==r)return e[r]},E.filter=E.select=function(e,t,n){var r=[];return t=S(t,n),E.each(e,function(value,e,n){t(value,e,n)&&r.push(value)}),r},E.reject=function(e,t,n){return E.filter(e,E.negate(S(t)),n)},E.every=E.all=function(e,t,n){t=S(t,n);for(var r=!D(e)&&E.keys(e),o=(r||e).length,s=0;s<o;s++){var u=r?r[s]:s;if(!t(e[u],u,e))return!1}return!0},E.some=E.any=function(e,t,n){t=S(t,n);for(var r=!D(e)&&E.keys(e),o=(r||e).length,s=0;s<o;s++){var u=r?r[s]:s;if(t(e[u],u,e))return!0}return!1},E.contains=E.includes=E.include=function(e,t,n,r){return D(e)||(e=E.values(e)),("number"!=typeof n||r)&&(n=0),E.indexOf(e,t,n)>=0},E.invoke=function(e,t){var n=d.call(arguments,2),r=E.isFunction(t);return E.map(e,function(value){var e=r?t:value[t];return null==e?e:e.apply(value,n)})},E.pluck=function(e,t){return E.map(e,E.property(t))},E.where=function(e,t){return E.filter(e,E.matcher(t))},E.findWhere=function(e,t){return E.find(e,E.matcher(t))},E.max=function(e,t,n){var value,r,o=-1/0,s=-1/0;if(null==t&&null!=e)for(var i=0,u=(e=D(e)?e:E.values(e)).length;i<u;i++)(value=e[i])>o&&(o=value);else t=S(t,n),E.each(e,function(value,e,n){((r=t(value,e,n))>s||r===-1/0&&o===-1/0)&&(o=value,s=r)});return o},E.min=function(e,t,n){var value,r,o=1/0,s=1/0;if(null==t&&null!=e)for(var i=0,u=(e=D(e)?e:E.values(e)).length;i<u;i++)(value=e[i])<o&&(o=value);else t=S(t,n),E.each(e,function(value,e,n){((r=t(value,e,n))<s||r===1/0&&o===1/0)&&(o=value,s=r)});return o},E.shuffle=function(e){for(var t,n=D(e)?e:E.values(e),r=n.length,o=Array(r),s=0;s<r;s++)(t=E.random(0,s))!==s&&(o[s]=o[t]),o[t]=n[s];return o},E.sample=function(e,t,n){return null==t||n?(D(e)||(e=E.values(e)),e[E.random(e.length-1)]):E.shuffle(e).slice(0,Math.max(0,t))},E.sortBy=function(e,t,n){return t=S(t,n),E.pluck(E.map(e,function(value,e,n){return{value:value,index:e,criteria:t(value,e,n)}}).sort(function(e,t){var a=e.criteria,b=t.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(a<b||void 0===b)return-1}return e.index-t.index}),"value")};var I=function(e){return function(t,n,r){var o={};return n=S(n,r),E.each(t,function(value,r){var s=n(value,r,t);e(o,value,s)}),o}};E.groupBy=I(function(e,value,t){E.has(e,t)?e[t].push(value):e[t]=[value]}),E.indexBy=I(function(e,value,t){e[t]=value}),E.countBy=I(function(e,value,t){E.has(e,t)?e[t]++:e[t]=1}),E.toArray=function(e){return e?E.isArray(e)?d.call(e):D(e)?E.map(e,E.identity):E.values(e):[]},E.size=function(e){return null==e?0:D(e)?e.length:E.keys(e).length},E.partition=function(e,t,n){t=S(t,n);var r=[],o=[];return E.each(e,function(value,e,n){(t(value,e,n)?r:o).push(value)}),[r,o]},E.first=E.head=E.take=function(e,t,n){if(null!=e)return null==t||n?e[0]:E.initial(e,e.length-t)},E.initial=function(e,t,n){return d.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},E.last=function(e,t,n){if(null!=e)return null==t||n?e[e.length-1]:E.rest(e,Math.max(0,e.length-t))},E.rest=E.tail=E.drop=function(e,t,n){return d.call(e,null==t||n?1:t)},E.compact=function(e){return E.filter(e,E.identity)};var P=function(e,t,n,r){for(var o=[],s=0,i=r||0,u=C(e);i<u;i++){var value=e[i];if(D(value)&&(E.isArray(value)||E.isArguments(value))){t||(value=P(value,t,n));var j=0,l=value.length;for(o.length+=l;j<l;)o[s++]=value[j++]}else n||(o[s++]=value)}return o};function L(e){return function(t,n,r){n=S(n,r);for(var o=C(t),s=e>0?0:o-1;s>=0&&s<o;s+=e)if(n(t[s],s,t))return s;return-1}}function z(e,t,n){return function(r,o,s){var i=0,u=C(r);if("number"==typeof s)e>0?i=s>=0?s:Math.max(s+u,i):u=s>=0?Math.min(s+1,u):s+u+1;else if(n&&s&&u)return r[s=n(r,o)]===o?s:-1;if(o!=o)return(s=t(d.call(r,i,u),E.isNaN))>=0?s+i:-1;for(s=e>0?i:u-1;s>=0&&s<u;s+=e)if(r[s]===o)return s;return-1}}E.flatten=function(e,t){return P(e,t,!1)},E.without=function(e){return E.difference(e,d.call(arguments,1))},E.uniq=E.unique=function(e,t,n,r){E.isBoolean(t)||(r=n,n=t,t=!1),null!=n&&(n=S(n,r));for(var o=[],s=[],i=0,u=C(e);i<u;i++){var value=e[i],l=n?n(value,i,e):value;t?(i&&s===l||o.push(value),s=l):n?E.contains(s,l)||(s.push(l),o.push(value)):E.contains(o,value)||o.push(value)}return o},E.union=function(){return E.uniq(P(arguments,!0,!0))},E.intersection=function(e){for(var t=[],n=arguments.length,i=0,r=C(e);i<r;i++){var o=e[i];if(!E.contains(t,o)){for(var j=1;j<n&&E.contains(arguments[j],o);j++);j===n&&t.push(o)}}return t},E.difference=function(e){var t=P(arguments,!0,!0,1);return E.filter(e,function(value){return!E.contains(t,value)})},E.zip=function(){return E.unzip(arguments)},E.unzip=function(e){for(var t=e&&E.max(e,C).length||0,n=Array(t),r=0;r<t;r++)n[r]=E.pluck(e,r);return n},E.object=function(e,t){for(var n={},i=0,r=C(e);i<r;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n},E.findIndex=L(1),E.findLastIndex=L(-1),E.sortedIndex=function(e,t,n,r){for(var value=(n=S(n,r,1))(t),o=0,s=C(e);o<s;){var u=Math.floor((o+s)/2);n(e[u])<value?o=u+1:s=u}return o},E.indexOf=z(1,E.findIndex,E.sortedIndex),E.lastIndexOf=z(-1,E.findLastIndex),E.range=function(e,t,n){null==t&&(t=e||0,e=0),n=n||1;for(var r=Math.max(Math.ceil((t-e)/n),0),o=Array(r),s=0;s<r;s++,e+=n)o[s]=e;return o};var F=function(e,t,n,r,o){if(!(r instanceof t))return e.apply(n,o);var s=T(e.prototype),u=e.apply(s,o);return E.isObject(u)?u:s};E.bind=function(e,t){if(v&&e.bind===v)return v.apply(e,d.call(arguments,1));if(!E.isFunction(e))throw new TypeError("Bind must be called on a function");var n=d.call(arguments,2),r=function(){return F(e,r,t,this,n.concat(d.call(arguments)))};return r},E.partial=function(e){var t=d.call(arguments,1),n=function(){for(var r=0,o=t.length,s=Array(o),i=0;i<o;i++)s[i]=t[i]===E?arguments[r++]:t[i];for(;r<arguments.length;)s.push(arguments[r++]);return F(e,n,this,this,s)};return n},E.bindAll=function(e){var i,t,n=arguments.length;if(n<=1)throw new Error("bindAll must be passed function names");for(i=1;i<n;i++)e[t=arguments[i]]=E.bind(e[t],e);return e},E.memoize=function(e,t){var n=function(r){var o=n.cache,s=""+(t?t.apply(this,arguments):r);return E.has(o,s)||(o[s]=e.apply(this,arguments)),o[s]};return n.cache={},n},E.delay=function(e,t){var n=d.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},E.defer=E.partial(E.delay,E,1),E.throttle=function(e,t,n){var r,o,s,u=null,l=0;n||(n={});var c=function(){l=!1===n.leading?0:E.now(),u=null,s=e.apply(r,o),u||(r=o=null)};return function(){var d=E.now();l||!1!==n.leading||(l=d);var h=t-(d-l);return r=this,o=arguments,h<=0||h>t?(u&&(clearTimeout(u),u=null),l=d,s=e.apply(r,o),u||(r=o=null)):u||!1===n.trailing||(u=setTimeout(c,h)),s}},E.debounce=function(e,t,n){var r,o,s,u,l,c=function(){var d=E.now()-u;d<t&&d>=0?r=setTimeout(c,t-d):(r=null,n||(l=e.apply(s,o),r||(s=o=null)))};return function(){s=this,o=arguments,u=E.now();var d=n&&!r;return r||(r=setTimeout(c,t)),d&&(l=e.apply(s,o),s=o=null),l}},E.wrap=function(e,t){return E.partial(t,e)},E.negate=function(e){return function(){return!e.apply(this,arguments)}},E.compose=function(){var e=arguments,t=e.length-1;return function(){for(var i=t,n=e[t].apply(this,arguments);i--;)n=e[i].call(this,n);return n}},E.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},E.before=function(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}},E.once=E.partial(E.before,2);var U=!{toString:null}.propertyIsEnumerable("toString"),B=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function V(e,t){var n=B.length,r=e.constructor,o=E.isFunction(r)&&r.prototype||u,s="constructor";for(E.has(e,s)&&!E.contains(t,s)&&t.push(s);n--;)(s=B[n])in e&&e[s]!==o[s]&&!E.contains(t,s)&&t.push(s)}E.keys=function(e){if(!E.isObject(e))return[];if(m)return m(e);var t=[];for(var n in e)E.has(e,n)&&t.push(n);return U&&V(e,t),t},E.allKeys=function(e){if(!E.isObject(e))return[];var t=[];for(var n in e)t.push(n);return U&&V(e,t),t},E.values=function(e){for(var t=E.keys(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=e[t[i]];return r},E.mapObject=function(e,t,n){t=S(t,n);for(var r,o=E.keys(e),s=o.length,u={},l=0;l<s;l++)u[r=o[l]]=t(e[r],r,e);return u},E.pairs=function(e){for(var t=E.keys(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},E.invert=function(e){for(var t={},n=E.keys(e),i=0,r=n.length;i<r;i++)t[e[n[i]]]=n[i];return t},E.functions=E.methods=function(e){var t=[];for(var n in e)E.isFunction(e[n])&&t.push(n);return t.sort()},E.extend=A(E.allKeys),E.extendOwn=E.assign=A(E.keys),E.findKey=function(e,t,n){t=S(t,n);for(var r,o=E.keys(e),i=0,s=o.length;i<s;i++)if(t(e[r=o[i]],r,e))return r},E.pick=function(e,t,n){var r,o,s={},u=e;if(null==u)return s;E.isFunction(t)?(o=E.allKeys(u),r=O(t,n)):(o=P(arguments,!1,!1,1),r=function(value,e,t){return e in t},u=Object(u));for(var i=0,l=o.length;i<l;i++){var c=o[i],value=u[c];r(value,c,u)&&(s[c]=value)}return s},E.omit=function(e,t,n){if(E.isFunction(t))t=E.negate(t);else{var r=E.map(P(arguments,!1,!1,1),String);t=function(value,e){return!E.contains(r,e)}}return E.pick(e,t,n)},E.defaults=A(E.allKeys,!0),E.create=function(e,t){var n=T(e);return t&&E.extendOwn(n,t),n},E.clone=function(e){return E.isObject(e)?E.isArray(e)?e.slice():E.extend({},e):e},E.tap=function(e,t){return t(e),e},E.isMatch=function(e,t){var n=E.keys(t),r=n.length;if(null==e)return!r;for(var o=Object(e),i=0;i<r;i++){var s=n[i];if(t[s]!==o[s]||!(s in o))return!1}return!0};var q=function(a,b,e,t){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof E&&(a=a._wrapped),b instanceof E&&(b=b._wrapped);var n=h.call(a);if(n!==h.call(b))return!1;switch(n){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!=+a?+b!=+b:0==+a?1/+a==1/b:+a==+b;case"[object Date]":case"[object Boolean]":return+a==+b}var r="[object Array]"===n;if(!r){if("object"!=typeof a||"object"!=typeof b)return!1;var o=a.constructor,s=b.constructor;if(o!==s&&!(E.isFunction(o)&&o instanceof o&&E.isFunction(s)&&s instanceof s)&&"constructor"in a&&"constructor"in b)return!1}e=e||[],t=t||[];for(var u=e.length;u--;)if(e[u]===a)return t[u]===b;if(e.push(a),t.push(b),r){if((u=a.length)!==b.length)return!1;for(;u--;)if(!q(a[u],b[u],e,t))return!1}else{var l,c=E.keys(a);if(u=c.length,E.keys(b).length!==u)return!1;for(;u--;)if(!E.has(b,l=c[u])||!q(a[l],b[l],e,t))return!1}return e.pop(),t.pop(),!0};E.isEqual=function(a,b){return q(a,b)},E.isEmpty=function(e){return null==e||(D(e)&&(E.isArray(e)||E.isString(e)||E.isArguments(e))?0===e.length:0===E.keys(e).length)},E.isElement=function(e){return!(!e||1!==e.nodeType)},E.isArray=g||function(e){return"[object Array]"===h.call(e)},E.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},E.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){E["is"+e]=function(t){return h.call(t)==="[object "+e+"]"}}),E.isArguments(arguments)||(E.isArguments=function(e){return E.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(E.isFunction=function(e){return"function"==typeof e||!1}),E.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},E.isNaN=function(e){return E.isNumber(e)&&e!==+e},E.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"===h.call(e)},E.isNull=function(e){return null===e},E.isUndefined=function(e){return void 0===e},E.has=function(e,t){return null!=e&&p.call(e,t)},E.noConflict=function(){return n._=o,this},E.identity=function(value){return value},E.constant=function(value){return function(){return value}},E.noop=function(){},E.property=N,E.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},E.matcher=E.matches=function(e){return e=E.extendOwn({},e),function(t){return E.isMatch(t,e)}},E.times=function(e,t,n){var r=Array(Math.max(0,e));t=O(t,n,1);for(var i=0;i<e;i++)r[i]=t(i);return r},E.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},E.now=Date.now||function(){return(new Date).getTime()};var G={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},W=E.invert(G),H=function(e){var t=function(t){return e[t]},n="(?:"+E.keys(e).join("|")+")",r=RegExp(n),o=RegExp(n,"g");return function(e){return r.test(e=null==e?"":""+e)?e.replace(o,t):e}};E.escape=H(G),E.unescape=H(W),E.result=function(e,t,n){var value=null==e?void 0:e[t];return void 0===value&&(value=n),E.isFunction(value)?value.call(e):value};var X=0;E.uniqueId=function(e){var t=++X+"";return e?e+t:t},E.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Y=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},J=/\\|'|\r|\n|\u2028|\u2029/g,Z=function(e){return"\\"+K[e]};E.template=function(e,t,n){!t&&n&&(t=n),t=E.defaults({},t,E.templateSettings);var r=RegExp([(t.escape||Y).source,(t.interpolate||Y).source,(t.evaluate||Y).source].join("|")+"|$","g"),o=0,s="__p+='";e.replace(r,function(t,n,r,u,l){return s+=e.slice(o,l).replace(J,Z),o=l+t.length,n?s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?s+="'+\n((__t=("+r+"))==null?'':__t)+\n'":u&&(s+="';\n"+u+"\n__p+='"),t}),s+="';\n",t.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var u=new Function(t.variable||"obj","_",s)}catch(e){throw e.source=s,e}var l=function(e){return u.call(this,e,E)};return l.source="function("+(t.variable||"obj")+"){\n"+s+"}",l},E.chain=function(e){var t=E(e);return t._chain=!0,t};var Q=function(e,t){return e._chain?E(t).chain():t};E.mixin=function(e){E.each(E.functions(e),function(t){var n=E[t]=e[t];E.prototype[t]=function(){var e=[this._wrapped];return c.apply(e,arguments),Q(this,n.apply(E,e))}})},E.mixin(E),E.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=s[e];E.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0],Q(this,n)}}),E.each(["concat","join","slice"],function(e){var t=s[e];E.prototype[e]=function(){return Q(this,t.apply(this._wrapped,arguments))}}),E.prototype.value=function(){return this._wrapped},E.prototype.valueOf=E.prototype.toJSON=E.prototype.value,E.prototype.toString=function(){return""+this._wrapped},void 0===(r=(function(){return E}).apply(t,[]))||(e.exports=r)}).call(this)},"5swq":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("XFvI");t.Profiler=function(){function e(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new o)}return e.prototype.profileKernel=function(e,f){var t,n=this,o=this.backendTimer.time(function(){t=f()}),s=t.dataSync();return r.checkForNaN(s,t.dtype,e),o.then(function(r){n.logger.logKernelProfile(e,t,s,r.kernelMs)}),t},e}();var o=function(){function e(){}return e.prototype.logKernelProfile=function(e,t,n,o){var s=r.rightPad(o+"ms",9),u=r.rightPad(e,25),l=t.rank,c=t.size,d=r.rightPad(t.shape.toString(),14);console.log("%c"+u+"\t%c"+s+"\t%c"+l+"D "+d+"\t%c"+c,"font-weight:bold","color:red","color:blue","color: orange")},e}();t.Logger=o},6:function(e,t){},"6MX6":function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("Bsgt"),s=n("KMAE");function u(e){return o.isString(e)?{type:e}:e||{}}t.normalizeAutoSize=function(e,t,n){void 0===n&&(n=!0);var o=r({type:"pad"},u(t),u(e));return"fit"===o.type&&(n||(s.warn(s.message.FIT_NON_SINGLE),o.type="pad")),o};var l=["background","padding","datasets"];t.extractTopLevelProperties=function(e){return l.reduce(function(t,n){return e&&void 0!==e[n]&&(t[n]=e[n]),t},{})}},"6SkM":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("KMAE"),o=n("kglw");t.default={has:function(e){return"interval"!==e.type&&e.nearest},marks:function(e,t,n){var s=o.positionalProjections(t),x=s.x,y=s.y,u=e.mark();if("line"===u||"area"===u)return r.warn(r.message.nearestNotSupportForContinuous(u)),n;var l={name:e.getName("voronoi"),type:"path",from:{data:e.getName("marks")},encode:{enter:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}}},transform:[{type:"voronoi",x:x||!x&&!y?"datum.x":{expr:"0"},y:y||!x&&!y?"datum.y":{expr:"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]},c=0,d=!1;return n.forEach(function(t,i){var n=t.name||"";n===e.component.mark[0].name?c=i:n.indexOf("voronoi")>=0&&(d=!0)}),d||n.splice(c+1,0,l),n}}},"6Tiz":function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("8Wnz"),s=n("Xq4m"),u=n("vyDb"),l=n("paLv"),c=n("MxPC"),d=n("FgHA"),h=n("0vBu"),p=n("Q2Ef"),g=n("F3d7"),m=n("LH1+"),v=n("OiDY"),_=n("QbRd"),w=n("ELZD"),E=n("yI+w"),O=n("EOrY"),S=n("mz/+"),A=n("Qi+2");function T(e){var t=0;return function n(s,T){if(s instanceof O.SourceNode&&(o.isUrlData(s.data)||(e.push(T),T={name:null,source:T.name,transform:[]})),s instanceof m.ParseNode&&(s.parent instanceof O.SourceNode&&!T.source?T.format=r({},T.format||{},{parse:s.assembleFormatParse()}):T.transform=T.transform.concat(s.assembleTransforms())),s instanceof h.FacetNode)return T.name||(T.name="data_"+t++),!T.source||T.transform.length>0?(e.push(T),s.data=T.name):s.data=T.source,void s.assemble().forEach(function(t){return e.push(t)});switch((s instanceof p.FilterNode||s instanceof c.CalculateNode||s instanceof _.GeoPointNode||s instanceof v.GeoJSONNode||s instanceof u.AggregateNode||s instanceof E.LookupNode||s instanceof w.IdentifierNode)&&T.transform.push(s.assemble()),(s instanceof g.FilterInvalidNode||s instanceof l.BinNode||s instanceof A.TimeUnitNode||s instanceof S.StackNode)&&(T.transform=T.transform.concat(s.assemble())),s instanceof u.AggregateNode&&(T.name||(T.name="data_"+t++)),s instanceof d.OutputNode&&(T.source&&0===T.transform.length?s.setSource(T.source):s.parent instanceof d.OutputNode?s.setSource(T.name):(T.name||(T.name="data_"+t++),s.setSource(T.name),1===s.numChildren()&&(e.push(T),T={name:null,source:T.name,transform:[]}))),s.numChildren()){case 0:s instanceof d.OutputNode&&(!T.source||T.transform.length>0)&&e.push(T);break;case 1:n(s.children[0],T);break;default:T.name||(T.name="data_"+t++);var N=T.name;!T.source||T.transform.length>0?e.push(T):N=T.source,s.children.forEach(function(e){n(e,{name:null,source:N,transform:[]})})}}}t.assembleFacetData=function(e){var t=[],n=T(t);return e.children.forEach(function(t){return n(t,{source:e.name,name:null,transform:[]})}),t},t.assembleRootData=function(e,t){var n=s.vals(e.sources),r=[],o=T(r),u=0;n.forEach(function(e){e.hasName()||(e.dataName="source_"+u++);var t=e.assemble();o(e,t)}),r.forEach(function(e){0===e.transform.length&&delete e.transform}),r.sort(function(a,b){return 0===(a.transform||[]).length?-1:0===(b.transform||[]).length?1:0});for(var l=0,c=r;l<c.length;l++)for(var d=0,h=(v=c[l]).transform||[];d<h.length;d++){var p=h[d];"lookup"===p.type&&(p.from=e.outputNodes[p.from].getSource())}for(var g=0,m=r;g<m.length;g++){var v;(v=m[g]).name in t&&(v.values=t[v.name])}return r}},"6xrs":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Bsgt"),o=n("dQN6"),s=n("xdLA"),u=n("utsZ"),l=n("gqjM"),c=n("KMAE"),d=n("D6ZG"),h=n("rxHH"),p=n("Xq4m"),g={zero:1,center:1,normalize:1};function m(e){return!!g[e]}t.isStackOffset=m,t.STACKABLE_MARKS=[d.BAR,d.AREA,d.RULE,d.POINT,d.CIRCLE,d.SQUARE,d.LINE,d.TEXT,d.TICK],t.STACK_BY_DEFAULT_MARKS=[d.BAR,d.AREA],t.stack=function(e,n,g){var v=d.isMarkDef(e)?e.type:e;if(!p.contains(t.STACKABLE_MARKS,v))return null;var _=function(e){var t=e.x,n=e.y;if(l.isFieldDef(t)&&l.isFieldDef(n))if("quantitative"===t.type&&"quantitative"===n.type){if(t.stack)return"x";if(n.stack)return"y";if(!!t.aggregate!=!!n.aggregate)return t.aggregate?"x":"y"}else{if("quantitative"===t.type)return"x";if("quantitative"===n.type)return"y"}else{if(l.isFieldDef(t)&&"quantitative"===t.type)return"x";if(l.isFieldDef(n)&&"quantitative"===n.type)return"y"}}(n);if(!_)return null;var w,E=n[_],O=l.isStringFieldDef(E)?l.vgField(E,{}):void 0,S="x"===_?"y":"x",A=n[S],T=l.isStringFieldDef(A)?l.vgField(A,{}):void 0,N=s.NONPOSITION_CHANNELS.reduce(function(e,t){if(u.channelHasField(n,t)){var o=n[t];(r.isArray(o)?o:[o]).forEach(function(n){var r=l.getFieldDef(n);if(!r.aggregate){var f=l.isStringFieldDef(r)?l.vgField(r,{}):void 0;(!f||f!==T&&f!==O)&&e.push({channel:t,fieldDef:r})}})}return e},[]);return 0===N.length?null:(w=void 0!==E.stack?E.stack:p.contains(t.STACK_BY_DEFAULT_MARKS,v)&&void 0===g?"zero":g)&&m(w)?E.scale&&E.scale.type&&E.scale.type!==h.ScaleType.LINEAR?(c.warn(c.message.cannotStackNonLinearScale(E.scale.type)),null):u.channelHasField(n,_===s.X?s.X2:s.Y2)?(c.warn(c.message.cannotStackRangedMark(_)),null):(E.aggregate&&!p.contains(o.SUM_OPS,E.aggregate)&&c.warn(c.message.stackNonSummativeAggregate(E.aggregate)),{groupbyChannel:A?S:void 0,fieldChannel:_,impute:p.contains(["area","line"],v),stackBy:N,offset:w}):null}},"77UE":function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("Bsgt"),s=n("Td0G"),u=n("Td0G"),l=n("GrTV"),c=n("JFC7"),d=n("D6ZG"),h=n("D6ZG"),p=n("rxHH"),g=n("YsHz"),m=n("0LBb"),v=n("Xq4m");t.defaultViewConfig={width:200,height:200},t.defaultConfig={padding:5,timeFormat:"%b %d, %Y",countTitle:"Number of Records",invalidValues:"filter",view:t.defaultViewConfig,mark:h.defaultMarkConfig,area:{},bar:h.defaultBarConfig,circle:{},geoshape:{},line:{},point:{},rect:{},rule:{color:"black"},square:{},text:{color:"black"},tick:h.defaultTickConfig,box:{size:14,extent:1.5},boxWhisker:{},boxMid:{color:"white"},scale:p.defaultScaleConfig,projection:{},axis:{},axisX:{},axisY:{minExtent:30},axisLeft:{},axisRight:{},axisTop:{},axisBottom:{},axisBand:{},legend:c.defaultLegendConfig,selection:g.defaultConfig,style:{},title:{}},t.initConfig=function(e){return v.mergeDeep(v.duplicate(t.defaultConfig),e)};var _=["view"].concat(d.PRIMITIVE_MARKS,s.COMPOSITE_MARK_STYLES),w=["padding","numberFormat","timeFormat","countTitle","stack","scale","selection","invalidValues","overlay"],E=r({view:["width","height"]},d.VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX,u.VL_ONLY_COMPOSITE_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX);function O(e,t,n){var o="title"===t?m.extractTitleConfig(e.title).mark:e[t];"view"===t&&(n="cell");var s=r({},o,e.style[t]);v.keys(s).length>0&&(e.style[n||t]=s),delete e[t]}t.stripAndRedirectConfig=function(e){e=v.duplicate(e);for(var t=0,n=w;t<n.length;t++)delete e[D=n[t]];if(e.axis)for(var r=0,s=l.VL_ONLY_GUIDE_CONFIG;r<s.length;r++)delete e.axis[D=s[r]];if(e.legend)for(var u=0,c=l.VL_ONLY_GUIDE_CONFIG;u<c.length;u++)delete e.legend[D=c[u]];if(e.mark)for(var h=0,p=d.VL_ONLY_MARK_CONFIG_PROPERTIES;h<p.length;h++)delete e.mark[D=p[h]];for(var g=0,m=_;g<m.length;g++){for(var S=m[g],A=0,T=d.VL_ONLY_MARK_CONFIG_PROPERTIES;A<T.length;A++)delete e[S][D=T[A]];var N=E[S];if(N)for(var M=0,C=N;M<C.length;M++)delete e[S][D=C[M]];O(e,S)}for(var D in O(e,"title","group-title"),e)o.isObject(e[D])&&0===v.keys(e[D]).length&&delete e[D];return v.keys(e).length>0?e:void 0}},"7AlL":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSortField=function(e){return!(!e||"count"!==e.op&&!e.field||!e.op)}},"8Wnz":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isUrlData=function(e){return!!e.url},t.isInlineData=function(e){return!!e.values},t.isNamedData=function(e){return!!e.name},t.MAIN="main",t.RAW="raw"},"8YQ1":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("xdLA"),o=n("KMAE"),s=n("Xq4m"),u=n("OMxB");t.defaultScaleResolve=function(e,t){if(u.isLayerModel(t)||u.isFacetModel(t))return"shared";if(u.isConcatModel(t)||u.isRepeatModel(t))return s.contains(r.POSITION_SCALE_CHANNELS,e)?"independent":"shared";throw new Error("invalid model type for resolve")},t.parseGuideResolve=function(e,t){var n=e.scale[t],u=s.contains(r.POSITION_SCALE_CHANNELS,t)?"axis":"legend";return"independent"===n?("shared"===e[u][t]&&o.warn(o.message.independentScaleMeansIndependentGuide(t)),"independent"):e[u][t]||"shared"}},"8eNT":function(e,t,n){"use strict";(function(e){var r=n("Bsgt");t.a=function(t,n){var o,s=n&&n.property?Object(r.field)(n.property):r.identity;return!Object(r.isObject)(t)||(o=t,"function"==typeof e&&Object(r.isFunction)(e.isBuffer)&&e.isBuffer(o))?s(JSON.parse(t)):function(e,t){return e}(s(t))}}).call(t,n("EuP9").Buffer)},"8na5":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("OZKY"),o=n("6SkM"),s=n("2bHe"),u=n("x8nG"),l=n("+DWr"),c=n("zSGG"),d=n("QCnU"),h={project:s.default,toggle:l.default,scales:u.default,translate:c.default,zoom:d.default,inputs:r.default,nearest:o.default};t.forEachTransform=function(e,t){for(var n in h)h[n].has(e)&&t(h[n])}},"9Nf/":function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("v/P2"),u=n("V6aD"),l=n("XPNO"),c=n("XFvI");function d(e){if(e.filter(function(e){return null==e}).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}t.Gradients=function(){function e(){}return e.gradScope=function(e,t){return u.tidy(e,t,!0)},e.grad=function(f){return c.assert(c.isFunction(f),"The f passed in grad(f) must be a function"),function(x,e){c.assert(x instanceof l.Tensor,"The x passed in grad(f)(x) must be a tensor"),c.assert(null==e||e instanceof l.Tensor,"The dy passed in grad(f)(x, dy) must be a tensor");var t=s.ENV.engine.gradients(function(){return f(x)},[x],e),value=t.value,n=t.grads;return null!=e&&c.assertShapesMatch(value.shape,e.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),value.dispose(),d(n),n[0]}},e.grads=function(f){return c.assert(c.isFunction(f),"The f passed in grads(f) must be a function"),function(e,t){c.assert(Array.isArray(e)&&e.every(function(e){return e instanceof l.Tensor}),"The args passed in grads(f)(args) must be an array of tensors"),c.assert(null==t||t instanceof l.Tensor,"The dy passed in grads(f)(args, dy) must be a tensor");var n=s.ENV.engine.gradients(function(){return f.apply(void 0,e)},e,t),value=n.value,r=n.grads;return null!=t&&c.assertShapesMatch(value.shape,t.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),value.dispose(),d(r),r}},e.valueAndGrad=function(f){return c.assert(c.isFunction(f),"The f passed in valueAndGrad(f) must be a function"),function(x,e){c.assert(x instanceof l.Tensor,"The x passed in valueAndGrad(f)(x) must be a tensor"),c.assert(null==e||e instanceof l.Tensor,"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");var t=s.ENV.engine.gradients(function(){return f(x)},[x],e),n=t.grads,value=t.value;return d(n),{grad:n[0],value:value}}},e.valueAndGrads=function(f){return c.assert(c.isFunction(f),"The f passed in valueAndGrads(f) must be a function"),function(e,t){c.assert(Array.isArray(e)&&e.every(function(e){return e instanceof l.Tensor}),"The args passed in valueAndGrads(f)(args) must be array of tensors"),c.assert(null==t||t instanceof l.Tensor,"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");var n=s.ENV.engine.gradients(function(){return f.apply(void 0,e)},e,t);return null!=t&&c.assertShapesMatch(n.value.shape,t.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),d(n.grads),n}},e.variableGrads=function(f,e){if(c.assert(c.isFunction(f),"The f passed in variableGrads(f) must be a function"),c.assert(null==e||Array.isArray(e)&&e.every(function(e){return e instanceof l.Variable}),"The varList passed in variableGrads(f, varList) must be an array of variables"),null==e)for(var t in e=[],s.ENV.engine.registeredVariables)e.push(s.ENV.engine.registeredVariables[t]);var n=e.length;e=e.filter(function(e){return e.trainable}),c.assert(e.length>0,"variableGrads() expects at least one of the input variables to be trainable, but none of the "+n+" variables is trainable.");var r=s.ENV.engine.gradients(f,e,null,!0),value=r.value,o=r.grads;c.assert(o.some(function(e){return null!=e}),"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),c.assert(0===value.rank,"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+value.rank+" tensor");var u={};return e.forEach(function(e,i){null!=o[i]&&(u[e.name]=o[i])}),{value:value,grads:u}},e.customGrad=function(f){return s.ENV.engine.customGrad(f)},r([o.doc({heading:"Training",subheading:"Gradients"})],e,"grad",null),r([o.doc({heading:"Training",subheading:"Gradients"})],e,"grads",null),r([o.doc({heading:"Training",subheading:"Gradients"})],e,"valueAndGrad",null),r([o.doc({heading:"Training",subheading:"Gradients"})],e,"valueAndGrads",null),r([o.doc({heading:"Training",subheading:"Gradients"})],e,"variableGrads",null),r([o.doc({heading:"Training",subheading:"Gradients"})],e,"customGrad",null),e}()},"9QYT":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("8Wnz"),o=n("Xq4m"),s=n("vyDb"),u=n("FgHA"),l=n("0vBu"),c=n("F3d7"),d=n("Abzp"),h=n("mz/+");function p(e){if(e instanceof l.FacetNode)if(1!==e.numChildren()||e.children[0]instanceof u.OutputNode)!function e(t){if(t instanceof u.OutputNode&&t.type===r.MAIN&&1===t.numChildren()){var n=t.children[0];n instanceof l.FacetNode||(n.swapWithParent(),e(t))}}(e.model.component.data.main),o.flatten(e.children.map((c=e,function e(n){if(!(n instanceof l.FacetNode)){var r=n.clone();if(r instanceof u.OutputNode){var d=t.FACET_SCALE_PREFIX+r.getSource();r.setSource(d),c.model.component.data.outputNodes[d]=r}else(r instanceof s.AggregateNode||r instanceof h.StackNode)&&r.addDimensions(c.fields);return o.flatten(n.children.map(e)).forEach(function(e){return e.parent=r}),[r]}return o.flatten(n.children.map(e))}))).forEach(function(t){return t.parent=e.model.component.data.main});else{var n=e.children[0];(n instanceof s.AggregateNode||n instanceof h.StackNode)&&n.addDimensions(e.fields),n.swapWithParent(),p(e)}else e.children.forEach(p);var c}function g(e){e instanceof c.FilterInvalidNode&&o.every(o.vals(e.filter),function(f){return null===f})&&e.remove(),e instanceof u.OutputNode&&!e.isRequired()&&e.remove(),e.children.forEach(g)}function m(e){var t=[];return e.forEach(function e(n){0===n.numChildren()?t.push(n):n.children.forEach(e)}),t}t.FACET_SCALE_PREFIX="scale_",t.optimizeDataflow=function(e){var t=o.vals(e.sources);t.forEach(g),m(t=t.filter(function(e){return e.numChildren()>0})).forEach(d.iterateFromLeaves(d.removeUnusedSubtrees)),m(t=t.filter(function(e){return e.numChildren()>0})).forEach(d.iterateFromLeaves(d.moveParseUp)),m(t).forEach(d.removeDuplicateTimeUnits),t.forEach(p),o.keys(e.sources).forEach(function(t){0===e.sources[t].numChildren()&&delete e.sources[t]})}},"9d0T":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("rxHH"),o=n("0N5v"),s=n("OMxB");function u(e,t){var n="width"===t?"x":"y",u=e.component.layoutSize.get(t);if(!u||"merged"===u)return[];var d=e.getSizeSignalRef(t).signal;if("range-step"===u){var h=e.getScaleComponent(n);if(h){var p=h.get("type"),g=h.get("range");if(r.hasDiscreteDomain(p)&&o.isVgRangeStep(g)){var m=e.scaleName(n);return s.isFacetModel(e.parent)&&"independent"===e.parent.component.resolve.scale[n]?[l(m,g)]:[l(m,g),{name:d,update:c(m,h,"domain('"+m+"').length")}]}}throw new Error("layout size is range step although there is no rangeStep.")}return[{name:d,value:u}]}function l(e,t){return{name:e+"_step",value:t.step}}function c(e,t,n){var r=t.get("type"),o=t.get("padding"),s=t.get("paddingOuter");s=void 0!==s?s:o;var u=t.get("paddingInner");return"bandspace("+n+", "+(u="band"===r?void 0!==u?u:o:1)+", "+s+") * "+e+"_step"}t.assembleLayoutSignals=function(e){return[].concat(u(e,"width"),u(e,"height"))},t.sizeSignals=u,t.sizeExpr=c},"9g4f":function(e,t,n){(function(e){var r;!function(e,o,s){function u(f,e){return e.i=f.i,e.w=f.w,e.X=f.X.slice(),e}function l(e,t){null==e&&(e=+new Date);var n=new function(e){var t=this;t.next=function(){var e,n,r=t.w,o=t.X,i=t.i;return t.w=r=r+1640531527|0,n=o[i+34&127],e=o[i=i+1&127],n^=n<<13,e^=e<<17,n=o[i]=(n^=n>>>15)^(e^=e>>>12),t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,i,j,o,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),i=0,j=-32;j<u;++j)t&&(r^=t.charCodeAt((j+32)%t.length)),0===j&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,j>=0&&(i=0==(n=s[127&j]^=r+(o=o+1640531527|0))?i+1:0);for(i>=128&&(s[127&(t&&t.length||0)]=-1),i=127,j=512;j>0;--j)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,s[i]=(r^=r>>>15)^(n^=n>>>12);e.w=o,e.X=s,e.i=i}(t,e)}(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&(r.X&&u(r,n),o.state=function(){return u(n,{})}),o}o&&o.exports?o.exports=l:n("LGuY")&&n("nErl")?void 0===(r=(function(){return l}).call(t,n,t,o))||(o.exports=r):this.xor4096=l}(0,"object"==typeof e&&e,n("LGuY"))}).call(t,n("3IRH")(e))},"9j4o":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="http://www.w3.org/1999/xhtml",o={svg:"http://www.w3.org/2000/svg",xhtml:r,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},s=function(e){var t=e+="",i=t.indexOf(":");return i>=0&&"xmlns"!==(t=e.slice(0,i))&&(e=e.slice(i+1)),o.hasOwnProperty(t)?{space:o[t],local:e}:e},u=function(e){var t=s(e);return(t.local?function(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}:function(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===r&&t.documentElement.namespaceURI===r?t.createElement(e):t.createElementNS(n,e)}})(t)};function l(){}var c=function(e){return null==e?l:function(){return this.querySelector(e)}};function d(){return[]}var h=function(e){return null==e?d:function(){return this.querySelectorAll(e)}},p=function(e){return function(){return this.matches(e)}};if("undefined"!=typeof document){var g=document.documentElement;if(!g.matches){var m=g.webkitMatchesSelector||g.msMatchesSelector||g.mozMatchesSelector||g.oMatchesSelector;p=function(e){return function(){return m.call(this,e)}}}}var v=p,_=function(e){return new Array(e.length)};function w(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}w.prototype={constructor:w,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var E="$";function O(e,t,n,r,o,s){for(var u,i=0,l=t.length,c=s.length;i<c;++i)(u=t[i])?(u.__data__=s[i],r[i]=u):n[i]=new w(e,s[i]);for(;i<l;++i)(u=t[i])&&(o[i]=u)}function S(e,t,n,r,o,s,u){var i,l,c,d={},h=t.length,p=s.length,g=new Array(h);for(i=0;i<h;++i)(l=t[i])&&(g[i]=c=E+u.call(l,l.__data__,i,t),c in d?o[i]=l:d[c]=l);for(i=0;i<p;++i)(l=d[c=E+u.call(e,s[i],i,s)])?(r[i]=l,l.__data__=s[i],d[c]=null):n[i]=new w(e,s[i]);for(i=0;i<h;++i)(l=t[i])&&d[g[i]]===l&&(o[i]=l)}function A(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}var T=function(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView};function N(e,t){return e.style.getPropertyValue(t)||T(e).getComputedStyle(e,null).getPropertyValue(t)}function M(e){return e.trim().split(/^|\s+/)}function C(e){return e.classList||new D(e)}function D(e){this._node=e,this._names=M(e.getAttribute("class")||"")}function R(e,t){for(var n=C(e),i=-1,r=t.length;++i<r;)n.add(t[i])}function I(e,t){for(var n=C(e),i=-1,r=t.length;++i<r;)n.remove(t[i])}function P(){this.textContent=""}function L(){this.innerHTML=""}function z(){this.nextSibling&&this.parentNode.appendChild(this)}function F(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function U(){return null}function B(){var e=this.parentNode;e&&e.removeChild(this)}function V(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function q(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}D.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var i=this._names.indexOf(e);i>=0&&(this._names.splice(i,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var G={},W=null;function H(e,t,n){return e=X(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function X(e,t,n){return function(r){var o=W;W=r;try{e.call(this,this.__data__,t,n)}finally{W=o}}}function Y(e){return function(){var t=this.__on;if(t){for(var n,j=0,i=-1,r=t.length;j<r;++j)n=t[j],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?t.length=i:delete this.__on}}}function K(e,value,t){var n=G.hasOwnProperty(e.type)?H:X;return function(r,i,o){var s,u=this.__on,l=n(value,i,o);if(u)for(var j=0,c=u.length;j<c;++j)if((s=u[j]).type===e.type&&s.name===e.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=l,s.capture=t),void(s.value=value);this.addEventListener(e.type,l,t),s={type:e.type,name:e.name,value:value,listener:l,capture:t},u?u.push(s):this.__on=[s]}}function J(e,t,n,r){var o=W;e.sourceEvent=W,W=e;try{return t.apply(n,r)}finally{W=o}}function Z(e,t,n){var r=T(e),o=r.CustomEvent;"function"==typeof o?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(G={mouseenter:"mouseover",mouseleave:"mouseout"}));var Q=[null];function $(e,t){this._groups=e,this._parents=t}function ee(){return new $([[document.documentElement]],Q)}$.prototype=ee.prototype={constructor:$,select:function(e){"function"!=typeof e&&(e=c(e));for(var t=this._groups,n=t.length,r=new Array(n),j=0;j<n;++j)for(var o,s,u=t[j],l=u.length,d=r[j]=new Array(l),i=0;i<l;++i)(o=u[i])&&(s=e.call(o,o.__data__,i,u))&&("__data__"in o&&(s.__data__=o.__data__),d[i]=s);return new $(r,this._parents)},selectAll:function(e){"function"!=typeof e&&(e=h(e));for(var t=this._groups,n=t.length,r=[],o=[],j=0;j<n;++j)for(var s,u=t[j],l=u.length,i=0;i<l;++i)(s=u[i])&&(r.push(e.call(s,s.__data__,i,u)),o.push(s));return new $(r,o)},filter:function(e){"function"!=typeof e&&(e=v(e));for(var t=this._groups,n=t.length,r=new Array(n),j=0;j<n;++j)for(var o,s=t[j],u=s.length,l=r[j]=[],i=0;i<u;++i)(o=s[i])&&e.call(o,o.__data__,i,s)&&l.push(o);return new $(r,this._parents)},data:function(value,e){if(!value)return p=new Array(this.size()),j=-1,this.each(function(e){p[++j]=e}),p;var x,t=e?S:O,n=this._parents,r=this._groups;"function"!=typeof value&&(x=value,value=function(){return x});for(var o=r.length,s=new Array(o),u=new Array(o),l=new Array(o),j=0;j<o;++j){var c=n[j],d=r[j],h=d.length,p=value.call(c,c&&c.__data__,j,n),g=p.length,m=u[j]=new Array(g),v=s[j]=new Array(g);t(c,d,m,v,l[j]=new Array(h),p,e);for(var _,w,E=0,A=0;E<g;++E)if(_=m[E]){for(E>=A&&(A=E+1);!(w=v[A])&&++A<g;);_._next=w||null}}return(s=new $(s,n))._enter=u,s._exit=l,s},enter:function(){return new $(this._enter||this._groups.map(_),this._parents)},exit:function(){return new $(this._exit||this._groups.map(_),this._parents)},merge:function(e){for(var t=this._groups,n=e._groups,r=t.length,o=Math.min(r,n.length),s=new Array(r),j=0;j<o;++j)for(var u,l=t[j],c=n[j],d=l.length,h=s[j]=new Array(d),i=0;i<d;++i)(u=l[i]||c[i])&&(h[i]=u);for(;j<r;++j)s[j]=t[j];return new $(s,this._parents)},order:function(){for(var e=this._groups,j=-1,t=e.length;++j<t;)for(var n,r=e[j],i=r.length-1,o=r[i];--i>=0;)(n=r[i])&&(o&&o!==n.nextSibling&&o.parentNode.insertBefore(n,o),o=n);return this},sort:function(e){function t(a,b){return a&&b?e(a.__data__,b.__data__):!a-!b}e||(e=A);for(var n=this._groups,r=n.length,o=new Array(r),j=0;j<r;++j){for(var s,u=n[j],l=u.length,c=o[j]=new Array(l),i=0;i<l;++i)(s=u[i])&&(c[i]=s);c.sort(t)}return new $(o,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),i=-1;return this.each(function(){e[++i]=this}),e},node:function(){for(var e=this._groups,j=0,t=e.length;j<t;++j)for(var n=e[j],i=0,r=n.length;i<r;++i){var o=n[i];if(o)return o}return null},size:function(){var e=0;return this.each(function(){++e}),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,j=0,n=t.length;j<n;++j)for(var r,o=t[j],i=0,s=o.length;i<s;++i)(r=o[i])&&e.call(r,r.__data__,i,o);return this},attr:function(e,value){var t=s(e);if(arguments.length<2){var n=this.node();return t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}return this.each((null==value?t.local?function(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function(e){return function(){this.removeAttribute(e)}}:"function"==typeof value?t.local?function(e,value){return function(){var t=value.apply(this,arguments);null==t?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}}:function(e,value){return function(){var t=value.apply(this,arguments);null==t?this.removeAttribute(e):this.setAttribute(e,t)}}:t.local?function(e,value){return function(){this.setAttributeNS(e.space,e.local,value)}}:function(e,value){return function(){this.setAttribute(e,value)}})(t,value))},style:function(e,value,t){return arguments.length>1?this.each((null==value?function(e){return function(){this.style.removeProperty(e)}}:"function"==typeof value?function(e,value,t){return function(){var n=value.apply(this,arguments);null==n?this.style.removeProperty(e):this.style.setProperty(e,n,t)}}:function(e,value,t){return function(){this.style.setProperty(e,value,t)}})(e,value,null==t?"":t)):N(this.node(),e)},property:function(e,value){return arguments.length>1?this.each((null==value?function(e){return function(){delete this[e]}}:"function"==typeof value?function(e,value){return function(){var t=value.apply(this,arguments);null==t?delete this[e]:this[e]=t}}:function(e,value){return function(){this[e]=value}})(e,value)):this.node()[e]},classed:function(e,value){var t=M(e+"");if(arguments.length<2){for(var n=C(this.node()),i=-1,r=t.length;++i<r;)if(!n.contains(t[i]))return!1;return!0}return this.each(("function"==typeof value?function(e,value){return function(){(value.apply(this,arguments)?R:I)(this,e)}}:value?function(e){return function(){R(this,e)}}:function(e){return function(){I(this,e)}})(t,value))},text:function(value){return arguments.length?this.each(null==value?P:("function"==typeof value?function(value){return function(){var e=value.apply(this,arguments);this.textContent=null==e?"":e}}:function(value){return function(){this.textContent=value}})(value)):this.node().textContent},html:function(value){return arguments.length?this.each(null==value?L:("function"==typeof value?function(value){return function(){var e=value.apply(this,arguments);this.innerHTML=null==e?"":e}}:function(value){return function(){this.innerHTML=value}})(value)):this.node().innerHTML},raise:function(){return this.each(z)},lower:function(){return this.each(F)},append:function(e){var t="function"==typeof e?e:u(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:u(e),r=null==t?U:"function"==typeof t?t:c(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(B)},clone:function(e){return this.select(e?q:V)},datum:function(value){return arguments.length?this.property("__data__",value):this.node().__data__},on:function(e,value,t){var i,n,r=(e+"").trim().split(/^|\s+/).map(function(e){var t="",i=e.indexOf(".");return i>=0&&(t=e.slice(i+1),e=e.slice(0,i)),{type:e,name:t}}),o=r.length;if(!(arguments.length<2)){for(s=value?K:Y,null==t&&(t=!1),i=0;i<o;++i)this.each(s(r[i],value,t));return this}var s=this.node().__on;if(s)for(var u,j=0,l=s.length;j<l;++j)for(i=0,u=s[j];i<o;++i)if((n=r[i]).type===u.type&&n.name===u.name)return u.value},dispatch:function(e,t){return this.each(("function"==typeof t?function(e,t){return function(){return Z(this,e,t.apply(this,arguments))}}:function(e,t){return function(){return Z(this,e,t)}})(e,t))}};var te=ee,ne=function(e){return"string"==typeof e?new $([[document.querySelector(e)]],[document.documentElement]):new $([[e]],Q)},re=function(e){return ne(u(e).call(document.documentElement))},ie=0;function ae(){return new oe}function oe(){this._="@"+(++ie).toString(36)}oe.prototype=ae.prototype={constructor:oe,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,value){return e[this._]=value},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};var se=function(){for(var e,t=W;e=t.sourceEvent;)t=e;return t},ue=function(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}var o=e.getBoundingClientRect();return[t.clientX-o.left-e.clientLeft,t.clientY-o.top-e.clientTop]},le=function(e){var t=se();return t.changedTouches&&(t=t.changedTouches[0]),ue(e,t)},ce=function(e){return"string"==typeof e?new $([document.querySelectorAll(e)],[document.documentElement]):new $([null==e?[]:e],Q)},fe=function(e,t,n){arguments.length<3&&(n=t,t=se().changedTouches);for(var r,i=0,o=t?t.length:0;i<o;++i)if((r=t[i]).identifier===n)return ue(e,r);return null},de=function(e,t){null==t&&(t=se().touches);for(var i=0,n=t?t.length:0,r=new Array(n);i<n;++i)r[i]=ue(e,t[i]);return r};n.d(t,"create",function(){return re}),n.d(t,"creator",function(){return u}),n.d(t,"local",function(){return ae}),n.d(t,"matcher",function(){return v}),n.d(t,"mouse",function(){return le}),n.d(t,"namespace",function(){return s}),n.d(t,"namespaces",function(){return o}),n.d(t,"clientPoint",function(){return ue}),n.d(t,"select",function(){return ne}),n.d(t,"selectAll",function(){return ce}),n.d(t,"selection",function(){return te}),n.d(t,"selector",function(){return c}),n.d(t,"selectorAll",function(){return h}),n.d(t,"style",function(){return N}),n.d(t,"touch",function(){return fe}),n.d(t,"touches",function(){return de}),n.d(t,"window",function(){return T}),n.d(t,"event",function(){return W}),n.d(t,"customEvent",function(){return J})},"A3i/":function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function u(value){try{c(r.next(value))}catch(e){s(e)}}function l(value){try{c(r.throw(value))}catch(e){s(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,l)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var f,y,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(f)throw new TypeError("Generator is already executing.");for(;o;)try{if(f=1,y&&(n=y[2&r[0]?"return":r[0]?"throw":"next"])&&!(n=n.call(y,r[1])).done)return n;switch(y=0,n&&(r=[0,n.value]),r[0]){case 0:case 1:n=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,y=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){o.label=r[1];break}if(6===r[0]&&o.label<n[1]){o.label=n[1],n=r;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(r);break}n[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],y=0}finally{f=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=n("H/Ud"),u=n("v/P2"),l=n("DqkE"),c=n("bDWH"),d=n("EflS"),h=n("m3RX"),p=n("m3RX"),g=n("doZ3"),m=n("XPNO"),v=n("3goy"),_=n("XFvI"),w=n("WPJw"),E=function(){function e(){this.data=new WeakMap,"undefined"!=typeof document&&(this.canvas=document.createElement("canvas"))}return e.prototype.register=function(e,t,n){if(this.data.has(e))throw new Error("Data buffer is already registered");this.data.set(e,null)},e.prototype.write=function(e,t){if(null==t)throw new Error("MathBackendCPU.write(): values can not be null");this.throwIfNoData(e),this.data.set(e,t)},e.prototype.fromPixels=function(e,t){if(null==e)throw new Error("MathBackendCPU.writePixels(): pixels can not be null");var n,r;if(e instanceof ImageData)n=e.data;else if(e instanceof HTMLCanvasElement)n=e.getContext("2d").getImageData(0,0,e.width,e.height).data;else{if(!(e instanceof HTMLImageElement||e instanceof HTMLVideoElement))throw new Error("pixels is of unknown type: "+e.constructor.name);if(null==this.canvas)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.canvas.width=e.width,this.canvas.height=e.height,this.canvas.getContext("2d").drawImage(e,0,0,e.width,e.height),n=this.canvas.getContext("2d").getImageData(0,0,e.width,e.height).data}if(4===t)r=new Int32Array(n);else{var o=e.width*e.height;r=new Int32Array(o*t);for(var i=0;i<o;i++)for(var s=0;s<t;++s)r[i*t+s]=n[4*i+s]}return p.tensor3d(r,[e.height,e.width,t],"int32")},e.prototype.read=function(e){return r(this,void 0,void 0,function(){return o(this,function(t){return[2,this.readSync(e)]})})},e.prototype.readSync=function(e){return this.throwIfNoData(e),this.data.get(e)},e.prototype.disposeData=function(e){this.data.has(e)&&this.data.delete(e)},e.prototype.time=function(f){return r(this,void 0,void 0,function(){var e;return o(this,function(t){return e=performance.now(),f(),[2,{kernelMs:performance.now()-e}]})})},e.prototype.memory=function(){return{unreliable:!0}},e.prototype.throwIfNoData=function(e){if(!this.data.has(e))throw new Error("CPU backend: No data found for this tensor. Did you change your backend in the middle of the program? New backends can't use Tensors created with previous backends")},e.prototype.slice=function(x,e,t){for(var n=h.buffer(t,x.dtype),i=0;i<n.size;++i){var r=n.indexToLoc(i),o=r.map(function(t,j){return t+e[j]});n.set.apply(n,[x.get.apply(x,o)].concat(r))}return n.toTensor()},e.prototype.reverse=function(x,e){for(var t=h.buffer(x.shape,x.dtype),n=x.buffer(),r=function(i){var r=t.indexToLoc(i),o=r.slice();e.forEach(function(e){return o[e]=x.shape[e]-1-o[e]}),t.set.apply(t,[n.get.apply(n,o)].concat(r))},i=0;i<t.size;i++)r(i);return t.toTensor()},e.prototype.concat=function(a,b){var e=d.computeOutShape(a.shape,b.shape,1),t=h.buffer(e,a.dtype);if(1===a.shape[0]&&1===b.shape[0]){var n=a.dataSync(),r=b.dataSync(),o=t.values;return o.set(n,0),o.set(r,a.size),t.toTensor()}for(var i=0;i<e[0];++i){for(var j=0;j<a.shape[1];++j)t.set(a.get(i,j),i,j);for(j=0;j<b.shape[1];++j)t.set(b.get(i,j),i,j+a.shape[1])}return t.toTensor()},e.prototype.neg=function(x){return this.multiply(h.scalar(-1),x)},e.prototype.add=function(a,b){return this.broadcastedBinaryOp(a,b,v.upcastType(a.dtype,b.dtype),function(e,t){return e+t})},e.prototype.subtract=function(a,b){return this.broadcastedBinaryOp(a,b,v.upcastType(a.dtype,b.dtype),function(e,t){return e-t})},e.prototype.pow=function(a,b){return this.broadcastedBinaryOp(a,b,a.dtype,function(e,t){return Math.pow(e,t)})},e.prototype.matMul=function(a,b,e,t){for(var n=e?a.shape[0]:a.shape[1],r=e?a.shape[1]:a.shape[0],o=t?b.shape[0]:b.shape[1],s=function(e,i,j){return e.get(i,j)},u=function(e,i,j){return e.get(j,i)},l=e?u:s,c=t?u:s,d=new Float32Array(r*o),p=0,i=0;i<r;++i)for(var j=0;j<o;++j){for(var sum=0,k=0;k<n;++k)sum+=l(a,i,k)*c(b,k,j);d[p++]=sum}return h.tensor2d(d,[r,o])},e.prototype.multiply=function(a,b){return this.broadcastedBinaryOp(a,b,v.upcastType(a.dtype,b.dtype),function(e,t){return e*t})},e.prototype.divide=function(a,b){return this.broadcastedBinaryOp(a,b,"float32",function(e,t){return e/t})},e.prototype.sum=function(x,e){l.assertAxesAreInnerMostDims("sum",e,x.rank);for(var t=l.computeOutAndReduceShapes(x.shape,e),n=t[0],r=t[1],o=v.upcastType(x.dtype,"int32"),s=h.zeros(n,o),u=_.sizeFromShape(r),c=s.dataSync(),d=x.dataSync(),i=0;i<c.length;++i){for(var p=i*u,sum=0,j=0;j<u;++j)sum+=d[p+j];c[i]=sum}return s},e.prototype.argMin=function(x,e){l.assertAxesAreInnerMostDims("argMin",e,x.rank);for(var t=l.computeOutAndReduceShapes(x.shape,e),n=t[1],r=h.zeros(t[0],"int32"),o=_.sizeFromShape(n),s=r.dataSync(),u=x.dataSync(),i=0;i<s.length;++i){for(var c=i*o,d=u[c],p=0,j=0;j<o;++j){var value=u[c+j];if(isNaN(value)){p=_.NAN_INT32;break}value<d&&(d=value,p=j)}s[i]=p}return r},e.prototype.argMax=function(x,e){l.assertAxesAreInnerMostDims("argMax",e,x.rank);for(var t=l.computeOutAndReduceShapes(x.shape,e),n=t[1],r=h.zeros(t[0],"int32"),o=_.sizeFromShape(n),s=r.dataSync(),u=x.dataSync(),i=0;i<s.length;++i){for(var c=i*o,d=u[c],p=0,j=0;j<o;++j){var value=u[c+j];if(isNaN(value)){p=_.NAN_INT32;break}value>d&&(d=value,p=j)}s[i]=p}return r},e.prototype.equal=function(a,b){return this.broadcastedBinaryOp(a,b,"bool",function(e,t){return _.isValNaN(e,a.dtype)||_.isValNaN(t,b.dtype)?_.getNaN("bool"):e===t?1:0})},e.prototype.notEqual=function(a,b){return this.broadcastedBinaryOp(a,b,"bool",function(e,t){return _.isValNaN(e,a.dtype)||_.isValNaN(t,b.dtype)?_.getNaN("bool"):e!==t?1:0})},e.prototype.less=function(a,b){return this.broadcastedBinaryOp(a,b,"bool",function(e,t){return _.isValNaN(e,a.dtype)||_.isValNaN(t,b.dtype)?_.getNaN("bool"):e<t?1:0})},e.prototype.lessEqual=function(a,b){return this.broadcastedBinaryOp(a,b,"bool",function(e,t){return _.isValNaN(e,a.dtype)||_.isValNaN(t,b.dtype)?_.getNaN("bool"):e<=t?1:0})},e.prototype.greater=function(a,b){return this.broadcastedBinaryOp(a,b,"bool",function(e,t){return _.isValNaN(e,a.dtype)||_.isValNaN(t,b.dtype)?_.getNaN("bool"):e>t?1:0})},e.prototype.greaterEqual=function(a,b){return this.broadcastedBinaryOp(a,b,"bool",function(e,t){return _.isValNaN(e,a.dtype)||_.isValNaN(t,b.dtype)?_.getNaN("bool"):e>=t?1:0})},e.prototype.logicalNot=function(x){for(var e=x.dataSync(),t=new Int32Array(e.length),i=0;i<e.length;++i)t[i]=_.isValNaN(e[i],x.dtype)?_.getNaN("bool"):e[i]?0:1;return m.Tensor.make(x.shape,{values:t},"bool")},e.prototype.logicalAnd=function(a,b){return this.broadcastedBinaryOp(a,b,"bool",function(e,t){return _.isValNaN(e,a.dtype)||_.isValNaN(t,b.dtype)?_.getNaN("bool"):e&&t})},e.prototype.logicalOr=function(a,b){return this.broadcastedBinaryOp(a,b,"bool",function(e,t){return _.isValNaN(e,a.dtype)||_.isValNaN(t,b.dtype)?_.getNaN("bool"):e||t})},e.prototype.logicalXor=function(a,b){return this.broadcastedBinaryOp(a,b,"bool",function(e,t){return _.isValNaN(e,a.dtype)||_.isValNaN(t,b.dtype)?_.getNaN("bool"):e^t})},e.prototype.where=function(e,a,b,t){for(var n=e.dataSync(),r=a.dataSync(),o=b.dataSync(),s=h.zeros(a.shape,t),u=s.dataSync(),l=0,c=0===e.rank||e.rank>1||1===a.rank?1:a.shape[1],i=0;i<n.length;i++)for(var j=0;j<c;j++)u[l++]=1===n[i]?r[i]:o[i];return s},e.prototype.topKValues=function(x,k){return this.topK(x,k).values},e.prototype.topKIndices=function(x,k){return this.topK(x,k).indices},e.prototype.topK=function(x,k){for(var e=x.dataSync(),t=[],i=0;i<e.length;i++)t.push({value:e[i],index:i});t.sort(function(a,b){return b.value-a.value});var n=_.getTypedArrayFromDType(x.dtype,k),r=new Int32Array(k);for(i=0;i<k;i++)n[i]=t[i].value,r[i]=t[i].index;return{values:h.tensor1d(n,x.dtype),indices:h.tensor1d(r,"int32")}},e.prototype.min=function(x,e){l.assertAxesAreInnerMostDims("min",e,x.rank);for(var t=l.computeOutAndReduceShapes(x.shape,e),n=t[1],r=h.zeros(t[0],x.dtype),o=_.sizeFromShape(n),s=r.dataSync(),u=x.dataSync(),i=0;i<s.length;++i){for(var c=i*o,d=u[0],j=0;j<o;++j){var value=u[c+j];if(isNaN(value)){d=Number.NaN;break}value<d&&(d=value)}s[i]=d}return r},e.prototype.minimum=function(a,b){return this.broadcastedBinaryOp(a,b,a.dtype,function(e,t){return Math.min(e,t)})},e.prototype.max=function(x,e){l.assertAxesAreInnerMostDims("max",e,x.rank);for(var t=l.computeOutAndReduceShapes(x.shape,e),n=t[1],r=h.zeros(t[0],x.dtype),o=_.sizeFromShape(n),s=r.dataSync(),u=x.dataSync(),i=0;i<s.length;++i){for(var c=i*o,d=u[c],j=0;j<o;++j){var value=u[c+j];if(isNaN(value)){d=Number.NaN;break}value>d&&(d=value)}s[i]=d}return r},e.prototype.maximum=function(a,b){return this.broadcastedBinaryOp(a,b,a.dtype,function(e,t){return Math.max(e,t)})},e.prototype.squaredDifference=function(a,b){return this.broadcastedBinaryOp(a,b,a.dtype,function(e,t){var n=e-t;return n*n})},e.prototype.ceil=function(x){for(var e=x.dataSync(),t=new Float32Array(e.length),i=0;i<e.length;++i)t[i]=Math.ceil(e[i]);return m.Tensor.make(x.shape,{values:t})},e.prototype.floor=function(x){for(var e=x.dataSync(),t=new Float32Array(e.length),i=0;i<e.length;++i)t[i]=Math.floor(e[i]);return m.Tensor.make(x.shape,{values:t})},e.prototype.exp=function(x){for(var e=x.dataSync(),t=new Float32Array(e.length),i=0;i<e.length;++i)t[i]=Math.exp(e[i]);return m.Tensor.make(x.shape,{values:t})},e.prototype.expm1=function(x){for(var e=x.dataSync(),t=new Float32Array(e.length),i=0;i<e.length;++i)t[i]=Math.expm1(e[i]);return m.Tensor.make(x.shape,{values:t})},e.prototype.log=function(x){for(var e=x.dataSync(),t=new Float32Array(e.length),i=0;i<e.length;++i)t[i]=Math.log(e[i]);return m.Tensor.make(x.shape,{values:t})},e.prototype.log1p=function(x){for(var e=x.dataSync(),t=new Float32Array(e.length),i=0;i<e.length;++i)t[i]=Math.log1p(e[i]);return m.Tensor.make(x.shape,{values:t})},e.prototype.sqrt=function(x){for(var e=x.dataSync(),t=new Float32Array(e.length),i=0;i<e.length;++i)t[i]=Math.sqrt(e[i]);return m.Tensor.make(x.shape,{values:t})},e.prototype.square=function(x){for(var e=x.dataSync(),t=new Float32Array(e.length),i=0;i<e.length;++i){var value=e[i];t[i]=value*value}return m.Tensor.make(x.shape,{values:t})},e.prototype.relu=function(x){for(var e=h.zeros(x.shape,x.dtype),t=e.dataSync(),n=x.dataSync(),i=0;i<n.length;++i)t[i]=_.isValNaN(n[i],x.dtype)?_.getNaN(e.dtype):Math.max(0,n[i]);return e},e.prototype.elu=function(x){for(var e=new Float32Array(x.size),t=x.dataSync(),i=0;i<t.length;++i){var n=t[i];e[i]=n>=0?n:Math.exp(n)-1}return m.Tensor.make(x.shape,{values:e})},e.prototype.eluDer=function(x){for(var e=new Float32Array(x.size),t=x.dataSync(),i=0;i<t.length;++i){var n=t[i];e[i]=n>=0?1:Math.exp(n)}return m.Tensor.make(x.shape,{values:e})},e.prototype.selu=function(x){for(var e=g.SELU_SCALEALPHA,t=g.SELU_SCALE,n=new Float32Array(x.size),r=x.dataSync(),i=0;i<r.length;++i){var o=r[i];n[i]=o>=0?t*o:e*(Math.exp(o)-1)}return m.Tensor.make(x.shape,{values:n})},e.prototype.leakyRelu=function(x,e){for(var t=new Float32Array(x.size),n=x.dataSync(),i=0;i<n.length;i++){var r=n[i];t[i]=r>=0?r:e*r}return m.Tensor.make(x.shape,{values:t})},e.prototype.prelu=function(x,e){for(var t=new Float32Array(x.size),n=x.dataSync(),r=e.dataSync(),i=0;i<n.length;i++){var o=n[i];t[i]=o>=0?o:r[i]*o}return m.Tensor.make(x.shape,{values:t})},e.prototype.preluDer=function(x,e){for(var t=new Float32Array(x.size),n=x.dataSync(),r=e.dataSync(),i=0;i<n.length;i++){var o=n[i];t[i]=o>0?1:o<0?r[i]:o}return m.Tensor.make(x.shape,{values:t})},e.prototype.clip=function(x,e,t){for(var n=new Float32Array(x.size),r=x.dataSync(),i=0;i<r.length;++i)n[i]=Math.min(t,Math.max(e,r[i]));return m.Tensor.make(x.shape,{values:n})},e.prototype.abs=function(x){for(var e=new Float32Array(x.size),t=x.dataSync(),i=0;i<t.length;++i)e[i]=Math.abs(t[i]);return m.Tensor.make(x.shape,{values:e})},e.prototype.int=function(x){for(var e=new Int32Array(x.size),t=x.dataSync(),i=0;i<t.length;++i)e[i]=t[i];return m.Tensor.make(x.shape,{values:e},"int32")},e.prototype.sigmoid=function(x){for(var e=new Float32Array(x.size),t=x.dataSync(),i=0;i<t.length;++i)e[i]=1/(1+Math.exp(-t[i]));return m.Tensor.make(x.shape,{values:e})},e.prototype.sin=function(x){for(var e=new Float32Array(x.size),t=x.dataSync(),i=0;i<t.length;++i)e[i]=Math.sin(t[i]);return m.Tensor.make(x.shape,{values:e})},e.prototype.cos=function(x){for(var e=new Float32Array(x.size),t=x.dataSync(),i=0;i<t.length;++i)e[i]=Math.cos(t[i]);return m.Tensor.make(x.shape,{values:e})},e.prototype.tan=function(x){for(var e=new Float32Array(x.size),t=x.dataSync(),i=0;i<t.length;++i)e[i]=Math.tan(t[i]);return m.Tensor.make(x.shape,{values:e})},e.prototype.asin=function(x){for(var e=new Float32Array(x.size),t=x.dataSync(),i=0;i<t.length;++i)e[i]=Math.asin(t[i]);return m.Tensor.make(x.shape,{values:e})},e.prototype.acos=function(x){for(var e=new Float32Array(x.size),t=x.dataSync(),i=0;i<t.length;++i)e[i]=Math.acos(t[i]);return m.Tensor.make(x.shape,{values:e})},e.prototype.atan=function(x){for(var e=new Float32Array(x.size),t=x.dataSync(),i=0;i<t.length;++i)e[i]=Math.atan(t[i]);return m.Tensor.make(x.shape,{values:e})},e.prototype.atan2=function(a,b){return this.broadcastedBinaryOp(a,b,a.dtype,function(e,t){return Math.atan2(e,t)})},e.prototype.sinh=function(x){for(var e=new Float32Array(x.size),t=x.dataSync(),i=0;i<t.length;++i)e[i]=Math.sinh(t[i]);return m.Tensor.make(x.shape,{values:e})},e.prototype.cosh=function(x){for(var e=new Float32Array(x.size),t=x.dataSync(),i=0;i<t.length;++i)e[i]=Math.cosh(t[i]);return m.Tensor.make(x.shape,{values:e})},e.prototype.tanh=function(x){for(var e=new Float32Array(x.size),t=x.dataSync(),i=0;i<t.length;++i)e[i]=_.tanh(t[i]);return m.Tensor.make(x.shape,{values:e})},e.prototype.step=function(x,e){void 0===e&&(e=0);for(var t=new Float32Array(x.size),n=x.dataSync(),i=0;i<n.length;++i){var value=n[i];t[i]=_.isValNaN(value,x.dtype)?_.getNaN(x.dtype):value>0?1:e}return m.Tensor.make(x.shape,{values:t})},e.prototype.conv2d=function(x,e,t){for(var n=t.filterHeight,r=t.filterWidth,o=t.dilationHeight,s=t.dilationWidth,u=t.padInfo.left,l=t.padInfo.top,y=h.buffer(t.outShape,x.dtype),b=0;b<t.batchSize;++b)for(var c=0;c<t.outChannels;++c)for(var d=0;d<t.outHeight;++d)for(var p=d*t.strideHeight-u,g=0;g<t.outWidth;++g){for(var m=g*t.strideWidth-l,v=0,_=0;_<n;_++){var w=p+_*o;if(!(w<0||w>=t.inHeight))for(var E=0;E<r;E++){var O=m+E*s;if(!(O<0||O>=t.inWidth))for(var S=0;S<t.inChannels;++S)v+=x.get(b,w,O,S)*e.get(_,E,S,c)}}y.set(v,b,d,g,c)}return y.toTensor()},e.prototype.conv2dDerInput=function(e,t,n){for(var r=n.filterHeight,o=n.filterWidth,s=r-1-n.padInfo.top,u=o-1-n.padInfo.left,l=n.strideHeight,c=n.strideWidth,d=h.buffer(n.inShape,"float32"),b=0;b<n.batchSize;++b)for(var p=0;p<n.inChannels;++p)for(var g=0;g<n.inHeight;++g)for(var m=g-u,v=Math.max(0,Math.ceil(m/l)),_=Math.min(n.outHeight,(r+m)/l),w=0;w<n.inWidth;++w){for(var E=w-s,O=Math.max(0,Math.ceil(E/c)),S=Math.min(n.outWidth,(o+E)/c),A=0,T=v;T<_;++T)for(var N=T*l-m,M=O;M<S;++M)for(var C=M*c-E,D=0;D<n.outChannels;++D)A+=e.get(b,T,M,D)*t.get(r-1-N,o-1-C,p,D);d.set(A,b,g,w,p)}return d.toTensor()},e.prototype.conv2dDerFilter=function(x,e,t){for(var n=t.strideHeight,r=t.strideWidth,o=t.filterHeight,s=t.filterWidth,u=h.buffer(t.filterShape,"float32"),l=t.padInfo.left,c=t.padInfo.top,d=0;d<o;++d)for(var p=Math.max(0,Math.ceil((c-d)/n)),g=Math.min(t.outHeight,(t.inHeight+c-d)/n),m=0;m<s;++m)for(var v=Math.max(0,Math.ceil((l-m)/r)),_=Math.min(t.outWidth,(t.inWidth+l-m)/r),w=0;w<t.inChannels;++w)for(var E=0;E<t.outChannels;++E){for(var O=0,b=0;b<t.batchSize;++b)for(var S=p;S<g;++S)for(var A=d+S*n-c,T=v;T<_;++T)O+=x.get(b,A,m+T*r-l,w)*e.get(b,S,T,E);u.set(O,d,m,w,E)}return u.toTensor()},e.prototype.depthwiseConv2D=function(x,e,t){for(var n=t.filterHeight,r=t.filterWidth,o=t.dilationHeight,s=t.dilationWidth,u=t.padInfo.left,l=t.padInfo.top,c=t.outChannels/t.inChannels,y=h.buffer(t.outShape,x.dtype),b=0;b<t.batchSize;++b)for(var d=0;d<t.inChannels;++d)for(var p=0;p<t.outHeight;++p)for(var g=p*t.strideHeight-u,m=0;m<t.outWidth;++m)for(var v=m*t.strideWidth-l,_=0;_<c;++_){for(var w=0,E=0;E<n;++E){var O=g+E*o;if(!(O<0||O>=t.inHeight))for(var S=0;S<r;++S){var A=v+S*s;A<0||A>=t.inWidth||(w+=x.get(b,O,A,d)*e.get(E,S,d,_))}}y.set(w,b,p,m,d*c+_)}return y.toTensor()},e.prototype.tile=function(x,e){for(var t=new Array(x.rank),i=0;i<t.length;i++)t[i]=x.shape[i]*e[i];var n=h.buffer(t,x.dtype),r=x.buffer();for(i=0;i<n.values.length;++i){for(var o=n.indexToLoc(i),s=new Array(x.rank),u=0;u<s.length;u++)s[u]=o[u]%x.shape[u];var l=r.locToIndex(s);n.values[i]=r.values[l]}return n.toTensor()},e.prototype.pad=function(x,e,t){var n=e.map(function(e,i){return e[0]+x.shape[i]+e[1]}),r=e.map(function(e){return e[0]}),o=x.buffer(),s=h.buffer(n,x.dtype);0!==t&&s.values.fill(t);for(var i=0;i<x.size;i++){var u=o.indexToLoc(i),l=u.map(function(e,i){return e+r[i]});s.set.apply(s,[x.get.apply(x,u)].concat(l))}return s.toTensor()},e.prototype.transpose=function(x,e){for(var t=new Array(x.rank),i=0;i<t.length;i++)t[i]=x.shape[e[i]];var n=x.dataSync(),r=p.buffer(t,x.dtype),o=x.buffer();for(i=0;i<x.size;++i){for(var s=o.indexToLoc(i),u=new Array(s.length),l=0;l<u.length;l++)u[l]=s[e[l]];var c=r.locToIndex(u);r.values[c]=n[i]}return r.toTensor()},e.prototype.gather=function(x,e,t){var n=x.shape.slice(),r=e.dataSync();n[t]=r.length;for(var o=p.buffer(n,x.dtype),s=x.buffer(),i=0;i<o.size;++i){var u=o.indexToLoc(i),l=u.slice();l[t]=r[u[t]];var c=s.locToIndex(l);o.values[i]=s.values[c]}return o.toTensor()},e.prototype.pool=function(x,e,t){for(var n=e.strideHeight,r=e.strideWidth,o=e.filterHeight,s=e.filterWidth,y=h.buffer(e.outShape,"float32"),u=e.padInfo.top,l=e.padInfo.left,b=0;b<e.batchSize;++b)for(var c=0;c<e.inChannels;++c)for(var d=0;d<e.outHeight;++d)for(var p=d*n-u,g=Math.max(0,p),m=Math.min(e.inHeight,o+p),v=0;v<e.outWidth;++v){for(var _=v*r-l,w=Math.max(0,_),E=Math.min(e.inWidth,s+_),O="max"===t?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,S=0,A=g;A<m;++A){for(var T=w;T<E;++T){var N=x.get(b,A,T,c);if(isNaN(N)){O=NaN,S=NaN;break}"max"===t&&N>O||"min"===t&&N<O?O=N:"avg"===t&&(S+=N/(o*s))}if(isNaN(O))break}y.set("avg"===t?S:O,b,d,v,c)}return y.toTensor()},e.prototype.maxPool=function(x,e){return this.pool(x,e,"max")},e.prototype.maxPoolPositions=function(x,e){for(var t=h.buffer(e.outShape,"int32"),n=e.strideHeight,r=e.strideWidth,o=e.filterHeight,s=e.filterWidth,u=e.padInfo.top,l=e.padInfo.left,b=0;b<e.batchSize;++b)for(var c=0;c<e.inChannels;++c)for(var d=0;d<e.outHeight;++d)for(var p=d*n-u,g=Math.max(0,p),m=Math.min(e.inHeight,o+p),v=0;v<e.outWidth;++v){for(var _=v*r-l,w=Math.max(0,_),E=Math.min(e.inWidth,s+_),O=Number.NEGATIVE_INFINITY,S=-1,A=g;A<m;++A)for(var T=A-p,N=w;N<E;++N){var M=N-_,C=x.get(b,A,N,c);C>O&&(O=C,S=T*s+M)}t.set(S,b,d,v,c)}return t.toTensor()},e.prototype.maxPoolBackprop=function(e,x,t){for(var n=this.maxPoolPositions(x,t),r=t.strideHeight,o=t.strideWidth,s=t.filterHeight,u=t.filterWidth,l=u-1-t.padInfo.left,c=s-1-t.padInfo.top,d=h.buffer(x.shape,"float32"),b=0;b<t.batchSize;++b)for(var p=0;p<t.inChannels;++p)for(var g=0;g<t.inHeight;++g)for(var m=0;m<t.inWidth;++m){for(var v=g-c,_=m-l,w=0,E=0;E<s;++E){var O=(v+E)/r;if(!(O<0||O>=t.outHeight||Math.floor(O)!==O))for(var S=0;S<u;++S){var A=(_+S)/o;if(!(A<0||A>=t.outWidth||Math.floor(A)!==A)){var T=s*u-1-n.get(b,O,A,p)===E*u+S?1:0;0!==T&&(w+=e.get(b,O,A,p)*T)}}}d.set(w,b,g,m,p)}return d.toTensor()},e.prototype.avgPoolBackprop=function(e,x,t){for(var n=t.strideHeight,r=t.strideWidth,o=t.filterHeight,s=t.filterWidth,u=s-1-t.padInfo.left,l=o-1-t.padInfo.top,c=h.buffer(x.shape,"float32"),d=1/(o*s),b=0;b<t.batchSize;++b)for(var p=0;p<t.inChannels;++p)for(var g=0;g<t.inHeight;++g)for(var m=0;m<t.inWidth;++m){for(var v=g-l,_=m-u,w=0,E=0;E<o;++E){var O=(v+E)/n;if(!(O<0||O>=t.outHeight||Math.floor(O)!==O))for(var S=0;S<s;++S){var A=(_+S)/r;A<0||A>=t.outWidth||Math.floor(A)!==A||(w+=e.get(b,O,A,p))}}c.set(w*d,b,g,m,p)}return c.toTensor()},e.prototype.cast=function(x,e){return w.castTensor(x,e,this)},e.prototype.reshape=function(x,e){return w.reshapeTensor(x,e)},e.prototype.minPool=function(x,e){return this.pool(x,e,"min")},e.prototype.avgPool=function(x,e){return this.pool(x,e,"avg").toFloat()},e.prototype.resizeBilinear=function(x,e,t,n){for(var r=x.shape,o=r[0],s=r[1],u=r[2],l=r[3],c=h.buffer([o,e,t,l],x.dtype),d=n?[s-1,u-1]:[s,u],p=n?[e-1,t-1]:[e,t],b=0;b<o;b++)for(var g=0;g<e;g++)for(var m=0;m<t;m++)for(var v=0;v<l;v++){var _=d[0]*g/p[0],w=d[1]*m/p[1],E=Math.floor(_),O=Math.min(s-1,Math.ceil(_)),S=Math.floor(w),A=Math.min(u-1,Math.ceil(w)),T=x.get(b,E,S,v),N=x.get(b,O,S,v),M=x.get(b,E,A,v),C=x.get(b,O,A,v),D=w-S,R=T+(M-T)*D;c.set(R+(N+(C-N)*D-R)*(_-E),b,g,m,v)}return c.toTensor()},e.prototype.batchNormalization4D=function(x,e,t,n,r,o){for(var s=x.dataSync(),u=e.dataSync(),l=t.dataSync(),c=r?r.dataSync():new Float32Array([1]),d=o?o.dataSync():new Float32Array([0]),h=new Float32Array(s.length),i=0;i<s.length;i++)h[i]=d[i%d.length]+(s[i]-u[i%u.length])*c[i%c.length]/Math.sqrt(l[i%l.length]+n);return p.tensor4d(h,x.shape)},e.prototype.localResponseNormalization4D=function(x,radius,e,t,n,r){for(var o=h.buffer(x.shape,"float32"),s=radius,u=o.shape[1]-1,l=o.shape[2]-1,c=o.shape[3]-1,d=function(b,e,t,n){for(var sum=0,j=Math.max(0,n-s);j<=Math.min(n+s,c);j++){var r=x.get(b,e,t,j);sum+=r*r}return sum},p=function(b,e,t,n){for(var sum=0,r=Math.max(0,e-s);r<=Math.min(e+s,u);r++)for(var o=Math.max(0,t-s);o<=Math.min(t+s,l);o++)sum+=Math.pow(x.get(b,r,o,n),2);return sum},b=0;b<o.shape[0];b++)for(var g=0;g<=o.shape[1];g++)for(var m=0;m<o.shape[2];m++)for(var v=0;v<o.shape[3];v++){var sum="withinChannel"===r?p(b,g,m,v):d(b,g,m,v),_=x.get(b,g,m,v)*Math.pow(e+t*sum,-n);o.set(_,b,g,m,v)}return o.toTensor()},e.prototype.multinomial=function(e,t,n){for(var r=e.shape[0],o=e.shape[1],u=h.zeros([r,t],"int32"),l=u.dataSync(),c=e.dataSync(),b=0;b<r;++b){var d=b*o,p=new Float32Array(o-1);p[0]=c[d];for(var g=1;g<p.length;++g)p[g]=p[g-1]+c[d+g];for(var m=s.alea(n.toString()),v=b*t,_=0;_<t;++_){var w=m();l[v+_]=p.length;for(var E=0;E<p.length;E++)if(w<p[E]){l[v+_]=E;break}}}return u},e.prototype.oneHot=function(e,t,n,r){var o=new Float32Array(e.size*t);o.fill(r);for(var s=0;s<e.size;++s)o[s*t+e.get(s)]=n;return h.tensor2d(o,[e.size,t])},e.prototype.broadcastedBinaryOp=function(a,b,e,t){for(var n=c.assertAndGetBroadcastShape(a.shape,b.shape),r=h.buffer(n,e),o=a.dataSync(),s=b.dataSync(),u=c.getBroadcastDims(a.shape,n),l=c.getBroadcastDims(b.shape,n),d=a.buffer(),p=b.buffer(),g=function(i){var e=r.indexToLoc(i),n=e.slice(-a.rank);u.forEach(function(e){return n[e]=0});var c=d.locToIndex(n),h=e.slice(-b.rank);l.forEach(function(e){return h[e]=0});var g=p.locToIndex(h);r.values[i]=t(o[c],s[g])},i=0;i<r.values.length;++i)g(i);return r.toTensor()},e.prototype.dispose=function(){},e}();t.MathBackendCPU=E,u.ENV.registerBackend("cpu",function(){return new E})},A6gD:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function u(value){try{c(r.next(value))}catch(e){s(e)}}function l(value){try{c(r.throw(value))}catch(e){s(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,l)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var f,y,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(f)throw new TypeError("Generator is already executing.");for(;o;)try{if(f=1,y&&(n=y[2&r[0]?"return":r[0]?"throw":"next"])&&!(n=n.call(y,r[1])).done)return n;switch(y=0,n&&(r=[0,n.value]),r[0]){case 0:case 1:n=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,y=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){o.label=r[1];break}if(6===r[0]&&o.label<n[1]){o.label=n[1],n=r;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(r);break}n[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],y=0}finally{f=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=n("v/P2"),u=n("DqkE"),l=n("Yt8P"),c=n("XPNO"),d=n("3goy"),h=n("XFvI"),p=n("WPJw"),g=n("q049"),m=n("Dv7J"),v=n("S5zt"),_=n("ccAg"),w=n("ccAg"),E=n("Uujx"),O=n("4UeO"),S=n("4qyC"),A=n("3p3G"),T=n("wSd8"),N=n("vmeP"),M=n("5+T6"),C=n("JnFz"),D=n("pIoe"),R=n("mPLz"),I=n("aXiv"),P=n("xn9R"),L=n("K+ss"),z=n("lBAX"),F=n("RK46"),U=n("wdBI"),B=n("RmJh"),V=n("GxMh"),q=n("kpg/"),G=n("VSJw"),W=n("rd7I"),H=n("IlUm"),X=n("/F3B"),Y=n("gr0I"),K=n("wcX3"),J=n("Q3Cc"),Z=n("Q3Cc"),Q=n("yltK"),$=function(){function e(e,t){if(void 0===t&&(t=!0),this.gpgpu=e,this.delayedStorage=t,this.texData=new WeakMap,this.uploadWaitMs=0,this.downloadWaitMs=0,this.binaryCache={},this.disposed=!1,s.ENV.get("WEBGL_VERSION")<1)throw new Error("WebGL is not supported on this device");null==e?(this.gpgpu=new C.GPGPUContext,this.gpgpuCreatedLocally=!0):this.gpgpuCreatedLocally=!1,"undefined"!=typeof document&&(this.canvas=document.createElement("canvas")),this.textureManager=new X.TextureManager(this.gpgpu)}return e.prototype.register=function(e,t,n){if(this.texData.has(e))throw new Error("Data buffer is already registered");this.texData.set(e,{shape:t,dtype:n,values:null,texture:null,texShape:null,texType:H.TextureType.FLOAT})},e.prototype.fromPixels=function(e,t){if(null==e)throw new Error("MathBackendWebGL.writePixels(): pixels can not be null");var n=[e.height,e.width],r=[e.height,e.width,t];if(e instanceof HTMLVideoElement){if(null==this.canvas)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.canvas.width=e.width,this.canvas.height=e.height,this.canvas.getContext("2d").drawImage(e,0,0,e.width,e.height),e=this.canvas}var o=c.Tensor.make(n,{},"int32");this.texData.get(o.dataId).texType=H.TextureType.UNSIGNED_BYTE,this.gpgpu.uploadPixelDataToTexture(this.getTexture(o.dataId),e);var s=new N.FromPixelsProgram(r),u=this.compileAndRun(s,[o]);return o.dispose(),u},e.prototype.write=function(e,t){if(null==t)throw new Error("MathBackendWebGL.write(): values can not be null");this.throwIfNoData(e);var n=this.texData.get(e),r=n.texture;null!=r&&(this.textureManager.releaseTexture(r,n.texShape,n.texType),n.texture=null,n.texShape=null),n.values=t,this.delayedStorage||this.uploadToGPU(e)},e.prototype.readSync=function(e){this.throwIfNoData(e);var t=this.texData.get(e),n=t.texture,r=t.values,o=t.texShape;if(null!=r)return this.cacheOnCPU(e),r;var s,u=null!=this.activeTimers;u&&(s=performance.now());var l=this.gpgpu.downloadMatrixFromTexture(n,o[0],o[1]);return u&&(this.downloadWaitMs+=performance.now()-s),this.cacheOnCPU(e,l),t.values},e.prototype.read=function(e){return r(this,void 0,void 0,function(){var t,n,r,u,l;return o(this,function(o){switch(o.label){case 0:return this.throwIfNoData(e),t=this.texData.get(e),n=t.texture,u=t.texShape,null!=(r=t.values)?(this.cacheOnCPU(e),[2,r]):s.ENV.get("WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED")?[4,this.gpgpu.downloadMatrixFromTextureAsync(n,u[0],u[1])]:[3,2];case 1:return l=o.sent(),this.cacheOnCPU(e,l),[2,t.values];case 2:return 0===s.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?[2,this.readSync(e)]:[4,this.gpgpu.runQuery(function(){})];case 3:return o.sent(),[2,this.readSync(e)]}})})},e.prototype.time=function(f){return r(this,void 0,void 0,function(){var e,t,n,r,s,u;return o(this,function(o){switch(o.label){case 0:return e=this.activeTimers,t=[],n=!1,null==this.programTimersStack?(this.programTimersStack=t,n=!0):this.activeTimers.push(t),this.activeTimers=t,f(),r=h.flatten(this.activeTimers),this.activeTimers=e,n&&(this.programTimersStack=null),[4,Promise.all(r).then(function(e){var sum=0;return e.forEach(function(e){return sum+=e}),sum})];case 1:return s=o.sent(),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:s,wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},e.prototype.memory=function(){return{unreliable:!1}},e.prototype.startTimer=function(){return s.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?this.gpgpu.beginQuery():{startMs:performance.now(),endMs:null}},e.prototype.endTimer=function(e){return s.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(this.gpgpu.endQuery(),e):(e.endMs=performance.now(),e)},e.prototype.getQueryTime=function(e){return r(this,void 0,void 0,function(){var t;return o(this,function(n){return s.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?[2,this.gpgpu.pollQueryTime(e)]:[2,(t=e).endMs-t.startMs]})})},e.prototype.disposeData=function(e){if(this.texData.has(e)){var t=this.texData.get(e),n=t.texture;null!=n&&this.textureManager.releaseTexture(n,t.texShape,t.texType),this.texData.delete(e)}},e.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},e.prototype.getTextureData=function(e){return this.uploadToGPU(e),this.texData.get(e)},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.slice=function(x,e,t){var n=new W.SliceProgram(t),r=n.getCustomSetupFunc(e);return this.compileAndRun(n,[x],null,r)},e.prototype.reverse=function(x,e){var t=new G.ReverseProgram(x.shape,e);return this.compileAndRun(t,[x])},e.prototype.concat=function(a,b){var e=new O.ConcatProgram(a.shape,b.shape);return this.compileAndRun(e,[a,b])},e.prototype.neg=function(x){var e=new Z.UnaryOpProgram(x.shape,J.NEG);return this.compileAndRun(e,[x])},e.prototype.matMul=function(a,b,e,t){var n=new L.MatMulProgram(a.shape,b.shape,e,t);return this.compileAndRun(n,[a,b])},e.prototype.multiply=function(a,b){var e=new w.BinaryOpProgram(_.MUL,a.shape,b.shape),t=this.makeOutputArray(e.outputShape,d.upcastType(a.dtype,b.dtype));return this.compileAndRun(e,[a,b],t)},e.prototype.batchNormalization4D=function(x,e,t,n,r,o){var s=[x,e,t],u=null;null!=o&&(u=o.shape,s.push(o));var l=null;null!=r&&(l=r.shape,s.push(r));var c=new v.BatchNormProgram(x.shape,e.shape,t.shape,u,l,n);return this.compileAndRun(c,s)},e.prototype.localResponseNormalization4D=function(x,radius,e,t,n,r){var o=new I.LRNProgram(x.shape,radius,e,t,n,r);return this.compileAndRun(o,[x])},e.prototype.tile=function(x,e){var t=new Y.TileProgram(x.shape,e);return this.compileAndRun(t,[x])},e.prototype.pad=function(x,e,t){var n=new U.PadProgram(x.shape,e,t);return this.compileAndRun(n,[x])},e.prototype.transpose=function(x,e){var t=new K.TransposeProgram(x.shape,e);return this.compileAndRun(t,[x])},e.prototype.gather=function(x,e,t){var n=new M.GatherProgram(x.shape,e.size,t);return this.compileAndRun(n,[x,e])},e.prototype.reduce=function(x,e,t){var n=x.shape[0],r=x.shape[1],o=l.computeOptimalWindowSize(r),s=new V.ReduceProgram({windowSize:o,inSize:r,batchSize:n},e),u=s.outputShape,c=this.makeOutputArray([u[0],u[1]],t);return this.compileAndRun(s,[x],c),1===c.shape[1]?c:this.reduce(c,e,t)},e.prototype.argReduce=function(x,e,t){void 0===t&&(t=null);var n=x.shape[0],r=x.shape[1];null!=t&&(n=t.shape[0],r=t.shape[1]);var o=l.computeOptimalWindowSize(r),s=new g.ArgMinMaxProgram({windowSize:o,inSize:r,batchSize:n},e,null==t),u=s.outputShape,c=this.makeOutputArray([u[0],u[1]],"int32"),d=[x];return null!=t&&d.push(t),this.compileAndRun(s,d,c),1===c.shape[1]?c:this.argReduce(x,e,c)},e.prototype.sum=function(x,e){u.assertAxesAreInnerMostDims("sum",e,x.rank);var t=u.computeOutAndReduceShapes(x.shape,e),n=t[0],r=h.sizeFromShape(t[1]),o=x.as2D(-1,r),s=d.sumOutType(x.dtype);return this.reduce(o,"sum",s).reshape(n)},e.prototype.argMin=function(x,e){u.assertAxesAreInnerMostDims("argMin",e,x.rank);var t=u.computeOutAndReduceShapes(x.shape,e),n=t[0],r=h.sizeFromShape(t[1]),o=x.as2D(-1,r);return this.argReduce(o,"min").reshape(n)},e.prototype.argMax=function(x,e){u.assertAxesAreInnerMostDims("argMax",e,x.rank);var t=u.computeOutAndReduceShapes(x.shape,e),n=t[0],r=h.sizeFromShape(t[1]),o=x.as2D(-1,r);return this.argReduce(o,"max").reshape(n)},e.prototype.equal=function(a,b){var e=new w.BinaryOpProgram(_.EQUAL,a.shape,b.shape),t=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[a,b],t)},e.prototype.notEqual=function(a,b){var e=new w.BinaryOpProgram(_.NOT_EQUAL,a.shape,b.shape),t=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[a,b],t)},e.prototype.less=function(a,b){var e=new w.BinaryOpProgram(_.LESS,a.shape,b.shape),t=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[a,b],t)},e.prototype.lessEqual=function(a,b){var e=new w.BinaryOpProgram(_.LESS_EQUAL,a.shape,b.shape),t=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[a,b],t)},e.prototype.greater=function(a,b){var e=new w.BinaryOpProgram(_.GREATER,a.shape,b.shape),t=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[a,b],t)},e.prototype.greaterEqual=function(a,b){var e=new w.BinaryOpProgram(_.GREATER_EQUAL,a.shape,b.shape),t=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[a,b],t)},e.prototype.logicalNot=function(x){var e=new Z.UnaryOpProgram(x.shape,J.LOGICAL_NOT);return this.compileAndRun(e,[x])},e.prototype.logicalAnd=function(a,b){var e=new w.BinaryOpProgram(_.LOGICAL_AND,a.shape,b.shape),t=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[a,b],t)},e.prototype.logicalOr=function(a,b){var e=new w.BinaryOpProgram(_.LOGICAL_OR,a.shape,b.shape),t=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[a,b],t)},e.prototype.logicalXor=function(a,b){var e=new w.BinaryOpProgram(_.LOGICAL_XOR,a.shape,b.shape),t=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[a,b],t)},e.prototype.where=function(e,a,b,t){var n=new R.WhereProgram(e.rank,a.shape,a.rank),r=this.makeOutputArray(n.outputShape,t);return this.compileAndRun(n,[e,a,b],r)},e.prototype.topKValues=function(x,k){throw new Error("topKValues GPU not yet implemented!")},e.prototype.topKIndices=function(x,k){throw new Error("topKIndices GPU not yet implemented!")},e.prototype.min=function(x,e){u.assertAxesAreInnerMostDims("min",e,x.rank);var t=u.computeOutAndReduceShapes(x.shape,e),n=t[0],r=h.sizeFromShape(t[1]),o=x.as2D(-1,r);return this.reduce(o,"min",o.dtype).reshape(n)},e.prototype.minimum=function(a,b){var e=new w.BinaryOpProgram(_.MIN,a.shape,b.shape);return this.compileAndRun(e,[a,b])},e.prototype.max=function(x,e){u.assertAxesAreInnerMostDims("max",e,x.rank);var t=u.computeOutAndReduceShapes(x.shape,e),n=t[0],r=h.sizeFromShape(t[1]),o=x.as2D(-1,r);return this.reduce(o,"max",o.dtype).reshape(n)},e.prototype.maximum=function(a,b){var e=new w.BinaryOpProgram(_.MAX,a.shape,b.shape);return this.compileAndRun(e,[a,b])},e.prototype.squaredDifference=function(a,b){var e=new w.BinaryOpProgram(_.SQUARED_DIFFERENCE,a.shape,b.shape);return this.compileAndRun(e,[a,b])},e.prototype.divide=function(a,b){var e=new w.BinaryOpProgram(_.DIV,a.shape,b.shape),t=this.makeOutputArray(e.outputShape,"float32");return this.compileAndRun(e,[a,b],t)},e.prototype.add=function(a,b){var e=new w.BinaryOpProgram(_.ADD,a.shape,b.shape),t=this.makeOutputArray(e.outputShape,d.upcastType(a.dtype,b.dtype));return this.compileAndRun(e,[a,b],t)},e.prototype.subtract=function(a,b){var e=new w.BinaryOpProgram(_.SUB,a.shape,b.shape),t=this.makeOutputArray(e.outputShape,d.upcastType(a.dtype,b.dtype));return this.compileAndRun(e,[a,b],t)},e.prototype.pow=function(a,b){var e=new w.BinaryOpProgram(_.POW,a.shape,b.shape),t=this.makeOutputArray(e.outputShape,d.upcastType(a.dtype,b.dtype));return this.compileAndRun(e,[a,b],t)},e.prototype.ceil=function(x){var e=new Z.UnaryOpProgram(x.shape,J.CEIL);return this.compileAndRun(e,[x])},e.prototype.floor=function(x){var e=new Z.UnaryOpProgram(x.shape,J.FLOOR);return this.compileAndRun(e,[x])},e.prototype.exp=function(x){var e=new Z.UnaryOpProgram(x.shape,J.EXP);return this.compileAndRun(e,[x])},e.prototype.expm1=function(x){var e=new Z.UnaryOpProgram(x.shape,J.EXPM1);return this.compileAndRun(e,[x])},e.prototype.log=function(x){var e=new Z.UnaryOpProgram(x.shape,J.LOG);return this.compileAndRun(e,[x])},e.prototype.log1p=function(x){var e=new Z.UnaryOpProgram(x.shape,J.LOG1P);return this.compileAndRun(e,[x])},e.prototype.sqrt=function(x){var e=new Z.UnaryOpProgram(x.shape,J.SQRT);return this.compileAndRun(e,[x])},e.prototype.square=function(x){var e=new Z.UnaryOpProgram(x.shape,J.SQUARE);return this.compileAndRun(e,[x])},e.prototype.relu=function(x){var e=new Z.UnaryOpProgram(x.shape,J.RELU);return this.compileAndRun(e,[x])},e.prototype.elu=function(x){var e=new Z.UnaryOpProgram(x.shape,J.ELU);return this.compileAndRun(e,[x])},e.prototype.eluDer=function(x){var e=new Z.UnaryOpProgram(x.shape,J.ELU_DER);return this.compileAndRun(e,[x])},e.prototype.selu=function(x){var e=new Z.UnaryOpProgram(x.shape,J.SELU);return this.compileAndRun(e,[x])},e.prototype.leakyRelu=function(x,e){var t=new Z.UnaryOpProgram(x.shape,J.LEAKY_RELU(e));return this.compileAndRun(t,[x])},e.prototype.prelu=function(a,b){var e=new w.BinaryOpProgram(_.PRELU,a.shape,b.shape);return this.compileAndRun(e,[a,b])},e.prototype.preluDer=function(a,b){var e=new w.BinaryOpProgram(_.PRELU_DER,a.shape,b.shape);return this.compileAndRun(e,[a,b])},e.prototype.int=function(x){var e=new Z.UnaryOpProgram(x.shape,J.TO_INT),t=this.makeOutputArray(e.outputShape,"int32");return this.compileAndRun(e,[x],t)},e.prototype.clip=function(x,e,t){var n=new E.ClipProgram(x.shape,e,t);return this.compileAndRun(n,[x])},e.prototype.abs=function(x){var e=new Z.UnaryOpProgram(x.shape,J.ABS);return this.compileAndRun(e,[x])},e.prototype.sigmoid=function(x){var e=new Z.UnaryOpProgram(x.shape,J.SIGMOID);return this.compileAndRun(e,[x])},e.prototype.sin=function(x){var e=new Z.UnaryOpProgram(x.shape,J.SIN);return this.compileAndRun(e,[x])},e.prototype.cos=function(x){var e=new Z.UnaryOpProgram(x.shape,J.COS);return this.compileAndRun(e,[x])},e.prototype.tan=function(x){var e=new Z.UnaryOpProgram(x.shape,J.TAN);return this.compileAndRun(e,[x])},e.prototype.asin=function(x){var e=new Z.UnaryOpProgram(x.shape,J.ASIN);return this.compileAndRun(e,[x])},e.prototype.acos=function(x){var e=new Z.UnaryOpProgram(x.shape,J.ACOS);return this.compileAndRun(e,[x])},e.prototype.atan=function(x){var e=new Z.UnaryOpProgram(x.shape,J.ATAN);return this.compileAndRun(e,[x])},e.prototype.atan2=function(a,b){var e=new w.BinaryOpProgram(_.ATAN2,a.shape,b.shape);return this.compileAndRun(e,[a,b])},e.prototype.sinh=function(x){var e=new Z.UnaryOpProgram(x.shape,J.SINH);return this.compileAndRun(e,[x])},e.prototype.cosh=function(x){var e=new Z.UnaryOpProgram(x.shape,J.COSH);return this.compileAndRun(e,[x])},e.prototype.tanh=function(x){var e=new Z.UnaryOpProgram(x.shape,J.TANH);return this.compileAndRun(e,[x])},e.prototype.step=function(x,e){var t=new Z.UnaryOpProgram(x.shape,J.STEP(e));return this.compileAndRun(t,[x])},e.prototype.conv2d=function(x,e,t){var n=new A.Conv2DProgram(t);return this.compileAndRun(n,[x,e])},e.prototype.conv2dDerInput=function(e,t,n){var r=new S.Conv2DDerInputProgram(n);return this.compileAndRun(r,[e,t])},e.prototype.conv2dDerFilter=function(x,e,t){var n=new S.Conv2DDerFilterProgram(t);return this.compileAndRun(n,[x,e])},e.prototype.depthwiseConv2D=function(x,e,t){var n=new T.DepthwiseConv2DProgram(t);return this.compileAndRun(n,[x,e])},e.prototype.maxPool=function(x,e){var t=new B.Pool2DProgram(e,"max",!1),n=this.makeOutputArray(t.outputShape,x.dtype);return this.compileAndRun(t,[x],n)},e.prototype.minPool=function(x,e){var t=new B.Pool2DProgram(e,"min",!1),n=this.makeOutputArray(t.outputShape,x.dtype);return this.compileAndRun(t,[x],n)},e.prototype.avgPool=function(x,e){var t=new B.Pool2DProgram(e,"avg",!1),n=this.makeOutputArray(t.outputShape,"float32");return this.compileAndRun(t,[x],n)},e.prototype.maxPoolBackprop=function(e,x,t){var n=new B.Pool2DProgram(t,"max",!0),r=this.compileAndRun(n,[x]),o=new P.MaxPool2DBackpropProgram(t),s=this.makeOutputArray(o.outputShape,x.dtype),u=this.compileAndRun(o,[e,r],s);return r.dispose(),u},e.prototype.avgPoolBackprop=function(e,x,t){var n=new m.AvgPool2DBackpropProgram(t),r=this.makeOutputArray(n.outputShape,x.dtype);return this.compileAndRun(n,[e],r)},e.prototype.cast=function(x,e){return p.castTensor(x,e,this)},e.prototype.reshape=function(x,e){return p.reshapeTensor(x,e)},e.prototype.resizeBilinear=function(x,e,t,n){var r=new q.ResizeBilinearProgram(x.shape,e,t,n);return this.compileAndRun(r,[x])},e.prototype.multinomial=function(e,t,n){var r=new z.MultinomialProgram(e.shape[0],e.shape[1],t),o=this.makeOutputArray(r.outputShape,"int32"),s=r.getCustomSetupFunc(n);return this.compileAndRun(r,[e],o,s)},e.prototype.oneHot=function(e,t,n,r){var o=new F.OneHotProgram(e.size,t,n,r);return this.compileAndRun(o,[e])},e.prototype.makeOutputArray=function(e,t){return c.Tensor.make(e,{},t)},e.prototype.compileAndRun=function(e,t,n,r){var o=this;null==n&&(n=this.makeOutputArray(e.outputShape,t[0].dtype));var s=t.map(function(e){return o.uploadToGPU(e.dataId),{tensor:e,texData:o.texData.get(e.dataId)}});this.uploadToGPU(n.dataId);var u,l={tensor:n,texData:this.texData.get(n.dataId)},c=D.makeShaderKey(e,s,l),d=this.getAndSaveBinary(c,function(){return D.compileProgram(o.gpgpu,e,s,l)}),h=null!=this.activeTimers;return h&&(u=this.startTimer()),D.runProgram(d,s,l,r),h&&(u=this.endTimer(u),this.activeTimers.push(this.getQueryTime(u))),n},e.prototype.getAndSaveBinary=function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){if(!this.disposed){for(var e in this.binaryCache)this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram);this.textureManager.dispose(),this.canvas.remove(),this.gpgpuCreatedLocally&&this.gpgpu.dispose(),this.disposed=!0}},e.prototype.throwIfNoData=function(e){if(!this.texData.has(e))throw new Error("WebGL backend: No data found for this tensor. Did you change your backend in the middle of the program? New backends can't use Tensors created with previous backends")},e.prototype.uploadToGPU=function(e){this.throwIfNoData(e);var t=this.texData.get(e),n=t.shape,r=t.values,o=t.dtype,s=t.texType;if(null==t.texture){var u,l=null!=this.activeTimers;l&&(u=performance.now());var c=Q.getTextureShapeFromLogicalShape(this.gpgpu.gl,n);t.texShape=c;var d=this.textureManager.acquireTexture(c,s);t.texture=d,null!=r&&(this.gpgpu.uploadMatrixToTexture(d,c[0],c[1],function(a,e){if(a instanceof Float32Array)return a;for(var t=new Float32Array(a.length),i=0;i<t.length;i++){var n=a[i];t[i]=h.isValNaN(n,e)?NaN:n}return t}(r,o)),t.values=null,l&&(this.uploadWaitMs+=performance.now()-u))}},e.prototype.cacheOnCPU=function(e,t){var n=this.delayedStorage,r=this.texData.get(e),o=r.texture,s=r.dtype;n&&null!=o&&(this.textureManager.releaseTexture(o,r.texShape,r.texType),r.texture=null,r.texShape=null),null!=t&&(r.values=function(a,e){if("float32"===e)return a;if("int32"===e||"bool"===e){for(var t="int32"===e?new Int32Array(a.length):new Uint8Array(a.length),i=0;i<t.length;++i){var n=a[i];n=isNaN(n)?h.getNaN(e):Math.round(n),t[i]=n}return t}throw new Error("Unknown dtype "+e)}(t,s))},e}();t.MathBackendWebGL=$,s.ENV.registerBackend("webgl",function(){return new $})},ADrU:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("rxHH"),o=n("0N5v"),s=n("aIXu");function u(e){l(e);var t=e.component.layoutSize;t.setWithExplicit("width",c(e,"width")),t.setWithExplicit("height",c(e,"height"))}function l(e){for(var t=0,n=e.children;t<n.length;t++)n[t].parseLayoutSize()}function c(e,t){for(var n,r="width"===t?"x":"y",o=e.component.resolve,u=0,l=e.children;u<l.length;u++){var c=(g=l[u]).component.layoutSize.getWithExplicit(t),d=o.scale[r];if("independent"===d&&"range-step"===c.value){n=void 0;break}if(n){if("independent"===d&&n.value!==c.value){n=void 0;break}n=s.mergeValuesWithExplicit(n,c,t,"")}else n=c}if(n){for(var h=0,p=e.children;h<p.length;h++){var g;e.renameLayoutSize((g=p[h]).getName(t),e.getName(t)),g.component.layoutSize.set(t,"merged",!1)}return n}return{explicit:!1,value:void 0}}function d(e,t){var n=e.config,s=e.getScaleComponent("width"===t?"x":"y");if(s){var u=s.get("type"),l=s.get("range");return r.hasDiscreteDomain(u)&&o.isVgRangeStep(l)?"range-step":n.view[t]}return"width"===t&&"text"===e.mark()?n.scale.textXRangeStep:n.scale.rangeStep||r.defaultScaleConfig.rangeStep}t.parseLayerLayoutSize=u,t.parseRepeatLayoutSize=u,t.parseConcatLayoutSize=function(e){l(e);var t=e.isVConcat?"width":"height";e.component.layoutSize.setWithExplicit(t,c(e,t))},t.parseChildrenLayoutSize=l,t.parseUnitLayoutSize=function(e){var t=e.component.layoutSize;if(!t.explicit.width){var n=d(e,"width");t.set("width",n,!1)}if(!t.explicit.height){var r=d(e,"height");t.set("height",r,!1)}}},AJaF:function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n("JV7f")),r(n("4ll/"));var o=n("JV7f"),s=n("4ll/"),u=n("xuXS");t.version={"tfjs-core":o.version_core,"tfjs-layers":s.version_layers,tfjs:u.version}},AQHg:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("np2E");t.deserialize=function(e,t){return void 0===t&&(t={}),r.deserializeKerasObject(e,r.ClassNameMap.getMap().pythonClassNameMap,t,"layer")}},Abzp:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("Xq4m"),s=n("FgHA"),u=n("0vBu"),l=n("LH1+"),c=n("EOrY"),d=n("Qi+2");function h(f){return function e(t){if(!(t instanceof c.SourceNode)){var n=t.parent;f(t)&&e(n)}}}t.iterateFromLeaves=h,t.moveParseUp=function(e){var t=e.parent;if(e instanceof l.ParseNode){if(t instanceof c.SourceNode)return!1;if(t.numChildren()>1)return!0;if(t instanceof l.ParseNode)t.merge(e);else{if(o.hasIntersection(t.producedFields(),e.dependentFields()))return!0;e.swapWithParent()}}return!0},t.removeUnusedSubtrees=function(e){return!(e instanceof s.OutputNode||e.numChildren()>0||e instanceof u.FacetNode||(e.remove(),0))},t.removeDuplicateTimeUnits=function(e){var t={};return h(function(e){if(e instanceof d.TimeUnitNode){var n=e.producedFields();o.keys(n).every(function(k){return!!t[k]})?e.remove():t=r({},t,n)}return!0})(e)}},BP3J:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("xdLA"),s=n("gqjM"),u=n("rxHH"),l=n("zEzE"),c=n("Xq4m"),d=n("efV4"),h=n("deCJ");function p(e,t){return"top"===t||"bottom"===t?e<=45||315<=e?{value:"top"===t?"bottom":"top"}:135<=e&&e<=225?{value:"top"===t?"top":"bottom"}:{value:"middle"}:e<=45||315<=e||135<=e&&e<=225?{value:"middle"}:45<=e&&e<=135?{value:"left"===t?"top":"bottom"}:{value:"left"===t?"bottom":"top"}}function g(e,t,n){return void 0!==e.labelAngle?(e.labelAngle%360+360)%360:t===o.X&&c.contains([l.NOMINAL,l.ORDINAL],n.type)?270:void 0}function m(e,t){return e=(e%360+360)%360,"top"===t||"bottom"===t?e%180==0?"center":0<e&&e<180?"top"===t?"right":"left":"top"===t?"left":"right":(e+90)%180==0?"center":90<=e&&e<270?"left"===t?"left":"right":"left"===t?"right":"left"}t.labels=function(e,t,n,o){var l=e.fieldDef(t)||("x"===t?e.fieldDef("x2"):"y"===t?e.fieldDef("y2"):void 0),v=e.axis(t),_=e.config,w={};if(s.isTimeFieldDef(l)){var E=e.getScaleComponent(t).get("type")===u.ScaleType.UTC;w.text={signal:d.timeFormatExpression("datum.value",l.timeUnit,v.format,_.axis.shortTimeLabels,_.timeFormat,E)}}var O=h.getAxisConfig("labelAngle",e.config,t,o,e.getScaleComponent(t).get("type"));if(void 0===O&&(O=g(v,t,l))&&(w.angle={value:O}),void 0!==O){var S=m(O,o);S&&(w.align={value:S}),w.baseline=p(O,o)}return w=r({},w,n),0===c.keys(w).length?void 0:w},t.labelBaseline=p,t.labelAngle=g,t.labelAlign=m},Bsgt:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,n){return e.fields=t||[],e.fname=n,e};function o(e){return null==e?null:e.fname}function s(e){return null==e?null:e.fields}var u=function(e){throw Error(e)},l=function(e){var i,j,t,n=[],r=null,b=0,o=e.length,s="";function l(){n.push(s+e.substring(i,j)),s="",i=j+1}for(e+="",i=j=0;j<o;++j)if("\\"===(t=e[j]))s+=e.substring(i,j),i=++j;else if(t===r)l(),r=null,b=-1;else{if(r)continue;i===b&&'"'===t?(i=j+1,r=t):i===b&&"'"===t?(i=j+1,r=t):"."!==t||b?"["===t?(j>i&&l(),b=i=j+1):"]"===t&&(b||u("Access path missing open bracket: "+e),b>0&&l(),b=0,i=j+1):j>i?l():i=j+1}return b&&u("Access path missing closing bracket: "+e),r&&u("Access path missing closing quote: "+e),j>i&&(j++,l()),n},c=Array.isArray,d=function(e){return e===Object(e)},h=function(e){return"string"==typeof e};function p(x){return c(x)?"["+x.map(p)+"]":d(x)||h(x)?JSON.stringify(x).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):x}var g=function(e,t){var n=l(e),o="return _["+n.map(p).join("][")+"];";return r(Function("_",o),[e=1===n.length?n[0]:e],t||e)},m=[],v=g("id"),_=r(function(e){return e},m,"identity"),w=r(function(){return 0},m,"zero"),E=r(function(){return 1},m,"one"),O=r(function(){return!0},m,"true"),S=r(function(){return!1},m,"false");function A(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var T=function(e){var t=e||0;return{level:function(e){return arguments.length?(t=+e,this):t},error:function(){return t>=1&&A("error","ERROR",arguments),this},warn:function(){return t>=2&&A("warn","WARN",arguments),this},info:function(){return t>=3&&A("log","INFO",arguments),this},debug:function(){return t>=4&&A("log","DEBUG",arguments),this}}},N=function(e){return e[e.length-1]},M=function(e){return null==e||""===e?null:+e};function C(e){return function(x){return e*Math.exp(x)}}function D(e){return function(x){return Math.log(e*x)}}function R(e){return function(x){return x<0?-Math.pow(-x,e):Math.pow(x,e)}}function I(e,t,n,r){var o=n(e[0]),s=n(N(e)),u=(s-o)*t;return[r(o-u),r(s-u)]}function P(e,t){return I(e,t,M,_)}function L(e,t){var n=Math.sign(e[0]);return I(e,t,D(n),C(n))}function z(e,t,n){return I(e,t,R(n),R(1/n))}function F(e,t,n,r,o){var s=r(e[0]),u=r(N(e)),l=null!=t?r(t):(s+u)/2;return[o(l+(s-l)*n),o(l+(u-l)*n)]}function U(e,t,n){return F(e,t,n,M,_)}function B(e,t,n){var r=Math.sign(e[0]);return F(e,t,n,D(r),C(r))}function V(e,t,n,r){return F(e,t,n,R(r),R(1/r))}var q=function(e){return null!=e?c(e)?e:[e]:[]},G=function(e){return"function"==typeof e},W=function(e,t){var i,j,f,n,o,u,c,d,h,g=[],m=(e=q(e)).map(function(f,i){return null==f?null:(g.push(i),G(f)?f:l(f).map(p).join("]["))}),v=g.length-1,_=q(t),w="var u,v;return ";if(v<0)return null;for(j=0;j<=v;++j)G(f=m[i=g[j]])?(n="(u=this."+(u="f"+i)+"(a))",o="(v=this."+u+"(b))",(c=c||{})[u]=f):(n="(u=a["+f+"])",o="(v=b["+f+"])"),u="((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))","descending"!==_[i]?(h=1,d=-1):(h=-1,d=1),w+="("+n+"<"+o+"||u==null)&&v!=null?"+d+":(u>v||v==null)&&u!=null?"+h+":"+u+"!==u&&v===v?"+d+":v!==v&&u===u?"+h+(i<v?":":":0");return f=Function("a","b",w+";"),c&&(f=f.bind(c)),e=e.reduce(function(e,t){return G(t)?(s(t)||[]).forEach(function(t){e[t]=1}):null!=t&&(e[t+""]=1),e},{}),r(f,Object.keys(e))},H=function(e){return G(e)?e:function(){return e}},X=function(e,t){var n,r;function o(){t(r),n=r=null}return function(t){r=t,n&&clearTimeout(n),n=setTimeout(o,e)}},Y=function(e){for(var x,k,i=1,t=arguments.length;i<t;++i)for(k in x=arguments[i])e[k]=x[k];return e},K=function(e,f){var a,b,t,n,r,i=-1,o=e.length;if(null==f){for(;++i<o;)if(null!=(b=e[i])&&b>=b){a=t=b;break}for(n=r=i;++i<o;)null!=(b=e[i])&&(a>b&&(a=b,n=i),t<b&&(t=b,r=i))}else{for(;++i<o;)if(null!=(b=f(e[i],i,e))&&b>=b){a=t=b;break}for(n=r=i;++i<o;)null!=(b=f(e[i],i,e))&&(a>b&&(a=b,n=i),t<b&&(t=b,r=i))}return[n,r]},J={},Z=function(e){var t,n,r={};function o(e){return r.hasOwnProperty(e)&&r[e]!==J}return t={size:0,empty:0,object:r,has:o,get:function(e){return o(e)?r[e]:void 0},set:function(e,value){return o(e)||(++t.size,r[e]===J&&--t.empty),r[e]=value,this},delete:function(e){return o(e)&&(--t.size,++t.empty,r[e]=J),this},clear:function(){t.size=t.empty=0,t.object=r={}},test:function(e){return arguments.length?(n=e,t):n},clean:function(){var e,value,o={},s=0;for(e in r)(value=r[e])===J||n&&n(value)||(o[e]=value,++s);t.size=s,t.empty=0,t.object=r=o}},e&&Object.keys(e).forEach(function(n){t.set(n,e[n])}),t},Q=function(e,t){var n=e.prototype=Object.create(t.prototype);return n.constructor=e,n},$=function(e){return"boolean"==typeof e},ee=function(e){return"[object Date]"===Object.prototype.toString.call(e)},te=function(e){return"number"==typeof e},ne=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},re=function(e,t){e&&(e=t?q(e).map(function(f){return f.replace(/\\(.)/g,"$1")}):q(e));var n=e&&e.length?Function("_","return ''+"+e.map(function(f){return"_["+(t?p(f):l(f).map(p).join("]["))+"]"}).join("+'|'+")+";"):function(){return""};return r(n,e,"key")},ie=function(e,t,n,r){var o=t.length,s=n.length;if(!s)return t;if(!o)return n;for(var u=r||new t.constructor(o+s),l=0,c=0,i=0;l<o&&c<s;++i)u[i]=e(t[l],n[c])>0?n[c++]:t[l++];for(;l<o;++l,++i)u[i]=t[l];for(;c<s;++c,++i)u[i]=n[c];return u},ae=function(e,t){for(var n="";--t>=0;)n+=e;return n},oe=function(e,t,n,r){var o=n||" ",s=e+"",u=t-s.length;return u<=0?s:"left"===r?ae(o,u)+s:"center"===r?ae(o,~~(u/2))+s+ae(o,Math.ceil(u/2)):s+ae(o,u)},se=function(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e||!e)};function ue(e){return te(e)?e:ee(e)?e:Date.parse(e)}var le=function(e,t){return t=t||ue,null==e||""===e?null:t(e)},ce=function(e){return null==e||""===e?null:e+""},fe=function(e){for(var t={},i=0,n=e.length;i<n;++i)t[e[i]]=!0;return t},de=function(e,t,n,r){var o=null!=r?r:"\u2026",s=e+"",u=s.length,l=Math.max(0,t-o.length);return u<=t?s:"left"===n?o+s.slice(u-l):"center"===n?s.slice(0,Math.ceil(l/2))+o+s.slice(u-~~(l/2)):s.slice(0,l)+o},he=function(e,t,n){if(e){var r,i=0,o=e.length;if(t)for(;i<o;++i)(r=t(e[i]))&&n(r,i,e);else e.forEach(n)}};n.d(t,"accessor",function(){return r}),n.d(t,"accessorName",function(){return o}),n.d(t,"accessorFields",function(){return s}),n.d(t,"id",function(){return v}),n.d(t,"identity",function(){return _}),n.d(t,"zero",function(){return w}),n.d(t,"one",function(){return E}),n.d(t,"truthy",function(){return O}),n.d(t,"falsy",function(){return S}),n.d(t,"logger",function(){return T}),n.d(t,"None",function(){return 0}),n.d(t,"Error",function(){return 1}),n.d(t,"Warn",function(){return 2}),n.d(t,"Info",function(){return 3}),n.d(t,"Debug",function(){return 4}),n.d(t,"panLinear",function(){return P}),n.d(t,"panLog",function(){return L}),n.d(t,"panPow",function(){return z}),n.d(t,"zoomLinear",function(){return U}),n.d(t,"zoomLog",function(){return B}),n.d(t,"zoomPow",function(){return V}),n.d(t,"array",function(){return q}),n.d(t,"compare",function(){return W}),n.d(t,"constant",function(){return H}),n.d(t,"debounce",function(){return X}),n.d(t,"error",function(){return u}),n.d(t,"extend",function(){return Y}),n.d(t,"extentIndex",function(){return K}),n.d(t,"fastmap",function(){return Z}),n.d(t,"field",function(){return g}),n.d(t,"inherits",function(){return Q}),n.d(t,"isArray",function(){return c}),n.d(t,"isBoolean",function(){return $}),n.d(t,"isDate",function(){return ee}),n.d(t,"isFunction",function(){return G}),n.d(t,"isNumber",function(){return te}),n.d(t,"isObject",function(){return d}),n.d(t,"isRegExp",function(){return ne}),n.d(t,"isString",function(){return h}),n.d(t,"key",function(){return re}),n.d(t,"merge",function(){return ie}),n.d(t,"pad",function(){return oe}),n.d(t,"peek",function(){return N}),n.d(t,"repeat",function(){return ae}),n.d(t,"splitAccessPath",function(){return l}),n.d(t,"stringValue",function(){return p}),n.d(t,"toBoolean",function(){return se}),n.d(t,"toDate",function(){return le}),n.d(t,"toNumber",function(){return M}),n.d(t,"toString",function(){return ce}),n.d(t,"toSet",function(){return fe}),n.d(t,"truncate",function(){return de}),n.d(t,"visitArray",function(){return he})},C5Mr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("H/Ud");t.MPRandGauss=function(){function e(e,t,n,o,s){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var u=s||Math.random();this.random=r.alea(u.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var value=this.nextVal;return this.nextVal=NaN,value}for(var e,t,n=!1;!n;){var r=void 0,o=void 0,s=void 0;do{s=(r=2*this.random()-1)*r+(o=2*this.random()-1)*o}while(s>=1||0===s);var u=Math.sqrt(-2*Math.log(s)/s);e=this.mean+this.stdDev*r*u,t=this.mean+this.stdDev*o*u,this.truncated&&!this.isValidTruncated(e)||(n=!0)}return this.truncated&&!this.isValidTruncated(t)||(this.nextVal=this.convertValue(t)),this.convertValue(e)},e.prototype.convertValue=function(value){return null==this.dtype||"float32"===this.dtype?value:Math.round(value)},e.prototype.isValidTruncated=function(value){return value<=this.upper&&value>=this.lower},e}()},CSN5:function(e,t,n){"use strict";var r=n("TToO").__extends,o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n("KMAE"),u=n("ooBR"),l=n("P+57"),c=n("ndgZ"),d=n("ADrU");t.ConcatModel=function(e){function t(t,n,r,o,l){var d=e.call(this,t,n,r,l,t.resolve)||this;return d.type="concat",t.resolve&&t.resolve.axis&&("shared"===t.resolve.axis.x||"shared"===t.resolve.axis.y)&&s.warn(s.message.CONCAT_CANNOT_SHARE_AXIS),d.isVConcat=u.isVConcatSpec(t),d.children=(u.isVConcatSpec(t)?t.vconcat:t.hconcat).map(function(e,i){return c.buildModel(e,d,d.getName("concat_"+i),void 0,o,l,!1)}),d}return r(t,e),t.prototype.parseLayoutSize=function(){d.parseConcatLayoutSize(this)},t.prototype.parseAxisGroup=function(){return null},t.prototype.assembleLayout=function(){return o({padding:{row:10,column:10},offset:10},this.isVConcat?{columns:1}:{},{bounds:"full",align:"each"})},t}(l.BaseConcatModel)},"D2h/":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.post=function(e,t,n){var r=e.open(t),o=40;e.addEventListener("message",function t(n){n.source===r&&(o=0,e.removeEventListener("message",t,!1))},!1),setTimeout(function e(){o<=0||(r.postMessage(n,"*"),setTimeout(e,250),o-=1)},250)}},D6ZG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n("Bsgt"),s=n("Xq4m");!function(e){e.AREA="area",e.BAR="bar",e.LINE="line",e.POINT="point",e.RECT="rect",e.RULE="rule",e.TEXT="text",e.TICK="tick",e.CIRCLE="circle",e.SQUARE="square",e.GEOSHAPE="geoshape"}(r=t.Mark||(t.Mark={})),t.AREA=r.AREA,t.BAR=r.BAR,t.LINE=r.LINE,t.POINT=r.POINT,t.TEXT=r.TEXT,t.TICK=r.TICK,t.RECT=r.RECT,t.RULE=r.RULE,t.GEOSHAPE=r.GEOSHAPE,t.CIRCLE=r.CIRCLE,t.SQUARE=r.SQUARE;var u={area:1,bar:1,line:1,point:1,text:1,tick:1,rect:1,geoshape:1,rule:1,circle:1,square:1};function l(e){return e.type}t.isMark=function(e){return!!u[e]},t.PRIMITIVE_MARKS=s.flagKeys(u),t.isMarkDef=l;var c=o.toSet(t.PRIMITIVE_MARKS);t.isPrimitiveMark=function(e){return(l(e)?e.type:e)in c},t.STROKE_CONFIG=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity"],t.FILL_CONFIG=["fill","fillOpacity"],t.FILL_STROKE_CONFIG=[].concat(t.STROKE_CONFIG,t.FILL_CONFIG),t.VL_ONLY_MARK_CONFIG_PROPERTIES=["filled","color"],t.VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX={bar:["binSpacing","continuousBandSize","discreteBandSize"],text:["shortTimeLabels"],tick:["bandSize","thickness"]},t.defaultMarkConfig={color:"#4c78a8"},t.defaultBarConfig={binSpacing:1,continuousBandSize:5},t.defaultTickConfig={thickness:1}},DCGi:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("v/P2"),u=n("XFvI"),l=n("35G1");t.ImageOps=function(){function e(){}return e.resizeBilinear=function(e,t,n){void 0===n&&(n=!1),u.assert(3===e.rank||4===e.rank,"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+e.rank+"."),u.assert(2===t.length,"Error in resizeBilinear: new shape must 2D, but got shape "+t+".");var r=e,o=!1;3===e.rank&&(o=!0,r=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var l=t[0],c=t[1],d=s.ENV.engine.runKernel(function(e){return e.resizeBilinear(r,l,c,n)},{batchImages:r});return o?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d},r([o.doc({heading:"Operations",subheading:"Images",namespace:"image"}),l.operation],e,"resizeBilinear",null),e}()},DjcB:function(e,t,n){"use strict";var r=n("TToO").__extends,o=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var s=n("JV7f"),u=n("5WUj"),l=n("qmZh"),c=n("yJL4"),d=n("AQHg"),h=n("mFTl"),p=n("np2E"),g=n("g4zD");t.InputSpec=function(e){this.dtype=e.dtype,this.shape=e.shape,this.ndim=null!=e.shape?e.shape.length:e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}};var m=0,v=function(){function e(e,t){this.callArgs=t,this.id=m++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(var n=0,r=e.inboundLayers;n<r.length;n++){var o=r[n];null!=o&&o.outboundNodes.push(this)}e.outboundLayer.inboundNodes.push(this)}return e.prototype.getConfig=function(){for(var e=[],t=0,n=this.inboundLayers;t<n.length;t++){var r=n[t];e.push(null!=r?r.name:null)}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},e}();t.Node=v;var _=0,w=function(){function e(e){this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=_++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];var t=e.name;if(!t){var n=this.constructor.name;t=p.toSnakeCase(n)+"_"+l.getUid(n)}if(this.name=t,this.trainable=p.pyGetAttr(e,"trainable",!0),this.updatable=p.pyGetAttr(e,"updatable",!0),null!=e.inputShape||null!=e.batchInputShape){var r=void 0;if(null!=e.batchInputShape)r=e.batchInputShape;else if(null!=e.inputShape){var o=null;null!=e.batchSize&&(o=e.batchSize),r=[o].concat(e.inputShape)}this.batchInputShape=r;var s=e.dtype;null==s&&(s=e.inputDType),null==s&&(s=l.floatx()),this.dtype=s}this.initialWeights=null!=e.weights?e.weights:null}return e.nodeKey=function(e,t){return e.name+"_ib-"+t.toString()},e.prototype.getNodeAtIndex=function(e,t){if(0===this.inboundNodes.length)throw new c.RuntimeError("The layer has never been called and thus has no defined "+t+".");if(this.inboundNodes.length<=e)throw new c.ValueError("Asked to get "+t+" at node "+e+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[e]},e.prototype.getInputAt=function(e){return p.singletonOrArray(this.getNodeAtIndex(e,"input").inputTensors)},e.prototype.getOutputAt=function(e){return p.singletonOrArray(this.getNodeAtIndex(e,"output").outputTensors)},Object.defineProperty(e.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new c.AttributeError("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new c.AttributeError("Layer "+this.name+" is not connected, no input to return.");return p.singletonOrArray(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"output",{get:function(){if(0===this.inboundNodes.length)throw new c.AttributeError("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new c.AttributeError("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return p.singletonOrArray(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),e.prototype.calculateLosses=function(){return this.losses.map(function(e){return e()})},Object.defineProperty(e.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"built",{get:function(){return this._built},set:function(e){this._built=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.trainable?this._trainableWeights:[]},set:function(weights){this._trainableWeights=weights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._nonTrainableWeights:this._trainableWeights.concat(this._nonTrainableWeights)},set:function(weights){this._nonTrainableWeights=weights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),e.prototype.assertInputCompatibility=function(e){if(e=p.toList(e),null!=this.inputSpec&&0!==this.inputSpec.length){var t=p.toList(this.inputSpec);if(e.length!==t.length)throw new c.ValueError("Layer "+this.name+" expects "+t.length+" inputs, but it received "+e.length+" input tensors. Input received: "+e);for(var n=0;n<e.length;n++){var x=e[n],r=t[n];if(null!=r){var o=l.ndim(x);if(null!=r.ndim&&o!==r.ndim)throw new c.ValueError("Input "+n+" is incompatible with layer "+this.name+": expected ndim="+r.ndim+", found ndim="+o);if(null!=r.maxNDim&&o>r.maxNDim)throw new c.ValueError("Input "+n+" is incompatible with layer "+this.name+": expected max_ndim="+r.maxNDim+", found ndim="+o);if(null!=r.minNDim&&o<r.minNDim)throw new c.ValueError("Input "+n+" is incompatible with layer "+this.name+": expected min_ndim="+r.minNDim+", found ndim="+o+".");if(null!=r.dtype&&l.dtype(x)!==r.dtype){var s=l.dtype(x);throw new c.ValueError("Input "+n+" is incompatible with layer "+this.name+" : expected dtype="+r.dtype+", found dtype="+s+".")}if(r.axes)for(var d=l.intShape(x),h=0,g=u.pairs(r.axes);h<g.length;h++){var m=g[h],v=m[0],value=m[1];if(v=Number(v),null!=value&&!u.contains([value,null],v>=0?d[v]:d[d.length+v]))throw new c.ValueError("Input "+n+" is incompatible with layer "+this.name+": expected axis "+v+" of input shape to have value "+value+" but got shape "+d+".")}if(null!=r.shape){d=l.intShape(x);for(var _=0,w=u.zip(r.shape,d);_<w.length;_++){var E=w[_],O=E[0],S=E[1];if(null!=O&&null!=S&&O!==S)throw new c.ValueError("Input "+n+" is incompatible with layer "+this.name+": expected shape="+r.shape+", found shape=${xShape}.")}}}}}},e.prototype.call=function(e,t){return e},e.prototype.invokeCallHook=function(e,t){null!=this._callHook&&this._callHook(e,t)},e.prototype.setCallHook=function(e){this._callHook=e},e.prototype.clearCallHook=function(){this._callHook=null},e.prototype.apply=function(e,t){var n=this;t=t||{};var r=p.toList(e),o=u.every(r,function(x){return x instanceof h.SymbolicTensor}),s=u.every(r,function(x){return!(x instanceof h.SymbolicTensor)});if(o===s)throw new c.ValueError("Arguments to apply() must be all SymbolicTensors or all Tensors");return l.nameScope(this.name,function(){if(!n.built){n.assertInputCompatibility(e);for(var o=[],d=0,g=p.toList(e);d<g.length;d++)o.push(l.intShape(g[d]));n.build(p.singletonOrArray(o)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights)}if(n.assertInputCompatibility(e),s){for(var m=n.call(e,t),v=[],_=0,w=p.toList(m);_<w.length;_++){var x=w[_];u.contains(r,x)&&(x=l.identity(x)),v.push(x)}if(m=p.singletonOrArray(v),null!=n.activityRegularizer)throw new c.NotImplementedError("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return m}var E=function(t){for(var n=[],r=0,o=p.toList(e);r<o.length;r++)n.push(l.intShape(o[r]));return p.singletonOrArray(n)}(),O=n.computeOutputShape(E),S=(m=void 0,h.DType.float32);if(m=null!=O&&O.length>0&&Array.isArray(O[0])?O.map(function(r,o){return new h.SymbolicTensor(S,r,n,p.toList(e),t,n.name,o)}):new h.SymbolicTensor(S,O,n,p.toList(e),t,n.name),n.addInboundNode(e,m,null,null,E,O,t),null!=n.activityRegularizer)throw new c.NotImplementedError("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return m})},e.prototype.build=function(e){this.built=!0},e.prototype.getWeights=function(){return l.batchGetValue(this.weights)},e.prototype.setWeights=function(weights){var e=this.weights;if(e.length!==weights.length)throw new c.ValueError('You called setWeights(weights) on layer "'+this.name+'" with a weight list of length '+weights.length+", but the layer was expecting "+e.length+" weights. Provided weights: "+weights+"...");if(0!==e.length){for(var t=[],n=l.batchGetValue(e),r=0,o=u.zip(n,e,weights);r<o.length;r++){var s=o[r],d=s[0],h=s[1],p=s[2];if(!u.isEqual(d.shape,p.shape))throw new c.ValueError("Layer weight shape "+d.shape+" not compatible with provided weight shape "+p.shape);t.push([h,p])}l.batchSetValue(t)}},e.prototype.addWeight=function(e,t,n,r,o,s,u){if(-1!==this._addedWeightNames.indexOf(e))throw new c.ValueError("Duplicate weight name "+e+" for layer "+this.name);this._addedWeightNames.push(e),null==n&&(n=l.floatx());var d=new h.LayerVariable(r.apply(t,n),n,e,s,u);return null!=o&&this.addLoss(function(){return o.apply(d.read())}),null==s&&(s=!0),s?this._trainableWeights.push(d):this._nonTrainableWeights.push(d),d},e.prototype.addLoss=function(e){var t;null==e||Array.isArray(e)&&0===e.length||(e=p.toList(e),void 0!==this._losses&&null!==this._losses&&(t=this.losses).push.apply(t,e))},e.prototype.computeOutputShape=function(e){return e},e.prototype.computeMask=function(e,t){if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer "+this.name+" does not support masking,but was passed an inputMask.");if(u.any(t))throw new TypeError("Layer "+this.name+" does not support masking,but was passed an inputMask.")}return null}return t},e.prototype.addInboundNode=function(e,t,n,r,o,s,u){void 0===u&&(u=null);var l=p.toList(e);t=p.toList(t),n=p.toList(n),r=p.toList(r),o=p.normalizeShapeList(o),s=p.normalizeShapeList(s);for(var c=[],d=[],h=[],g=0,m=l;g<m.length;g++){var x=m[g];c.push(x.sourceLayer),d.push(x.nodeIndex),h.push(x.tensorIndex)}new v({outboundLayer:this,inboundLayers:c,nodeIndices:d,tensorIndices:h,inputTensors:l,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:o,outputShapes:s},u);for(var i=0;i<t.length;i++)t[i].sourceLayer=this,t[i].nodeIndex=this.inboundNodes.length-1,t[i].tensorIndex=i},e.prototype.getConfig=function(){var e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e},e.fromConfig=function(e,t){return new e(t)},o([s.doc({heading:"Models",subheading:"Classes"})],e.prototype,"apply",null),o([s.doc({heading:"Layers",subheading:"Classes",namespace:"layers"})],e)}();t.Layer=w;var E=function(e){function t(t){var n=e.call(this,{dtype:t.dtype,name:null!=t.name?t.name:l.getUid("input").toString()})||this;if(null==t.batchSize&&(t.batchSize=null),null==t.sparse&&(t.sparse=!1),n.trainable=!1,n.built=!0,n.sparse=t.sparse,null!=t.inputShape&&null!=t.batchInputShape)throw new c.ValueError("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var r=t.batchInputShape;if(null==r){if(null==t.inputShape)throw new c.ValueError("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");r=[t.batchSize].concat(t.inputShape)}else if(null!=t.batchSize)throw new c.ValueError("Cannot specify batchSize if batchInputShape isspecified when creating an InputLayer.");var o=t.dtype||l.floatx();n.batchInputShape=r,n.dtype=o,n.inputSpec=[{shape:r}];var s=new h.SymbolicTensor(n.dtype,n.batchInputShape,n,[],{},n.name);return s.nodeIndex=0,s.tensorIndex=0,new v({outboundLayer:n,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[r],outputShapes:[r]}),n}return r(t,e),t.prototype.apply=function(e,t){throw new c.ValueError("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},t.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},t}(w);function O(e,weights,t,n){if(!t.startsWith("2."))throw new c.ValueError("Unsupported Keras version in weights being loaded: "+t);return weights}function S(weights,e){for(var t={},n=0,r=0,o=e;r<o.length;r++)for(var s=0,u=o[r].weights;s<u.length;s++){var d=u[s];if(null!=t[d.name])throw new c.ValueError("Duplicate weight name: "+d.name);t[d.name]=d,n++}var h=[];for(var p in weights)h.push([t[p],weights[p]]),delete t[p];var g=[];for(var m in t)g.push(m);if(g.length>0)throw new c.ValueError(g.length+" of "+n+" weights are not set: "+g);l.batchSetValue(h)}function A(e,t,n){void 0===n&&(n=!1);for(var r=e.keras_version,o=t.map(function(e){return e.name}),d={},g=0,m=t;g<m.length;g++)null!=(R=m[g]).name&&(null==d[R.name]&&(d[R.name]=[]),d[R.name].push(R));for(var v,value,_,w=e.weights,E=[],k=0;k<o.length;++k){var S=o[k],A=w[S];null==A&&(A=[]);for(var T=[],N=0;N<A.length;++N){var M=A[N];T.push(new h.LayerVariable((v=M.shape,value=M.value,_=p.stringToDType(M.dtype),s.Tensor.make(v,{values:0===v.length?value:u.flatten(value)},_))))}for(var C=0,D=d[S];C<D.length;C++){var R,I=(R=D[C]).weights;if((T=O(0,T,r)).length!==I.length){if(!n)throw new c.ValueError("Layer #"+k+' (named "'+R.name+'") expects '+I.length+" weight(s), but the saved weights have "+T.length+" element(s).");console.warn("Skipping loading of weights of layer "+R.name+" due to mismatch in number of weights: ("+T.length+" vs "+I.length+").")}for(var i=0;i<T.length;++i)!n||u.isEqual(I[i].shape,T[i].shape)?E.push([I[i],T[i].read()]):console.warn("Skipping loading of weights for layer "+R.name+" due to mismatch in shape ("+I[i].shape+" vs "+T[i].shape+")")}}l.batchSetValue(E)}t.InputLayer=E,p.ClassNameMap.register("InputLayer",E),t.Input=function(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new c.ValueError("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));var n=e.dtype;return null==n&&(n=l.floatx()),new E({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]},t.Container=function(e){function t(n){var r=e.call(this,{})||this;if(r.containerNodes=new Set,r.name=n.name,null==r.name){var o=r.constructor.name.toLowerCase();r.name=l.getUid(o)}if(r.supportsMasking=!1,r.trainable=!0,r.updatable=!0,r.inputs=Array.isArray(n.inputs)?n.inputs.slice():[n.inputs],r.outputs=Array.isArray(n.outputs)?n.outputs.slice():[n.outputs],u.uniq(r.inputs).length!==r.inputs.length)throw new c.ValueError("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+r.inputs.map(function(x){return x.name}));u.uniq(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+r.outputs.map(function(x){return x.name})),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[];for(var s=0,d=r.outputs;s<d.length;s++){var h=(x=d[s]).nodeIndex,g=x.tensorIndex;r.outputLayers.push(w=x.sourceLayer),r.outputLayersNodeIndices.push(h),r.outputLayersTensorIndices.push(g)}for(var m=0,_=r.inputs;m<_.length;m++){var w=(x=_[m]).sourceLayer;g=x.tensorIndex,p.assert(0===(h=x.nodeIndex),"input layer has >1 nodes"),p.assert(0===g,"input layer has >1 tensors"),r.inputLayers.push(w),r.inputLayersNodeIndices.push(h),r.inputLayersTensorIndices.push(g)}r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var i=0;i<r.inputLayers.length;i++){if(!((w=r.inputLayers[i])instanceof E))throw new TypeError("Input layers to a Model must be InputLayer objects. Received inputs: "+n.inputs+". Input "+i+" (0-based) originates from layer type "+w.constructor.name+".");r.inputNames.push(w.name),r.feedInputShapes.push(w.batchInputShape),r.feedInputNames.push(w.name)}for(var O=0,S=r.outputLayers;O<S.length;O++)r.outputNames.push((w=S[O]).name);r.internalInputShapes=r.inputs.map(function(x){return x.shape}),r.internalOutputShapes=r.outputs.map(function(x){return x.shape});for(var A={},T={},N={},M={},C={},D=[],R=function(e,n,o,s,l,d){null!=s&&null!=l&&null!=d||(s=e.sourceLayer,l=e.nodeIndex,d=e.tensorIndex);var h=s.inboundNodes[l];if(u.contains(o,h))throw new c.RuntimeError("The tensor "+e.name+' at layer "'+s.name+'" is part of a cycle.');if(!u.contains(n,h)){r.containerNodes.add(t.nodeKey(s,l)),s.id in C||(C[s.id]=u.keys(C).length),u.contains(o,h)||o.push(h);for(var p=h.inboundLayers.length,i=0;i<p;i++)R(h.inputTensors[i],n,o,h.inboundLayers[i],h.nodeIndices[i],h.tensorIndices[i]);for(n.push(h);o.indexOf(h)>=0;)o.splice(o.indexOf(h),1);D.push(h)}},I=[],P=[],L=0,z=r.outputs;L<z.length;L++)R(x=z[L],I,P);for(var F=0,U=D.slice().reverse();F<U.length;F++){T[(fe=U[F]).id]=fe,fe.id in A||(A[fe.id]=0);var B=A[fe.id];for(B=Math.max(B,null==N[fe.outboundLayer.id]?0:N[fe.outboundLayer.id]),N[fe.outboundLayer.id]=B,M[fe.outboundLayer.id]=fe.outboundLayer,A[fe.id]=B,i=0;i<fe.inboundLayers.length;i++){var V=fe.inboundLayers[i].inboundNodes[h=fe.nodeIndices[i]];A[V.id]=Math.max(B+1,null==A[V.id]?0:A[V.id]),T[V.id]=V}}for(var q={},G=0,W=u.pairs(A);G<W.length;G++){var H=W[G],X=H[0];(B=H[1])in q||(q[B]=[]),q[B].push(T[X])}for(var Y={},K=0,J=u.pairs(N);K<J.length;K++){var Z=J[K],Q=Z[0];(B=Z[1])in Y||(Y[B]=[]),Y[B].push(M[Q])}var $=u.keys(Y).map(function(x){return parseInt(x,10)}).sort(p.reverseNumberCompare);r.layers=[];for(var ee=0,te=$;ee<te.length;ee++){var ne=Y[B=te[ee]];ne.sort(function(a,b){var e=C[a.id],t=C[b.id];return e<t?-1:e>t?1:0});for(var re=0,ie=ne;re<ie.length;re++)r.layers.push(w=ie[re])}r.layersByDepth=Y,$=u.keys(q).map(function(x){return parseInt(x,10)}).sort(p.reverseNumberCompare);for(var ae=r.inputs.slice(),oe=[],se=0,ue=$;se<ue.length;se++)for(var le=0,ce=q[B=ue[se]];le<ce.length;le++){var fe;if(null!=(w=(fe=ce[le]).outboundLayer)){for(var de=0,he=fe.inputTensors;de<he.length;de++)if(!u.contains(ae,x=he[de]))throw new c.RuntimeError("Graph disconnected: cannot obtain value for tensor "+x+' at layer "'+w.name+'". The following previous layers were accessed without issue: '+oe);for(var pe=0,ge=fe.outputTensors;pe<ge.length;pe++){var x;ae.push(x=ge[pe])}oe.push(w.name)}}r.nodesByDepth=q;for(var me=r.layers.map(function(x){return x.name}),ve=function(e){var t=me.filter(function(x){return x===e}).length;if(1!==t)throw new c.RuntimeError('The name "'+e+'" is used '+t+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(me))},ye=0,be=me;ye<be.length;ye++)ve(be[ye]);return r.outboundNodes=[],r.inboundNodes=[],new v({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map(function(x){return null}),outputMasks:r.outputs.map(function(x){return null}),inputShapes:r.inputs.map(function(x){return x.shape}),outputShapes:r.outputs.map(function(x){return x.shape})}),r.built=!0,r}return r(t,e),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){if(this._trainableWeights.length>0)throw new c.ValueError("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(var weights=[],e=0,t=this.layers;e<t.length;e++)weights=weights.concat(t[e].trainableWeights);return weights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){for(var weights=[],e=0,t=this.layers;e<t.length;e++)weights.push.apply(weights,t[e].nonTrainableWeights);if(!this.trainable){for(var n=[],r=0,o=this.layers;r<o.length;r++)n.push.apply(n,o[r].trainableWeights);return n.concat(weights)}return weights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),t.prototype.loadWeights=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1),n?S(e,this.layers):A(e,this.layers,t)},t.prototype.updatedConfig=function(){var e=this.getConfig();return{className:this.constructor.name,config:e,kerasVersion:"tfjs-layers pre-release",backend:"TensorFlow.js"}},t.prototype.toJSON=function(e){var t=this.updatedConfig();return JSON.stringify(g.convertTsToPythonic(t))},t.prototype.call=function(e,t){var n;return e=p.toList(e),n="mask"in t?p.toList(t.mask):p.pyListRepeat(null,e.length),this.runInternalGraph(e,n)[0]},t.prototype.computeMask=function(e,t){var n;return e=p.toList(e),n=null==t?p.pyListRepeat(null,e.length):p.toList(t),this.runInternalGraph(e,n)[1]},t.prototype.computeOutputShape=function(e){var t=p.normalizeShapeList(e);if(t.length!==this.inputLayers.length)throw new c.ValueError("Invalid inputShape argument "+e+": model has "+this.inputLayers.length+" tensor inputs.");for(var n={},i=0;i<t.length;i++)n[(g=this.inputLayers[i]).name+"_0_0"]=t[i];var r=Object.keys(this.nodesByDepth).map(function(x){return parseInt(x,10)}).sort(p.reverseNumberCompare);if(r.length>1)for(var o=0,s=r;o<s.length;o++)for(var l=0,d=this.nodesByDepth[s[o]];l<d.length;l++){var h=d[l],g=h.outboundLayer;if(!u.contains(this.inputLayers.map(function(x){return x.id}),g.id)){for(var m=[],j=0;j<h.inboundLayers.length;j++)m.push(n[h.inboundLayers[j].name+"_"+h.nodeIndices[j]+"_"+h.tensorIndices[j]]);var v=g.computeOutputShape(p.singletonOrArray(m)),_=p.normalizeShapeList(v),w=g.inboundNodes.indexOf(h);for(j=0;j<_.length;j++)n[g.name+"_"+w+"_"+j]=_[j]}}var E=[],O=[];for(i=0;i<this.outputLayers.length;i++)O.push((g=this.outputLayers[i]).name+"_"+(w=this.outputLayersNodeIndices[i])+"_"+this.outputLayersTensorIndices[i]);for(i=0;i<O.length;i++){var S=O[i];p.assert(S in n),E.push(n[S])}return p.singletonOrArray(E)},t.prototype.runInternalGraph=function(e,t){null==t&&(t=p.pyListRepeat(null,e.length));for(var n={},r=0,o=u.zip(this.inputs,e,t);r<o.length;r++){var s=o[r];n[(x=s[0]).id]=[s[1],H=s[2]]}for(var l=0,d=Object.keys(this.nodesByDepth).map(function(x){return parseInt(x,10)}).sort(p.reverseNumberCompare);l<d.length;l++)for(var h=0,g=this.nodesByDepth[d[l]];h<g.length;h++){for(var m=g[h],v=m.outboundLayer,_=m.inputTensors,w=m.outputTensors,E=new Array,O=0,S=_;O<S.length;O++)(x=S[O]).id in n&&E.push(n[x.id]);if(E.length===_.length){var A={},T=void 0,N=void 0,M=void 0,C=void 0;if(null!=m.callArgs&&(A=m.callArgs),1===E.length){var D=E[0],R=D[0],I=D[1];null==A.mask&&(A.mask=I),M=p.toList(v.call(R,A)),C=p.toList(v.computeMask(R,I)),T=[R],N=[I]}else T=E.map(function(x){return x[0]}),N=E.map(function(x){return x[1]}),null==A.mask&&(A.mask=N),M=p.toList(v.call(T,A)),C=p.toList(v.computeMask(T,N));if(v.activityRegularizer)throw new c.NotImplementedError("Model invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(var P=0,L=u.zip(w,M,C);P<L.length;P++){var z=L[P];n[(x=z[0]).id]=[z[1],H=z[2]]}}}for(var F=[],U=[],B=[],V=0,q=this.outputs;V<q.length;V++){var x;p.assert((x=q[V]).id in n,"Could not compute output "+x.name+" : "+x.id);var G=n[x.id],W=G[0],H=G[1];B.push(W.shape),F.push(W),U.push(H)}return[F,U,B]},t.prototype.buildNodeConversionMap=function(e){for(var n,r={},o=0,s=this.layers;o<s.length;o++){var u=s[o];n=u instanceof t?1:0;for(var l=0;l<u.inboundNodes.length;l++){var c=t.nodeKey(u,l);c in this.containerNodes&&(r[c]=n,n+=1)}}return r},t.prototype.getLayer=function(e,t){if(null!=t){if(this.layers.length<=t)throw new c.ValueError("Was asked to retrieve layer at index "+t+", but model only has "+this.layers.length+" layer(s).");return this.layers[t]}if(null==e)throw new c.ValueError("Provide either a layer name or layer index");for(var n=0,r=this.layers;n<r.length;n++){var o=r[n];if(o.name===e)return o}throw new c.ValueError("No such layer: "+e)},t.prototype.calculateLosses=function(){var e=this;return s.tidy(function(){for(var n=[],r=0,o=e.layers;r<o.length;r++)for(var s=o[r],u=0;u<s.inboundNodes.length;++u){var l=t.nodeKey(s,u);e.containerNodes.has(l)&&n.push.apply(n,s.calculateLosses())}return n})},t.prototype.getConfig=function(){for(var e={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[],o=0,s=this.layers;o<s.length;o++){for(var u=(O=s[o]).constructor.name,l=O.getConfig(),c=[],d=0;d<O.inboundNodes.length;d++){var h=O.inboundNodes[d],p=t.nodeKey(O,d),g={};if(this.containerNodes.has(p)&&(h.callArgs&&(-1===JSON.stringify(h.callArgs).indexOf("undefined")?g=h.callArgs:(console.warn("Layer "+O.name+" was passed non-serializable keyword arguments: "+h.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),g={})),h.inboundLayers.length>0)){for(var m=[],i=0;i<h.inboundLayers.length;i++){var v=h.inboundLayers[i],_=h.tensorIndices[i];null!==(S=n[t.nodeKey(v,h.nodeIndices[i])])&&void 0!==S||(S=0),m.push([v.name,S,_,g])}c.push(m)}}r.push({name:O.name,className:u,config:l,inboundNodes:c})}e.layers=r;var w=[];for(i=0;i<this.inputLayers.length;i++)p=t.nodeKey(O=this.inputLayers[i],this.inputLayersNodeIndices[i]),this.containerNodes.has(p)&&(null!==(S=n[p])&&void 0!==S||(S=0),w.push([O.name,S,_=this.inputLayersTensorIndices[i]]));e.inputLayers=w;var E=[];for(i=0;i<this.outputLayers.length;i++){var O,S;p=t.nodeKey(O=this.outputLayers[i],this.outputLayersNodeIndices[i]),this.containerNodes.has(p)&&(null!==(S=n[p])&&void 0!==S||(S=0),E.push([O.name,S,_=this.outputLayersTensorIndices[i]]))}return e.outputLayers=E,e},t.fromConfig=function(e,t){var n={},r={};function o(e,t){e.name in r?r[e.name].push(t):r[e.name]=[t]}function s(e,t){for(var r,s=[],l=0,d=t;l<d.length;l++){var h=d[l],g=h[0],m=h[1],v=h[2];if(3===h.length)r={};else{if(4!==h.length)throw new c.ValueError("Improperly formatted model config for layer "+JSON.stringify(e)+": "+JSON.stringify(h));r=h[3]}if(!(g in n))return void o(e,t);var _=n[g];if(_.inboundNodes.length<=m)return void o(e,t);s.push(_.inboundNodes[m].outputTensors[v])}u.isEmpty(s)||e.apply(p.singletonOrArray(s),r)}function l(e){var r=e.name,s=d.deserialize(e,null!=t.customObjects?t.customObjects:{});n[r]=s;for(var u=0,l=e.inboundNodes;u<l.length;u++){var h=l[u];if(!(h instanceof Array))throw new c.ValueError("Corrupted configuration, expected array for nodeData: "+h);o(s,h)}}for(var h=t.name,g=t.layers,m=0,v=g;m<v.length;m++)l(I=v[m]);for(;!u.isEmpty(r);)for(var _=0,w=g;_<w.length;_++)if((L=n[(I=w[_]).name]).name in r){for(var E=0,O=r[L.name];E<O.length;E++)s(L,O[E]);delete r[L.name]}for(var S=[],A=[],T=0,N=t.inputLayers;T<N.length;T++){var M=(I=N[T])[1],C=I[2];p.assert((P=I[0])in n),S.push((L=n[P]).inboundNodes[M].outputTensors[C])}for(var D=0,R=t.outputLayers;D<R.length;D++){var I,P,L;M=(I=R[D])[1],C=I[2],p.assert((P=I[0])in n),A.push((L=n[P]).inboundNodes[M].outputTensors[C])}return new e({inputs:S,outputs:A,name:h})},Object.defineProperty(t.prototype,"stateful",{get:function(){if(this._stateful)throw new c.ValueError("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(var e=0,t=this.layers;e<t.length;e++)if(t[e].stateful)return!0;return!1},enumerable:!0,configurable:!0}),t}(w),t.getSourceInputs=function e(t,n,r){if((null==n||null!=r&&r>0)&&(n=t.sourceLayer,r=t.nodeIndex),0===n.inboundNodes.length)return[t];var o=n.inboundNodes[r];if(0===o.inboundLayers.length)return o.inputTensors;for(var s=[],i=0;i<o.inboundLayers.length;i++)for(var l=0,c=e(o.inputTensors[i],o.inboundLayers[i],o.nodeIndices[i]);l<c.length;l++){var d=c[l];u.contains(s,d)||s.push(d)}return s},t.loadWeightsFromNamedTensorMap=S,t.loadWeightsFromJson=A},DqkE:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("XFvI");function o(e,t){for(var i=0;i<e.length;++i)if(e[e.length-i-1]!==t-1-i)return!1;return!0}function s(e,t,n){for(var r=e.length+t.length,o=[],s=0,u=0,l=0;l<r;l++)-1===n.indexOf(l)?o.push(e[s++]):o.push(t[u++]);return o}t.axesAreInnerMostDims=o,t.combineLocations=s,t.computeOutAndReduceShapes=function(e,t){for(var n=[],r=e.length,o=0;o<r;o++)-1===t.indexOf(o)&&n.push(e[o]);return[n,t.map(function(t){return e[t]})]},t.expandShapeToKeepDim=function(e,t){return s(e,t.map(function(x){return 1}),t)},t.parseAxisParam=function(e,t){var n=t.length;return e=null==e?t.map(function(e,i){return i}):[].concat(e),r.assert(e.every(function(e){return e>=-n&&e<n}),"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e),r.assert(e.every(function(e){return r.isInt(e)}),"All values in axis param must be integers but got axis "+e),e.map(function(a){return a<0?n+a:a})},t.assertAxesAreInnerMostDims=function(e,t,n){r.assert(o(t,n),e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input.")},t.getAxesPermutation=function(e,t){if(o(e,t))return null;for(var n=[],i=0;i<t;++i)-1===e.indexOf(i)&&n.push(i);return e.forEach(function(e){return n.push(e)}),n},t.getUndoAxesPermutation=function(e){return e.map(function(e,i){return[i,e]}).sort(function(a,b){return a[1]-b[1]}).map(function(x){return x[0]})},t.getInnerMostAxes=function(e,t){for(var n=[],i=t-e;i<t;++i)n.push(i);return n}},Dv7J:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AvgPool2DBackpropProgram=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(t-1-e.padInfo.top)+", "+(n-1-e.padInfo.left)+");\n      const float avgMultiplier = float("+1/(t*n)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}},DwrG:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("5WUj"),s=n("jRWw"),u=n("qmZh"),l=n("lbmW"),c=n("DjcB"),d=n("yJL4"),h=n("TPCB"),p=n("Q1Fz"),g=n("np2E"),m=n("np2E"),v=n("KB5b"),_=function(e){function t(t){var n=e.call(this,t)||this;if(n.rate=Math.max(Math.min(t.rate,1),0),n.rateScalar=u.getScalar(n.rate),n.noiseShape=t.noiseShape,n.seed=t.seed,null!=n.seed)throw new d.NotImplementedError("Non-default seed is not implemented in Dropout layer yet: "+n.seed);return n.supportsMasking=!0,n}return r(t,e),t.prototype.getNoiseShape=function(e){if(null==this.noiseShape)return this.noiseShape;for(var t=e.shape,n=[],i=0;i<this.noiseShape.length;++i)n.push(null==this.noiseShape[i]?t[i]:this.noiseShape[i]);return n},t.prototype.call=function(e,t){var n=this;this.invokeCallHook(e,t);var r=g.getExactlyOneTensor(e);if(null!=this.noiseShape&&!o.isEqual(r.shape,this.noiseShape))throw new d.NotImplementedError("Non-default noise shape is not implemented in Dropout layer yet: "+JSON.stringify(this.noiseShape));if(0<this.rate&&this.rate<1){var s=null!=t.training&&t.training,l=this.getNoiseShape(r);return u.inTrainPhase(function(){return u.dropout(r,n.rateScalar,l,n.seed)},function(){return r},s)}return e},t.prototype.getConfig=function(){var t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(c.Layer);t.Dropout=_,g.ClassNameMap.register("Dropout",_);var w=function(e){function t(t){var n=e.call(this,t)||this;if(n.activation=null,n.useBias=!0,n.kernel=null,n.bias=null,n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_BIAS_INITIALIZER="zeros",null==t.batchInputShape&&null==t.inputShape&&null!=t.inputDim){var r=null;null!=t.batchSize&&(r=t.batchSize),n.batchInputShape=[r,t.inputDim]}return n.units=t.units,n.activation=s.getActivation(t.activation),null!=t.useBias&&(n.useBias=t.useBias),n.kernelInitializer=h.getInitializer(t.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.biasInitializer=h.getInitializer(t.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelConstraint=l.getConstraint(t.kernelConstraint),n.biasConstraint=l.getConstraint(t.biasConstraint),n.kernelRegularizer=p.getRegularizer(t.kernelRegularizer),n.biasRegularizer=p.getRegularizer(t.biasRegularizer),n.activityRegularizer=p.getRegularizer(t.activityRegularizer),n.inputSpec=[{minNDim:2}],n}return r(t,e),t.prototype.build=function(e){var t,n=(e=g.getExactlyOneShape(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(t={},t[-1]=n,t)}],this.built=!0},t.prototype.computeOutputShape=function(e){var t=(e=g.getExactlyOneShape(e)).slice();return t[t.length-1]=this.units,t},t.prototype.call=function(e,t){this.invokeCallHook(e,t);var n=g.getExactlyOneTensor(e),r=u.dot(n,this.kernel.read());return null!=this.bias&&(r=u.biasAdd(r,this.bias.read())),null!=this.activation&&(r=this.activation(r)),r},t.prototype.getConfig=function(){var t={units:this.units,activation:s.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:h.serializeInitializer(this.kernelInitializer),biasInitializer:h.serializeInitializer(this.biasInitializer),kernelRegularizer:p.serializeRegularizer(this.kernelRegularizer),biasRegularizer:p.serializeRegularizer(this.biasRegularizer),activityRegularizer:p.serializeRegularizer(this.activityRegularizer),kernelConstraint:l.serializeConstraint(this.kernelConstraint),biasConstraint:l.serializeConstraint(this.biasConstraint)},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(c.Layer);t.Dense=w,g.ClassNameMap.register("Dense",w);var E=function(e){function t(t){var n=e.call(this,t||{})||this;return n.inputSpec=[{minNDim:3}],n}return r(t,e),t.prototype.computeOutputShape=function(e){for(var t=0,n=(e=g.getExactlyOneShape(e)).slice(1);t<n.length;t++)if(null==n[t])throw new d.ValueError('The shape of the input to "Flatten" is not fully defined (got '+e.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.');return[e[0],v.arrayProd(e,1)]},t.prototype.call=function(e,t){return this.invokeCallHook(e,t),u.batchFlatten(g.getExactlyOneTensor(e))},t}(c.Layer);t.Flatten=E,g.ClassNameMap.register("Flatten",E);var O=function(e){function t(t){var n=e.call(this,t)||this;return n.supportsMasking=!0,n.activation=s.getActivation(t.activation),n}return r(t,e),t.prototype.call=function(e,t){this.invokeCallHook(e,t);var n=g.getExactlyOneTensor(e);return this.activation(n)},t}(c.Layer);t.Activation=O,g.ClassNameMap.register("Activation",O);var S=function(e){function t(t){var n=e.call(this,t)||this;return n.n=t.n,n.inputSpec=[{ndim:2}],n}return r(t,e),t.prototype.computeOutputShape=function(e){return[e[0],this.n,e[1]]},t.prototype.call=function(e,t){return e=m.getExactlyOneTensor(e),u.repeat(e,this.n)},t.prototype.getConfig=function(){var t={n:this.n},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(c.Layer);t.RepeatVector=S,g.ClassNameMap.register("RepeatVector",S);var A=function(e){function t(t){var n=e.call(this,t)||this;n.targetShape=t.targetShape;for(var i=0;i<n.targetShape.length;++i)n.isUnknown(n.targetShape[i])&&(n.targetShape[i]=null);return n}return r(t,e),t.prototype.isUnknown=function(e){return e<0||null==e},t.prototype.fixUnknownDimension=function(e,t){for(var n="Total size of new array must be unchanged.",r=t.slice(),o=1,s=null,i=0;i<r.length;++i){var u=r[i];if(this.isUnknown(u)){if(null!==s)throw new d.ValueError("Can only specifiy one unknown dimension.");s=i}else o*=u}var l=v.arrayProd(e);if(null!==s){if(0===o||l%o!=0)throw new d.ValueError(n);r[s]=l/o}else if(l!==o)throw new d.ValueError(n);return r},t.prototype.computeOutputShape=function(e){for(var t=!1,i=0;i<e.length;++i)if(this.isUnknown(e[i])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))},t.prototype.call=function(e,t){this.invokeCallHook(e,t);var n=g.getExactlyOneTensor(e),r=u.shape(n),o=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return u.reshape(n,o)},t}(c.Layer);t.Reshape=A,g.ClassNameMap.register("Reshape",A)},DxGv:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("V6aD"),u=n("XFvI"),l=n("DqkE"),c=n("35G1"),d=n("m3RX");t.SoftmaxOps=function(){function e(){}return e.softmax=function(e,t){if(void 0===t&&(t=-1),-1===t&&(t=e.rank-1),t!==e.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and dim was "+t);return s.customGrad(function(e){var n=e.logSumExp([t],!0),y=e.toFloat().sub(n).exp();return{value:y,gradFunc:function(e){var n=e.mul(y);return n.sub(n.sum([t],!0).mul(y))}}})(e)},e.softmaxCrossEntropy=function(e,t,n){if(void 0===n&&(n=-1),u.assertShapesMatch(e.shape,t.shape,"Error in softmaxCrossEntropy: "),-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+t.rank+" and dim was "+n);return s.customGrad(function(e,t){var r=t.softmax(n);return{value:d.scalar(1e-5).add(r).log().mul(e).neg().sum([n]),gradFunc:function(t){var o=l.expandShapeToKeepDim(t.shape,[n]);return[t.reshape(o).mul(e.toFloat().sub(r)),t.reshape(o).mul(r.sub(e.toFloat()))]}}})(e,t)},r([o.doc({heading:"Operations",subheading:"Normalization"}),c.operation],e,"softmax",null),r([o.doc({heading:"Training",subheading:"Losses",namespace:"losses"}),c.operation],e,"softmaxCrossEntropy",null),e}()},EJHg:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("JV7f"),o=n("qmZh"),s=n("yJL4"),u=n("Ljb4");function l(e,t){var n=o.scalarTimesArray(o.getScalar(.5),r.onesLike(t)),s=o.cast(o.greater(t,n),e.dtype);return o.mean(o.equal(e,s),-1)}function c(e,t){return o.cast(o.equal(o.argmax(e,-1),o.argmax(t,-1)),"float32")}t.binaryAccuracy=l,t.categoricalAccuracy=c,t.binaryCrossentropy=function(e,t){throw new s.NotImplementedError},t.categoricalCrossentropy=function(e,t){throw new s.NotImplementedError},t.sparseCategoricalAccuracy=function(e,t){throw new s.NotImplementedError},t.sparseCategoricalCrossentropy=function(e,t){throw new s.NotImplementedError},t.topKCategoricalAccuracy=function(e,t){throw new s.NotImplementedError},t.sparseTopKCategoricalAccuracy=function(e,t){throw new s.NotImplementedError},t.mse=u.meanSquaredError,t.MSE=u.meanSquaredError,t.mae=u.meanAbsoluteError,t.MAE=u.meanAbsoluteError,t.mape=u.meanAbsolutePercentageError,t.MAPE=u.meanAbsolutePercentageError,t.cosine=u.cosineProximity,t.get=function(e){var n={binaryAccuracy:l,categoricalAccuracy:c,mse:t.mse,MSE:t.MSE,mae:t.mae,MAE:t.MAE,mape:t.mape,MAPE:t.MAPE,cosine:t.cosine};if("string"==typeof e&&e in n)return n[e];if("string"!=typeof e&&null!=e)return e;throw new s.ValueError("Unknown metric "+e)}},EKta:function(e,t,n){"use strict";t.byteLength=function(e){return 3*e.length/4-c(e)},t.toByteArray=function(e){var i,t,n,r,u,l=e.length;r=c(e),u=new s(3*l/4-r),t=r>0?l-4:l;var d=0;for(i=0;i<t;i+=4)n=o[e.charCodeAt(i)]<<18|o[e.charCodeAt(i+1)]<<12|o[e.charCodeAt(i+2)]<<6|o[e.charCodeAt(i+3)],u[d++]=n>>16&255,u[d++]=n>>8&255,u[d++]=255&n;return 2===r?(n=o[e.charCodeAt(i)]<<2|o[e.charCodeAt(i+1)]>>4,u[d++]=255&n):1===r&&(n=o[e.charCodeAt(i)]<<10|o[e.charCodeAt(i+1)]<<4|o[e.charCodeAt(i+2)]>>2,u[d++]=n>>8&255,u[d++]=255&n),u},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,s="",u=[],i=0,l=n-o;i<l;i+=16383)u.push(d(e,i,i+16383>l?l:i+16383));return 1===o?(s+=r[(t=e[n-1])>>2],s+=r[t<<4&63],s+="=="):2===o&&(s+=r[(t=(e[n-2]<<8)+e[n-1])>>10],s+=r[t>>4&63],s+=r[t<<2&63],s+="="),u.push(s),u.join("")};for(var r=[],o=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,l=u.length;i<l;++i)r[i]=u[i],o[u.charCodeAt(i)]=i;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function d(e,t,n){for(var o,s=[],i=t;i<n;i+=3)s.push(r[(o=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]))>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},ELZD:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("YsHz"),s=n("FgHA");t.IdentifierNode=function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.prototype.clone=function(){return new t(null)},t.prototype.producedFields=function(){return(e={})[o.SELECTION_ID]=!0,e;var e},t.prototype.assemble=function(){return{type:"identifier",as:o.SELECTION_ID}},t}(s.DataFlowNode)},EOrY:function(e,t,n){"use strict";var r=n("TToO").__extends,o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},s=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var u=n("8Wnz"),l=n("Xq4m"),c=n("FgHA");t.SourceNode=function(e){function t(t){var n=e.call(this,null)||this;if(u.isInlineData(t=t||{name:"source"}))n._data={values:t.values};else if(u.isUrlData(t)){if(n._data={url:t.url},t.format||(t.format={}),!t.format||!t.format.type){var r=/(?:\.([^.]+))?$/.exec(t.url)[1];l.contains(["json","csv","tsv","topojson"],r)||(r="json"),t.format.type=r}}else u.isNamedData(t)&&(n._name=t.name,n._data={});if(!u.isNamedData(t)&&t.format){var o=s(t.format,["parse"]);n._data.format=o}return n}return r(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),t.prototype.hasName=function(){return!!this._name},Object.defineProperty(t.prototype,"dataName",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{set:function(e){throw new Error("Source nodes have to be roots.")},enumerable:!0,configurable:!0}),t.prototype.remove=function(){throw new Error("Source nodes are roots and cannot be removed.")},t.prototype.hash=function(){return u.isInlineData(this._data)?(this._hash||(this._hash=l.hash(this._data)),this._hash):u.isUrlData(this._data)?l.hash([this._data.url,this._data.format]):this._name},t.prototype.assemble=function(){return o({name:this._name},this._data,{transform:[]})},t}(c.DataFlowNode)},EbtV:function(e,t,n){var r="undefined"!=typeof JSON?JSON:n("RnQl");e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var n=t.space||"";"number"==typeof n&&(n=Array(n+1).join(" "));var f,u="boolean"==typeof t.cycles&&t.cycles,l=t.replacer||function(e,value){return value},c=t.cmp&&(f=t.cmp,function(e){return function(a,b){return f({key:a,value:e[a]},{key:b,value:e[b]})}}),d=[];return function e(t,h,p,g){var m=n?"\n"+new Array(g+1).join(n):"",v=n?": ":":";if(p&&p.toJSON&&"function"==typeof p.toJSON&&(p=p.toJSON()),void 0!==(p=l.call(t,h,p))){if("object"!=typeof p||null===p)return r.stringify(p);if(o(p)){for(var _=[],i=0;i<p.length;i++){var w=e(p,i,p[i],g+1)||r.stringify(null);_.push(m+n+w)}return"["+_.join(",")+m+"]"}if(-1!==d.indexOf(p)){if(u)return r.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}d.push(p);var E=s(p).sort(c&&c(p));for(_=[],i=0;i<E.length;i++){var value=e(p,h=E[i],p[h],g+1);if(value){var O=r.stringify(h)+v+value;_.push(m+n+O)}}return d.splice(d.indexOf(p),1),"{"+_.join(",")+m+"}"}}({"":e},"",e,0)};var o=Array.isArray||function(x){return"[object Array]"==={}.toString.call(x)},s=Object.keys||function(e){var t=Object.prototype.hasOwnProperty||function(){return!0},n=[];for(var r in e)t.call(e,r)&&n.push(r);return n}},EflS:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("XFvI");t.assertParams=function(e,t,n){var o=e.length;r.assert(e.length===t.length,"Error in concat"+o+"D: rank of x1 ("+o+") and x2 ("+t.length+") must be the same."),r.assert(n>=0&&n<o,"Error in concat"+o+"D: axis must be between 0 and "+(o-1)+".");for(var i=0;i<o;i++)r.assert(i===n||e[i]===t[i],"Error in concat"+o+"D: Shape ("+e+") does not match ("+t+") along the non-concatenated axis "+i+".")},t.computeOutShape1D=function(e,t){r.assert(1===e.length&&1===t.length,"x1 and x2 should be 1d array.");var n=e.slice();return n[0]+=t[0],n},t.computeOutShape=function(e,t,n){r.assert(e.length===t.length,"x1 and x2 should have the same rank.");var o=e.slice();return o[n]+=t[n],o},t.computeGradientSliceShapes=function(e,t){return{aBegin:[0,0],aSize:e,bBegin:[0,e[1]],bSize:t}}},EuP9:function(e,t,n){"use strict";(function(e){var r=n("EKta"),o=n("ujcs"),s=n("sOR5");function u(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function l(e,t){if(u()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return p(this,e)}return d(this,e,t,n)}function d(e,value,t,n){if("number"==typeof value)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&value instanceof ArrayBuffer?function(e,t,n,r){if(n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=g(e,t),e}(e,value,t,n):"string"==typeof value?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|v(t,n),o=(e=l(e,r)).write(t,n);return o!==r&&(e=e.slice(0,o)),e}(e,value,t):function(e,t){if(c.isBuffer(t)){var n=0|m(t.length);return 0===(e=l(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?l(e,0):g(e,t);if("Buffer"===t.type&&s(t.data))return g(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,value)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function p(e,t){if(h(t),e=l(e,t<0?0:0|m(t)),!c.TYPED_ARRAY_SUPPORT)for(var i=0;i<t;++i)e[i]=0;return e}function g(e,t){var n=t.length<0?0:0|m(t.length);e=l(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function m(e){if(e>=u())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+u().toString(16)+" bytes");return 0|e}function v(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return X(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Y(e).length;default:if(r)return X(e).length;t=(""+t).toLowerCase(),r=!0}}function _(b,e,t){var i=b[e];b[e]=b[t],b[t]=i}function w(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:E(e,t,n,r,o);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):E(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function E(e,t,n,r,o){var i,s=1,u=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,u/=2,l/=2,n/=2}function c(e,i){return 1===s?e[i]:e.readUInt16BE(i*s)}if(o){var d=-1;for(i=n;i<u;i++)if(c(e,i)===c(t,-1===d?0:i-d)){if(-1===d&&(d=i),i-d+1===l)return d*s}else-1!==d&&(i-=i-d),d=-1}else for(n+l>u&&(n=u-l),i=n;i>=0;i--){for(var h=!0,j=0;j<l;j++)if(c(e,i+j)!==c(t,j)){h=!1;break}if(h)return i}return-1}function O(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var s=t.length;if(s%2!=0)throw new TypeError("Invalid hex string");r>s/2&&(r=s/2);for(var i=0;i<r;++i){var u=parseInt(t.substr(2*i,2),16);if(isNaN(u))return i;e[n+i]=u}return i}function S(e,t,n,r){return K(X(t,e.length-n),e,n,r)}function A(e,t,n,r){return K(function(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(t),e,n,r)}function T(e,t,n,r){return A(e,t,n,r)}function N(e,t,n,r){return K(Y(t),e,n,r)}function M(e,t,n,r){return K(function(e,t){for(var n,r,o=[],i=0;i<e.length&&!((t-=2)<0);++i)r=(n=e.charCodeAt(i))>>8,o.push(n%256),o.push(r);return o}(t,e.length-n),e,n,r)}function C(e,t,n){return r.fromByteArray(0===t&&n===e.length?e:e.slice(t,n))}function D(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,s,u,l,c=e[i],d=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(d=c);break;case 2:128==(192&(o=e[i+1]))&&(l=(31&c)<<6|63&o)>127&&(d=l);break;case 3:s=e[i+2],128==(192&(o=e[i+1]))&&128==(192&s)&&(l=(15&c)<<12|(63&o)<<6|63&s)>2047&&(l<55296||l>57343)&&(d=l);break;case 4:s=e[i+2],u=e[i+3],128==(192&(o=e[i+1]))&&128==(192&s)&&128==(192&u)&&(l=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&u)>65535&&l<1114112&&(d=l)}null===d?(d=65533,h=1):d>65535&&(r.push((d-=65536)>>>10&1023|55296),d=56320|1023&d),r.push(d),i+=h}return function(e){var t=e.length;if(t<=R)return String.fromCharCode.apply(String,e);for(var n="",i=0;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=R));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){return+e!=e&&(e=0),c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=u(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(value,e,t){return d(null,value,e,t)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return h(t),t<=0?l(null,t):void 0!==n?"string"==typeof r?l(null,t).fill(n,r):l(null,t).fill(n):l(null,t)}(0,e,t,n)},c.allocUnsafe=function(e){return p(null,e)},c.allocUnsafeSlow=function(e){return p(null,e)},c.isBuffer=function(b){return!(null==b||!b._isBuffer)},c.compare=function(a,b){if(!c.isBuffer(a)||!c.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,e=Math.min(x,y);i<e;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!s(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var i;if(void 0===t)for(t=0,i=0;i<e.length;++i)t+=e[i].length;var n=c.allocUnsafe(t),r=0;for(i=0;i<e.length;++i){var o=e[i];if(!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,r),r+=o.length}return n},c.byteLength=v,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<e;i+=2)_(this,i,i+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<e;i+=4)_(this,i,i+3),_(this,i+1,i+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<e;i+=8)_(this,i,i+7),_(this,i+1,i+6),_(this,i+2,i+5),_(this,i+3,i+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?D(this,0,e):(function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return L(this,t,n);case"utf8":case"utf-8":return D(this,t,n);case"ascii":return I(this,t,n);case"latin1":case"binary":return P(this,t,n);case"base64":return C(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}).apply(this,arguments)},c.prototype.equals=function(b){if(!c.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===c.compare(this,b)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,o){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,o>>>=0,this===e)return 0;for(var x=o-r,y=n-t,s=Math.min(x,y),u=this.slice(r,o),l=e.slice(t,n),i=0;i<s;++i)if(u[i]!==l[i]){x=u[i],y=l[i];break}return x<y?-1:y<x?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return w(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return w(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var s=!1;;)switch(r){case"hex":return O(this,e,t,n);case"utf8":case"utf-8":return S(this,e,t,n);case"ascii":return A(this,e,t,n);case"latin1":case"binary":return T(this,e,t,n);case"base64":return N(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var R=4096;function I(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function P(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function L(e,t,n){var r,o=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>o)&&(n=o);for(var s="",i=t;i<n;++i)s+=(r=e[i])<16?"0"+r.toString(16):r.toString(16);return s}function z(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function F(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function U(e,value,t,n,r,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>r||value<o)throw new RangeError('"value" argument is out of bounds');if(t+n>e.length)throw new RangeError("Index out of range")}function B(e,value,t,n){value<0&&(value=65535+value+1);for(var i=0,j=Math.min(e.length-t,2);i<j;++i)e[t+i]=(value&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function V(e,value,t,n){value<0&&(value=4294967295+value+1);for(var i=0,j=Math.min(e.length-t,4);i<j;++i)e[t+i]=value>>>8*(n?i:3-i)&255}function q(e,value,t,n,r,o){if(t+n>e.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function G(e,value,t,n,r){return r||q(e,0,t,4),o.write(e,value,t,n,23,4),t+4}function W(e,value,t,n,r){return r||q(e,0,t,8),o.write(e,value,t,n,52,8),t+8}c.prototype.slice=function(e,t){var n,r=this.length;if(e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var o=t-e;n=new c(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||F(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||F(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},c.prototype.readUInt8=function(e,t){return t||F(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||F(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||F(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||F(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||F(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||F(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||F(e,t,this.length);for(var i=t,r=1,o=this[e+--i];i>0&&(r*=256);)o+=this[e+--i]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return t||F(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||F(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||F(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||F(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||F(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||F(e,4,this.length),o.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||F(e,4,this.length),o.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||F(e,8,this.length),o.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||F(e,8,this.length),o.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(value,e,t,n){value=+value,e|=0,t|=0,n||U(this,value,e,t,Math.pow(2,8*t)-1,0);var r=1,i=0;for(this[e]=255&value;++i<t&&(r*=256);)this[e+i]=value/r&255;return e+t},c.prototype.writeUIntBE=function(value,e,t,n){value=+value,e|=0,t|=0,n||U(this,value,e,t,Math.pow(2,8*t)-1,0);var i=t-1,r=1;for(this[e+i]=255&value;--i>=0&&(r*=256);)this[e+i]=value/r&255;return e+t},c.prototype.writeUInt8=function(value,e,t){return value=+value,e|=0,t||U(this,value,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),this[e]=255&value,e+1},c.prototype.writeUInt16LE=function(value,e,t){return value=+value,e|=0,t||U(this,value,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&value,this[e+1]=value>>>8):B(this,value,e,!0),e+2},c.prototype.writeUInt16BE=function(value,e,t){return value=+value,e|=0,t||U(this,value,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=value>>>8,this[e+1]=255&value):B(this,value,e,!1),e+2},c.prototype.writeUInt32LE=function(value,e,t){return value=+value,e|=0,t||U(this,value,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=value>>>24,this[e+2]=value>>>16,this[e+1]=value>>>8,this[e]=255&value):V(this,value,e,!0),e+4},c.prototype.writeUInt32BE=function(value,e,t){return value=+value,e|=0,t||U(this,value,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=value>>>24,this[e+1]=value>>>16,this[e+2]=value>>>8,this[e+3]=255&value):V(this,value,e,!1),e+4},c.prototype.writeIntLE=function(value,e,t,n){if(value=+value,e|=0,!n){var r=Math.pow(2,8*t-1);U(this,value,e,t,r-1,-r)}var i=0,o=1,s=0;for(this[e]=255&value;++i<t&&(o*=256);)value<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(value/o>>0)-s&255;return e+t},c.prototype.writeIntBE=function(value,e,t,n){if(value=+value,e|=0,!n){var r=Math.pow(2,8*t-1);U(this,value,e,t,r-1,-r)}var i=t-1,o=1,s=0;for(this[e+i]=255&value;--i>=0&&(o*=256);)value<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(value/o>>0)-s&255;return e+t},c.prototype.writeInt8=function(value,e,t){return value=+value,e|=0,t||U(this,value,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),value<0&&(value=255+value+1),this[e]=255&value,e+1},c.prototype.writeInt16LE=function(value,e,t){return value=+value,e|=0,t||U(this,value,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&value,this[e+1]=value>>>8):B(this,value,e,!0),e+2},c.prototype.writeInt16BE=function(value,e,t){return value=+value,e|=0,t||U(this,value,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=value>>>8,this[e+1]=255&value):B(this,value,e,!1),e+2},c.prototype.writeInt32LE=function(value,e,t){return value=+value,e|=0,t||U(this,value,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&value,this[e+1]=value>>>8,this[e+2]=value>>>16,this[e+3]=value>>>24):V(this,value,e,!0),e+4},c.prototype.writeInt32BE=function(value,e,t){return value=+value,e|=0,t||U(this,value,e,4,2147483647,-2147483648),value<0&&(value=4294967295+value+1),c.TYPED_ARRAY_SUPPORT?(this[e]=value>>>24,this[e+1]=value>>>16,this[e+2]=value>>>8,this[e+3]=255&value):V(this,value,e,!1),e+4},c.prototype.writeFloatLE=function(value,e,t){return G(this,value,e,!0,t)},c.prototype.writeFloatBE=function(value,e,t){return G(this,value,e,!1,t)},c.prototype.writeDoubleLE=function(value,e,t){return W(this,value,e,!0,t)},c.prototype.writeDoubleBE=function(value,e,t){return W(this,value,e,!1,t)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var s=c.isBuffer(e)?e:X(new c(e,r).toString()),u=s.length;for(i=0;i<n-t;++i)this[i+t]=s[i%u]}return this};var H=/[^+\/0-9A-Za-z-_]/g;function X(e,t){var n;t=t||1/0;for(var r=e.length,o=null,s=[],i=0;i<r;++i){if((n=e.charCodeAt(i))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(i+1===r){(t-=3)>-1&&s.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&s.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&s.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function Y(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(H,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function K(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(t,n("DuR2"))},F3d7:function(e,t,n){"use strict";var r=n("TToO").__extends,o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n("xdLA"),u=n("gqjM"),l=n("rxHH"),c=n("Xq4m"),d=n("FgHA");t.FilterInvalidNode=function(e){function t(t,n){var r=e.call(this,t)||this;return r.fieldDefs=n,r}return r(t,e),t.prototype.clone=function(){return new t(null,o({},this.fieldDefs))},t.make=function(e,n){if("filter"!==n.config.invalidValues)return null;var r=n.reduceFieldDef(function(e,t,r){var o=s.isScaleChannel(r)&&n.getScaleComponent(r);if(o){var u=o.get("type");l.hasContinuousDomain(u)&&!t.aggregate&&(e[t.field]=t)}return e},{});return c.keys(r).length?new t(e,r):null},Object.defineProperty(t.prototype,"filter",{get:function(){return this.fieldDefs},enumerable:!0,configurable:!0}),t.prototype.assemble=function(){var e=this,t=c.keys(this.filter).reduce(function(t,n){var r=e.fieldDefs[n],o=u.vgField(r,{expr:"datum"});return null!==r&&(t.push(o+" !== null"),t.push("!isNaN("+o+")")),t},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null},t}(d.DataFlowNode)},FfdF:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function u(value){try{c(r.next(value))}catch(e){s(e)}}function l(value){try{c(r.throw(value))}catch(e){s(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,l)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var f,y,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(f)throw new TypeError("Generator is already executing.");for(;o;)try{if(f=1,y&&(n=y[2&r[0]?"return":r[0]?"throw":"next"])&&!(n=n.call(y,r[1])).done)return n;switch(y=0,n&&(r=[0,n.value]),r[0]){case 0:case 1:n=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,y=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){o.label=r[1];break}if(6===r[0]&&o.label<n[1]){o.label=n[1],n=r;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(r);break}n[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],y=0}finally{f=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=n("v/P2"),u=n("IlUm"),l=n("yltK");function c(e,t){return s.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")&&2===s.ENV.get("WEBGL_VERSION")?4===t?e.RGBA:e.RED:e.RGBA}function d(e){return s.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?e.FLOAT:e.UNSIGNED_BYTE}function h(e,t,n,r){l.validateTextureSize(e,t,n);var o=l.createTexture(e),u=e.TEXTURE_2D,h=function(e,t){return s.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")&&2===s.ENV.get("WEBGL_VERSION")?4===t?e.RGBA32F:e.R32F:e.RGBA}(e,r),p=c(e,r);return l.callAndCheck(e,function(){return e.bindTexture(u,o)}),l.callAndCheck(e,function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),l.callAndCheck(e,function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),l.callAndCheck(e,function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)}),l.callAndCheck(e,function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)}),l.callAndCheck(e,function(){return e.texImage2D(u,0,h,t,n,0,p,d(e),null)}),l.callAndCheck(e,function(){return e.bindTexture(e.TEXTURE_2D,null)}),o}function p(e,t,n,r,o,s){var u=c(e,s);l.validateTextureSize(e,n,r),l.callAndCheck(e,function(){return e.bindTexture(e.TEXTURE_2D,t)}),l.callAndCheck(e,function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,u,d(e),o)}),l.callAndCheck(e,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function g(e,t,n){return s.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?new Float32Array(u.getUnpackedArraySizeFromMatrixSize(e*t,n)):new Uint8Array(e*t*n)}function m(e,t,n,r){if(s.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")){var o=new Float32Array(t*n);return u.decodeMatrixFromUnpackedArray(e,o,r),o}return u.decodeToFloatArray(e)}t.getWebGLContextAttributes=function(){return{alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0}},t.createWebGLContext=function(e){var t,n={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};return t=null!=e?l.createWebGLRenderingContextFromCanvas(e,n):l.createWebGLRenderingContext(n),l.callAndCheck(t,function(){return t.disable(t.DEPTH_TEST)}),l.callAndCheck(t,function(){return t.disable(t.STENCIL_TEST)}),l.callAndCheck(t,function(){return t.disable(t.BLEND)}),l.callAndCheck(t,function(){return t.disable(t.DITHER)}),l.callAndCheck(t,function(){return t.disable(t.POLYGON_OFFSET_FILL)}),l.callAndCheck(t,function(){return t.disable(t.SAMPLE_COVERAGE)}),l.callAndCheck(t,function(){return t.enable(t.SCISSOR_TEST)}),l.callAndCheck(t,function(){return t.enable(t.CULL_FACE)}),l.callAndCheck(t,function(){return t.cullFace(t.BACK)}),t},t.createVertexShader=function(e){return l.createVertexShader(e,"\n    precision highp float;\n    attribute vec3 clipSpacePos;\n    attribute vec2 uv;\n    varying vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")},t.createVertexBuffer=function(e){var t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return l.createStaticVertexBuffer(e,t)},t.createIndexBuffer=function(e){var t=new Uint16Array([0,1,2,2,1,3]);return l.createStaticIndexBuffer(e,t)},t.createMatrixTexture=function(e,t,n){var r=u.getUnpackedMatrixTextureShapeWidthHeight(t,n);return h(e,r[0],r[1],1)},t.createColorMatrixTexture=function(e,t,n){var r=u.getColorMatrixTextureShapeWidthHeight(t,n);return h(e,r[0],r[1],4)},t.createPackedMatrixTexture=function(e,t,n){var r=u.getPackedMatrixTextureShapeWidthHeight(t,n);return h(e,r[0],r[1],4)},t.bindVertexProgramAttributeStreams=function(e,t,n){l.callAndCheck(e,function(){return e.bindBuffer(e.ARRAY_BUFFER,n)}),l.bindVertexBufferToProgramAttribute(e,t,"clipSpacePos",n,3,20,0),l.bindVertexBufferToProgramAttribute(e,t,"uv",n,2,20,12)},t.uploadPixelDataToTexture=function(e,t,n){l.callAndCheck(e,function(){return e.bindTexture(e.TEXTURE_2D,t)}),l.callAndCheck(e,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)}),l.callAndCheck(e,function(){return e.bindTexture(e.TEXTURE_2D,null)})},t.uploadMatrixToTexture=function(e,t,n,r,o,c){var d,h=u.getUnpackedMatrixTextureShapeWidthHeight(n,r),g=h[0],m=h[1];if(s.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")){var v=1===c?l.getChannelsPerTexture():c;1===v?d=o:(d=new Float32Array(u.getUnpackedArraySizeFromMatrixSize(o.length,v)),u.encodeMatrixToUnpackedArray(o,d,v))}else d=u.encodeFloatArray(o);p(e,t,g,m,d,c)},t.uploadMatrixToPackedTexture=function(e,t,n,r,o){var s=u.getPackedMatrixTextureShapeWidthHeight(n,r),l=s[0],c=s[1],d=new Float32Array(u.getPackedRGBAArraySizeFromMatrixShape(n,r));u.encodeMatrixToPackedRGBA(o,n,r,d),p(e,t,l,c,d,4)},t.downloadMatrixFromOutputTextureAsync=function(e,t,n,s){return r(this,void 0,void 0,function(){var r,u,c,h,p;return o(this,function(o){switch(o.label){case 0:return r=e,c=g(n,s,u=4),h=c instanceof Float32Array?4*c.length:c,p=e.createBuffer(),l.callAndCheck(e,function(){return e.bindBuffer(r.PIXEL_PACK_BUFFER,p)}),l.callAndCheck(e,function(){return e.bufferData(r.PIXEL_PACK_BUFFER,h,e.STATIC_DRAW)}),l.callAndCheck(e,function(){return r.readPixels(0,0,s,n,e.RGBA,d(e),0)}),[4,t.getBufferSubDataAsync(r.PIXEL_PACK_BUFFER,0,c)];case 1:return o.sent(),[2,m(c,n,s,u)]}})})},t.downloadMatrixFromOutputTexture=function(e,t,n){var r=u.getUnpackedMatrixTextureShapeWidthHeight(t,n),o=r[0],s=r[1],c=g(t,n,4);return l.callAndCheck(e,function(){return e.readPixels(0,0,o,s,e.RGBA,d(e),c)}),m(c,t,n,4)},t.downloadMatrixFromRGBAColorTexture=function(e,t,n,r){var o=t*n*4,s=new Uint8Array(o);l.callAndCheck(e,function(){return e.readPixels(0,0,n,t,e.RGBA,e.UNSIGNED_BYTE,s)});for(var c=new Float32Array(o),i=0;i<s.length;i++)c[i]=s[i];var d=new Float32Array(t*n*r);return u.decodeMatrixFromUnpackedColorRGBAArray(c,d,r),d},t.downloadMatrixFromPackedOutputTexture=function(e,t,n){var r=u.getPackedMatrixTextureShapeWidthHeight(t,n),o=r[0],s=r[1],c=new Float32Array(u.getPackedRGBAArraySizeFromMatrixShape(t,n));l.callAndCheck(e,function(){return e.readPixels(0,0,o,s,e.RGBA,d(e),c)});var h=new Float32Array(t*n);return u.decodeMatrixFromPackedRGBA(c,t,n,h)}},FgHA:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this.debugName=t,this._children=[],this._parent=null,e&&(this.parent=e)}return e.prototype.clone=function(){throw new Error("Cannot clone node")},e.prototype.producedFields=function(){return{}},e.prototype.dependentFields=function(){return{}},Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},set:function(e){this._parent=e,e.addChild(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),e.prototype.numChildren=function(){return this._children.length},e.prototype.addChild=function(e){this._children.push(e)},e.prototype.removeChild=function(e){this._children.splice(this._children.indexOf(e),1)},e.prototype.remove=function(){for(var e=0,t=this._children;e<t.length;e++)t[e].parent=this._parent;this._parent.removeChild(this)},e.prototype.insertAsParentOf=function(e){var t=e.parent;t.removeChild(this),this.parent=t,e.parent=this},e.prototype.swapWithParent=function(){for(var e=this._parent,t=e.parent,n=0,r=this._children;n<r.length;n++)r[n].parent=e;this._children=[],e.removeChild(this),e.parent.removeChild(e),this.parent=t,e.parent=this},e}();t.DataFlowNode=o,t.OutputNode=function(e){function t(t,n,r,o){var s=e.call(this,t,n)||this;return s.type=r,s.refCounts=o,s._source=s._name=n,!s.refCounts||s._name in s.refCounts||(s.refCounts[s._name]=0),s}return r(t,e),t.prototype.clone=function(){var e=new this.constructor;return e.debugName="clone_"+this.debugName,e._source=this._source,e._name="clone_"+this._name,e.type=this.type,e.refCounts=this.refCounts,e.refCounts[e._name]=0,e},t.prototype.getSource=function(){return this.refCounts[this._name]++,this._source},t.prototype.isRequired=function(){return!!this.refCounts[this._name]},t.prototype.setSource=function(e){this._source=e},t}(o)},FhLH:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("v/P2"),s=n("V6aD"),u=n("m3RX"),l=n("dFrR");t.AdamaxOptimizer=function(e){function t(t,n,r,o,l){void 0===o&&(o=1e-8),void 0===l&&(l=0);var c=e.call(this)||this;return c.learningRate=t,c.accumulatedFirstMoment={},c.accumulatedWeightedInfNorm={},c.c=s.keep(u.scalar(-t)),c.eps=s.keep(u.scalar(o)),c.beta1=s.keep(u.scalar(n)),c.beta2=s.keep(u.scalar(r)),c.decay=s.keep(u.scalar(l)),s.tidy(function(){c.iteration=u.scalar(0).variable(),c.accBeta1=u.scalar(n).variable()}),c.oneMinusBeta1=s.keep(u.scalar(1-n)),c.one=s.keep(u.scalar(1)),c}return r(t,e),t.prototype.applyGradients=function(e){var t=this;s.tidy(function(){var n=t.one.sub(t.accBeta1),r=t.c.div(t.one.add(t.decay.mul(t.iteration)));for(var s in e){var value=o.ENV.engine.registeredVariables[s];if(null==t.accumulatedFirstMoment[s]){var l=!1;t.accumulatedFirstMoment[s]=u.zerosLike(value).variable(l)}null==t.accumulatedWeightedInfNorm[s]&&(l=!1,t.accumulatedWeightedInfNorm[s]=u.zerosLike(value).variable(l));var c=e[s],d=t.accumulatedWeightedInfNorm[s],h=t.beta1.mul(t.accumulatedFirstMoment[s]).add(t.oneMinusBeta1.mul(c)),p=t.beta2.mul(d),g=c.abs(),m=p.maximum(g);t.accumulatedFirstMoment[s].assign(h),t.accumulatedWeightedInfNorm[s].assign(m);var v=r.div(n).mul(h.div(t.eps.add(m))).add(value);value.assign(v)}t.iteration.assign(t.iteration.add(t.one)),t.accBeta1.assign(t.accBeta1.mul(t.beta1))})},t.prototype.dispose=function(){var e=this;this.c.dispose(),this.eps.dispose(),this.accBeta1.dispose(),this.beta1.dispose(),this.beta2.dispose(),this.oneMinusBeta1.dispose(),this.decay.dispose(),this.iteration.dispose(),this.one.dispose(),null!=this.accumulatedFirstMoment&&Object.keys(this.accumulatedFirstMoment).forEach(function(t){return e.accumulatedFirstMoment[t].dispose()}),null!=this.accumulatedWeightedInfNorm&&Object.keys(this.accumulatedWeightedInfNorm).forEach(function(t){return e.accumulatedWeightedInfNorm[t].dispose()})},t}(l.Optimizer)},"G/mX":function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("dMOq"),s=n("gqjM"),u=n("zEzE");t.geoshape={vgMark:"shape",encodeEntry:function(e){return r({},o.baseEncodeEntry(e,{size:"ignore",orient:"ignore"}))},postEncodingTransform:function(e){var t=e.encoding.shape;return[r({type:"geoshape",projection:e.projectionName()},t&&s.isFieldDef(t)&&t.type===u.GEOJSON?{field:s.vgField(t,{expr:"datum"})}:{})]}}},G57i:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("v/P2"),u=n("XFvI"),l=n("bDWH"),c=n("35G1"),d=n("m3RX");t.BinaryOps=function(){function e(){}return e.add=function(a,b){u.assertTypesMatch(a,b);var e=l.assertAndGetBroadcastShape(a.shape,b.shape);return s.ENV.engine.runKernel(function(e){return e.add(a,b)},{a:a,b:b},function(t){return{a:function(){var n=t,r=l.getReductionAxes(a.shape,e);return r.length>0&&(n=n.sum(r)),n.reshape(a.shape)},b:function(){var n=t,r=l.getReductionAxes(b.shape,e);return r.length>0&&(n=n.sum(r)),n.reshape(b.shape)}}})},e.addStrict=function(a,b){return u.assertShapesMatch(a.shape,b.shape,"Error in addStrict: "),a.add(b)},e.sub=function(a,b){u.assertTypesMatch(a,b);var e=l.assertAndGetBroadcastShape(a.shape,b.shape);return s.ENV.engine.runKernel(function(e){return e.subtract(a,b)},{a:a,b:b},function(t){return{a:function(){var n=t,r=l.getReductionAxes(a.shape,e);return r.length>0&&(n=n.sum(r)),n.reshape(a.shape)},b:function(){var n=t,r=l.getReductionAxes(b.shape,e);return r.length>0&&(n=n.sum(r)),n.neg().reshape(b.shape)}}})},e.subStrict=function(a,b){return u.assertShapesMatch(a.shape,b.shape,"Error in subStrict: "),a.sub(b)},e.pow=function(e,t){return l.assertAndGetBroadcastShape(e.shape,t.shape),s.ENV.engine.runKernel(function(n){return n.pow(e,t)},{base:e},function(n){if(!u.arraysEqual(e.shape,t.shape)&&!u.isScalarShape(t.shape))throw new Error("Gradient of pow not yet supported for broadcasted shapes.");return{base:function(){var r=t.toFloat(),o=r.mul(e.toFloat().pow(r.sub(d.scalar(1))));return n.mulStrict(o)}}})},e.powStrict=function(e,t){return u.assertShapesMatch(e.shape,t.shape,"Error in powStrict: "),e.pow(t)},e.mul=function(a,b){u.assertTypesMatch(a,b);var e=l.assertAndGetBroadcastShape(a.shape,b.shape);return s.ENV.engine.runKernel(function(e){return e.multiply(a,b)},{a:a,b:b},function(t){return{a:function(){var n=t.mul(b.toFloat()),r=l.getReductionAxes(a.shape,e);return r.length>0?n.sum(r).reshape(a.shape):n},b:function(){var n=t.mul(a.toFloat()),r=l.getReductionAxes(b.shape,e);return r.length>0?n.sum(r).reshape(b.shape):n}}})},e.mulStrict=function(a,b){return u.assertShapesMatch(a.shape,b.shape,"Error in multiplyStrict: "),a.mul(b)},e.div=function(a,b){u.assertTypesMatch(a,b);var e=l.assertAndGetBroadcastShape(a.shape,b.shape);return s.ENV.engine.runKernel(function(e){return e.divide(a,b)},{a:a,b:b},function(t){return{a:function(){var n=t.div(b.toFloat()),r=l.getReductionAxes(a.shape,e);return r.length>0?n.sum(r).reshape(a.shape):n},b:function(){var n=t.mul(a.toFloat()),r=l.getReductionAxes(b.shape,e);r.length>0&&(n=n.sum(r).reshape(b.shape));var o=b.square();return n.div(o.toFloat()).neg()}}})},e.divStrict=function(a,b){return u.assertShapesMatch(a.shape,b.shape,"Error in divideStrict: "),a.div(b)},e.minimum=function(a,b){return u.assertTypesMatch(a,b),l.assertAndGetBroadcastShape(a.shape,b.shape),s.ENV.engine.runKernel(function(e){return e.minimum(a,b)},{a:a,b:b},function(e){return{a:function(){return e.mul(a.lessEqual(b).toFloat())},b:function(){return e.mul(a.greater(b).toFloat())}}})},e.minimumStrict=function(a,b){return u.assertShapesMatch(a.shape,b.shape,"Error in minimumStrict: "),a.minimum(b)},e.maximum=function(a,b){return u.assertTypesMatch(a,b),l.assertAndGetBroadcastShape(a.shape,b.shape),s.ENV.engine.runKernel(function(e){return e.maximum(a,b)},{a:a,b:b},function(e){return{a:function(){return e.mul(a.greaterEqual(b).toFloat())},b:function(){return e.mul(a.less(b).toFloat())}}})},e.maximumStrict=function(a,b){return u.assertShapesMatch(a.shape,b.shape,"Error in minimumStrict: "),a.maximum(b)},e.squaredDifference=function(a,b){return u.assertTypesMatch(a,b),l.assertAndGetBroadcastShape(a.shape,b.shape),s.ENV.engine.runKernel(function(e){return e.squaredDifference(a,b)},{a:a,b:b},function(e){var t=d.scalar(2);return{a:function(){return e.mul(a.sub(b).mul(t))},b:function(){return e.mul(b.sub(a).mul(t))}}})},e.squaredDifferenceStrict=function(a,b){return u.assertShapesMatch(a.shape,b.shape,"Error in squaredDifferenceStrict: "),a.squaredDifference(b)},e.atan2=function(a,b){u.assertTypesMatch(a,b);var t=l.assertAndGetBroadcastShape(a.shape,b.shape);return s.ENV.engine.runKernel(function(e){return e.atan2(a,b)},{a:a,b:b},function(n){return{a:function(){var r=e.add(d.square(a),d.square(b)),o=n.mul(b.div(r)),s=l.getReductionAxes(a.shape,t);return s.length>0&&(o=o.sum(s)),o.reshape(a.shape)},b:function(){var r=e.add(d.square(a),d.square(b)),o=d.neg(n.mul(a.div(r))),s=l.getReductionAxes(b.shape,t);return s.length>0&&(o=o.sum(s)),o.reshape(b.shape)}}})},r([o.doc({heading:"Operations",subheading:"Arithmetic"}),c.operation],e,"add",null),r([c.operation],e,"addStrict",null),r([o.doc({heading:"Operations",subheading:"Arithmetic"}),c.operation],e,"sub",null),r([c.operation],e,"subStrict",null),r([o.doc({heading:"Operations",subheading:"Arithmetic"}),c.operation],e,"pow",null),r([c.operation],e,"powStrict",null),r([o.doc({heading:"Operations",subheading:"Arithmetic"}),c.operation],e,"mul",null),r([c.operation],e,"mulStrict",null),r([o.doc({heading:"Operations",subheading:"Arithmetic"}),c.operation],e,"div",null),r([c.operation],e,"divStrict",null),r([o.doc({heading:"Operations",subheading:"Arithmetic"}),c.operation],e,"minimum",null),r([c.operation],e,"minimumStrict",null),r([o.doc({heading:"Operations",subheading:"Arithmetic"}),c.operation],e,"maximum",null),r([c.operation],e,"maximumStrict",null),r([o.doc({heading:"Operations",subheading:"Arithmetic"}),c.operation],e,"squaredDifference",null),r([c.operation],e,"squaredDifferenceStrict",null),r([c.operation],e,"atan2",null),e}()},GH2X:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var s=n("Bsgt"),u=n("dQN6"),l=n("NDl6"),c=n("xdLA"),d=n("8Wnz"),h=n("1dKF"),p=n("KMAE"),g=n("rxHH"),m=n("7AlL"),v=n("Xq4m"),_=n("Xq4m"),w=n("0N5v"),E=n("0N5v"),O=n("efV4"),S=n("9QYT"),A=n("OMxB"),T=n("kglw");function N(e,t){var n=e.getScaleComponent(t).get("type"),o=function(e,t,n,r){if("unaggregated"===e){var o=D(t,n);if(!o.valid)return void p.warn(o.reason)}else if(void 0===e&&r.useUnaggregatedDomain&&D(t,n).valid)return"unaggregated";return e}(e.scaleDomain(t),e.fieldDef(t),n,e.config.scale);return o!==e.scaleDomain(t)&&(e.specifiedScales[t]=r({},e.specifiedScales[t],{domain:o})),"x"===t&&e.channelHasField("x2")?e.channelHasField("x")?M(n,o,e,"x").concat(M(n,o,e,"x2")):M(n,o,e,"x2"):"y"===t&&e.channelHasField("y2")?e.channelHasField("y")?M(n,o,e,"y").concat(M(n,o,e,"y2")):M(n,o,e,"y2"):M(n,o,e,t)}function M(e,t,n,r){var o=n.fieldDef(r);if(t&&"unaggregated"!==t&&!g.isSelectionDomain(t)){if(!o.bin)return h.isDateTime(t[0])?t.map(function(e){return{signal:"{data: "+h.dateTimeExpr(e,!0)+"}"}}):[t];p.warn(p.message.conflictedDomain(r))}var s=n.stack;if(s&&r===s.fieldChannel)return"normalize"===s.offset?[[0,1]]:[{data:u=n.requestDataName(d.MAIN),field:n.vgField(r,{suffix:"start"})},{data:u,field:n.vgField(r,{suffix:"end"})}];var u,v=c.isScaleChannel(r)?C(n,r,e):void 0;if("unaggregated"===t)return[{data:u=n.requestDataName(d.MAIN),field:n.vgField(r,{aggregate:"min"})},{data:u,field:n.vgField(r,{aggregate:"max"})}];if(!o.bin)return v?[{data:_.isBoolean(v)?n.requestDataName(d.MAIN):n.requestDataName(d.RAW),field:n.vgField(r),sort:v}]:[{data:n.requestDataName(d.MAIN),field:n.vgField(r)}];if(g.isBinScale(e)){var w=n.getName(l.binToString(o.bin)+"_"+o.field+"_bins");return[{signal:"sequence("+w+".start, "+w+".stop + "+w+".step, "+w+".step)"}]}return g.hasDiscreteDomain(e)?[{data:_.isBoolean(v)?n.requestDataName(d.MAIN):n.requestDataName(d.RAW),field:n.vgField(r,O.binRequiresRange(o,r)?{binSuffix:"range"}:{}),sort:!0!==v&&m.isSortField(v)?v:{field:n.vgField(r,{}),op:"min"}}]:"x"===r||"y"===r?[{data:u=n.requestDataName(d.MAIN),field:n.vgField(r,{})},{data:u,field:n.vgField(r,{binSuffix:"end"})}]:[{data:n.requestDataName(d.MAIN),field:n.vgField(r,{})}]}function C(e,t,n){if(g.hasDiscreteDomain(n)){var r=e.sort(t);return m.isSortField(r)?r:"descending"===r?{op:"min",field:e.vgField(t),order:"descending"}:!!_.contains(["ascending",void 0],r)||void 0}}function D(e,t){return e.aggregate?u.SHARED_DOMAIN_OP_INDEX[e.aggregate]?"quantitative"===e.type&&"log"===t?{valid:!1,reason:p.message.unaggregatedDomainWithLogScale(e)}:{valid:!0}:{valid:!1,reason:p.message.unaggregateDomainWithNonSharedDomainOp(e.aggregate)}:{valid:!1,reason:p.message.unaggregateDomainHasNoEffectForRawField(e)}}function R(e){var t=_.unique(e.map(function(e){return E.isDataRefDomain(e)?o(e,["sort"]):e}),_.hash),n=_.unique(e.map(function(e){if(E.isDataRefDomain(e)){var t=e.sort;return void 0===t||_.isBoolean(t)||("count"===t.op&&delete t.field,"ascending"===t.order&&delete t.order),t}}).filter(function(e){return void 0!==e}),_.hash);if(1===t.length){if(E.isDataRefDomain(c=e[0])&&n.length>0){var s=n[0];return n.length>1&&(p.warn(p.message.MORE_THAN_ONE_SORT),s=!0),r({},c,{sort:s})}return c}var u=_.unique(n.map(function(e){return!0===e?e:"count"===e.op?e:(p.warn(p.message.domainSortDropped(e)),!0)}),_.hash),l=void 0;1===u.length?l=u[0]:u.length>1&&(p.warn(p.message.MORE_THAN_ONE_SORT),l=!0);var c,d=_.unique(e.map(function(e){return E.isDataRefDomain(e)?e.data:null}),function(x){return x});return 1===d.length&&null!==d[0]?c=r({data:d[0],fields:t.map(function(e){return e.field})},l?{sort:l}:{}):r({fields:t},l?{sort:l}:{})}t.parseScaleDomain=function e(t){A.isUnitModel(t)?function(e){var t=e.specifiedScales,n=e.component.scales;_.keys(n).forEach(function(r){var o=t[r],s=o?o.domain:void 0,u=N(e,r),l=n[r];if(l.domains=u,g.isSelectionDomain(s)&&l.set("domainRaw",{signal:T.SELECTION_DOMAIN+v.hash(s)},!0),e.component.data.isFaceted){for(var c=e;!A.isFacetModel(c)&&c.parent;)c=c.parent;if("shared"===c.component.resolve.scale[r])for(var d=0,h=u;d<h.length;d++){var p=h[d];E.isDataRefDomain(p)&&(p.data=S.FACET_SCALE_PREFIX+p.data.replace(S.FACET_SCALE_PREFIX,""))}}})}(t):function(t){for(var n=0,r=t.children;n<r.length;n++)e(r[n]);var o=t.component.scales;_.keys(o).forEach(function(e){for(var n,r=0,s=t.children;r<s.length;r++){var u=s[r].component.scales[e];u&&(n=void 0===n?u.domains:n.concat(u.domains))}o[e].domains=n})}(t)},t.parseDomainForChannel=N,t.domainSort=C,t.canUseUnaggregatedDomain=D,t.mergeDomains=R,t.getFieldFromDomain=function(e){if(E.isDataRefDomain(e)&&s.isString(e.field))return e.field;if(w.isDataRefUnionedDomain(e)){for(var t=void 0,n=0,r=e.fields;n<r.length;n++){var o=r[n];if(E.isDataRefDomain(o)&&s.isString(o.field))if(t){if(t!==o.field)return p.warn("Detected faceted independent scales that union domain of multiple fields from different data sources.  We will use the first field.  The result view size may be incorrect."),t}else t=o.field}return p.warn("Detected faceted independent scales that union domain of identical fields from different source detected.  We will assume that this is the same field from a different fork of the same data source.  However, if this is not case, the result view size maybe incorrect."),t}return w.isFieldRefUnionDomain(e)?(p.warn("Detected faceted independent scales that union domain of multiple fields from the same data source.  We will use the first field.  The result view size may be incorrect."),s.isString(t=e.fields[0])?t:void 0):void 0},t.assembleDomain=function(e,t){return R(e.component.scales[t].domains.map(function(t){return E.isDataRefDomain(t)&&(t.data=e.lookupDataSource(t.data)),t}))}},GOEm:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function u(value){try{c(r.next(value))}catch(e){s(e)}}function l(value){try{c(r.throw(value))}catch(e){s(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,l)}c((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var f,y,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(f)throw new TypeError("Generator is already executing.");for(;o;)try{if(f=1,y&&(n=y[2&r[0]?"return":r[0]?"throw":"next"])&&!(n=n.call(y,r[1])).done)return n;switch(y=0,n&&(r=[0,n.value]),r[0]){case 0:case 1:n=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,y=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){o.label=r[1];break}if(6===r[0]&&o.label<n[1]){o.label=n[1],n=r;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(r);break}n[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],y=0}finally{f=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var u=n("u9Pu"),l=n("9j4o"),c=n("YODX"),d=n("XGtb"),h=n("gt9F"),p=n("D2h/");t.vega=c,t.vl=d;var g={vega:"Vega","vega-lite":"Vega-Lite"},m={vega:t.vega.version,"vega-lite":t.vl?t.vl.version:"not available"},v={vega:function(e,t){return e},"vega-lite":function(e,n){return t.vl.compile(e,{config:n}).spec}};t.default=function e(n,c,d){return o(this,void 0,void 0,function(){var o,_,w,E,O,S,A,T,N,M,C,D,R,I,P;return s(this,function(s){switch(s.label){case 0:return o=void 0===(d=d||{}).actions||d.actions,_=d.loader||t.vega.loader(),w=d.renderer||"canvas",E=d.logLevel||t.vega.Warn,t.vega.isString(c)?[4,_.load(c)]:[3,2];case 1:return S=s.sent(),[2,e(n,JSON.parse(S),d)];case 2:return t.vega.isString(O=d.config)?[4,_.load(O)]:[3,4];case 3:return S=s.sent(),[2,e(n,c,r({},d,{config:JSON.parse(S)}))];case 4:return c.$schema?(A=h.default(c.$schema),d.mode&&d.mode!==A.library&&console.warn("The given visualization spec is written in "+g[A.library]+", but mode argument sets "+g[d.mode]+"."),u(A.version,m[T=A.library])>0&&console.warn("The input spec uses "+T+" "+A.version+", but the current version of "+g[T]+" is "+m[T]+".")):T=d.mode||"vega",N=v[T](c,O),"vega-lite"===T&&N.$schema&&(A=h.default(N.$schema),u(A.version,m.vega)>0&&console.warn("The compiled spec uses Vega "+A.version+", but current version is "+m.vega+".")),M=l.select(n).classed("vega-embed",!0).html(""),d.onBeforeParse&&(N=d.onBeforeParse(N)),C=t.vega.parse(N,"vega-lite"===T?{}:O),D=new t.vega.View(C,{loader:_,logLevel:E,renderer:w}).initialize(n),"vega-lite"!==T&&D.hover(),d&&(d.width&&D.width(d.width),d.height&&D.height(d.height),d.padding&&D.padding(d.padding)),d.runAsync?[4,D.runAsync()]:[3,6];case 5:return s.sent(),[3,7];case 6:D.run(),s.label=7;case 7:return!1!==o&&(R=M.append("div").attr("class","vega-actions"),!0!==o&&!1===o.export||(I="canvas"===w?"png":"svg",R.append("a").text("Export as "+I.toUpperCase()).attr("href","#").attr("target","_blank").attr("download","visualization."+I).on("mousedown",function(){var e=this;D.toImageURL(I).then(function(t){e.href=t}).catch(function(e){throw e}),l.event.preventDefault()})),!0!==o&&!1===o.source||R.append("a").text("View Source").attr("href","#").on("click",function(){var e,t,n,r;e=JSON.stringify(c,null,2),t="<html><head>"+(d.sourceHeader||"")+'</head><body><pre><code class="json">',n="</code></pre>"+(d.sourceFooter||"")+"</body></html>",(r=window.open("")).document.write(t+e+n),r.document.title="Vega JSON Source",l.event.preventDefault()}),!0!==o&&!1===o.editor||(P=d.editorUrl||"https://vega.github.io/editor/",R.append("a").text("Open in Vega Editor").attr("href","#").on("click",function(){p.post(window,P,{mode:T,renderer:w,spec:JSON.stringify(c,null,2)}),l.event.preventDefault()}))),[2,{view:D,spec:c}]}})})}},Gi67:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var s=n("Xq4m"),u=n("0N5v"),l=n("OMxB");function c(e){return e.children.reduce(function(e,t){return e.concat(t.assembleProjections())},d(e))}function d(e){var t=e.component.projection;if(!t||t.merged)return[];var n=t.combine(),l=n.name,c=o(n,["name"]),d={signal:"["+t.size.map(function(e){return e.signal}).join(", ")+"]"},h=t.data.reduce(function(t,n){var r=u.isVgSignalRef(n)?n.signal:"data('"+e.lookupDataSource(n)+"')";return s.contains(t,r)||t.push(r),t},[]);if(h.length<=0)throw new Error("Projection's fit didn't find any data sources");return[r({name:l,size:d,fit:{signal:h.length>1?"["+h.join(", ")+"]":h[0]}},c)]}t.assembleProjections=function(e){return l.isLayerModel(e)||l.isConcatModel(e)||l.isRepeatModel(e)?c(e):d(e)},t.assembleProjectionsForModelAndChildren=c,t.assembleProjectionForModel=d},GrTV:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VL_ONLY_GUIDE_CONFIG=["shortTimeLabels"]},GxMh:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReduceProgram=function(){return function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,o=e.inSize,s=Math.ceil(o/n);this.outputShape=[r,s];var u="sum"===t,l="0.0";u||(l="min"===t?"1.0 / 0.0":"-1.0 / 0.0");var c="min"===t?"min":"max",d=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t&&(d="sumValue");var h=4*Math.floor(n/4),p=n%4,g="\n      if ("+u+") {\n        sumValue += dot(values, ones);\n      } else {\n        if (hasNaN(values)) {\n          setOutput(getNaN(values));\n          return;\n        }\n        minMaxValue = "+c+"(values, minMaxValue);\n      }\n    ",m="";o%n>0&&(m="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+l+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+m+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+l+");\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+h+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+g+"\n        }\n\n        int inIdx = inOffset + "+h+";\n        if ("+(1===p)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n          "+g+"\n        } else if ("+(2===p)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n          "+g+"\n        } else if ("+(3===p)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n          "+g+"\n        }\n        setOutput("+d+");\n      }\n    "}}()},"H/Ud":function(e,t,n){var r=n("VOQS"),o=n("di0+"),s=n("i+52"),u=n("fzqA"),l=n("9g4f"),c=n("4dK1"),d=n("p//t");d.alea=r,d.xor128=o,d.xorwow=s,d.xorshift7=u,d.xor4096=l,d.tychei=c,e.exports=d},HS78:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("yJL4"),o=n("DjcB"),s=function(){function e(t){if(this.id2Value={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n];else{if(null==t)return;for(var r=0,o=t;r<o.length;r++){var s=o[r];this.add(s.key,s.value)}}}return e.prototype.add=function(e,value){if(function(e,t){if(null!=e.dtype&&e.dtype!==t.dtype)throw new r.ValueError("The dtype of the feed ("+t.dtype+") is incompatible with that of the key '"+e.name+"' ("+e.dtype+").");if(null!=e.shape){if(e.shape.length!==t.shape.length)throw new r.ValueError("The rank of feed ("+t.shape.length+") does not match the rank of the key ("+e.shape.length+").");for(var i=0;i<e.shape.length;++i)if(null!=e.shape[i]&&e.shape[i]!==t.shape[i])throw new r.ValueError("The "+i+"-th dimension of the feed ("+t.shape[i]+") is incompatible with that of the key ("+e.shape[i]+").")}}(e,value),null!=this.id2Value[e.id])throw new r.ValueError("Duplicate key: name="+e.name+", id="+e.id);return this.id2Value[e.id]=value,this},e.prototype.addFeed=function(e){this.add(e.key,e.value)},e.prototype.hasKey=function(e){return null!=this.id2Value[e.id]},e.prototype.getValue=function(e){if(null==this.id2Value[e.id])throw new r.ValueError("Nonexistent key: "+JSON.stringify(e));return this.id2Value[e.id]},e}();function u(e,t,n){if(t.hasKey(e))return t.getValue(e);if(e.sourceLayer instanceof o.InputLayer)throw new r.ValueError("Missing a feed value for SymbolicTensor from InputLayer '"+o.InputLayer.name+"'");for(var s=[],l=0,c=e.inputs;l<c.length;l++){var d=u(c[l],t,n);s.push(d)}var h=e.sourceLayer.apply(s,n);Array.isArray(h)||(h=[h]);for(var p=function(e){var t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{for(var n=null,i=0;i<e.sourceLayer.inboundNodes.length;++i)for(var r=0,o=e.sourceLayer.inboundNodes[i].outputTensors;r<o.length;r++)if(o[r].id===e.id){n=i;break}t=e.sourceLayer.getOutputAt(n)}return t}(e),g=Array.isArray(p)?p:[p],i=0;i<g.length;++i)t.add(g[i],h[i]);return 1===h.length?h[0]:h[e.outputTensorIndex]}t.FeedDict=s,t.execute=function(e,t,n){for(var r=Array.isArray(e),o=r?e:[e],l=[],c=new s(t),d=0,h=o;d<h.length;d++)l.push(u(h[d],c,n));return r?l:l[0]}},Hjly:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("XFvI");function o(e,t,n,o,d,h,p,g){void 0===p&&(p=!1),void 0===g&&(g="channelsLast");var m=[-1,-1,-1,-1],v=m[0],_=m[1],w=m[2],E=m[3];if("channelsLast"===g)v=e[0],_=e[1],w=e[2],E=e[3];else{if("channelsFirst"!==g)throw new Error("Unknown dataFormat "+g);v=e[0],E=e[1],_=e[2],w=e[3]}var O,S=t[0],A=t[1],T=t[3],N=u(n),M=N[0],C=N[1],D=u(o),R=D[0],I=D[1],P=function(e,t,n,o,u,l,d,h){var p,g,m;if("number"==typeof e){p={top:e,bottom:e,left:e,right:e};var v=function(e,t,n,o,u,l){null==u&&(u=s(e,t,o));var d=e[1],h=c((e[0]-t+2*u)/o+1,l);r.assert(r.isInt(h),"The output # of rows ("+h+") must be an integer. Change the stride and/or zero pad parameters");var p=c((d-t+2*u)/o+1,l);return r.assert(r.isInt(p),"The output # of columns ("+p+") must be an integer. Change the stride and/or zero pad parameters"),[h,p,1]}([t,n,1],l,0,o,e,h);g=v[0],m=v[1]}else if("same"===e){var _=((g=Math.ceil(t/o))-1)*o+l-t,w=((m=Math.ceil(n/u))-1)*u+d-n,E=Math.floor(_/2),O=_-E,S=Math.floor(w/2);p={top:E,bottom:O,left:S,right:w-S}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);p={top:0,bottom:0,left:0,right:0},g=Math.ceil((t-l+1)/o),m=Math.ceil((n-d+1)/u)}return{padInfo:p,outHeight:g,outWidth:m}}(d,_,w,M,C,l(S,R),l(A,I),h),L=P.outHeight,z=P.outWidth,F=p?T*E:T;return"channelsFirst"===g?O=[v,F,L,z]:"channelsLast"===g&&(O=[v,L,z,F]),{batchSize:v,dataFormat:g,inHeight:_,inWidth:w,inChannels:E,outHeight:L,outWidth:z,outChannels:F,padInfo:P.padInfo,strideHeight:M,strideWidth:C,filterHeight:S,filterWidth:A,dilationHeight:R,dilationWidth:I,inShape:e,outShape:O,filterShape:t}}function s(e,t,n,r){void 0===r&&(r=1);var o=l(t,r);return Math.floor((e[0]*(n-1)-n+o)/2)}function u(e){return"number"==typeof e?[e,e]:e}function l(e,t){return t<=1?e:e+(e-1)*(t-1)}function c(value,e){if(!e)return value;switch(e){case"round":return Math.round(value);case"ceil":return Math.ceil(value);case"floor":return Math.floor(value);default:throw new Error("Unknown roundingMode "+e)}}t.computePool2DInfo=function(e,t,n,r,s,l){void 0===l&&(l="channelsLast");var c,d=u(t),h=d[0],p=d[1];if("channelsLast"===l)c=[h,p,e[3],e[3]];else{if("channelsFirst"!==l)throw new Error("Unknown dataFormat "+l);c=[h,p,e[1],e[1]]}return o(e,c,n,1,r,s,!1,l)},t.computeConv2DInfo=o,t.computeDefaultPad=s},IJmD:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("v/P2"),s=n("V6aD"),u=n("m3RX"),l=n("dFrR");t.AdagradOptimizer=function(e){function t(t,n){void 0===n&&(n=.1);var r=e.call(this)||this;return r.learningRate=t,r.initialAccumulatorValue=n,r.accumulatedGrads={},r.c=s.keep(u.scalar(-t)),r.epsilon=s.keep(u.scalar(1e-8)),r}return r(t,e),t.prototype.applyGradients=function(e){var t=this,n=function(n){var value=o.ENV.engine.registeredVariables[n];null==r.accumulatedGrads[n]&&s.tidy(function(){t.accumulatedGrads[n]=u.fill(value.shape,t.initialAccumulatorValue).variable(!1)});var l=e[n],c=r.accumulatedGrads[n];s.tidy(function(){var e=c.add(l.square());t.accumulatedGrads[n].assign(e);var r=t.c.mul(l.div(e.add(t.epsilon).sqrt())).add(value);value.assign(r)})},r=this;for(var l in e)n(l)},t.prototype.dispose=function(){var e=this;this.epsilon.dispose(),this.c.dispose(),null!=this.accumulatedGrads&&Object.keys(this.accumulatedGrads).forEach(function(t){return e.accumulatedGrads[t].dispose()})},t}(l.Optimizer)},IlUm:function(e,t,n){"use strict";function r(e,t){return e*t}function o(e,t){if(e%t!=0)throw new Error("unpackedSize ("+e+") must be a multiple of "+t);return e/t}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.FLOAT=0]="FLOAT",e[e.UNSIGNED_BYTE=1]="UNSIGNED_BYTE"}(t.TextureType||(t.TextureType={})),t.getUnpackedMatrixTextureShapeWidthHeight=function(e,t){return[t,e]},t.getUnpackedArraySizeFromMatrixSize=r,t.getColorMatrixTextureShapeWidthHeight=function(e,t){return[4*t,e]},t.getMatrixSizeFromUnpackedArraySize=o,t.encodeMatrixToUnpackedArray=function(e,t,n){var o=r(e.length,n);if(t.length<o)throw new Error("unpackedArray length ("+t.length+") must be >= "+o);for(var s=0,u=0;u<e.length;++u)t[s]=e[u],s+=n},t.FLOAT_MAX=2e4,t.FLOAT_MIN=-t.FLOAT_MAX;var s=(t.FLOAT_MAX-t.FLOAT_MIN)/255,u=[1,1/255,1/65025,1/16581375],l=[1,255,65025];function c(e,t){return[Math.ceil(t/2),Math.ceil(e/2)]}function d(e,t){var n=c(e,t);return n[0]*n[1]*4}t.BYTE_NAN_VALUE=0,t.encodeFloatArray=function(e){for(var n=new Uint8Array(4*e.length),r=function(i){var value=e[i/4];if(isNaN(value))return n[i]=t.BYTE_NAN_VALUE,n[i+1]=t.BYTE_NAN_VALUE,n[i+2]=t.BYTE_NAN_VALUE,n[i+3]=t.BYTE_NAN_VALUE,"continue";var r=(value-t.FLOAT_MIN)/s,o=l.map(function(e){return e*r}).map(function(value){return Math.floor(value%1*255)});n[i]=Math.floor(r),n[i+1]=o[0],n[i+2]=o[1],n[i+3]=o[2]},i=0;i<n.length;i+=4)r(i);return n},t.decodeToFloatArray=function(e){for(var n=new Float32Array(e.length/4),r=function(i){if(e[i]===t.BYTE_NAN_VALUE&&e[i+1]===t.BYTE_NAN_VALUE&&e[i+2]===t.BYTE_NAN_VALUE&&e[i+3]===t.BYTE_NAN_VALUE)return n[i/4]=NaN,"continue";var r=0;u.forEach(function(t,j){r+=t*e[i+j]}),n[i/4]=r*s+t.FLOAT_MIN},i=0;i<e.length;i+=4)r(i);return n},t.decodeMatrixFromUnpackedArray=function(e,t,n){var r=o(e.length,n);if(t.length<r)throw new Error("matrix length ("+t.length+") must be >= "+r);for(var s=0,u=0;u<e.length;u+=n)t[s++]=e[u]},t.decodeMatrixFromUnpackedColorRGBAArray=function(e,t,n){var r=e.length*n/4;if(t.length<r)throw new Error("matrix length ("+t.length+") must be >= "+r);for(var o=0,s=0;s<e.length;s+=4)for(var u=0;u<n;u++)t[o++]=e[s+u]},t.getPackedMatrixTextureShapeWidthHeight=c,t.getPackedRGBAArraySizeFromMatrixShape=d,t.encodeMatrixToPackedRGBA=function(e,t,n,r){var o=d(t,n);if(r.length<o)throw new Error("packedRGBA length ("+r.length+") must be >= "+o);for(var s=c(t,n),u=s[0],l=s[1],h=n%2==1,p=t%2==1,g=Math.floor(n/2),m=Math.floor(t/2),v=h?4:0,_=n,w=0,E=0;E<m;++E){for(var O=2*E*n,S=0;S<g;++S)r[w]=e[A=O+2*S],r[w+1]=e[A+1],r[w+2]=e[A+_],r[w+3]=e[A+_+1],w+=4;w+=v}if(h){var A=n-1,T=(w=4*(u-1),2*n);for(v=4*u,E=0;E<m;++E)r[w]=e[A],r[w+2]=e[A+n],A+=T,w+=v}if(p)for(A=(t-1)*n,w=(l-1)*u*4,S=0;S<g;++S)r[w++]=e[A++],r[w++]=e[A++],w+=2;return h&&p&&(r[r.length-4]=e[e.length-1]),r},t.decodeMatrixFromPackedRGBA=function(e,t,n,r){var o=t*n;if(o<r.length)throw new Error("matrix length ("+r.length+") must be >= "+o);for(var s=n%2==1,u=t%2==1,l=Math.floor(n/2),d=Math.floor(t/2),h=c(t,n),p=h[0],g=h[1],m=s?4:0,v=n+(s?1:0),_=0,w=0,E=n,O=0;O<d;++O){for(var S=0;S<l;++S)r[w++]=e[_++],r[w++]=e[_++],r[E++]=e[_++],r[E++]=e[_++];_+=m,w+=v,E+=v}if(s){_=4*(p-1);var A=n-1;for(m=4*p,v=2*n,O=0;O<d;++O)r[A]=e[_],r[A+n]=e[_+2],_+=m,A+=v}if(u)for(_=(g-1)*p*4,A=(t-1)*n,S=0;S<l;++S)r[A++]=e[_++],r[A++]=e[_++],_+=2;return s&&u&&(r[r.length-1]=e[e.length-4]),r}},JE6x:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("v/P2"),s=n("V6aD"),u=n("m3RX"),l=n("as/7");t.MomentumOptimizer=function(e){function t(t,n,r){void 0===r&&(r=!1);var o=e.call(this,t)||this;return o.learningRate=t,o.momentum=n,o.useNesterov=r,o.m=u.scalar(o.momentum),o.accumulations={},o}return r(t,e),t.prototype.applyGradients=function(e){var t=this,n=function(n){var value=o.ENV.engine.registeredVariables[n];null==r.accumulations[n]&&s.tidy(function(){t.accumulations[n]=u.zerosLike(value).variable(!1)});var l=r.accumulations[n],c=e[n];s.tidy(function(){var e,r=t.m.mul(l).add(c);e=t.useNesterov?t.c.mul(c.add(r.mul(t.m))).add(value):t.c.mul(r).add(value),t.accumulations[n].assign(r),value.assign(e)})},r=this;for(var l in e)n(l)},t.prototype.dispose=function(){if(e.prototype.dispose.call(this),this.m.dispose(),null!=this.accumulations)for(var t in this.accumulations)this.accumulations[t].dispose()},t.prototype.setMomentum=function(e){this.momentum=e},t}(l.SGDOptimizer)},JFC7:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("Xq4m");t.defaultLegendConfig={};var s={entryPadding:1,format:1,offset:1,orient:1,padding:1,tickCount:1,title:1,type:1,values:1,zindex:1},u=r({},s,{opacity:1,shape:1,stroke:1,fill:1,size:1,encode:1});t.LEGEND_PROPERTIES=o.flagKeys(s),t.VG_LEGEND_PROPERTIES=o.flagKeys(u)},JV7f:function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});var o=n("1HS3"),s=n("v/P2");t.environment=s;var u=n("v/P2"),l=n("ZD6k");t.test_util=l;var c=n("XFvI");t.util=c;var d=n("XVV2");t.version_core=d.version;var h=n("JhAJ");t.AdadeltaOptimizer=h.AdadeltaOptimizer;var p=n("IJmD");t.AdagradOptimizer=p.AdagradOptimizer;var g=n("qVfm");t.AdamOptimizer=g.AdamOptimizer;var m=n("FhLH");t.AdamaxOptimizer=m.AdamaxOptimizer;var v=n("JE6x");t.MomentumOptimizer=v.MomentumOptimizer;var _=n("dFrR");t.Optimizer=_.Optimizer;var w=n("xJJ0");t.RMSPropOptimizer=w.RMSPropOptimizer;var E=n("as/7");t.SGDOptimizer=E.SGDOptimizer;var O=n("XPNO");t.Tensor=O.Tensor,t.TensorBuffer=O.TensorBuffer,t.variable=O.variable,t.Variable=O.Variable;var S=n("3goy");t.Rank=S.Rank;var A=n("objH");t.loadWeights=A.loadWeights,r(n("m3RX")),r(n("nHpP")),r(n("V6aD"));var T=n("v/P2");t.ENV=T.ENV,t.Environment=T.Environment,t.setBackend=u.Environment.setBackend,t.getBackend=u.Environment.getBackend,t.memory=u.Environment.memory;var N=n("w3wY");t.doc=N.doc,t.nextFrame=o.BrowserUtil.nextFrame},JdMc:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("DqkE"),u=n("35G1"),l=n("m3RX");t.NormOps=function(){function e(){}return e.norm=function(x,e,t,n){void 0===e&&(e="euclidean"),void 0===t&&(t=null),void 0===n&&(n=!1);var r=function e(x,t,n){if(void 0===n&&(n=null),0===x.rank)return x.abs();if(1!==x.rank&&null===n)return e(x.reshape([-1]),t,n);if(1===x.rank||"number"==typeof n||n instanceof Array&&1===n.length){if(1===t)return x.abs().sum(n);if(t===1/0)return x.abs().max(n);if(t===-1/0)return x.abs().min(n);if("euclidean"===t||2===t)return x.abs().pow(l.scalar(2,"int32")).sum(n).sqrt();throw new Error("Error in norm: invalid ord value: "+t)}if(n instanceof Array&&2===n.length){if(1===t)return x.abs().sum(n[0]).max(n[1]-1);if(t===1/0)return x.abs().sum(n[1]).max(n[0]);if(t===-1/0)return x.abs().sum(n[1]).min(n[0]);if("fro"===t||"euclidean"===t)return x.square().sum(n).sqrt();throw new Error("Error in norm: invalid ord value: "+t)}throw new Error("Error in norm: invalid axis: "+n)}(x,e,t),o=r.shape;if(n){var u=s.parseAxisParam(t,x.shape);o=s.expandShapeToKeepDim(r.shape,u)}return r.reshape(o)},r([o.doc({heading:"Operations",subheading:"Matrices"}),u.operation],e,"norm",null),e}()},JhAJ:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("v/P2"),s=n("V6aD"),u=n("m3RX"),l=n("dFrR");t.AdadeltaOptimizer=function(e){function t(t,n,r){void 0===r&&(r=1e-8);var o=e.call(this)||this;return o.accumulatedGrads={},o.accumulatedUpdates={},o.c=s.keep(u.scalar(-t)),o.epsilon=s.keep(u.scalar(r)),o.rho=s.keep(u.scalar(n)),o.oneMinusRho=s.keep(u.scalar(1-n)),o}return r(t,e),t.prototype.applyGradients=function(e){var t=this,n=function(n){var value=o.ENV.engine.registeredVariables[n];null==r.accumulatedGrads[n]&&s.tidy(function(){t.accumulatedGrads[n]=u.zerosLike(value).variable(!1)}),null==r.accumulatedUpdates[n]&&s.tidy(function(){t.accumulatedUpdates[n]=u.zerosLike(value).variable(!1)});var l=e[n],c=r.accumulatedGrads[n],d=r.accumulatedUpdates[n];s.tidy(function(){var e=t.rho.mul(c).add(t.oneMinusRho.mul(l.square())),r=d.add(t.epsilon).sqrt().div(c.add(t.epsilon).sqrt()).mul(l),o=t.rho.mul(d).add(t.oneMinusRho.mul(r.square()));t.accumulatedGrads[n].assign(e),t.accumulatedUpdates[n].assign(o);var s=t.c.mul(r).add(value);value.assign(s)})},r=this;for(var l in e)n(l)},t.prototype.dispose=function(){var e=this;this.c.dispose(),this.epsilon.dispose(),this.rho.dispose(),this.oneMinusRho.dispose(),null!=this.accumulatedUpdates&&(Object.keys(this.accumulatedUpdates).forEach(function(t){return e.accumulatedUpdates[t].dispose()}),Object.keys(this.accumulatedGrads).forEach(function(t){return e.accumulatedGrads[t].dispose()}))},t}(l.Optimizer)},JnFz:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function u(value){try{c(r.next(value))}catch(e){s(e)}}function l(value){try{c(r.throw(value))}catch(e){s(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,l)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var f,y,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(f)throw new TypeError("Generator is already executing.");for(;o;)try{if(f=1,y&&(n=y[2&r[0]?"return":r[0]?"throw":"next"])&&!(n=n.call(y,r[1])).done)return n;switch(y=0,n&&(r=[0,n.value]),r[0]){case 0:case 1:n=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,y=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){o.label=r[1];break}if(6===r[0]&&o.label<n[1]){o.label=n[1],n=r;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(r);break}n[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],y=0}finally{f=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=n("v/P2"),u=n("XFvI"),l=n("FfdF"),c=n("IlUm"),d=n("yltK");t.GPGPUContext=function(){function e(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.autoDebugValidate=!1,this.firstProgram=!0,this.gl=null!=e?e:l.createWebGLContext(),1===s.ENV.get("WEBGL_VERSION")?(this.textureFloatExtension=d.getExtensionOrThrow(this.gl,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float")):this.colorBufferFloatExtension=d.getExtensionOrThrow(this.gl,"EXT_color_buffer_float"),this.loseContextExtension=d.getExtensionOrThrow(this.gl,"WEBGL_lose_context"),s.ENV.get("WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED")&&(this.getBufferSubDataAsyncExtension=this.gl.getExtension("WEBGL_get_buffer_sub_data_async")),this.vertexBuffer=l.createVertexBuffer(this.gl),this.indexBuffer=l.createIndexBuffer(this.gl),this.framebuffer=d.createFramebuffer(this.gl)}return e.prototype.dispose=function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;d.callAndCheck(t,function(){return t.finish()}),d.callAndCheck(t,function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)}),d.callAndCheck(t,function(){return t.deleteFramebuffer(e.framebuffer)}),d.callAndCheck(t,function(){return t.bindBuffer(t.ARRAY_BUFFER,null)}),d.callAndCheck(t,function(){return t.deleteBuffer(e.vertexBuffer)}),d.callAndCheck(t,function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}),d.callAndCheck(t,function(){return t.deleteBuffer(e.indexBuffer)}),this.loseContextExtension.loseContext(),this.disposed=!0}},e.prototype.enableAutomaticDebugValidation=function(e){this.autoDebugValidate=e,d.enableDebugWebGLErrorChecking(e)},e.prototype.createMatrixTexture=function(e,t){return this.throwIfDisposed(),l.createMatrixTexture(this.gl,e,t)},e.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),l.uploadPixelDataToTexture(this.gl,e,t)},e.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),l.createPackedMatrixTexture(this.gl,e,t)},e.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(d.unbindColorTextureFromFramebuffer(this.gl,this.framebuffer),this.outputTexture=null),d.callAndCheck(this.gl,function(){return t.gl.deleteTexture(e)})},e.prototype.uploadMatrixToTexture=function(e,t,n,r){return this.throwIfDisposed(),l.uploadMatrixToTexture(this.gl,e,t,n,r,1)},e.prototype.uploadMatrixToPackedTexture=function(e,t,n,r){return this.throwIfDisposed(),l.uploadMatrixToPackedTexture(this.gl,e,t,n,r)},e.prototype.downloadMatrixFromTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,function(){return l.downloadMatrixFromOutputTexture(r.gl,t,n)})},e.prototype.downloadMatrixFromTextureAsync=function(e,t,n){return r(this,void 0,void 0,function(){var r=this;return o(this,function(o){if(null==this.getBufferSubDataAsyncExtension)throw new Error("Cannot download matrix from output texture asynchronously, WEBGL_get_buffer_sub_data_async is not enabled.");return[2,this.downloadMatrixDriverAsync(e,function(){return l.downloadMatrixFromOutputTextureAsync(r.gl,r.getBufferSubDataAsyncExtension,t,n)})]})})},e.prototype.downloadMatrixFromRGBAColorTexture=function(e,t,n,r){var o=this;return this.downloadMatrixDriver(e,function(){return l.downloadMatrixFromRGBAColorTexture(o.gl,t,n,r)})},e.prototype.downloadMatrixFromPackedTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,function(){return l.downloadMatrixFromPackedOutputTexture(r.gl,t,n)})},e.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,n=d.createFragmentShader(t,e),r=l.createVertexShader(t),o=d.createProgram(t);return d.callAndCheck(t,function(){return t.attachShader(o,r)}),d.callAndCheck(t,function(){return t.attachShader(o,n)}),d.linkProgram(t,o),this.autoDebugValidate&&d.validateProgram(t,o),this.firstProgram&&(this.firstProgram=!1,this.setProgram(o),l.bindVertexProgramAttributeStreams(t,this.program,this.vertexBuffer)),o},e.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&d.callAndCheck(this.gl,function(){return t.gl.deleteProgram(e)})},e.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.autoDebugValidate&&d.validateProgram(this.gl,this.program),d.callAndCheck(this.gl,function(){return t.gl.useProgram(e)})},e.prototype.getUniformLocation=function(e,t,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?d.getProgramUniformLocationOrThrow(this.gl,e,t):d.getProgramUniformLocation(this.gl,e,t)},e.prototype.getAttributeLocation=function(e,t){var n=this;return this.throwIfDisposed(),d.callAndCheck(this.gl,function(){return n.gl.getAttribLocation(e,t)})},e.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},e.prototype.setInputMatrixTexture=function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),d.bindTextureToProgramUniformSampler(this.gl,this.program,e,t,n)},e.prototype.setOutputMatrixTexture=function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)},e.prototype.setOutputPackedMatrixTexture=function(e,t,n){this.throwIfDisposed();var r=c.getPackedMatrixTextureShapeWidthHeight(t,n);this.setOutputMatrixTextureDriver(e,r[0],r[1])},e.prototype.setOutputMatrixWriteRegion=function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)},e.prototype.setOutputPackedMatrixWriteRegion=function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){null!=this.program&&d.validateProgram(this.gl,this.program),d.validateFramebuffer(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.autoDebugValidate&&this.debugValidate(),d.callAndCheck(e,function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),d.callAndCheck(this.gl,function(){return e.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=d.getExtensionOrThrow(this.gl,2===s.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.runQuery=function(e){var t=this.beginQuery();return e(),this.endQuery(),this.pollQueryTime(t)},e.prototype.beginQuery=function(){if(2===s.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),o=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,o),o},e.prototype.endQuery=function(){if(2!==s.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}},e.prototype.isQueryAvailable=function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE),s=this.gl.getParameter(r.GPU_DISJOINT_EXT);return o&&!s}return o=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT),s=this.gl.getParameter(r.GPU_DISJOINT_EXT),o&&!s},e.prototype.pollQueryTime=function(e){var t=this;return new Promise(function(n,r){var o=s.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION");u.repeatedTry(function(){return t.isQueryAvailable(e,o)}).then(function(){return n(t.getQueryTime(e,o))}).catch(function(){console.warn("Disjoint query timer never available."),n(-1)})})},e.prototype.getQueryTime=function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6},e.prototype.downloadMatrixDriverSetup=function(e){this.throwIfDisposed(),d.bindColorTextureToFramebuffer(this.gl,e,this.framebuffer),this.autoDebugValidate&&d.validateFramebuffer(this.gl)},e.prototype.downloadMatrixDriverTeardown=function(){null!=this.outputTexture?(d.bindColorTextureToFramebuffer(this.gl,this.outputTexture,this.framebuffer),this.autoDebugValidate&&d.validateFramebuffer(this.gl)):d.unbindColorTextureFromFramebuffer(this.gl,this.framebuffer)},e.prototype.downloadMatrixDriver=function(e,t){this.downloadMatrixDriverSetup(e);var n=t();return this.downloadMatrixDriverTeardown(),n},e.prototype.downloadMatrixDriverAsync=function(e,t){return r(this,void 0,void 0,function(){var n;return o(this,function(r){switch(r.label){case 0:return this.downloadMatrixDriverSetup(e),[4,t()];case 1:return n=r.sent(),this.downloadMatrixDriverTeardown(),[2,n]}})})},e.prototype.setOutputMatrixTextureDriver=function(e,t,n){this.throwIfDisposed();var r=this.gl;d.bindColorTextureToFramebuffer(r,e,this.framebuffer),this.autoDebugValidate&&d.validateFramebuffer(r),this.outputTexture=e,d.callAndCheck(r,function(){return r.viewport(0,0,t,n)}),d.callAndCheck(r,function(){return r.scissor(0,0,t,n)})},e.prototype.setOutputMatrixWriteRegionDriver=function(x,y,e,t){var n=this;this.throwIfDisposed(),d.callAndCheck(this.gl,function(){return n.gl.scissor(x,y,e,t)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},e}()},"K+ss":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MatMulProgram=function(){return function(e,t,n,r){void 0===n&&(n=!1),void 0===r&&(r=!1),this.variableNames=["matrixA","matrixB"];var o=n?e[0]:e[1];this.outputShape=[n?e[1]:e[0],r?t[0]:t[1]];var s=function(e,t){return n?t+" + "+e+", aRow":"aRow, "+t+" + "+e},u=function(e,t){return r?"bCol, "+t+" + "+e:t+" + "+e+", bCol"},l=4*Math.floor(o/4),c=o%4;this.userCode=" float dotARowBCol(int aRow, int bCol) {\n      float result = 0.0;\n      for (int i = 0; i < "+l+"; i += 4) {\n        vec4 a = vec4(\n          getMatrixA("+s(0,"i")+"),\n          getMatrixA("+s(1,"i")+"),\n          getMatrixA("+s(2,"i")+"),\n          getMatrixA("+s(3,"i")+")\n        );\n        vec4 b = vec4(\n          getMatrixB("+u(0,"i")+"),\n          getMatrixB("+u(1,"i")+"),\n          getMatrixB("+u(2,"i")+"),\n          getMatrixB("+u(3,"i")+")\n        );\n\n        result += dot(a, b);\n      }\n\n      if ("+(1===c)+") {\n        result += getMatrixA("+s(0,l)+") *\n          getMatrixB("+u(0,l)+");\n      } else if ("+(2===c)+") {\n        vec2 a = vec2(\n          getMatrixA("+s(0,l)+"),\n          getMatrixA("+s(1,l)+")\n        );\n        vec2 b = vec2(\n          getMatrixB("+u(0,l)+"),\n          getMatrixB("+u(1,l)+")\n        );\n        result += dot(a, b);\n      } else if ("+(3===c)+") {\n        vec3 a = vec3(\n          getMatrixA("+s(0,l)+"),\n          getMatrixA("+s(1,l)+"),\n          getMatrixA("+s(2,l)+")\n        );\n        vec3 b = vec3(\n          getMatrixB("+u(0,l)+"),\n          getMatrixB("+u(1,l)+"),\n          getMatrixB("+u(2,l)+")\n        );\n        result += dot(a, b);\n      }\n\n      return result;\n    }\n\n    void main() {\n      ivec2 resRC = getOutputCoords();\n      setOutput(dotARowBCol(resRC.x, resRC.y));\n    }\n    "}}()},K5jy:function(e,t,n){"use strict";var r=n("TToO").__extends,o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function u(value){try{c(r.next(value))}catch(e){s(e)}}function l(value){try{c(r.throw(value))}catch(e){s(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,l)}c((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var f,y,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(f)throw new TypeError("Generator is already executing.");for(;o;)try{if(f=1,y&&(n=y[2&r[0]?"return":r[0]?"throw":"next"])&&!(n=n.call(y,r[1])).done)return n;switch(y=0,n&&(r=[0,n.value]),r[0]){case 0:case 1:n=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,y=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){o.label=r[1];break}if(6===r[0]&&o.label<n[1]){o.label=n[1],n=r;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(r);break}n[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],y=0}finally{f=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var u=n("JV7f"),l=n("qmZh"),c=n("np2E"),d=function(){function e(){this.validationData=null,this.model=null}return e.prototype.setParams=function(e){this.params=e},e.prototype.setModel=function(e){this.model=e},e.prototype.onEpochBegin=function(e,t){return o(this,void 0,void 0,function(){return s(this,function(e){return[2]})})},e.prototype.onEpochEnd=function(e,t){return o(this,void 0,void 0,function(){return s(this,function(e){return[2]})})},e.prototype.onBatchBegin=function(e,t){return o(this,void 0,void 0,function(){return s(this,function(e){return[2]})})},e.prototype.onBatchEnd=function(e,t){return o(this,void 0,void 0,function(){return s(this,function(e){return[2]})})},e.prototype.onTrainBegin=function(e){return o(this,void 0,void 0,function(){return s(this,function(e){return[2]})})},e.prototype.onTrainEnd=function(e){return o(this,void 0,void 0,function(){return s(this,function(e){return[2]})})},e}();function h(e){return o(this,void 0,void 0,function(){var t,n,r,value,o,i;return s(this,function(s){switch(s.label){case 0:if(null==e)return[2];for(r in t=[],n=[],e)"number"!=typeof(value=e[r])&&(t.push(value.data()),n.push(r));return[4,Promise.all(t)];case 1:for(o=s.sent(),i=0;i<o.length;++i)e[n[i]]=o[i][0];return[2]}})})}t.Callback=d,t.CallbackList=function(){function e(e,t){void 0===t&&(t=10),null==e&&(e=[]),this.callbacks=e,this.queueLength=t}return e.prototype.append=function(e){this.callbacks.push(e)},e.prototype.setParams=function(e){for(var t=0,n=this.callbacks;t<n.length;t++)n[t].setParams(e)},e.prototype.setModel=function(e){for(var t=0,n=this.callbacks;t<n.length;t++)n[t].setModel(e)},e.prototype.onEpochBegin=function(e,t){return o(this,void 0,void 0,function(){var n,r;return s(this,function(o){switch(o.label){case 0:null==t&&(t={}),n=0,r=this.callbacks,o.label=1;case 1:return n<r.length?[4,r[n].onEpochBegin(e,t)]:[3,4];case 2:o.sent(),o.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e.prototype.onEpochEnd=function(e,t){return o(this,void 0,void 0,function(){var n,r;return s(this,function(o){switch(o.label){case 0:null==t&&(t={}),n=0,r=this.callbacks,o.label=1;case 1:return n<r.length?[4,r[n].onEpochEnd(e,t)]:[3,4];case 2:o.sent(),o.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e.prototype.onBatchBegin=function(e,t){return o(this,void 0,void 0,function(){var n,r;return s(this,function(o){switch(o.label){case 0:null==t&&(t={}),n=0,r=this.callbacks,o.label=1;case 1:return n<r.length?[4,r[n].onBatchBegin(e,t)]:[3,4];case 2:o.sent(),o.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e.prototype.onBatchEnd=function(e,t){return o(this,void 0,void 0,function(){var n,r;return s(this,function(o){switch(o.label){case 0:null==t&&(t={}),n=0,r=this.callbacks,o.label=1;case 1:return n<r.length?[4,r[n].onBatchEnd(e,t)]:[3,4];case 2:o.sent(),o.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e.prototype.onTrainBegin=function(e){return o(this,void 0,void 0,function(){var t,n;return s(this,function(r){switch(r.label){case 0:null==e&&(e={}),t=0,n=this.callbacks,r.label=1;case 1:return t<n.length?[4,n[t].onTrainBegin(e)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},e.prototype.onTrainEnd=function(e){return o(this,void 0,void 0,function(){var t,n;return s(this,function(r){switch(r.label){case 0:null==e&&(e={}),t=0,n=this.callbacks,r.label=1;case 1:return t<n.length?[4,n[t].onTrainEnd(e)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},e}(),t.BaseLogger=function(e){function t(){var t=e.call(this)||this;return t.scalarCache={},t}return r(t,e),t.prototype.onEpochBegin=function(e,t){return o(this,void 0,void 0,function(){return s(this,function(e){return this.seen=0,this.totals={},[2]})})},t.prototype.onBatchEnd=function(e,t){return o(this,void 0,void 0,function(){var e,n,r,o,c=this;return s(this,function(s){for(o in null==t&&(t={}),this.seen+=e=null==t.size?0:t.size,n=function(n){var value=t[n];"number"==typeof value?(r.totals.hasOwnProperty(n)||(r.totals[n]=0),r.totals[n]=r.totals[n]+value*e):(r.totals.hasOwnProperty(n)||(r.totals[n]=l.getScalar(0)),u.tidy(function(){c.totals[n]=l.scalarPlusArray(c.totals[n],l.multiply(value,l.getScalar(e))),l.keep(c.totals[n])}))},r=this,t)n(o);return[2]})})},t.prototype.onEpochEnd=function(e,t){return o(this,void 0,void 0,function(){var e,n,r,o,c=this;return s(this,function(s){if(null!=t)for(e=function(e){if(null==n.totals[e])return"continue";"number"==typeof n.totals[e]?t[e]=n.totals[e]/n.seen:u.tidy(function(){t[e]=l.scalarTimesArray(l.divide(l.getScalar(1),l.getScalar(c.seen)),c.totals[e]),l.keep(t[e])})},n=this,r=0,o=this.params.metrics;r<o.length;r++)e(o[r]);return[2]})})},t}(d),t.resolveScalarsInLogs=h,t.disposeTensorsInLogs=function(e){if(null!=e)for(var t in e){var value=e[t];"number"!=typeof value&&value.dispose()}},t.History=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.onTrainBegin=function(e){return o(this,void 0,void 0,function(){return s(this,function(e){return this.epoch=[],this.history={},[2]})})},t.prototype.onEpochEnd=function(e,t){return o(this,void 0,void 0,function(){var n;return s(this,function(r){for(n in null==t&&(t={}),this.epoch.push(e),t)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(t[n]);return[2]})})},t.prototype.syncData=function(){return o(this,void 0,void 0,function(){var e,t,n,r,o,i,u,l;return s(this,function(s){switch(s.label){case 0:for(r in e=[],t=[],n=[],this.history)for(o=this.history[r],i=0;i<o.length;++i)"number"!=typeof o[i]&&(e.push(o[i].data()),t.push(r),n.push(i));return[4,Promise.all(e)];case 1:for(u=s.sent(),l=0;l<u.length;++l)this.history[t[l]][n[l]].dispose(),this.history[t[l]][n[l]]=u[l][0];return[2]}})})},t}(d);var p=function(e){function t(t){var n=e.call(this)||this;return n.trainBegin=t.onTrainBegin,n.trainEnd=t.onTrainEnd,n.epochBegin=t.onEpochBegin,n.epochEnd=t.onEpochEnd,n.batchBegin=t.onBatchBegin,n.batchEnd=t.onBatchEnd,n}return r(t,e),t.prototype.onEpochBegin=function(e,t){return o(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return null==this.epochBegin?[3,3]:[4,h(t)];case 1:return n.sent(),[4,this.epochBegin(e,t)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.onEpochEnd=function(e,t){return o(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return null==this.epochEnd?[3,3]:[4,h(t)];case 1:return n.sent(),[4,this.epochEnd(e,t)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.onBatchBegin=function(e,t){return o(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return null==this.batchBegin?[3,3]:[4,h(t)];case 1:return n.sent(),[4,this.batchBegin(e,t)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.onBatchEnd=function(e,t){return o(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return null==this.batchEnd?[3,3]:[4,h(t)];case 1:return n.sent(),[4,this.batchEnd(e,t)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.onTrainBegin=function(e){return o(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return null==this.trainBegin?[3,3]:[4,h(e)];case 1:return t.sent(),[4,this.trainBegin(e)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},t.prototype.onTrainEnd=function(e){return o(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return null==this.trainEnd?[3,3]:[4,h(e)];case 1:return t.sent(),[4,this.trainEnd(e)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},t}(d);t.CustomCallback=p,t.standardizeCallbacks=function(e){return null==e?null:e instanceof d?[e]:Array.isArray(e)&&e[0]instanceof d?e:c.toList(e).map(function(e){return new p(e)})}},KB5b:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("JV7f"),o=n("JV7f");function s(e){return e=Array.isArray(e)?new Float32Array(e):e,o.tensor1d(e)}function sum(e){return r.sum(s(e)).dataSync()[0]}function u(e){return sum(e)/e.length}t.isInteger=function(x){return x===parseInt(x.toString(),10)},t.arrayProd=function(e,t,n){null==t&&(t=0),null==n&&(n=e.length);for(var r=1,i=t;i<n;++i)r*=e[i];return r},t.min=function(e){return r.min(s(e)).dataSync()[0]},t.max=function(e){return r.max(s(e)).dataSync()[0]},t.sum=sum,t.mean=u,t.variance=function(e){var t=r.sub(s(e),o.scalar(u(e)));return r.sum(r.mulStrict(t,t)).dataSync()[0]/e.length}},KIOn:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("xdLA"),s=n("gqjM"),u=n("rxHH"),l=n("zEzE"),c=n("Xq4m"),d=n("efV4");function h(e,t,n,o){var u=r({},t?{scale:t}:{},{field:s.vgField(e,n)});return o?r({},u,o):u}function p(e,t,n,r,p,g){if(t){if(s.isFieldDef(t)){if(t.bin)return c.contains([o.X,o.Y],e)&&t.type===l.QUANTITATIVE?p&&p.impute?h(t,n,{binSuffix:"mid"}):function(e,t){return{signal:'(scale("'+t+'", '+s.vgField(e,{expr:"datum"})+') + scale("'+t+'", '+s.vgField(e,{binSuffix:"end",expr:"datum"})+"))/2"}}(t,n):h(t,n,d.binRequiresRange(t,e)?{binSuffix:"range"}:{});if(r){var m=r.get("type");if(u.hasDiscreteDomain(m))return"band"===m?h(t,n,{binSuffix:"range"},{band:.5}):h(t,n,{binSuffix:"range"})}return h(t,n,{})}if(s.isValueDef(t))return{value:t.value}}if("zeroOrMin"===g){if(e===o.X||e===o.X2)return function(e,t){return e&&!c.contains([u.ScaleType.LOG,u.ScaleType.TIME,u.ScaleType.UTC],t.get("type"))&&!1!==t.get("zero")?{scale:e,value:0}:{value:0}}(n,r);if(e===o.Y||e===o.Y2)return function(e,t){return e&&!c.contains([u.ScaleType.LOG,u.ScaleType.TIME,u.ScaleType.UTC],t.get("type"))&&!1!==t.get("zero")?{scale:e,value:0}:{field:{group:"height"}}}(n,r);throw new Error("Unsupported channel "+e+" for base function")}if("zeroOrMax"===g){if(e===o.X||e===o.X2)return function(e,t){return e&&!c.contains([u.ScaleType.LOG,u.ScaleType.TIME,u.ScaleType.UTC],t.get("type"))&&!1!==t.get("zero")?{scale:e,value:0}:{field:{group:"width"}}}(n,r);if(e===o.Y||e===o.Y2)return function(e,t){return e&&!c.contains([u.ScaleType.LOG,u.ScaleType.TIME,u.ScaleType.UTC],t.get("type"))&&!1!==t.get("zero")?{scale:e,value:0}:{value:0}}(n,r);throw new Error("Unsupported channel "+e+" for base function")}return g}t.stackable=function(e,t,n,r,o,u){return s.isFieldDef(t)&&o&&e===o.fieldChannel?h(t,n,{suffix:"end"}):p(e,t,n,r,o,u)},t.stackable2=function(e,t,n,r,o,u,l){return s.isFieldDef(t)&&u&&e.charAt(0)===u.fieldChannel.charAt(0)?h(t,r,{suffix:"start"}):p(e,n,r,o,u,l)},t.bin=function(e,t,n,r){return h(e,t,{binSuffix:"start"===n?void 0:"end"},r?{offset:r}:{})},t.fieldRef=h,t.bandRef=function(e,t){return void 0===t&&(t=!0),{scale:e,band:t}},t.midPoint=p,t.text=function(e,t){if(e){if(s.isFieldDef(e))return d.formatSignalRef(e,e.format,"datum",t);if(s.isValueDef(e))return{value:e.value}}},t.mid=function(e){return r({},e,{mult:.5})}},KMAE:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n("Bsgt"),s=n("Xq4m"),u=o.logger(o.Warn),l=u,c=function(){function e(){this.warns=[],this.infos=[],this.debugs=[]}return e.prototype.level=function(){return this},e.prototype.warn=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this.warns).push.apply(e,t),this},e.prototype.info=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this.infos).push.apply(e,t),this},e.prototype.debug=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this.debugs).push.apply(e,t),this},e}();function d(){return l=u}t.LocalLogger=c,t.wrap=function(f){return function(){l=new c,f(l),d()}},t.set=function(e){return l=e},t.reset=d,t.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];l.warn.apply(l,arguments)},t.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];l.info.apply(l,arguments)},t.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];l.debug.apply(l,arguments)},(r=t.message||(t.message={})).INVALID_SPEC="Invalid spec",r.FIT_NON_SINGLE='Autosize "fit" only works for single views and layered views.',r.CANNOT_FIX_RANGE_STEP_WITH_FIT='Cannot use a fixed value of "rangeStep" when "autosize" is "fit".',r.cannotProjectOnChannelWithoutField=function(e){return'Cannot project a selection on encoding channel "'+e+'", which has no field.'},r.nearestNotSupportForContinuous=function(e){return'The "nearest" transform is not supported for '+e+" marks."},r.selectionNotFound=function(e){return'Cannot find a selection named "'+e+'"'},r.SCALE_BINDINGS_CONTINUOUS="Scale bindings are currently only supported for scales with unbinned, continuous domains.",r.noSuchRepeatedValue=function(e){return'Unknown repeated value "'+e+'".'},r.CONCAT_CANNOT_SHARE_AXIS="Axes cannot be shared in concatenated views.",r.REPEAT_CANNOT_SHARE_AXIS="Axes cannot be shared in repeated views.",r.cannotSetTitleAnchor=function(e){return'Cannot set title "anchor" for a '+e+" spec"},r.unrecognizedParse=function(e){return'Unrecognized parse "'+e+'".'},r.differentParse=function(e,t,n){return'An ancestor parsed field "'+e+'" as '+n+" but a child wants to parse the field as "+t+"."},r.invalidTransformIgnored=function(e){return"Ignoring an invalid transform: "+s.stringify(e)+"."},r.NO_FIELDS_NEEDS_AS='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the the data from the secondary source.',r.encodingOverridden=function(e){return"Layer's shared "+e.join(",")+" channel "+(1===e.length?"is":"are")+" overriden"},r.projectionOverridden=function(e){var t=e.projection;return"Layer's shared projection "+s.stringify(e.parentProjection)+" is overridden by a child projection "+s.stringify(t)+"."},r.primitiveChannelDef=function(e,t,value){return"Channel "+e+" is a "+t+". Converted to {value: "+s.stringify(value)+"}."},r.invalidFieldType=function(e){return'Invalid field type "'+e+'"'},r.invalidFieldTypeForCountAggregate=function(e,t){return'Invalid field type "'+e+'" for aggregate: "'+t+'", using "quantitative" instead.'},r.invalidAggregate=function(e){return'Invalid aggregation operator "'+e+'"'},r.emptyOrInvalidFieldType=function(e,t,n){return'Invalid field type "'+e+'" for channel "'+t+'", using "'+n+'" instead.'},r.emptyFieldDef=function(e,t){return"Dropping "+s.stringify(e)+' from channel "'+t+'" since it does not contain data field or value.'},r.latLongDeprecated=function(e,t,n){return e+"-encoding with type "+t+" is deprecated. Replacing with "+n+"-encoding."},r.incompatibleChannel=function(e,t,n){return e+' dropped as it is incompatible with "'+t+'"'+(n?" when "+n:"")+"."},r.invalidEncodingChannel=function(e){return e+"-encoding is dropped as "+e+" is not a valid encoding channel."},r.facetChannelShouldBeDiscrete=function(e){return e+" encoding should be discrete (ordinal / nominal / binned)."},r.discreteChannelCannotEncode=function(e,t){return'Using discrete channel "'+e+'" to encode "'+t+'" field can be misleading as it does not encode '+("ordinal"===t?"order":"magnitude")+"."},r.BAR_WITH_POINT_SCALE_AND_RANGESTEP_NULL="Bar mark should not be used with point scale when rangeStep is null. Please use band scale instead.",r.unclearOrientContinuous=function(e){return'Cannot clearly determine orientation for "'+e+'" since both x and y channel encode continuous fields. In this case, we use vertical by default'},r.unclearOrientDiscreteOrEmpty=function(e){return'Cannot clearly determine orientation for "'+e+'" since both x and y channel encode discrete or empty fields.'},r.orientOverridden=function(e,t){return'Specified orient "'+e+'" overridden with "'+t+'"'},r.CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN="custom domain scale cannot be unioned with default field-based domain",r.cannotUseScalePropertyWithNonColor=function(e){return'Cannot use the scale property "'+e+'" with non-color channel.'},r.unaggregateDomainHasNoEffectForRawField=function(e){return"Using unaggregated domain with raw field has no effect ("+s.stringify(e)+")."},r.unaggregateDomainWithNonSharedDomainOp=function(e){return'Unaggregated domain not applicable for "'+e+'" since it produces values outside the origin domain of the source data.'},r.unaggregatedDomainWithLogScale=function(e){return"Unaggregated domain is currently unsupported for log scale ("+s.stringify(e)+")."},r.cannotUseSizeFieldWithBandSize=function(e){return"Using size field when "+e+"-channel has a band scale is not supported."},r.cannotApplySizeToNonOrientedMark=function(e){return'Cannot apply size to non-oriented mark "'+e+'".'},r.rangeStepDropped=function(e){return'rangeStep for "'+e+'" is dropped as top-level '+("x"===e?"width":"height")+" is provided."},r.scaleTypeNotWorkWithChannel=function(e,t,n){return'Channel "'+e+'" does not work with "'+t+'" scale. We are using "'+n+'" scale instead.'},r.scaleTypeNotWorkWithFieldDef=function(e,t){return'FieldDef does not work with "'+e+'" scale. We are using "'+t+'" scale instead.'},r.scalePropertyNotWorkWithScaleType=function(e,t,n){return n+"-scale's \""+t+'" is dropped as it does not work with '+e+" scale."},r.scaleTypeNotWorkWithMark=function(e,t){return'Scale type "'+t+'" does not work with mark "'+e+'".'},r.mergeConflictingProperty=function(e,t,n,r){return"Conflicting "+t+' property "'+e+'" ('+s.stringify(n)+" and "+s.stringify(r)+").  Using "+s.stringify(n)+"."},r.independentScaleMeansIndependentGuide=function(e){return'Setting the scale to be independent for "'+e+'" means we also have to set the guide (axis or legend) to be independent.'},r.conflictedDomain=function(e){return"Cannot set "+e+'-scale\'s "domain" as it is binned. Please use "bin"\'s "extent" instead.'},r.domainSortDropped=function(e){return"Dropping sort property "+s.stringify(e)+" as unioned domains only support boolean or op 'count'."},r.UNABLE_TO_MERGE_DOMAINS="Unable to merge domains",r.MORE_THAN_ONE_SORT="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",r.INVALID_CHANNEL_FOR_AXIS="Invalid channel for axis.",r.cannotStackRangedMark=function(e){return'Cannot stack "'+e+'" if there is already "'+e+'2"'},r.cannotStackNonLinearScale=function(e){return"Cannot stack non-linear scale ("+e+")"},r.stackNonSummativeAggregate=function(e){return'Stacking is applied even though the aggregate function is non-summative ("'+e+'")'},r.invalidTimeUnit=function(e,value){return"Invalid "+e+": "+s.stringify(value)},r.dayReplacedWithDate=function(e){return'Time unit "'+e+'" is not supported. We are replacing it with '+e.replace("day","date")+"."},r.droppedDay=function(e){return"Dropping day from datetime "+s.stringify(e)+" as day cannot be combined with other units."}},Kb9Z:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("JV7f"),o=n("qmZh"),s=n("yJL4");t.getOptimizer=function(e){var t={Adagrad:function(){return r.train.adagrad(.01)},Adam:function(){return r.train.adam(.001,.9,.999,o.epsilon())},RMSProp:function(){return r.train.rmsprop(.001,.9,null,o.epsilon())},SGD:function(){return r.train.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adam=t.Adam,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new s.ValueError("Unknown Optimizer "+e)}},Kkag:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function u(value){try{c(r.next(value))}catch(e){s(e)}}function l(value){try{c(r.throw(value))}catch(e){s(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,l)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var f,y,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(f)throw new TypeError("Generator is already executing.");for(;o;)try{if(f=1,y&&(n=y[2&r[0]?"return":r[0]?"throw":"next"])&&!(n=n.call(y,r[1])).done)return n;switch(y=0,n&&(r=[0,n.value]),r[0]){case 0:case 1:n=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,y=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){o.label=r[1];break}if(6===r[0]&&o.label<n[1]){o.label=n[1],n=r;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(r);break}n[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],y=0}finally{f=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=n("v/P2"),u=n("V6aD"),l=n("m3RX"),c=n("5swq"),d=n("bpG5"),h=n("XPNO"),p=n("XFvI");t.Engine=function(){function e(e,t,n){this.backend=e,this.customBackend=t,this.safeMode=n,this.registeredVariables={},this.refCounter=new WeakMap,this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numDataBuffers=0,this.gradientScopeCount=0,this.customGradientDepth=0,this.activeScope={keep:[],track:[]},this.scopeStack=[this.activeScope],this.profiler=new c.Profiler(e)}return e.prototype.runKernel=function(e,t,n){var r,o=this,u=[],l=function(x){return u.push(x),x},c=this.activeScope.name;if(r=s.ENV.get("DEBUG")?this.profiler.profileKernel(c,function(){return e(o.backend,l)}):e(this.backend,l),null!=this.activeTape&&0===this.customGradientDepth){var d={id:this.nextTapeNodeId++,name:c,inputs:t,output:r};null!=n&&(d.gradient=function(e){return n(e,u)}),this.activeTape.push(d)}return r},e.prototype.registerTensor=function(a){var e=this.refCounter.has(a.dataId)?this.refCounter.get(a.dataId):0;this.numTensors++,0===e&&(this.numDataBuffers++,this.numBytes+=p.sizeFromShape(a.shape)*p.bytesPerElement(a.dtype),this.backend.register(a.dataId,a.shape,a.dtype)),this.refCounter.set(a.dataId,e+1),a instanceof h.Variable||this.track(a)},e.prototype.registerVariable=function(e){if(null!=this.registeredVariables[e.name])throw new Error("Variable with name "+e.name+" was already registered");this.registeredVariables[e.name]=e},e.prototype.disposeTensor=function(a){if(this.refCounter.has(a.dataId)){this.numTensors--;var e=this.refCounter.get(a.dataId);e<=1?(this.refCounter.delete(a.dataId),this.backend.disposeData(a.dataId),this.numDataBuffers--,this.numBytes-=p.sizeFromShape(a.shape)*p.bytesPerElement(a.dtype)):this.refCounter.set(a.dataId,e-1)}},e.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.numTensors,e.numDataBuffers=this.numDataBuffers,e.numBytes=this.numBytes,e},e.prototype.shouldRecord=function(){return null!=this.activeTape&&0===this.customGradientDepth},e.prototype.addTapeNode=function(e,t,n){var r={};e.forEach(function(e,t){r[t]=e});var o={id:this.nextTapeNodeId++,name:this.activeScope.name,inputs:r,output:t,gradient:function(e){var t={};return n(e).forEach(function(e,n){t[n]=function(){return e}}),t}};this.activeTape.push(o)},e.prototype.keep=function(e){if(1===this.scopeStack.length&&s.ENV.engine.safeMode)throw new Error("Safe mode is ON. Enclose all tensor operations inside dl.tidy(): dl.tidy(() => {...}) to avoid memory leaks.");return this.activeScope.keep.push(e),e},e.prototype.startScope=function(e,t){void 0===t&&(t=!1),t&&0===this.gradientScopeCount&&(this.activeTape=[]),t&&this.gradientScopeCount++;var n={keep:[],track:[]};e&&(n.name=e),this.scopeStack.push(n),this.activeScope=n},e.prototype.endScope=function(e,t){var n=this;void 0===t&&(t=!1),t&&(this.gradientScopeCount--,0===this.gradientScopeCount&&(this.activeTape=null));var r=this.activeScope.keep,o=p.extractTensorsFromContainer(e);r=r.concat(o);for(var i=0;i<this.activeScope.track.length;i++){var s=this.activeScope.track[i];p.isTensorInList(s,r)||(null!=this.activeTape?o.push(s):s.dispose())}this.scopeStack.pop(),this.activeScope=0===this.scopeStack.length?{keep:[],track:[]}:this.scopeStack[this.scopeStack.length-1],o.forEach(function(e){p.isTensorInList(e,n.activeScope.keep)||n.track(e)})},e.prototype.dispose=function(){this.customBackend&&this.backend.dispose()},e.prototype.gradients=function(f,e,t,n){var r=this;return void 0===n&&(n=!1),p.assert(e.length>0,"gradients() received an empty list of xs."),u.tidy("gradients",function(){var y=f();p.assert(y instanceof h.Tensor,"The result y returned by f() must be a tensor.");var o=d.getFilteredNodesXToY(r.activeTape,e,y);if(!n&&0===o.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");var s={};return s[y.id]=null==t?l.ones(y.shape):t,d.backpropagateGradients(s,o),{value:y,grads:e.map(function(x){return s[x.id]})}},!0)},e.prototype.customGrad=function(f){var e=this;return p.assert(p.isFunction(f),"The f passed in customGrad(f) must be a function."),function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];p.assert(n.every(function(e){return e instanceof h.Tensor}),"The args passed in customGrad(f)(x1, x2,...) must all be tensors"),e.customGradientDepth++;var o=u.tidy(f.name,function(){var e=f.apply(void 0,n),value=e.value,r=e.gradFunc;return p.assert(value instanceof h.Tensor,"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),p.assert(p.isFunction(r),"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),t=r,value},!0);return e.customGradientDepth--,e.shouldRecord()&&e.addTapeNode(n,o,function(e){var r=t(e),o=Array.isArray(r)?r:[r];return p.assert(o.length===n.length,"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),p.assert(o.every(function(e){return e instanceof h.Tensor}),"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."),o}),o}},e.prototype.write=function(e,t){this.backend.write(e,t)},e.prototype.readSync=function(e){return this.backend.readSync(e)},e.prototype.read=function(e){return this.backend.read(e)},e.prototype.fromPixels=function(e,t){return this.backend.fromPixels(e,t)},e.prototype.time=function(e){return r(this,void 0,void 0,function(){var t,n;return o(this,function(r){switch(r.label){case 0:return t=performance.now(),[4,this.backend.time(e)];case 1:return(n=r.sent()).wallMs=performance.now()-t,[2,n]}})})},e.prototype.track=function(e){if(1===this.scopeStack.length&&this.safeMode)throw new Error("Safe mode is ON. Enclose all tensor operations inside dl.tidy(): dl.tidy(() => {op();...}); to avoid memory leaks.");return this.activeScope.track.push(e),e},e}()},"LH1+":function(e,t,n){"use strict";var r=n("TToO").__extends,o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n("Bsgt"),u=n("dQN6"),l=n("gqjM"),c=n("KMAE"),d=n("OAHl"),h=n("0Ooj"),p=n("ODV5"),g=n("Xq4m"),m=n("OMxB"),v=n("FgHA");t.ParseNode=function(e){function t(t,n){var r=e.call(this,t)||this;return r._parse={},r._parse=n,r}return r(t,e),t.prototype.clone=function(){return new t(null,g.duplicate(this.parse))},t.make=function(e,n){var r={},o={};(n.transforms||[]).forEach(function(e){p.isCalculate(e)?o[e.as]=!0:p.isFilter(e)&&d.forEachLeave(e.filter,function(e){h.isFieldPredicate(e)&&e.timeUnit&&(r[e.field]="date")})},{}),(m.isUnitModel(n)||m.isFacetModel(n))&&n.forEachFieldDef(function(e){if(l.isTimeFieldDef(e))r[e.field]="date";else if(l.isNumberFieldDef(e)){if(o[e.field]||u.isCountingAggregateOp(e.aggregate))return;r[e.field]="number"}});var s=n.data;if(s&&s.format&&s.format.parse){var v=s.format.parse;g.keys(v).forEach(function(e){r[e]=v[e]})}var _=n.component.data.ancestorParse;return g.keys(_).forEach(function(e){r[e]!==_[e]?c.warn(c.message.differentParse(e,r[e],_[e])):delete r[e]}),0===g.keys(r).length?null:new t(e,r)},Object.defineProperty(t.prototype,"parse",{get:function(){return this._parse},enumerable:!0,configurable:!0}),t.prototype.merge=function(e){this._parse=o({},this._parse,e.parse),e.remove()},t.prototype.assembleFormatParse=function(){return this._parse},t.prototype.producedFields=function(){return s.toSet(g.keys(this.parse))},t.prototype.dependentFields=function(){return s.toSet(g.keys(this.parse))},t.prototype.assembleTransforms=function(){var e=this;return g.keys(this._parse).map(function(t){var n=function(e,t){var f="datum"+g.accessPath(e);return"number"===t?"toNumber("+f+")":"boolean"===t?"toBoolean("+f+")":"string"===t?"toString("+f+")":"date"===t?"toDate("+f+")":0===t.indexOf("date:")?"timeParse("+f+","+t.slice(5,t.length)+")":0===t.indexOf("utc:")?"utcParse("+f+","+t.slice(4,t.length)+")":(c.warn(c.message.unrecognizedParse(t)),null)}(t,e._parse[t]);return n?{type:"formula",expr:n,as:t}:null}).filter(function(e){return null!==e})},t}(v.DataFlowNode)},Ljb4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("qmZh"),o=n("yJL4");function s(e,t){return r.mean(r.square(r.subtract(t,e)),-1)}function u(e,t){return r.mean(r.abs(r.subtract(t,e)),-1)}function l(e,t){var n=r.subtract(e,t),o=r.clip(r.abs(e),r.epsilon(),Number.MAX_VALUE),s=r.abs(r.divide(n,o));return r.scalarTimesArray(r.getScalar(100),r.mean(s,-1))}function c(e,t){var n=r.getScalar(1),o=r.clip(t,r.epsilon(),Number.MAX_VALUE),s=r.log(r.scalarPlusArray(n,o)),u=r.clip(e,r.epsilon(),Number.MAX_VALUE),l=r.log(r.scalarPlusArray(n,u));return r.mean(r.square(r.subtract(s,l)),-1)}function d(e,t){var n=r.getScalar(0),o=r.getScalar(1),s=r.maximum(n,r.subtract(o,r.multiply(e,t)));return r.mean(r.square(s),-1)}function h(e,t){var n=r.getScalar(0),o=r.getScalar(1),s=r.maximum(n,r.subtract(o,r.multiply(e,t)));return r.mean(s,-1)}function p(e,t){var n=r.getScalar(0),o=r.getScalar(1),s=r.sum(r.multiply(e,t),-1),u=r.max(r.multiply(r.subtract(o,e),t),-1);return r.maximum(n,r.scalarPlusArray(o,r.subtract(u,s)))}function g(e,t){var n=r.getScalar(Math.log(2)),o=r.subtract(t,e),s=r.subtract(r.add(o,r.softplus(r.scalarTimesArray(r.getScalar(-2),o))),n);return r.mean(s,-1)}function m(e,t){return r.categoricalCrossentropy(e,t)}function v(e,t){return r.sparseCategoricalCrossentropy(e,t)}function _(e,t){return r.mean(r.binaryCrossentropy(e,t),-1)}function w(e,t){var n=r.clip(e,r.epsilon(),1),o=r.clip(t,r.epsilon(),1);return r.sum(r.multiply(e,r.log(r.divide(n,o))),-1)}function E(e,t){var n=r.log(r.scalarPlusArray(r.getScalar(r.epsilon()),t));return r.mean(r.subtract(t,r.multiply(e,n)),-1)}function O(e,t){var n=r.l2Normalize(e,-1),o=r.l2Normalize(t,-1),s=r.multiply(n,o);return r.neg(r.sum(s,-1))}t.meanSquaredError=s,t.meanAbsoluteError=u,t.meanAbsolutePercentageError=l,t.meanSquaredLogarithmicError=c,t.squaredHinge=d,t.hinge=h,t.categoricalHinge=p,t.logcosh=g,t.categoricalCrossentropy=m,t.sparseCategoricalCrossentropy=v,t.binaryCrossentropy=_,t.kullbackLeiblerDivergence=w,t.poisson=E,t.cosineProximity=O,t.mse=s,t.MSE=s,t.mae=u,t.MAE=u,t.mape=l,t.MAPE=l,t.msle=c,t.MSLE=c,t.kld=w,t.KLD=w,t.cosine=O,t.get=function(e){var t={meanSquaredError:s,meanAbsoluteError:u,meanAbsolutePercentageError:l,meanSquaredLogarithmicError:c,squaredHinge:d,hinge:h,categoricalHinge:p,logcosh:g,categoricalCrossentropy:m,sparseCategoricalCrossentropy:v,binaryCrossentropy:_,kullbackLeiblerDivergence:w,poisson:E,cosineProximity:O};if(e in t)return t[e];throw new o.ValueError("Unknown loss "+e)}},MZV5:function(e,t,n){"use strict";var r=n("TToO").__extends,o=n("TToO").__decorate,s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function u(value){try{c(r.next(value))}catch(e){s(e)}}function l(value){try{c(r.throw(value))}catch(e){s(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,l)}c((r=r.apply(e,t||[])).next())})},u=this&&this.__generator||function(e,t){var f,y,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(f)throw new TypeError("Generator is already executing.");for(;o;)try{if(f=1,y&&(n=y[2&r[0]?"return":r[0]?"throw":"next"])&&!(n=n.call(y,r[1])).done)return n;switch(y=0,n&&(r=[0,n.value]),r[0]){case 0:case 1:n=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,y=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){o.label=r[1];break}if(6===r[0]&&o.label<n[1]){o.label=n[1],n=r;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(r);break}n[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],y=0}finally{f=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var l=n("JV7f"),c=n("JV7f"),d=n("5WUj"),h=n("qmZh"),p=n("K5jy"),g=n("yJL4"),m=n("Ljb4"),v=n("EJHg"),_=n("Kb9Z"),w=n("np2E"),E=n("HS78"),O=n("DjcB");function S(x){return x instanceof c.Tensor}function A(x){return Array.isArray(x)}function T(x){return!S(x)&&!A(x)}function N(e,t,n,r,o){if(void 0===r&&(r=!0),void 0===o&&(o=""),null==t||0===t.length){if(null!=e){var s=!1;if(A(e)&&e.length>0)s=!0;else if(T(e)){for(var u in e)if(e.hasOwnProperty(u)){s=!0;break}}else s=!0;if(s)throw new g.ValueError("Error when checking model "+o+" expected no data, but got "+e)}return[]}if(null==e)return t.map(function(e){return null});var l;if(T(e)){e=e,l=[];for(var c=0,d=t;c<d.length;c++){var p=d[c];if(null==e[p])throw new g.ValueError('No data provided for "'+p+'". Need data for each key in: '+t);l.push(e[p])}}else if(A(e)){if((e=e).length!==t.length)throw new g.ValueError("Error when checking model "+o+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+t.length+" Tensor(s), but instead got the following list of Tensor(s): "+e);l=e}else{if(e=e,t.length>1)throw new g.ValueError("The model "+o+" expects "+t.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+e.shape);l=[e]}for(var i=0;i<t.length;++i)1===(m=l[i]).shape.length&&(l[i]=h.expandDims(m,1));if(null!=n)for(i=0;i<t.length;++i)if(null!=n[i]){var m;if((m=l[i]).shape.length!==n[i].length)throw new g.ValueError("Error when checking "+o+": expected "+t[i]+" to have "+n[i].length+" dimension(s). but got array with shape "+m.shape);for(var j=0;j<n[i].length;++j)if(0!==j||r){var v=n[i][j];if(null!=v&&v>=0&&m.shape[j]!==v)throw new g.ValueError("Error when checking "+o+": expected "+t[i]+" to have shape ["+n[i]+"], but got array with shape ["+m.shape+"].")}}return l}function M(e,t,weights){var n=d.unique(e.map(function(e){return e.shape[0]}));n.sort();var r=d.unique(t.map(function(e){return e.shape[0]}));if(r.sort(),n.length>1)throw new g.ValueError("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map(function(e){return e.shape})));if(r.length>1)throw new g.ValueError("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map(function(e){return e.shape})));if(n.length>0&&r.length>0&&!d.isEqual(n,r))throw new g.ValueError("Input Tensors should have the same number of samples as target Tensors. Found "+n[0]+" input sample(s) and "+r[0]+" target sample(s).")}function C(e,t){for(var n=[],r=0,o=null;r<e;)(o=r+t)>=e&&(o=e),n.push([r,o]),r=o;return n}function D(e,t,n){return null==e?[null]:Array.isArray(e)?e.map(function(e){return h.sliceAlongFirstAxis(e,t,n-t)}):h.sliceAlongFirstAxis(e,t,n-t)}function R(e,t){return null==e?null:Array.isArray(e)?e.map(function(e){return R(e,t)}):h.gather(e,t)}function I(e,t,n,r,o){var s;if(void 0===r&&(r=!0),void 0===o&&(o=""),Array.isArray(e)){if(e.length!==t.length)throw new g.ValueError("Error when checking model "+o+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+t.length+" Tensor(s), but instead got "+e.length+" Tensors(s).");s=e}else{if(t.length>1)throw new g.ValueError("The model expects "+t.length+" "+o+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(e.shape)+".");s=[e]}if(null!=n)for(var i=0;i<t.length;++i)if(null!=n[i]){var u=s[i];if(u.shape.length!==n[i].length)throw new g.ValueError("Error when checking "+o+": expected "+t[i]+" to have "+n[i].length+" dimension(s), but got array with shape "+JSON.stringify(u.shape));for(var j=0;j<n[i].length;++j)if(0!==j||r){var l=n[i][j];if(null!=l&&l!==u.shape[j])throw new g.ValueError("Error when checking "+o+": expected "+t[i]+" to have shape "+JSON.stringify(n[i])+" but got array with shape "+JSON.stringify(u.shape)+".")}}}t.isDataTensor=S,t.isDataArray=A,t.isDataDict=T,t.standardizeInputData=N,t.checkArrayLengths=M,t.makeBatches=C,t.sliceArraysByIndices=R,function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(t.ModelLoggingVerbosity||(t.ModelLoggingVerbosity={}));var P=function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.prototype.compile=function(e){var t=this;if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"==typeof e.optimizer)this.optimizer=_.getOptimizer(e.optimizer);else{if(!(e.optimizer instanceof c.Optimizer))throw new g.ValueError("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer=e.optimizer}var n=[];if(Array.isArray(e.loss)||"string"==typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new g.ValueError("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+e.loss+".");n=e.loss.map(function(e){return m.get(e)})}else{var r=m.get(e.loss);this.outputs.map(function(e){n.push(r)})}else{for(var o in e.loss=e.loss,e.loss)if(!d.contains(this.outputNames,o))throw new g.ValueError('Unknown entry in loss dictionary: "'+o+'". Only expect the following keys: '+this.outputNames);for(var s in this.outputNames)null==e.loss[s]&&console.warn('Output "'+s+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+s+" during training"),n.push(m.get(e.loss[s]))}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var i=0;i<this.outputs.length;++i){var u=this.internalOutputShapes[i];this.feedOutputNames.push(this.outputNames[i]),this.feedOutputShapes.push(u),this.feedLossFns.push(this.lossFunctions[i])}var l=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],h.nameScope("loss",function(){for(var i=0;i<t.outputs.length;++i)-1===l.indexOf(i)&&t.outputs.length>1&&(t.metricsTensors.push([t.lossFunctions[i],i]),t.metricsNames.push(t.outputNames[i]+"_loss"))});var p=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map(function(e){return[]});if(Array.isArray(e))return t.map(function(t){return e});if(null!=e){for(var n=[],r=0,o=t;r<o.length;r++){var s=o[r],u=e.hasOwnProperty(s)?e[s]:[];Array.isArray(u)||(u=[u]),n.push(u)}return n}throw new TypeError("Type of metrics argument not understood. Expected an Array or Object, found: "+e)}(e.metrics,this.outputNames);h.nameScope("metric",function(){for(var e=function(i){if(-1!==l.indexOf(i))return"continue";!function(e){for(var n,r,o,s=function(e){if(-1!==["accuracy","acc","crossentropy","ce"].indexOf(e)){var s=t.internalOutputShapes[i];1===s[s.length-1]||t.lossFunctions[i]===m.binaryCrossentropy?-1!==["accuracy","acc"].indexOf(e)?r=v.binaryAccuracy:-1!==["crossentropy","ce"].indexOf(e)&&(r=v.binaryCrossentropy):t.lossFunctions[i]===m.sparseCategoricalCrossentropy?-1!==["accuracy","acc"].indexOf(e)?r=v.sparseCategoricalAccuracy:-1!==["crossentropy","ce"].indexOf(e)&&(r=v.sparseCategoricalCrossentropy):-1!==["accuracy","acc"].indexOf(e)?r=v.categoricalAccuracy:-1!==["crossentropy","ce"].indexOf(e)&&(r=v.categoricalCrossentropy);var u=void 0;-1!==["accuracy","acc"].indexOf(e)?u="acc":-1!==["crossentropy","ce"].indexOf(e)&&(u="ce"),o=r,n=""+u}else{var l=v.get(e);o=l,n=""+e}var c;h.nameScope(n,function(){c=o}),function(e,n,r){t.outputNames.length>1&&(n=t.outputNames[e]+"_"+n),t.metricsNames.push(n),t.metricsTensors.push([r,e])}(i,n,c)},u=0,l=p[i];u<l.length;u++)s(l[u])}()},i=0;i<t.outputs.length;++i)e(i)}),this.collectedTrainableWeights=this.trainableWeights},t.prototype.checkTrainableWeightsConsistency=function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},t.prototype.evaluate=function(x,y,e){void 0===e&&(e={});var t=null==e.batchSize?32:e.batchSize,n=this.standardizeUserData(x,y,!0,t),r=n[0].concat(n[1]);this.makeTestFunction();var o=this.testLoop(this.testFunction,r,t,e.verbose,e.steps);return w.singletonOrArray(o)},t.prototype.checkNumSamples=function(e,t,n,r){var o;if(void 0===r&&(r="steps"),null!=n){if(o=null,null!=t)throw new g.ValueError("If "+r+" is set, batchSize must be null or undefined.Got batchSize = "+t)}else{if(null==e)throw new g.ValueError("Either the input data should have a defined shape, or "+r+" shoud be specified.");o=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return o},t.prototype.predictLoop=function(e,t,n){var r=this;void 0===t&&(t=32),void 0===n&&(n=!1);var o=this.checkNumSamples(e);if(n)throw new g.NotImplementedError("Verbose predictLoop() is not implemented yet.");for(var s=C(o,t),u=[],c=function(t){var n=l.tidy(function(){var n=D(e,s[t][0],s[t][1]),o=[];if(Array.isArray(n))for(var i=0;i<n.length;++i)o.push({key:r.inputs[i],value:n[i]});else o.push({key:r.inputs[0],value:n});var u=new E.FeedDict(o);return E.execute(r.outputs,u)});if(0===t)for(var o=0,c=n;o<c.length;o++)u.push(c[o]);else for(var i=0;i<n.length;++i)u[i]=h.concatAlongFirstAxis(u[i],n[i])},d=0;d<s.length;++d)c(d);return w.singletonOrArray(u)},t.prototype.predict=function(x,e){return void 0===e&&(e={}),I(x,this.inputNames,this.feedInputShapes,!1),this.predictLoop(x,null==e.batchSize?32:e.batchSize)},t.prototype.predictOnBatch=function(x){return I(x,this.inputNames,this.feedInputShapes,!0),this.predictLoop(x,x.shape[0])},t.prototype.standardizeUserData=function(x,y,e,t){if(void 0===e&&(e=!0),null==this.optimizer)throw new g.RuntimeError("You must compile a model before training/testing. Use Model.compile(modelCompileConfig).");for(var n=[],i=0;i<this.feedOutputShapes.length;++i){var r=this.feedOutputShapes[i];n.push(this.feedLossFns[i]===m.sparseCategoricalCrossentropy?r.slice(0,r.length-1).concat([1]):r)}if(M(x=N(x,this.feedInputNames,this.feedInputShapes,!1,"input"),y=N(y,this.feedOutputNames,n,!1,"target")),function(e,t,n){for(var r=[m.meanSquaredError,m.binaryCrossentropy,m.categoricalCrossentropy],i=0;i<e.length;++i){var y=e[i],o=t[i],s=n[i];if(null!=o){if(o===m.categoricalCrossentropy&&1===y.shape[y.shape.length-1])throw new g.ValueError("You are passing a target array of shape "+y.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(d.contains(r,o))for(var u=y.shape.slice(1),l=s.slice(1),j=0;j<u.length;++j){var c=l[j];if(null!=c&&u[j]!==c)throw new g.ValueError("A target Tensor with shape "+y.shape+" was passed for an output of shape "+s+", while using a loss function that expects targets to have the same shape as the output.")}}}}(y,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=t&&t>0&&x[0].shape[0]%t!=0)throw new g.ValueError("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+t+". Found: "+x[0].shape[0]+" sample(s).");return[x,y,null]},t.prototype.fitLoop=function(f,e,t,n,r,o,m,v,_,w,E,O,S,A){return void 0===O&&(O=0),s(this,void 0,void 0,function(){var s,T,N,M,D,I,P=this;return u(this,function(L){switch(L.label){case 0:if(null==n&&(n=32),null==r&&(r=100),null==w&&(w=!0),null==O&&(O=0),s=!1,null!=v&&null!=_&&(s=!0),null!=A&&(s=!0,null==S))throw new g.ValueError("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");if(null!=(T=this.checkNumSamples(e,n,S,"steps_per_epoch"))&&(N=d.range(T)),this.history=new p.History,m=(m=null==m?[new p.BaseLogger]:[new p.BaseLogger].concat(m)).concat([this.history]),o>0)throw new g.NotImplementedError("Verbose mode is not implemented yet.");return(M=new p.CallbackList(m)).setModel(this),M.setParams({epochs:r,steps:S,verbose:o,doValidation:s,metrics:E}),[4,M.onTrainBegin()];case 1:L.sent(),D=function(r){var o,m,E,O,A,D;return u(this,function(I){switch(I.label){case 0:return[4,M.onEpochBegin(r)];case 1:if(I.sent(),o={},m=N,null==S)return[3,2];throw new g.NotImplementedError("stepsPerEpoch mode is not implemented yet.");case 2:if("batch"===w)throw new g.NotImplementedError("batch shuffling is not implemneted yet");w&&(m=d.shuffle(N)),E=c.tensor1d(m),O=C(T,n),A=function(r){var c;return u(this,function(u){switch(u.label){case 0:return[4,M.onBatchBegin(r,c={})];case 1:return u.sent(),l.tidy(function(){var u=O[r][0],l=O[r][1],d=h.sliceAlongFirstAxis(E,u,l-u);c.batch=r,c.size=l-u;for(var p=R(e,d),g=f(p),i=0;i<t.length;++i)c[S=t[i]]=w=g[i],h.keep(w);if(r===O.length-1&&s){var m=P.testLoop(v,_,n);for(i=0;i<t.length;++i){var w,S=t[i];h.keep(w=m[i]),o["val_"+S]=w}}}),[4,M.onBatchEnd(r,c)];case 2:return u.sent(),p.disposeTensorsInLogs(c),[2]}})},D=0,I.label=3;case 3:return D<O.length?[5,A(D)]:[3,6];case 4:I.sent(),I.label=5;case 5:return++D,[3,3];case 6:E.dispose(),I.label=7;case 7:return[4,M.onEpochEnd(r,o)];case 8:return I.sent(),[2]}})},I=O,L.label=2;case 2:return I<r?[5,D(I)]:[3,5];case 3:L.sent(),L.label=4;case 4:return++I,[3,2];case 5:return[4,M.onTrainEnd()];case 6:return L.sent(),[4,this.history.syncData()];case 7:return L.sent(),[2,this.history]}})})},t.prototype.testLoop=function(f,e,t,n,r){void 0===n&&(n=0);var o=this.checkNumSamples(e,t,r,"steps"),s=[];if(1===n)throw new g.NotImplementedError("Verbose mode is not implemented yet.");if(null!=r)throw new g.NotImplementedError("steps mode in testLoop() is not implemented yet");for(var u=C(o,t),l=c.tensor1d(d.range(o)),p=0;p<u.length;++p){var m=u[p][0],v=u[p][1],_=f(R(e,h.sliceAlongFirstAxis(l,m,v-m)));if(0===p)for(var i=0;i<_.length;++i)s.push(h.getScalar(0));for(i=0;i<_.length;++i){var w=_[i];s[i]=h.add(s[i],h.scalarTimesArray(h.getScalar(v-m),w))}}for(i=0;i<s.length;++i)s[i]=h.divide(s[i],h.getScalar(o));return s},t.prototype.getDedupedMetricsNames=function(){for(var e=this.metricsNames,t=[],i=0;i<e.length;++i){var n=e[i],r=n;w.count(e,n)>1&&(r+="_"+w.count(e.slice(0,i),n)),t.push(r)}return t},t.prototype.makeTestFunction=function(){var e=this;this.testFunction=function(t){return l.tidy(function(){for(var n,r=[],o=t.slice(0,e.inputs.length),s=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),u=[],i=0;i<e.inputs.length;++i)u.push({key:e.inputs[i],value:o[i]});var l=new E.FeedDict(u),c=E.execute(e.outputs,l);for(i=0;i<e.lossFunctions.length;++i){var d=h.mean((0,e.lossFunctions[i])(s[i],c[i]));n=0===i?d:h.add(n,d),r.push(n)}for(i=0;i<e.metricsTensors.length;++i){var p=e.metricsTensors[i][1],g=h.mean((0,e.metricsTensors[i][0])(s[p],c[p]));r.push(g)}return r})}},t.prototype.fit=function(x,y,e){return void 0===e&&(e={}),s(this,void 0,void 0,function(){var t,n,r,o,s,l,c,d,m,v,_,w,O,S,A,T,N,M=this;return u(this,function(u){if(n=this.standardizeUserData(x,y,!1,t=null==e.batchSize?32:e.batchSize),r=n[0],o=n[1],s=!1,null!=e.validationData&&e.validationData.length>0){if(s=!0,2!==e.validationData.length)throw 3===e.validationData.length?new g.NotImplementedError("validationData including sample weights is not supported yet."):new g.ValueError("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items, however it contains "+e.validationData.length+" items");m=this.standardizeUserData(l=e.validationData[0],c=e.validationData[1],!0,t),d=(l=m[0]).concat(c=m[1])}else null!=e.validationSplit&&e.validationSplit>0&&e.validationSplit<1?(s=!0,v=Math.floor(r[0].shape[0]*(1-e.validationSplit)),l=D(r,v,_=r[0].shape[0]),r=D(r,0,v),c=D(o,v,_),o=D(o,0,v),d=l.concat(c)):null!=e.validationSteps&&(s=!0);return w=r.concat(o),this.checkTrainableWeightsConsistency(),O=function(e){var t=[],n=[],r=e.slice(0,M.inputs.length),o=e.slice(M.inputs.length,M.inputs.length+M.outputs.length),s=[],u=M.collectedTrainableWeights.map(function(e){return e.read()});return[M.optimizer.minimize(function(){for(var e=[],i=0;i<M.inputs.length;++i)e.push({key:M.inputs[i],value:r[i]});var u,l=new E.FeedDict(e),c=E.execute(M.outputs,l,{training:!0});for(i=0;i<M.lossFunctions.length;++i){var d=(0,M.lossFunctions[i])(o[i],c[i]);t.push(d);var p=h.mean(d);n.push(p),u=0===i?d:h.add(u,d)}for(i=0;i<M.metricsTensors.length;++i){var g=M.metricsTensors[i][1],m=h.mean((0,M.metricsTensors[i][0])(o[g],c[g]));h.keep(m),s.push(m)}return u=h.mean(u),M.calculateLosses().forEach(function(e){u=h.add(u,e)}),u},!0,u)].concat(s)},S=this.getDedupedMetricsNames(),s?(this.makeTestFunction(),A=this.testFunction,T=S.slice().concat(S.map(function(e){return"val_"+e}))):(A=null,d=[],T=S.slice()),N=p.standardizeCallbacks(e.callbacks),[2,this.fitLoop(O,w,S,t,e.epochs,e.verbose,N,A,d,e.shuffle,T,null,null,null)]})})},o([c.doc({heading:"Models",subheading:"Classes",configParamIndices:[0]})],t.prototype,"compile",null),o([c.doc({heading:"Models",subheading:"Classes",configParamIndices:[2]})],t.prototype,"evaluate",null),o([c.doc({heading:"Models",subheading:"Classes",configParamIndices:[1]})],t.prototype,"predict",null),o([c.doc({heading:"Models",subheading:"Classes"})],t.prototype,"predictOnBatch",null),o([c.doc({heading:"Models",subheading:"Classes",configParamIndices:[2]})],t.prototype,"fit",null),o([c.doc({heading:"Models",subheading:"Classes"})],t)}(O.Container);t.Model=P,w.ClassNameMap.register("Model",P)},MxPC:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("Xq4m"),s=n("FgHA");t.CalculateNode=function(e){function t(t,n){var r=e.call(this,t)||this;return r.transform=n,r}return r(t,e),t.prototype.clone=function(){return new t(null,o.duplicate(this.transform))},t.prototype.producedFields=function(){var e={};return e[this.transform.as]=!0,e},t.prototype.assemble=function(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}},t}(s.DataFlowNode)},NDl6:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Bsgt"),o=n("xdLA"),s=n("Xq4m");t.binToString=function(e){return r.isBoolean(e)?"bin":"bin"+s.keys(e).map(function(t){return s.varName("_"+t+"_"+e[t])}).join("")},t.autoMaxBins=function(e){switch(e){case o.ROW:case o.COLUMN:case o.SIZE:case o.COLOR:case o.FILL:case o.STROKE:case o.OPACITY:case o.SHAPE:return 6;default:return 10}}},NKzF:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PROJECTION_PROPERTIES=["type","clipAngle","clipExtent","center","rotate","precision","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"]},OAHl:function(e,t,n){"use strict";function r(e){return!!e.or}function o(e){return!!e.and}function s(e){return!!e.not}Object.defineProperty(t,"__esModule",{value:!0}),t.isLogicalOr=r,t.isLogicalAnd=o,t.isLogicalNot=s,t.forEachLeave=function e(t,n){if(s(t))e(t.not,n);else if(o(t))for(var u=0,l=t.and;u<l.length;u++)e(l[u],n);else if(r(t))for(var c=0,d=t.or;c<d.length;c++)e(d[c],n);else n(t)},t.normalizeLogicalOperand=function e(t,n){return s(t)?{not:e(t.not,n)}:o(t)?{and:t.and.map(function(t){return e(t,n)})}:r(t)?{or:t.or.map(function(t){return e(t,n)})}:n(t)}},ODV5:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("OAHl"),o=n("0Ooj");function s(e){return void 0!==e.filter}t.isFilter=s,t.isLookup=function(e){return void 0!==e.lookup},t.isCalculate=function(e){return void 0!==e.calculate},t.isBin=function(e){return!!e.bin},t.isTimeUnit=function(e){return void 0!==e.timeUnit},t.isAggregate=function(e){return void 0!==e.aggregate},t.normalizeTransform=function(e){return e.map(function(e){return s(e)?{filter:r.normalizeLogicalOperand(e.filter,o.normalizePredicate)}:e})}},OMJi:function(e,t,n){(function(e,r){var o=/%[sdj%]/g;t.format=function(f){if(!E(f)){for(var e=[],i=0;i<arguments.length;i++)e.push(l(arguments[i]));return e.join(" ")}i=1;for(var t=arguments,n=t.length,r=String(f).replace(o,function(x){if("%%"===x)return"%";if(i>=n)return x;switch(x){case"%s":return String(t[i++]);case"%d":return Number(t[i++]);case"%j":try{return JSON.stringify(t[i++])}catch(e){return"[Circular]"}default:return x}}),x=t[i];i<n;x=t[++i])_(x)||!A(x)?r+=" "+x:r+=" "+l(x);return r},t.deprecate=function(n,o){if(O(e.process))return function(){return t.deprecate(n,o).apply(this,arguments)};if(!0===r.noDeprecation)return n;var s=!1;return function(){if(!s){if(r.throwDeprecation)throw new Error(o);r.traceDeprecation?console.trace(o):console.error(o),s=!0}return n.apply(this,arguments)}};var s,u={};function l(e,n){var r={seen:[],stylize:d};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),v(n)?r.showHidden=n:n&&t._extend(r,n),O(r.showHidden)&&(r.showHidden=!1),O(r.depth)&&(r.depth=2),O(r.colors)&&(r.colors=!1),O(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),h(r,e,r.depth)}function c(e,t){var n=l.styles[t];return n?"\x1b["+l.colors[n][0]+"m"+e+"\x1b["+l.colors[n][1]+"m":e}function d(e,t){return e}function h(e,value,n){if(e.customInspect&&value&&M(value.inspect)&&value.inspect!==t.inspect&&(!value.constructor||value.constructor.prototype!==value)){var r=value.inspect(n,e);return E(r)||(r=h(e,r,n)),r}var o=function(e,value){if(O(value))return e.stylize("undefined","undefined");if(E(value)){var t="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(t,"string")}return w(value)?e.stylize(""+value,"number"):v(value)?e.stylize(""+value,"boolean"):_(value)?e.stylize("null","null"):void 0}(e,value);if(o)return o;var s,u=Object.keys(value),l=(s={},u.forEach(function(e,t){s[e]=!0}),s);if(e.showHidden&&(u=Object.getOwnPropertyNames(value)),N(value)&&(u.indexOf("message")>=0||u.indexOf("description")>=0))return p(value);if(0===u.length){if(M(value))return e.stylize("[Function"+(value.name?": "+value.name:"")+"]","special");if(S(value))return e.stylize(RegExp.prototype.toString.call(value),"regexp");if(T(value))return e.stylize(Date.prototype.toString.call(value),"date");if(N(value))return p(value)}var c,d="",A=!1,C=["{","}"];return m(value)&&(A=!0,C=["[","]"]),M(value)&&(d=" [Function"+(value.name?": "+value.name:"")+"]"),S(value)&&(d=" "+RegExp.prototype.toString.call(value)),T(value)&&(d=" "+Date.prototype.toUTCString.call(value)),N(value)&&(d=" "+p(value)),0!==u.length||A&&0!=value.length?n<0?S(value)?e.stylize(RegExp.prototype.toString.call(value),"regexp"):e.stylize("[Object]","special"):(e.seen.push(value),c=A?function(e,value,t,n,r){for(var o=[],i=0,s=value.length;i<s;++i)I(value,String(i))?o.push(g(e,value,t,n,String(i),!0)):o.push("");return r.forEach(function(r){r.match(/^\d+$/)||o.push(g(e,value,t,n,r,!0))}),o}(e,value,n,l,u):u.map(function(t){return g(e,value,n,l,t,A)}),e.seen.pop(),function(e,t,n){return e.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(c,d,C)):C[0]+d+C[1]}function p(value){return"["+Error.prototype.toString.call(value)+"]"}function g(e,value,t,n,r,o){var s,u,l;if((l=Object.getOwnPropertyDescriptor(value,r)||{value:value[r]}).get?u=e.stylize(l.set?"[Getter/Setter]":"[Getter]","special"):l.set&&(u=e.stylize("[Setter]","special")),I(n,r)||(s="["+r+"]"),u||(e.seen.indexOf(l.value)<0?(u=_(t)?h(e,l.value,null):h(e,l.value,t-1)).indexOf("\n")>-1&&(u=o?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n")):u=e.stylize("[Circular]","special")),O(s)){if(o&&r.match(/^\d+$/))return u;(s=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+u}function m(e){return Array.isArray(e)}function v(e){return"boolean"==typeof e}function _(e){return null===e}function w(e){return"number"==typeof e}function E(e){return"string"==typeof e}function O(e){return void 0===e}function S(e){return A(e)&&"[object RegExp]"===C(e)}function A(e){return"object"==typeof e&&null!==e}function T(e){return A(e)&&"[object Date]"===C(e)}function N(e){return A(e)&&("[object Error]"===C(e)||e instanceof Error)}function M(e){return"function"==typeof e}function C(e){return Object.prototype.toString.call(e)}function D(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(O(s)&&(s=r.env.NODE_DEBUG||""),e=e.toUpperCase(),!u[e])if(new RegExp("\\b"+e+"\\b","i").test(s)){var n=r.pid;u[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else u[e]=function(){};return u[e]},t.inspect=l,l.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=m,t.isBoolean=v,t.isNull=_,t.isNullOrUndefined=function(e){return null==e},t.isNumber=w,t.isString=E,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=O,t.isRegExp=S,t.isObject=A,t.isDate=T,t.isError=N,t.isFunction=M,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e},t.isBuffer=n("fC4T");var R=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function I(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){var e,n;console.log("%s - %s",(n=[D((e=new Date).getHours()),D(e.getMinutes()),D(e.getSeconds())].join(":"),[e.getDate(),R[e.getMonth()],n].join(" ")),t.format.apply(t,arguments))},t.inherits=n("ONRY"),t._extend=function(e,t){if(!t||!A(t))return e;for(var n=Object.keys(t),i=n.length;i--;)e[n[i]]=t[n[i]];return e}}).call(t,n("DuR2"),n("W2nU"))},OMxB:function(e,t,n){"use strict";var r=n("TToO").__extends,o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n("Bsgt"),u=n("xdLA"),l=n("utsZ"),c=n("gqjM"),d=n("KMAE"),h=n("rxHH"),p=n("ooBR"),g=n("0LBb"),m=n("ODV5"),v=n("Xq4m"),_=n("0N5v"),w=n("ivZP"),E=n("36K7"),O=n("9d0T"),S=n("3kMs"),A=n("qZoT"),T=n("Gi67"),N=n("YC5c"),M=n("xoEB"),C=n("GH2X"),D=n("tDz0"),R=n("aIXu"),I=function(){function e(){this.nameMap={}}return e.prototype.rename=function(e,t){this.nameMap[e]=t},e.prototype.has=function(e){return void 0!==this.nameMap[e]},e.prototype.get=function(e){for(;this.nameMap[e]&&e!==this.nameMap[e];)e=this.nameMap[e];return e},e}();function P(e){return e&&"unit"===e.type}function L(e){return e&&"facet"===e.type}t.NameMap=I,t.isUnitModel=P,t.isFacetModel=L,t.isRepeatModel=function(e){return e&&"repeat"===e.type},t.isConcatModel=function(e){return e&&"concat"===e.type},t.isLayerModel=function(e){return e&&"layer"===e.type};var z=function(){function e(e,t,n,r,u){var l=this;this.children=[],this.correctDataNames=function(e){return e.from&&e.from.data&&(e.from.data=l.lookupDataSource(e.from.data)),e.from&&e.from.facet&&e.from.facet.data&&(e.from.facet.data=l.lookupDataSource(e.from.facet.data)),e},this.parent=t,this.config=r,this.name=e.name||n,this.title=s.isString(e.title)?{text:e.title}:e.title,this.scaleNameMap=t?t.scaleNameMap:new I,this.projectionNameMap=t?t.projectionNameMap:new I,this.layoutSizeNameMap=t?t.layoutSizeNameMap:new I,this.data=e.data,this.description=e.description,this.transforms=m.normalizeTransform(e.transform||[]),this.component={data:{sources:t?t.component.data.sources:{},outputNodes:t?t.component.data.outputNodes:{},outputNodeRefCounts:t?t.component.data.outputNodeRefCounts:{},ancestorParse:t?o({},t.component.data.ancestorParse):{},isFaceted:p.isFacetSpec(e)||t&&t.component.data.isFaceted&&!e.data},layoutSize:new R.Split,layoutHeaders:{row:{},column:{}},mark:null,resolve:o({scale:{},axis:{},legend:{}},u||{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}return Object.defineProperty(e.prototype,"width",{get:function(){return this.getSizeSignalRef("width")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.getSizeSignalRef("height")},enumerable:!0,configurable:!0}),e.prototype.initSize=function(e){var t=e.width,n=e.height;t&&this.component.layoutSize.set("width",t,!0),n&&this.component.layoutSize.set("height",n,!0)},e.prototype.parse=function(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSize(),this.parseSelection(),this.parseProjection(),this.parseData(),this.parseAxisAndHeader(),this.parseLegend(),this.parseMarkGroup()},e.prototype.parseScale=function(){D.parseScale(this)},e.prototype.parseProjection=function(){N.parseProjection(this)},e.prototype.renameTopLevelLayoutSize=function(){"width"!==this.getName("width")&&this.renameLayoutSize(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameLayoutSize(this.getName("height"),"height")},e.prototype.parseLegend=function(){A.parseLegend(this)},e.prototype.assembleGroupStyle=function(){if("unit"===this.type||"layer"===this.type)return"cell"},e.prototype.assembleLayoutSize=function(){if("unit"===this.type||"layer"===this.type)return{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")}},e.prototype.assembleHeaderMarks=function(){for(var e=this.component.layoutHeaders,t=[],n=0,r=E.HEADER_CHANNELS;n<r.length;n++)e[u=r[n]].title&&t.push(E.getTitleGroup(this,u));for(var o=0,s=E.HEADER_CHANNELS;o<s.length;o++){var u;t=t.concat(E.getHeaderGroups(this,u=s[o]))}return t},e.prototype.assembleAxes=function(){return w.assembleAxes(this.component.axes,this.config)},e.prototype.assembleLegends=function(){return S.assembleLegends(this)},e.prototype.assembleProjections=function(){return T.assembleProjections(this)},e.prototype.assembleTitle=function(){var e=o({},g.extractTitleConfig(this.config.title).nonMark,this.title);if(e.text)return v.contains(["unit","layer"],this.type)||(e.anchor&&"start"!==e.anchor&&d.warn(d.message.cannotSetTitleAnchor(this.type)),e.anchor="start"),v.keys(e).length>0?e:void 0},e.prototype.assembleGroup=function(e){void 0===e&&(e=[]);var t={};(e=e.concat(this.assembleSelectionSignals())).length>0&&(t.signals=e);var n=this.assembleLayout();n&&(t.layout=n),t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());var r=!this.parent||L(this.parent)?M.assembleScales(this):[];r.length>0&&(t.scales=r);var o=this.assembleAxes();o.length>0&&(t.axes=o);var s=this.assembleLegends();return s.length>0&&(t.legends=s),t},e.prototype.hasDescendantWithFieldOnChannel=function(e){for(var t=0,n=this.children;t<n.length;t++){var r=n[t];if(P(r)){if(r.channelHasField(e))return!0}else if(r.hasDescendantWithFieldOnChannel(e))return!0}return!1},e.prototype.getName=function(e){return v.varName((this.name?this.name+"_":"")+e)},e.prototype.requestDataName=function(e){var t=this.getName(e),n=this.component.data.outputNodeRefCounts;return n[t]=(n[t]||0)+1,t},e.prototype.getSizeSignalRef=function(e){if(L(this.parent)){var t="width"===e?"x":"y",n=this.component.scales[t];if(n&&!n.merged){var r=n.get("type"),o=n.get("range");if(h.hasDiscreteDomain(r)&&_.isVgRangeStep(o)){var s=n.get("name"),u=C.assembleDomain(this,t),l=C.getFieldFromDomain(u);if(l){var p=c.vgField({aggregate:"distinct",field:l},{expr:"datum"});return{signal:O.sizeExpr(s,n,p)}}return d.warn("Unknown field for ${channel}.  Cannot calculate view size."),null}}}return{signal:this.layoutSizeNameMap.get(this.getName(e))}},e.prototype.lookupDataSource=function(e){var t=this.component.data.outputNodes[e];return t?t.getSource():e},e.prototype.getSizeName=function(e){return this.layoutSizeNameMap.get(e)},e.prototype.renameLayoutSize=function(e,t){this.layoutSizeNameMap.rename(e,t)},e.prototype.renameScale=function(e,t){this.scaleNameMap.rename(e,t)},e.prototype.renameProjection=function(e,t){this.projectionNameMap.rename(e,t)},e.prototype.scaleName=function(e,t){return t?this.getName(e):u.isChannel(e)&&u.isScaleChannel(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))?this.scaleNameMap.get(this.getName(e)):void 0},e.prototype.projectionName=function(e){return e?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0},e.prototype.getScaleComponent=function(e){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale().  Make sure you have called parseScale or use parseUnitModelWithScale().");var t=this.component.scales[e];return t&&!t.merged?t:this.parent?this.parent.getScaleComponent(e):void 0},e.prototype.getSelectionComponent=function(e,t){var n=this.component.selection[e];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(e,t)),!n)throw new Error(d.message.selectionNotFound(t));return n},e}();t.Model=z,t.ModelWithField=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.vgField=function(e,t){void 0===t&&(t={});var n=this.fieldDef(e);if(n)return c.vgField(n,t)},t.prototype.reduceFieldDef=function(f,e,t){return l.reduce(this.getMapping(),function(e,t,n){var r=c.getFieldDef(t);return r?f(e,r,n):e},e,t)},t.prototype.forEachFieldDef=function(f,e){l.forEach(this.getMapping(),function(e,t){var n=c.getFieldDef(e);n&&f(n,t)},e)},t}(z)},ONRY:function(e,t){e.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},OZKY:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Bsgt"),o=n("Xq4m"),s=n("kglw"),u=n("6SkM");t.default={has:function(e){return"single"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind},topLevelSignals:function(e,t,n){var r=t.name,s=t.project,l=t.bind,c=u.default.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return s.forEach(function(e){var s=o.varName(r+"_"+e.field);n.filter(function(e){return e.name===s}).length||n.unshift({name:s,value:"",on:[{events:t.events,update:"datum && item().mark.marktype !== 'group' ? "+c+o.accessPath(e.field)+" : null"}],bind:l[e.field]||l[e.channel]||l})}),n},signals:function(e,t,n){var u=t.name,l=t.project,c=n.filter(function(e){return e.name===u+s.TUPLE})[0],d=l.map(function(e){return r.stringValue(e.field)}).join(", "),h=l.map(function(e){return o.varName(u+"_"+e.field)});return c.update=h.join(" && ")+" ? {fields: ["+d+"], values: ["+h.join(", ")+"]} : null",delete c.value,delete c.on,n}}},OiDY:function(e,t,n){"use strict";var r=n("TToO").__extends,o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n("xdLA"),u=n("zEzE"),l=n("Xq4m"),c=n("FgHA");t.GeoJSONNode=function(e){function t(t,n,r,o){var s=e.call(this,t)||this;return s.fields=n,s.geojson=r,s.signal=o,s}return r(t,e),t.prototype.clone=function(){return new t(null,l.duplicate(this.fields),this.geojson,this.signal)},t.parseAll=function(e,n){var r=0;if([[s.LONGITUDE,s.LATITUDE],[s.LONGITUDE2,s.LATITUDE2]].forEach(function(o){var s=o.map(function(e){return n.channelHasField(e)?n.fieldDef(e).field:void 0});(s[0]||s[1])&&(e=new t(e,s,null,n.getName("geojson_"+r++)))}),n.channelHasField(s.SHAPE)){var o=n.fieldDef(s.SHAPE);o.type===u.GEOJSON&&(e=new t(e,null,o.field,n.getName("geojson_"+r++)))}return e},t.prototype.assemble=function(){return o({type:"geojson"},this.fields?{fields:this.fields}:{},this.geojson?{geojson:this.geojson}:{},{signal:this.signal})},t}(c.DataFlowNode)},"P+57":function(e,t,n){"use strict";var r=n("TToO").__extends,o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n("Xq4m"),u=n("4TaE"),l=n("9d0T"),c=n("OMxB");t.BaseConcatModel=function(e){function t(t,n,r,o,s){return e.call(this,t,n,r,o,s)||this}return r(t,e),t.prototype.parseData=function(){this.component.data=u.parseData(this),this.children.forEach(function(e){e.parseData()})},t.prototype.parseSelection=function(){var e=this;this.component.selection={};for(var t=function(t){t.parseSelection(),s.keys(t.component.selection).forEach(function(n){e.component.selection[n]=t.component.selection[n]})},n=0,r=this.children;n<r.length;n++)t(r[n])},t.prototype.parseMarkGroup=function(){for(var e=0,t=this.children;e<t.length;e++)t[e].parseMarkGroup()},t.prototype.parseAxisAndHeader=function(){for(var e=0,t=this.children;e<t.length;e++)t[e].parseAxisAndHeader()},t.prototype.assembleSelectionTopLevelSignals=function(e){return this.children.reduce(function(e,t){return t.assembleSelectionTopLevelSignals(e)},e)},t.prototype.assembleSelectionSignals=function(){return this.children.forEach(function(e){return e.assembleSelectionSignals()}),[]},t.prototype.assembleLayoutSignals=function(){return this.children.reduce(function(e,t){return e.concat(t.assembleLayoutSignals())},l.assembleLayoutSignals(this))},t.prototype.assembleSelectionData=function(e){return this.children.reduce(function(e,t){return t.assembleSelectionData(e)},e)},t.prototype.assembleMarks=function(){return this.children.map(function(e){var t=e.assembleTitle(),n=e.assembleGroupStyle(),r=e.assembleLayoutSize();return o({type:"group",name:e.getName("group")},t?{title:t}:{},n?{style:n}:{},r?{encode:{update:r}}:{},e.assembleGroup())})},t}(c.Model)},Q1Fz:function(e,t,n){"use strict";var r=n("TToO").__extends,o=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var s=n("JV7f"),u=n("qmZh"),l=n("np2E"),c=function(){};t.Regularizer=c;var d=function(e){function t(t){var n=e.call(this)||this,r=null==t||null==t.l1?.01:t.l1,o=null==t||null==t.l2?.01:t.l2;return n.hasL1=0!==r,n.hasL2=0!==o,n.l1=u.getScalar(r),n.l2=u.getScalar(o),n}return r(t,e),n=t,t.prototype.apply=function(x){var e=s.zeros([1]);return this.hasL1&&(e=u.add(e,u.sum(u.scalarTimesArray(this.l1,u.abs(x))))),this.hasL2&&(e=u.add(e,u.sum(u.scalarTimesArray(this.l2,u.square(x))))),e.asScalar()},t.prototype.getConfig=function(){return{l1:this.l1.dataSync()[0],l2:this.l2.dataSync()[0]}},t.fromConfig=function(e,t){return new n({l1:t.l1,l2:t.l2})},n=o([s.doc({heading:"Regularizers",namespace:"regularizers"})],t);var n}(c);function h(e,t){return void 0===t&&(t={}),l.deserializeKerasObject(e,l.ClassNameMap.getMap().pythonClassNameMap,t,"regularizer")}t.L1L2=d,l.ClassNameMap.register("L1L2",d),t.l1=function(e){return new d({l1:null!=e?e.l1:null,l2:0})},t.l2=function(e){return new d({l2:null!=e?e.l2:null,l1:0})},t.REGULARIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP={l1l2:"L1L2"},t.serializeRegularizer=function(e){return l.serializeKerasObject(e)},t.deserializeRegularizer=h,t.getRegularizer=function(e){return null==e?null:"string"==typeof e?h({className:e in t.REGULARIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP?t.REGULARIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP[e]:e,config:{}}):e instanceof c?e:h(e)}},Q2Ef:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("0Ooj"),s=n("Xq4m"),u=n("FgHA");t.FilterNode=function(e){function t(t,n,r){var s=e.call(this,t)||this;return s.model=n,s.filter=r,s.expr=o.expression(s.model,s.filter,s),s}return r(t,e),t.prototype.clone=function(){return new t(null,this.model,s.duplicate(this.filter))},t.prototype.assemble=function(){return{type:"filter",expr:this.expr}},t}(u.DataFlowNode)},Q3Cc:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("doZ3");t.UnaryOpProgram=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      float unaryOperation(float x) {\n        "+t+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "};var o="\n  if (isNaN(x)) return x;\n";t.ABS="\n  return abs(x);\n",t.RELU=o+"\n  return (x < 0.0) ? 0.0 : x;\n",t.ELU="\n  return (x >= 0.0) ? x : (exp(x) - 1.0);\n",t.ELU_DER="\n  return (x >= 0.0) ? 1.0 : exp(x);\n",t.SELU="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = "+r.SELU_SCALEALPHA+";\n  float scale = "+r.SELU_SCALE+";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n",t.LEAKY_RELU=function(e){return"\n    return (x >= 0.0) ? x : "+e+" * x;\n  "},t.STEP=function(e){return void 0===e&&(e=0),o+"\n    return x > 0.0 ? 1.0 : float("+e+");\n  "},t.NEG="\n  return -x;\n",t.CEIL="\n  return ceil(x);\n",t.FLOOR="\n  return floor(x);\n",t.EXP="\n  return exp(x);\n",t.EXPM1="\n  return exp(x) - 1.0;\n",t.LOG="\n  return log(x);\n",t.LOG1P="\n  return log(1.0 + x);\n",t.SQRT=o+"\n  return sqrt(x);\n",t.SIGMOID="\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",t.SIN=o+"\n  return sin(x);\n",t.COS=o+"\n  return cos(x);\n",t.TAN="\n  return tan(x);\n",t.ASIN=o+"\n  return asin(x);\n",t.ACOS=o+"\n  return acos(x);\n",t.ATAN=o+"\n  return atan(x);\n",t.SINH="\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n",t.COSH="\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n",t.TANH="\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n",t.SQUARE="\n  return x * x;\n",t.LOGICAL_NOT=o+"\n  return float(!(x >= 1.0));\n",t.TO_INT="\n  return float(int(x));\n"},QCnU:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("XSKZ"),o=n("Bsgt"),s=n("xdLA"),u=n("3A6A"),l=n("kglw"),c=n("x8nG"),d="_zoom_anchor",h="_zoom_delta";function p(e,t,n,r,o){var s=t.name,u=c.default.has(t),p=o.filter(function(e){return e.name===l.channelSignalName(t,n,u?"data":"visual")})[0],g=e.getSizeSignalRef(r).signal,m=e.getScaleComponent(n),v=m.get("type"),_=u?c.domain(e,n):p.name,w=s+h,E=(u?"log"===v?"zoomLog":"pow"===v?"zoomPow":"zoomLinear":"zoomLinear")+"("+_+", "+s+d+"."+n+", "+w+(u&&"pow"===v?", "+(m.get("exponent")||1):"")+")";p.on.push({events:{signal:w},update:u?E:"clampRange("+E+", 0, "+g+")"})}t.default={has:function(e){return"interval"===e.type&&e.zoom},signals:function(e,t,n){var g=t.name,m=c.default.has(t),v=g+h,_=l.positionalProjections(t),x=_.x,y=_.y,w=o.stringValue(e.scaleName(s.X)),E=o.stringValue(e.scaleName(s.Y)),O=r.selector(t.zoom,"scope");return m||(O=O.map(function(e){return e.markname=g+u.BRUSH,e})),n.push({name:g+d,on:[{events:O,update:m?"{"+[w?"x: invert("+w+", x(unit))":"",E?"y: invert("+E+", y(unit))":""].filter(function(e){return!!e}).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:v,on:[{events:O,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),null!==x&&p(e,t,"x","width",n),null!==y&&p(e,t,"y","height",n),n}}},QbRd:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("xdLA"),s=n("Xq4m"),u=n("FgHA");t.GeoPointNode=function(e){function t(t,n,r,o){var s=e.call(this,t)||this;return s.projection=n,s.fields=r,s.as=o,s}return r(t,e),t.prototype.clone=function(){return new t(null,this.projection,s.duplicate(this.fields),s.duplicate(this.as))},t.parseAll=function(e,n){return n.projectionName()?([[o.LONGITUDE,o.LATITUDE],[o.LONGITUDE2,o.LATITUDE2]].forEach(function(r){var s=r.map(function(e){return n.channelHasField(e)?n.fieldDef(e).field:void 0}),u=r[0]===o.LONGITUDE2?"2":"";(s[0]||s[1])&&(e=new t(e,n.projectionName(),s,[n.getName("x"+u),n.getName("y"+u)]))}),e):e},t.prototype.assemble=function(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}},t}(u.DataFlowNode)},QhdG:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("JhAJ"),u=n("IJmD"),l=n("qVfm"),c=n("FhLH"),d=n("JE6x"),h=n("xJJ0"),p=n("as/7");t.OptimizerConstructors=function(){function e(){}return e.sgd=function(e){return new p.SGDOptimizer(e)},e.momentum=function(e,t,n){return void 0===n&&(n=!1),new d.MomentumOptimizer(e,t,n)},e.rmsprop=function(e,t,n,r){return void 0===t&&(t=.9),void 0===n&&(n=0),void 0===r&&(r=1e-8),new h.RMSPropOptimizer(e,t,n,r)},e.adam=function(e,t,n,r){return void 0===e&&(e=.001),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=1e-8),new l.AdamOptimizer(e,t,n,r)},e.adadelta=function(e,t,n){return void 0===e&&(e=.001),void 0===t&&(t=.95),void 0===n&&(n=1e-8),new s.AdadeltaOptimizer(e,t,n)},e.adamax=function(e,t,n,r,o){return void 0===e&&(e=.002),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=1e-8),void 0===o&&(o=0),new c.AdamaxOptimizer(e,t,n,r,o)},e.adagrad=function(e,t){return void 0===t&&(t=.1),new u.AdagradOptimizer(e,t)},r([o.doc({heading:"Training",subheading:"Optimizers",namespace:"train"})],e,"sgd",null),r([o.doc({heading:"Training",subheading:"Optimizers",namespace:"train"})],e,"momentum",null),r([o.doc({heading:"Training",subheading:"Optimizers",namespace:"train"})],e,"rmsprop",null),r([o.doc({heading:"Training",subheading:"Optimizers",namespace:"train"})],e,"adam",null),r([o.doc({heading:"Training",subheading:"Optimizers",namespace:"train"})],e,"adadelta",null),r([o.doc({heading:"Training",subheading:"Optimizers",namespace:"train"})],e,"adamax",null),r([o.doc({heading:"Training",subheading:"Optimizers",namespace:"train"})],e,"adagrad",null),e}()},"Qi+2":function(e,t,n){"use strict";var r=n("TToO").__extends,o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n("gqjM"),u=n("jfp2"),l=n("Xq4m"),c=n("FgHA");t.TimeUnitNode=function(e){function t(t,n){var r=e.call(this,t)||this;return r.formula=n,r}return r(t,e),t.prototype.clone=function(){return new t(null,l.duplicate(this.formula))},t.makeFromEncoding=function(e,n){var r=n.reduceFieldDef(function(e,t){if(t.timeUnit){var f=s.vgField(t);e[f]={as:f,timeUnit:t.timeUnit,field:t.field}}return e},{});return 0===l.keys(r).length?null:new t(e,r)},t.makeFromTransform=function(e,n){return new t(e,((r={})[n.field]={as:n.as,timeUnit:n.timeUnit,field:n.field},r));var r},t.prototype.merge=function(e){this.formula=o({},this.formula,e.formula),e.remove()},t.prototype.producedFields=function(){var e={};return l.vals(this.formula).forEach(function(f){e[f.as]=!0}),e},t.prototype.dependentFields=function(){var e={};return l.vals(this.formula).forEach(function(f){e[f.field]=!0}),e},t.prototype.assemble=function(){return l.vals(this.formula).map(function(e){return{type:"formula",as:e.as,expr:u.fieldExpr(e.timeUnit,e.field)}})},t}(c.DataFlowNode)},RK46:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OneHotProgram=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "}},RmJh:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pool2DProgram=function(){return function(e,t,n){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterHeight,o=e.filterWidth,s=e.strideHeight,u=e.strideWidth,l=e.padInfo.top,c=e.padInfo.left;this.outputShape=e.outShape;var d="avg"===t,h="0.0";if(d||(h="min"===t?"1.0 / 0.0":"-1.0 / 0.0"),n)this.userCode="\n        const ivec2 strides = ivec2("+s+", "+u+");\n        const ivec2 pads = ivec2("+l+", "+c+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+r+"; wR++) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+o+"; wC++) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              if (isNaN(value)) {\n                setOutput(value);\n                return;\n              }\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value "+("min"===t?"<=":">=")+" currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+o+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var p="min"===t?"min":"max",g=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(g="avgValue / "+r*o+".0");var m=4*Math.floor(o/4),v=o%4,_="\n      if (hasNaN(values)) {\n        setOutput(getNaN(values));\n        return;\n      }\n      if ("+d+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = "+p+"(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+s+", "+u+");\n      const ivec2 pads = ivec2("+l+", "+c+");\n      const float initializationValue = "+h+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+h+");\n        float avgValue = 0.0;\n\n        for (int wR = 0; wR < "+r+"; wR++) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+m+"; wC += 4) {\n            int xC = xCCorner + wC;\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + 1, d),\n              getValue(batch, xR, xC + 2, d),\n              getValue(batch, xR, xC + 3, d)\n            );\n\n            "+_+"\n          }\n\n          int xC = xCCorner + "+m+";\n          if ("+(1===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n            "+_+"\n          } else if ("+(2===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + 1, d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+_+"\n          } else if ("+(3===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + 1, d),\n              getValue(batch, xR, xC + 2, d),\n              initializationValue\n            );\n\n            "+_+"\n          }\n        }\n        setOutput("+g+");\n      }\n    "}}}()},RmoZ:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("5WUj"),s=n("qmZh"),u=n("DjcB"),l=n("yJL4"),c=n("np2E"),d=n("KB5b"),h=function(e){function t(t){var n=e.call(this,t||{})||this;return n.supportsMasking=!0,n}return r(t,e),t.prototype.mergeFunction=function(e){throw new l.NotImplementedError},t.prototype.computeElementwiseOpOutputShape=function(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;for(var n=e.slice(0,e.length-t.length),k=0;k<t.length;++k){var i=e[e.length-t.length+k],j=t[k];if(null==i||null==j||i<0||j<0)n.push(null);else if(1===i)n.push(j);else if(1===j)n.push(i);else{if(i!==j)throw new l.ValueError("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(i)}}return n},t.prototype.build=function(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[c.getExactlyOneShape(e)]),(e=e).length<2)throw new l.ValueError("A merge layer should be called on an Array of at least 2 inputs. Got "+e.length+" input(s).");for(var t=[],n=0,r=e;n<r.length;n++)null!=(u=r[n])&&null!==u[0]&&t.push(u[0]);if((t=o.uniq(t)).length>1)throw new l.ValueError("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(e)+".");for(var s=null==e[0]?null:e[0].slice(1),i=1;i<e.length;++i){var u=null==e[i]?null:e[i].slice(1);s=this.computeElementwiseOpOutputShape(s,u)}var d=e.map(function(e){return e.length});this.reshapeRequired=!(!o.contains(e,null)&&1===o.uniq(d).length)},t.prototype.call=function(e,t){if(e=e,this.reshapeRequired){var n=[],r=e.map(function(e){return s.ndim(e)});if(o.contains(r,null)){for(var u=!1,l=0,c=e;l<c.length;l++)if(null==(A=s.ndim(x=c[l]))){var h=s.shape(x),p=h[0],g=h.slice(1).concat([p]),m=s.reshape(x,[p].concat(d.arrayProd(h.slice(1))));m=s.permuteDimensions(m,[1,0]),m=s.reshape(m,g),n.push(m),u=!0}else if(A>1){var v=o.range(1,A).concat([0]);n.push(s.permuteDimensions(x,v)),u=!0}else n.push(x);var y=this.mergeFunction(n),_=s.ndim(y);if(u)if(null==_){var w=s.shape(y);g=[p=w[w.length-1]].concat(w.slice(0,w.length-1)),y=s.reshape(s.permuteDimensions(s.reshape(y,[-1,p]),[1,0]),g)}else _>1&&(v=[_-1].concat(o.range(0,_-1)),y=s.permuteDimensions(y,v));return y}for(var E=o.max(r),O=0,S=e;O<S.length;O++){for(var x,A=s.ndim(x=S[O]),k=0;k<E-A;++k)x=s.expandDims(x,1);n.push(x)}return this.mergeFunction(n)}return this.mergeFunction(e)},t.prototype.computeOutputShape=function(e){var t;t=null==(e=e)[0]?null:e[0].slice(1);for(var i=1;i<e.length;++i){var n=null==e[i]?null:e[i].slice(1);t=this.computeElementwiseOpOutputShape(t,n)}for(var r=[],s=0,u=e;s<u.length;s++)null!=(n=u[s])&&null!==n[0]&&r.push(n[0]);return 1===(r=o.uniq(r)).length?r.concat(t):[null].concat(t)},t}(u.Layer);t.Merge=h;var p=function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.prototype.mergeFunction=function(e){for(var t=s.zeros(e[0].shape),n=0,r=e;n<r.length;n++)t=s.add(t,r[n]);return t},t}(h);t.Add=p,c.ClassNameMap.register("Add",p),t.add=function(e){return Array.isArray(e)?new p({}).apply(e):new p(e)};var g=function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.prototype.mergeFunction=function(e){for(var t=s.ones(e[0].shape),n=0,r=e;n<r.length;n++)t=s.multiply(t,r[n]);return t},t}(h);t.Multiply=g,c.ClassNameMap.register("Multiply",g),t.multiply=function(e){return Array.isArray(e)?new g({}).apply(e):new g(e)};var m=function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.prototype.mergeFunction=function(e){for(var t=s.zeros(e[0].shape),n=0,r=e;n<r.length;n++)t=s.add(t,r[n]);return s.scalarTimesArray(s.getScalar(1/e.length),t)},t}(h);t.Average=m,c.ClassNameMap.register("Average",m),t.average=function(e){return Array.isArray(e)?new m({}).apply(e):new m(e)};var v=function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.prototype.mergeFunction=function(e){for(var t=e[0],i=1;i<e.length;++i)t=s.maximum(t,e[i]);return t},t}(h);t.Maximum=v,c.ClassNameMap.register("Maximum",v),t.maximum=function(e){return Array.isArray(e)?new v({}).apply(e):new v(e)};var _=function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.prototype.mergeFunction=function(e){for(var t=e[0],i=1;i<e.length;++i)t=s.minimum(t,e[i]);return t},t}(h);t.Minimum=_,c.ClassNameMap.register("Minimum",_),t.minimum=function(e){return Array.isArray(e)?new _({}).apply(e):new _(e)};var w=function(e){function t(t){var n=e.call(this,t)||this;return n.DEFAULT_AXIS=-1,null==t&&(t={}),n.axis=null==t.axis?n.DEFAULT_AXIS:t.axis,n.supportsMasking=!0,n.reshapeRequired=!1,n}return r(t,e),t.prototype.build=function(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new l.ValueError("A `Concatenate` layer should be called on a list of at least 2 inputs");for(var t=!0,n=0,r=e=e;n<r.length;n++)if(null!=r[n]){t=!1;break}if(!t){for(var s=[],i=0;i<e.length;++i){var u=e[i].slice();u.splice(this.axis,1);for(var c=!1,d=0,h=s;d<h.length;d++)if(o.isEqual(h[d],u)){c=!0;break}c||s.push(u)}if(s.length>1)throw new l.ValueError("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}},t.prototype.mergeFunction=function(e){return s.concatenate(e,this.axis)},t.prototype.computeOutputShape=function(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new l.ValueError("A `Concatenate` layer should be called on a list of inputs.");for(var t=e,n=t[0].slice(),r=this.axis<0?n.length+this.axis:this.axis,o=0,s=t.slice(1);o<s.length;o++){var u=s[o];if(null==n[r]||null==u[r]){n[r]=null;break}n[r]+=u[r]}return n},t}(h);t.Concatenate=w,c.ClassNameMap.register("Concatenate",w),t.concatenate=function(e){return Array.isArray(e)?new w({}).apply(e):new w(e)}},RnQl:function(e,t,n){t.parse=n("51uB"),t.stringify=n("/NEo")},Rnp6:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"S/bZ":function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("Bsgt"),s=n("xdLA"),u=n("gqjM"),l=n("D6ZG"),c=n("rxHH"),d=n("Xq4m"),h=n("efV4"),p=n("dMOq");function g(e){if(u.isValueDef(e)){if(u.hasConditionalValueDef(e)){var t=o.isArray(e.condition)?e.condition.map(function(e){return e.value}):[e.condition.value];return Math.max.apply(null,[e.value].concat(t))}return e.value}}t.symbols=function(e,t,n,o,c){if("gradient"!==c){var m={},v=n.mark();switch(v){case l.BAR:case l.TICK:case l.TEXT:m.shape={value:"square"};break;case l.CIRCLE:case l.SQUARE:m.shape={value:v}}var _=o===s.COLOR?d.without(l.FILL_STROKE_CONFIG,[n.markDef.filled?"fill":"stroke","strokeDash","strokeDashOffset"]):l.FILL_STROKE_CONFIG;if(_=d.without(_,["strokeDash","strokeDashOffset"]),h.applyMarkConfig(m,n,_),o!==s.COLOR){var w=p.color(n);w.fill&&(w.fill.field||"transparent"===w.fill.value)&&delete w.fill,w.stroke&&(w.stroke.field||"transparent"===w.stroke.value)&&delete w.stroke,m=r({},m,w)}if(o!==s.SHAPE){var E=n.encoding.shape;u.isValueDef(E)&&(m.shape={value:E.value})}if(o!==s.OPACITY){var O=g(n.encoding.opacity)||n.markDef.opacity;O&&(m.opacity={value:O})}return m=r({},m,t),d.keys(m).length>0?m:void 0}},t.gradient=function(e,t,n,o,s){var u={};if("gradient"===s){var l=g(n.encoding.opacity)||n.markDef.opacity;l&&(u.opacity={value:l})}return u=r({},u,t),d.keys(u).length>0?u:void 0},t.labels=function(e,t,n,o,s){var l=n.legend(o),p=n.config,g={};if(u.isTimeFieldDef(e)){var m=n.getScaleComponent(o).get("type")===c.ScaleType.UTC;t=r({text:{signal:h.timeFormatExpression("datum.value",e.timeUnit,l.format,p.legend.shortTimeLabels,p.timeFormat,m)}},t)}return g=r({},g,t),d.keys(g).length>0?g:void 0}},S5zt:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("bDWH");t.BatchNormProgram=function(){return function(e,t,n,o,s,u){this.outputShape=[],this.supportsBroadcasting=!0,this.variableNames=["x","mean","variance"],r.assertAndGetBroadcastShape(e,t),r.assertAndGetBroadcastShape(e,n);var l="0.0";null!=o&&(r.assertAndGetBroadcastShape(e,o),this.variableNames.push("offset"),l="getOffsetAtOutCoords()");var c="1.0";null!=s&&(r.assertAndGetBroadcastShape(e,s),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+l+";\n        float scale = "+c+";\n        float inv = scale / sqrt(variance + float("+u+"));\n        setOutput((x - mean) * inv + offset);\n      }\n    "}}()},SPTo:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("v/P2"),u=n("XFvI"),l=n("DqkE"),c=n("EflS"),d=n("35G1");function h(a,b,e){c.assertParams(a.shape,b.shape,e);var t=c.computeOutShape(a.shape,b.shape,e),n=a.as2D(-1,u.sizeFromShape(a.shape.slice(e))),r=b.as2D(-1,u.sizeFromShape(b.shape.slice(e))),o=c.computeGradientSliceShapes(n.shape,r.shape),l=o.aBegin,d=o.aSize,h=o.bBegin,p=o.bSize;return s.ENV.engine.runKernel(function(e){return e.concat(n,r)},{a:n,b:r},function(e){return{a:function(){return e.slice(l,d)},b:function(){return e.slice(h,p)}}}).reshape(t)}t.ConcatOps=function(){function e(){}return e.concat1d=function(t){return e.concat(t,0)},e.concat2d=function(t,n){return e.concat(t,n)},e.concat3d=function(t,n){return e.concat(t,n)},e.concat4d=function(t,n){return e.concat(t,n)},e.concat=function(e,t){void 0===t&&(t=0),u.assert(e.length>=2,"Pass at least two tensors to concat");for(var n=e[0],r=l.parseAxisParam(t,n.shape),i=1;i<e.length;++i)n=h(n,e[i],r[0]);return n},r([o.doc({heading:"Tensors",subheading:"Slicing and Joining"}),d.operation],e,"concat",null),e}()},SeQP:function(e,t){e.exports={_from:"vega-lib@^3.2.1",_id:"vega-lib@3.2.1",_inBundle:!1,_integrity:"sha512-ufcPBsYyiDkyvw20lKZi/pAYFRVJNmsnpX+JyO+lvLUg2XjtChC7xNHI7htHI2AXk525F4zG/yHB2T9U97JdBQ==",_location:"/vega-lib",_phantomChildren:{},_requested:{type:"range",registry:!0,raw:"vega-lib@^3.2.1",name:"vega-lib",escapedName:"vega-lib",rawSpec:"^3.2.1",saveSpec:null,fetchSpec:"^3.2.1"},_requiredBy:["/vega-embed"],_resolved:"https://registry.npmjs.org/vega-lib/-/vega-lib-3.2.1.tgz",_shasum:"feca4b054a0db492f92fd555e6c20be3f3c117d0",_spec:"vega-lib@^3.2.1",_where:"C:\\Users\\Wolfr\\Entwicklung\\AngularExamples\\node_modules\\vega-embed",author:{name:"UW Interactive Data Lab",url:"http://idl.cs.washington.edu"},browser:{buffer:!1,canvas:!1,"canvas-prebuilt":!1,fs:!1},bugs:{url:"https://github.com/vega/vega-lib/issues"},bundleDependencies:!1,contributors:[{name:"Jeffrey Heer",url:"http://idl.cs.washington.edu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Ryan Russell",url:"https://github.com/RussellSprouts"},{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"},{name:"Yuri Astrakhan",url:"https://github.com/nyurik"}],dependencies:{"vega-crossfilter":"2","vega-dataflow":"3","vega-encode":"2","vega-expression":"^2.3","vega-force":"2","vega-geo":"^2.2","vega-hierarchy":"^2.1","vega-loader":"2","vega-parser":"^2.5","vega-projection":"1","vega-runtime":"2","vega-scale":"^2.1","vega-scenegraph":"^2.3","vega-statistics":"^1.2","vega-transforms":"^1.2","vega-typings":"*","vega-util":"^1.7","vega-view":"^2.2","vega-view-transforms":"^1.2","vega-voronoi":"2","vega-wordcloud":"^2.1"},deprecated:!1,description:"Include Vega in projeccts using minimal dependencies.",devDependencies:{eslint:"4",rollup:"0.43","rollup-plugin-json":"2","rollup-plugin-node-resolve":"3",tape:"4",tv4:"1","uglify-js":"3"},homepage:"https://github.com/vega/vega-lib#readme","jsnext:main":"index",keywords:["vega","visualization","interaction","dataflow","library","data","d3"],license:"BSD-3-Clause",main:"build/vega.js",module:"index",name:"vega-lib",repository:{type:"git",url:"git+https://github.com/vega/vega-lib.git"},scripts:{__postpublish:"git push && git push --tags",build:"npm run rollup && bin/rollup -e",postbuild:"uglifyjs build/vega.js -c -m -o build/vega.min.js && uglifyjs build/vega-core.js -c -m -o build/vega-core.min.js",prebuild:"rm -rf build && mkdir build",prepublish:"npm run test && npm run build",rollup:"bin/rollup && bin/schema > build/vega-schema.json",test:"eslint index.js"},version:"3.2.1"}},T4GW:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Bsgt"),o=n("YuVP"),s=n("kglw");t.default={predicate:"vlSingle",scaleDomain:"vlSingleDomain",signals:o.default.signals,topLevelSignals:function(e,t,n){var o=n.filter(function(e){return e.name===t.name}),u="data("+r.stringValue(t.name+s.STORE)+")",l=u+"[0].values";return o.length?n:n.concat({name:t.name,update:u+".length && {"+t.project.map(function(e,i){return e.field+": "+l+"["+i+"]"}).join(", ")+"}"})},modifyExpr:function(e,t){return t.name+s.TUPLE+", "+("global"===t.resolve?"true":"{unit: "+s.unitName(e)+"}")}}},TBqz:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("dMOq"),s=n("KIOn");t.rule={vgMark:"rule",encodeEntry:function(e){var t=e.width,n=e.height,u=e.markDef.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?r({},o.baseEncodeEntry(e,{size:"ignore",orient:"ignore"}),o.pointPosition("x",e,"horizontal"===u?"zeroOrMin":s.mid(t)),o.pointPosition("y",e,"vertical"===u?"zeroOrMin":s.mid(n)),"vertical"!==u?o.pointPosition2(e,"zeroOrMax","x2"):{},"horizontal"!==u?o.pointPosition2(e,"zeroOrMax","y2"):{},o.nonPosition("size",e,{vgChannel:"strokeWidth"})):{}}}},TPCB:function(e,t,n){"use strict";var r=n("TToO").__extends,o=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var s=n("JV7f"),u=n("5WUj"),l=n("qmZh"),c=n("e/LB"),d=n("yJL4"),h=n("mFTl"),p=n("np2E"),g=n("KB5b");function m(value){if(null!=value&&t.VALID_FAN_MODE_VALUES.indexOf(value)<0)throw new d.ValueError(value+" is not a valid FanMode.  Valid values as "+t.VALID_FAN_MODE_VALUES)}function v(value){if(null!=value&&t.VALID_DISTRIBUTION_VALUES.indexOf(value)<0)throw new d.ValueError(value+" is not a valid Distribution.  Valid values as "+t.VALID_DISTRIBUTION_VALUES)}p.SerializableEnumRegistry.register("mode",{fan_in:"fanIn",fan_out:"fanOut",fan_avg:"fanAvg"}),t.VALID_FAN_MODE_VALUES=["fanIn","fanOut","fanAvg",void 0,null],t.checkFanMode=m,p.SerializableEnumRegistry.register("distribution",{normal:"normal",uniform:"uniform"}),t.VALID_DISTRIBUTION_VALUES=["normal","uniform",void 0,null],t.checkDistribution=v;var _=function(){function e(){}return e.fromConfig=function(e,t){return new e(t)},e.prototype.fromConfigUsesCustomObjects=function(){return!1},e.prototype.getConfig=function(){return{}},o([s.doc({heading:"Initializers",subheading:"Classes",namespace:"initializers"})],e)}();t.Initializer=_;var w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.apply=function(e,t){return l.zeros(e,t)},t}(_);t.Zeros=w,p.ClassNameMap.register("Zeros",w);var E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.apply=function(e,t){return l.ones(e,t)},t}(_);t.Ones=E,p.ClassNameMap.register("Ones",E);var O=function(e){function t(t){var n=e.call(this)||this;return n.value=t.value,n}return r(t,e),t.prototype.apply=function(e,t){return l.scalarTimesArray(s.scalar(this.value),l.ones(e,t))},t.prototype.getConfig=function(){return{value:this.value}},t}(_);t.Constant=O,p.ClassNameMap.register("Constant",O);var S=function(e){function t(t){var n=e.call(this)||this;return n.DEFAULT_MINVAL=-.05,n.DEFAULT_MAXVAL=.05,n.minval=t.minval||n.DEFAULT_MINVAL,n.maxval=t.maxval||n.DEFAULT_MAXVAL,n.seed=t.seed,n}return r(t,e),t.prototype.apply=function(e,t){return l.randomUniform(e,this.minval,this.maxval,t,this.seed)},t.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},t}(_);t.RandomUniform=S,p.ClassNameMap.register("RandomUniform",S);var A=function(e){function t(t){var n=e.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=t.mean||n.DEFAULT_MEAN,n.stddev=t.stddev||n.DEFAULT_STDDEV,n.seed=t.seed,n}return r(t,e),t.prototype.apply=function(e,t){return l.randomNormal(e,this.mean,this.stddev,t,this.seed)},t.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},t}(_);t.RandomNormal=A,p.ClassNameMap.register("RandomNormal",A);var T=function(e){function t(t){var n=e.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=t.mean||n.DEFAULT_MEAN,n.stddev=t.stddev||n.DEFAULT_STDDEV,n.seed=t.seed,n}return r(t,e),t.prototype.apply=function(e,t){return l.truncatedNormal(e,this.mean,this.stddev,t,this.seed)},t.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},t}(_);t.TruncatedNormal=T,p.ClassNameMap.register("TruncatedNormal",T);var N=function(e){function t(t){var n=e.call(this)||this;return n.gain=null!=t.gain?s.scalar(t.gain):l.getScalar(1),n}return r(t,e),t.prototype.apply=function(e,t){if(2!==e.length||e[0]!==e[1])throw new d.ValueError("Identity matrix initializer can only be used for 2D square matrices.");return l.scalarTimesArray(this.gain,l.eye(e[0]))},t.prototype.getConfig=function(){return{gain:this.gain.get()}},t}(_);t.Identity=N,p.ClassNameMap.register("Identity",N);var M=function(e){function t(t){var n=e.call(this)||this;if(t.scale<0)throw new d.ValueError("scale must be a positive float. Got: "+t.scale);return n.scale=null==t.scale?1:t.scale,n.mode=t.mode,m(n.mode),n.distribution=t.distribution,v(n.distribution),n.seed=t.seed,n}return r(t,e),t.prototype.apply=function(e,t){var n=function(e,t){var n,r;if(void 0===t&&(t="channelsLast"),c.checkDataFormat(t),2===e.length)n=e[0],r=e[1];else if(u.contains([3,4,5],e.length))if("channelsFirst"===t){var o=g.arrayProd(e,2);n=e[1]*o,r=e[0]*o}else"channelsLast"===t&&(o=g.arrayProd(e,0,e.length-2),n=e[e.length-2]*o,r=e[e.length-1]*o);else{var s=g.arrayProd(e);n=Math.sqrt(s),r=Math.sqrt(s)}return[n,r]}(e),r=n[0],o=n[1],s=this.scale;if(s/="fanIn"===this.mode?Math.max(1,r):"fanOut"===this.mode?Math.max(1,o):Math.max(1,(r+o)/2),"normal"===this.distribution){var d=Math.sqrt(s);return l.truncatedNormal(e,0,d,t,this.seed)}var h=Math.sqrt(3*s);return l.randomUniform(e,-h,h,t,this.seed)},t.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},t}(_);t.VarianceScaling=M,p.ClassNameMap.register("VarianceScaling",M);var C=function(e){function t(t){return e.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:t.seed})||this}return r(t,e),t}(M);t.GlorotUniform=C,p.ClassNameMap.register("GlorotUniform",C);var D=function(e){function t(t){return e.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:t.seed})||this}return r(t,e),t}(M);t.GlorotNormal=D,p.ClassNameMap.register("GlorotNormal",D);var R=function(e){function t(t){return e.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:t.seed})||this}return r(t,e),t}(M);t.HeNormal=R,p.ClassNameMap.register("HeNormal",R);var I=function(e){function t(t){return e.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:t.seed})||this}return r(t,e),t}(M);t.LeCunNormal=I,p.ClassNameMap.register("LeCunNormal",I);var P=function(e){function t(t){var n=e.call(this)||this;if(n.DEFAULT_GAIN=1,n.gain=null==t.gain?n.DEFAULT_GAIN:t.gain,n.seed=t.seed,null!=n.seed)throw new d.NotImplementedError("Random seed is not implemented for Orthogonal Initializer yet.");return n}return r(t,e),t.prototype.apply=function(e,t){if(2!==e.length)throw new d.NotImplementedError("The Orthogonal Initializer does not support non-2D shapes yet.");var n=e[0]>=e[1]?e:[e[1],e[0]],a=l.randomNormal(n,0,1,h.DType.float32),r=l.qr(a)[0];return r.shape[1]>n[1]&&(r=r.slice([0,0],n)),e[0]<e[1]&&(r=r.transpose()),l.scalarTimesArray(l.getScalar(this.gain),r)},t.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},t}(_);function L(e,t){return void 0===t&&(t={}),p.deserializeKerasObject(e,p.ClassNameMap.getMap().pythonClassNameMap,t,"initializer")}t.Orthogonal=P,p.ClassNameMap.register("Orthogonal",P),t.INITIALIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",identity:"Identity",leCunNormal:"LeCunNormal",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"},t.serializeInitializer=function(e){return p.serializeKerasObject(e)},t.getInitializer=function(e){return"string"==typeof e?L({className:e in t.INITIALIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP?t.INITIALIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP[e]:e,config:{}}):e instanceof _?e:L(e)}},"TZ+F":function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("v/P2"),u=n("XFvI"),l=n("Hjly"),c=n("35G1");function d(e){var t=function(e){return"number"==typeof e?[e,e]:e}(e);return 1===t[0]&&1===t[1]}function h(e,t){return d(e)||d(t)}t.ConvOps=function(){function e(){}return e.conv1d=function(t,n,r,o,s,l,c){void 0===s&&(s="NWC"),void 0===l&&(l=1);var d=t,p=!1;2===t.rank&&(p=!0,d=t.as3D(1,t.shape[0],t.shape[1])),u.assert(3===d.rank,"Error in conv1d: input must be rank 3, but got rank "+d.rank+"."),u.assert(3===n.rank,"Error in conv1d: filter must be rank 3, but got rank "+n.rank+"."),null!=c&&u.assert(u.isInt(o),"Error in conv1d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+o+"."),u.assert(d.shape[2]===n.shape[1],"Error in conv1d: depth of input ("+d.shape[2]+") must match  input depth for filter "+n.shape[1]+"."),u.assert(h(r,l),"Error in conv1D: Either stride or dilation must be 1.Got stride "+r+" and dilation '"+l+"'"),u.assert("NWC"===s,"Error in conv1d: got dataFormat of "+s+" but only NWC is currently supported.");var g=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]),m=d.as4D(d.shape[0],1,d.shape[1],d.shape[2]),v=e.conv2d(m,g,[1,r],o,"NHWC",[1,l],c);return p?v.as2D(v.shape[2],v.shape[3]):v.as3D(v.shape[0],v.shape[2],v.shape[3])},e.conv2d=function(x,t,n,r,o,c,p){void 0===o&&(o="NHWC"),void 0===c&&(c=[1,1]);var g=x,m=!1;3===x.rank&&(m=!0,g=x.as4D(1,x.shape[0],x.shape[1],x.shape[2])),u.assert(4===g.rank,"Error in conv2d: input must be rank 4, but got rank "+g.rank+"."),u.assert(4===t.rank,"Error in conv2d: filter must be rank 4, but got rank "+t.rank+"."),null!=p&&u.assert(u.isInt(r),"Error in conv2d: pad must be an integer when using, dimRoundingMode "+p+" but got pad "+r+"."),u.assert(g.shape[3]===t.shape[2],"Error in conv2d: depth of input ("+g.shape[3]+") must match  input depth for filter "+t.shape[2]+"."),u.assert(h(n,c),"Error in conv2D: Either strides or dilations must be 1.Got strides "+n+" and dilations '"+c+"'"),u.assert("NHWC"===o,"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported.");var v=l.computeConv2DInfo(g.shape,t.shape,n,c,r,p),_=s.ENV.engine.runKernel(function(e){return e.conv2d(g,t,v)},{x:g,filter:t},function(o){return u.assert(d(c),"Error in gradient of conv2D: dilation rates greater than 1 are notyet supported in gradients. Got dilations '"+c+"'"),{x:function(){return e.conv2dDerInput(g.shape,o,t,n,r)},filter:function(){return e.conv2dDerFilter(g,o,t.shape,n,r)}}});return m?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_},e.conv2dDerInput=function(e,t,n,r,o,c){u.assert(e.length===t.rank,"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match");var d=e,h=t,p=!1;3===t.rank&&(p=!0,h=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),d=[1,e[0],e[1],e[2]]);var g=d[3],m=h.shape[3];u.assert(4===d.length,"Error in conv2dDerInput: inShape must be length 4, but got length "+d.length+"."),u.assert(4===h.rank,"Error in conv2dDerInput: dy must be rank 4, but got rank "+h.rank),u.assert(4===n.rank,"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank),u.assert(g===n.shape[2],"Error in conv2dDerInput: depth of input ("+g+") must match input depth for filter "+n.shape[2]+"."),u.assert(m===n.shape[3],"Error in conv2dDerInput: depth of output ("+m+") mustmatch output depth for filter "+n.shape[3]+"."),null!=c&&u.assert(u.isInt(o),"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+o+".");var v=l.computeConv2DInfo(d,n.shape,r,1,o,c),_=s.ENV.engine.runKernel(function(e){return e.conv2dDerInput(h,n,v)},{dy4D:h});return p?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_},e.conv2dDerFilter=function(x,e,t,n,r,o){var c=x;3===x.rank&&(c=x.as4D(1,x.shape[0],x.shape[1],x.shape[2]));var d=e;3===d.rank&&(d=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),u.assert(4===c.rank,"Error in conv2dDerFilter: input must be rank 4, but got shape "+c.shape+"."),u.assert(4===d.rank,"Error in conv2dDerFilter: dy must be rank 4, but got shape "+d.shape+"."),u.assert(4===t.length,"Error in conv2dDerFilter: filterShape must be length 4, but got "+t+"."),u.assert(c.shape[3]===t[2],"Error in conv2dDerFilter: depth of input "+c.shape[3]+") must match input depth in filter ("+t[2]+"."),u.assert(d.shape[3]===t[3],"Error in conv2dDerFilter: depth of dy ("+d.shape[3]+") must match output depth for filter ("+t[3]+")."),null!=o&&u.assert(u.isInt(r),"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+".");var h=l.computeConv2DInfo(c.shape,t,n,1,r,o);return s.ENV.engine.runKernel(function(e){return e.conv2dDerFilter(c,d,h)},{x4D:c,dy4D:d})},e.conv2dTranspose=function(x,t,n,r,o,s){return e.conv2dDerInput(n,x,t,r,o,s)},e.depthwiseConv2d=function(e,t,n,r,o,c,d){void 0===o&&(o="NHWC"),void 0===c&&(c=[1,1]);var p=e,g=!1;3===e.rank&&(g=!0,p=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),u.assert(4===p.rank,"Error in depthwiseConv2D: input must be rank 4, but got rank "+p.rank+"."),u.assert(4===t.rank,"Error in depthwiseConv2D: filter must be rank 4, but got rank "+t.rank+"."),u.assert(p.shape[3]===t.shape[2],"Error in depthwiseConv2D: number of input channels ("+p.shape[3]+") must match the inChannels dimension in filter "+t.shape[2]+"."),null==c&&(c=[1,1]),u.assert(h(n,c),"Error in depthwiseConv2d: Either strides or dilations must be 1.Got strides "+n+" and dilations '"+c+"'"),null!=d&&u.assert(u.isInt(r),"Error in depthwiseConv2D: pad must be an integer when using, dimRoundingMode "+d+" but got pad "+r+".");var m=l.computeConv2DInfo(p.shape,t.shape,n,c,r,d,!0),v=s.ENV.engine.runKernel(function(e){return e.depthwiseConv2D(p,t,m)},{input4D:p,filter:t});return g?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v},r([o.doc({heading:"Operations",subheading:"Convolution"}),c.operation],e,"conv1d",null),r([o.doc({heading:"Operations",subheading:"Convolution"}),c.operation],e,"conv2d",null),r([c.operation],e,"conv2dDerInput",null),r([c.operation],e,"conv2dDerFilter",null),r([o.doc({heading:"Operations",subheading:"Convolution"}),c.operation],e,"conv2dTranspose",null),r([o.doc({heading:"Operations",subheading:"Convolution"}),c.operation],e,"depthwiseConv2d",null),e}()},Td0G:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("D6ZG"),s=n("YFgP"),u=n("41KP"),l={};function c(e,t){l[e]=t}t.add=c,t.remove=function(e){delete l[e]},t.COMPOSITE_MARK_STYLES=s.BOXPLOT_STYLES,t.VL_ONLY_COMPOSITE_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX=r({},s.VL_ONLY_BOXPLOT_CONFIG_PROPERTY_INDEX),c(s.BOXPLOT,s.normalizeBoxPlot),c(u.ERRORBAR,u.normalizeErrorBar),t.normalize=function(e,t){var n=o.isMarkDef(e.mark)?e.mark.type:e.mark,r=l[n];if(r)return r(e,t);throw new Error('Invalid mark type "'+n+'"')}},UNfQ:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("JV7f"),s=n("lbmW"),u=n("DjcB"),l=n("MZV5"),c=n("TPCB"),d=n("h5Qj"),h=n("bcxt"),p=n("ZQPO"),g=n("DwrG"),m=n("xPdO"),v=n("RmoZ"),_=n("VFyW"),w=n("UdGD"),E=n("h6VP"),O=n("msRB"),S=n("1Z9O"),A=n("VKbu"),T=n("Q1Fz"),N=function(){function e(){}return e.model=function(e){return new l.Model(e)},e.sequential=function(e){return new A.Sequential(e)},e.loadModel=function(e){return A.loadModelInternal(e)},e.input=function(e){return u.Input(e)},r([o.doc({heading:"Models",subheading:"Creation",configParamIndices:[0]})],e,"model",null),r([o.doc({heading:"Models",subheading:"Creation",configParamIndices:[0]})],e,"sequential",null),r([o.doc({heading:"Models",subheading:"Loading",useDocsFrom:"loadModelInternal"})],e,"loadModel",null),r([o.doc({heading:"Models",subheading:"Inputs",useDocsFrom:"Input",configParamIndices:[0]})],e,"input",null),e}();t.ModelExports=N,t.LayerExports=function(){function e(){}return e.inputLayer=function(e){return new u.InputLayer(e)},e.elu=function(e){return new d.ELU(e)},e.leakyReLU=function(e){return new d.LeakyReLU(e)},e.softmax=function(e){return new d.Softmax(e)},e.thresohldedReLU=function(e){return new d.ThresholdedReLU(e)},e.conv1d=function(e){return new h.Conv1D(e)},e.conv2d=function(e){return new h.Conv2D(e)},e.conv2dTranspose=function(e){return new h.Conv2DTranspose(e)},e.depthwiseConv2d=function(e){return new p.DepthwiseConv2D(e)},e.activation=function(e){return new g.Activation(e)},e.dense=function(e){return new g.Dense(e)},e.dropout=function(e){return new g.Dropout(e)},e.flatten=function(e){return new g.Flatten(e)},e.repeatVector=function(e){return new g.RepeatVector(e)},e.embedding=function(e){return new m.Embedding(e)},e.add=function(e){return new v.Add(e)},e.average=function(e){return new v.Average(e)},e.concatenate=function(e){return new v.Concatenate(e)},e.maximum=function(e){return new v.Maximum(e)},e.minimum=function(e){return new v.Minimum(e)},e.multiply=function(e){return new v.Multiply(e)},e.batchNormalization=function(e){return new _.BatchNormalization(e)},e.zeroPadding2d=function(e){return new w.ZeroPadding2D(e)},e.avgPooling1d=function(e){return new E.AvgPooling1D(e)},e.avgPooling2d=function(e){return new E.AvgPooling2D(e)},e.globalAveragePooling1d=function(e){return new E.GlobalAveragePooling1D(e)},e.globalAveragePooling2d=function(e){return new E.GlobalAveragePooling2D(e)},e.globalMaxPooling1d=function(e){return new E.GlobalMaxPooling1D(e)},e.globalMaxPooling2d=function(e){return new E.GlobalMaxPooling2D(e)},e.maxPooling1d=function(e){return new E.MaxPooling1D(e)},e.maxPooling2d=function(e){return new E.MaxPooling2D(e)},e.gru=function(e){return new O.GRU(e)},e.gruCell=function(e){return new O.GRUCell(e)},e.lstm=function(e){return new O.LSTM(e)},e.lstmCell=function(e){return new O.LSTMCell(e)},e.simpleRNN=function(e){return new O.SimpleRNN(e)},e.simpleRNNCell=function(e){return new O.SimpleRNNCell(e)},e.rnn=function(e){return new O.RNN(e)},e.stackedRNNCells=function(e){return new O.StackedRNNCells(e)},e.bidirectional=function(e){return new S.Bidirectional(e)},e.timeDistributed=function(e){return new S.TimeDistributed(e)},e.Layer=u.Layer,e.RNNCell=O.RNNCell,e.input=N.input,r([o.doc({heading:"Layers",subheading:"Inputs",namespace:"layers",useDocsFrom:"InputLayer",configParamIndices:[0]})],e,"inputLayer",null),r([o.doc({heading:"Layers",subheading:"Advanced Activation",namespace:"layers",useDocsFrom:"ELU",configParamIndices:[0]})],e,"elu",null),r([o.doc({heading:"Layers",subheading:"Advanced Activation",namespace:"layers",useDocsFrom:"LeakyReLU",configParamIndices:[0]})],e,"leakyReLU",null),r([o.doc({heading:"Layers",subheading:"Advanced Activation",namespace:"layers",useDocsFrom:"Softmax",configParamIndices:[0]})],e,"softmax",null),r([o.doc({heading:"Layers",subheading:"Advanced Activation",namespace:"layers",useDocsFrom:"ThresholdedReLU",configParamIndices:[0]})],e,"thresohldedReLU",null),r([o.doc({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"Conv1D",configParamIndices:[0]})],e,"conv1d",null),r([o.doc({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"Conv2D",configParamIndices:[0]})],e,"conv2d",null),r([o.doc({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"Conv2DTranspose",configParamIndices:[0]})],e,"conv2dTranspose",null),r([o.doc({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"DepthwiseConv2D",configParamIndices:[0]})],e,"depthwiseConv2d",null),r([o.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Activation",configParamIndices:[0]})],e,"activation",null),r([o.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Dense",configParamIndices:[0]})],e,"dense",null),r([o.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Dropout",configParamIndices:[0]})],e,"dropout",null),r([o.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Flatten",configParamIndices:[0]})],e,"flatten",null),r([o.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"RepeatVector",configParamIndices:[0]})],e,"repeatVector",null),r([o.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Embedding",configParamIndices:[0]})],e,"embedding",null),r([o.doc({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Add",configParamIndices:[0]})],e,"add",null),r([o.doc({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Average",configParamIndices:[0]})],e,"average",null),r([o.doc({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Concatenate",configParamIndices:[0]})],e,"concatenate",null),r([o.doc({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Maximum",configParamIndices:[0]})],e,"maximum",null),r([o.doc({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Minimum",configParamIndices:[0]})],e,"minimum",null),r([o.doc({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Multiply",configParamIndices:[0]})],e,"multiply",null),r([o.doc({heading:"Layers",subheading:"Normalization",namespace:"layers",useDocsFrom:"BatchNormalization",configParamIndices:[0]})],e,"batchNormalization",null),r([o.doc({heading:"Layers",subheading:"Padding",namespace:"layers",useDocsFrom:"ZeroPadding2D",configParamIndices:[0]})],e,"zeroPadding2d",null),r([o.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"AvgPooling1D",configParamIndices:[0]})],e,"avgPooling1d",null),r([o.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"AvgPooling2D",configParamIndices:[0]})],e,"avgPooling2d",null),r([o.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"GlobalAveragePooling1D",configParamIndices:[0]})],e,"globalAveragePooling1d",null),r([o.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"GlobalAveragePooling2D",configParamIndices:[0]})],e,"globalAveragePooling2d",null),r([o.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"GlobalMaxPooling1D",configParamIndices:[0]})],e,"globalMaxPooling1d",null),r([o.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"GlobalMaxPooling2D",configParamIndices:[0]})],e,"globalMaxPooling2d",null),r([o.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"MaxPooling1D",configParamIndices:[0]})],e,"maxPooling1d",null),r([o.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"MaxPooling2D",configParamIndices:[0]})],e,"maxPooling2d",null),r([o.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"GRU",configParamIndices:[0]})],e,"gru",null),r([o.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"GRUCell",configParamIndices:[0]})],e,"gruCell",null),r([o.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"LSTM",configParamIndices:[0]})],e,"lstm",null),r([o.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"LSTMCell",configParamIndices:[0]})],e,"lstmCell",null),r([o.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"SimpleRNN",configParamIndices:[0]})],e,"simpleRNN",null),r([o.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"SimpleRNNCell",configParamIndices:[0]})],e,"simpleRNNCell",null),r([o.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"RNN",configParamIndices:[0]})],e,"rnn",null),r([o.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"RNN",configParamIndices:[0]})],e,"stackedRNNCells",null),r([o.doc({heading:"Layers",subheading:"Wrapper",namespace:"layers",useDocsFrom:"Bidirectional",configParamIndices:[0]})],e,"bidirectional",null),r([o.doc({heading:"Layers",subheading:"Wrapper",namespace:"layers",useDocsFrom:"TimeDistributed",configParamIndices:[0]})],e,"timeDistributed",null),e}(),t.ConstraintExports=function(){function e(){}return e.maxNorm=function(e){return new s.MaxNorm(e)},e.unitNorm=function(e){return new s.UnitNorm(e)},e.nonNeg=function(){return new s.NonNeg},e.minMaxNorm=function(e){return new s.MinMaxNorm(e)},r([o.doc({heading:"Constraints",namespace:"constraints",useDocsFrom:"MaxNorm",configParamIndices:[0]})],e,"maxNorm",null),r([o.doc({heading:"Constraints",namespace:"constraints",useDocsFrom:"UnitNorm",configParamIndices:[0]})],e,"unitNorm",null),r([o.doc({heading:"Constraints",namespace:"constraints",useDocsFrom:"NonNeg"})],e,"nonNeg",null),r([o.doc({heading:"Constraints",namespace:"constraints",useDocsFrom:"MinMaxNormConfig",configParamIndices:[0]})],e,"minMaxNorm",null),e}(),t.InitializerExports=function(){function e(){}return e.zeros=function(){return new c.Zeros},e.ones=function(){return new c.Ones},e.constant=function(e){return new c.Constant(e)},e.randomUniform=function(e){return new c.RandomUniform(e)},e.randomNormal=function(e){return new c.RandomNormal(e)},e.truncatedNormal=function(e){return new c.TruncatedNormal(e)},e.identity=function(e){return new c.Identity(e)},e.varianceScaling=function(e){return new c.VarianceScaling(e)},e.glorotUniform=function(e){return new c.GlorotUniform(e)},e.glorotNormal=function(e){return new c.GlorotNormal(e)},e.heNormal=function(e){return new c.HeNormal(e)},e.leCunNormal=function(e){return new c.LeCunNormal(e)},e.orthogonal=function(e){return new c.Orthogonal(e)},r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"Zeros"})],e,"zeros",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"Ones"})],e,"ones",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"Constant",configParamIndices:[0]})],e,"constant",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"RandomUniform",configParamIndices:[0]})],e,"randomUniform",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"RandomNormal",configParamIndices:[0]})],e,"randomNormal",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"TruncatedNormal",configParamIndices:[0]})],e,"truncatedNormal",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"Identity",configParamIndices:[0]})],e,"identity",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"VarianceScaling",configParamIndices:[0]})],e,"varianceScaling",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"GlorotUniform",configParamIndices:[0]})],e,"glorotUniform",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"GlorotNormal",configParamIndices:[0]})],e,"glorotNormal",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"HeNormal",configParamIndices:[0]})],e,"heNormal",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"LeCunNormal",configParamIndices:[0]})],e,"leCunNormal",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"Orthogonal",configParamIndices:[0]})],e,"orthogonal",null),e}(),t.RegularizerExports=function(){function e(){}return e.l1l2=function(e){return new T.L1L2(e)},e.l1=function(e){return T.l1(e)},e.l2=function(e){return T.l2(e)},r([o.doc({heading:"Regularizers",namespace:"regularizers",useDocsFrom:"L1L2"})],e,"l1l2",null),r([o.doc({heading:"Regularizers",namespace:"regularizers",useDocsFrom:"L1L2"})],e,"l1",null),r([o.doc({heading:"Regularizers",namespace:"regularizers",useDocsFrom:"L1L2"})],e,"l2",null),e}()},UPUT:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("v/P2"),u=n("V6aD"),l=n("XFvI"),c=n("DqkE"),d=n("35G1"),h=n("m3RX");t.ReductionOps=function(){function e(){}return e.logSumExp=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=c.parseAxisParam(t,e.shape),o=e.max(r,!0),s=e.sub(o).exp().sum(r).log(),u=o.reshape(s.shape).add(s);if(n){var l=c.expandShapeToKeepDim(u.shape,r);return u.reshape(l)}return u},e.sum=function(x,e,t){void 0===e&&(e=null),void 0===t&&(t=!1);var n=c.parseAxisParam(e,x.shape);return u.customGrad(function(x){var e=c.getAxesPermutation(n,x.rank),r=n,o=x;null!=e&&(o=x.transpose(e),r=c.getInnerMostAxes(r.length,x.rank));var value=s.ENV.engine.runKernel(function(e){return e.sum(o,r)},{permutedX:o});if(t){var u=c.expandShapeToKeepDim(value.shape,n);value=value.reshape(u)}return{value:value,gradFunc:function(e){var t=x.shape.slice();return n.forEach(function(e){t[e]=1}),e.reshape(t).mul(h.ones(x.shape,"float32"))}}})(x)},e.mean=function(x,e,t){void 0===e&&(e=null),void 0===t&&(t=!1);var n=c.parseAxisParam(e,x.shape),r=c.computeOutAndReduceShapes(x.shape,n),o=l.sizeFromShape(r[1]);return u.customGrad(function(x){var r=h.scalar(o);return{value:(r.dtype===x.dtype?x:x.cast(r.dtype)).div(r).sum(e,t),gradFunc:function(e){var t=x.shape.slice();return n.forEach(function(e){t[e]=1}),e.reshape(t).mul(h.ones(x.shape,"float32")).div(r)}}})(x)},e.min=function(x,e,t){void 0===e&&(e=null),void 0===t&&(t=!1);var n=c.parseAxisParam(e,x.shape),r=n,o=c.getAxesPermutation(r,x.rank);null!=o&&(x=x.transpose(o),r=c.getInnerMostAxes(r.length,x.rank));var u=s.ENV.engine.runKernel(function(e){return e.min(x,r)},{x:x});if(t){var l=c.expandShapeToKeepDim(u.shape,n);return u.reshape(l)}return u},e.max=function(x,e,t){void 0===e&&(e=null),void 0===t&&(t=!1);var n=c.parseAxisParam(e,x.shape),r=n,o=c.getAxesPermutation(r,x.rank);null!=o&&(x=x.transpose(o),r=c.getInnerMostAxes(r.length,x.rank));var u=s.ENV.engine.runKernel(function(e){return e.max(x,r)},{x:x});if(t){var l=c.expandShapeToKeepDim(u.shape,n);return u.reshape(l)}return u},e.argMin=function(x,e){void 0===e&&(e=null);var t=c.parseAxisParam(e,x.shape),n=c.getAxesPermutation(t,x.rank);return null!=n&&(x=x.transpose(n),t=c.getInnerMostAxes(t.length,x.rank)),s.ENV.engine.runKernel(function(e){return e.argMin(x,t)},{x:x})},e.argMax=function(x,e){void 0===e&&(e=null);var t=c.parseAxisParam(e,x.shape),n=c.getAxesPermutation(t,x.rank);return null!=n&&(x=x.transpose(n),t=c.getInnerMostAxes(t.length,x.rank)),s.ENV.engine.runKernel(function(e){return e.argMax(x,t)},{x:x})},e.moments=function(x,e,t){void 0===e&&(e=null),void 0===t&&(t=!1);var n=c.parseAxisParam(e,x.shape),r=x.mean(n,t),o=r.shape;return t||(o=c.expandShapeToKeepDim(r.shape,n)),{mean:r,variance:x.toFloat().sub(r.reshape(o)).square().mean(n,t)}},r([o.doc({heading:"Operations",subheading:"Reduction"}),d.operation],e,"logSumExp",null),r([o.doc({heading:"Operations",subheading:"Reduction"}),d.operation],e,"sum",null),r([o.doc({heading:"Operations",subheading:"Reduction"}),d.operation],e,"mean",null),r([o.doc({heading:"Operations",subheading:"Reduction"}),d.operation],e,"min",null),r([o.doc({heading:"Operations",subheading:"Reduction"}),d.operation],e,"max",null),r([o.doc({heading:"Operations",subheading:"Reduction"}),d.operation],e,"argMin",null),r([o.doc({heading:"Operations",subheading:"Reduction"}),d.operation],e,"argMax",null),r([o.doc({heading:"Operations",subheading:"Normalization"}),d.operation],e,"moments",null),e}()},UdGD:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("vurQ"),s=n("qmZh"),u=n("DjcB"),l=n("yJL4"),c=n("np2E"),d=function(e){function t(t){var n=this;if(null==t&&(t={}),(n=e.call(this,t)||this).dataFormat=null==t.dataFormat?o.imageDataFormat():t.dataFormat,null==t.padding)n.padding=[[1,1],[1,1]];else if("number"==typeof t.padding)n.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,2!==t.padding.length)throw new l.ValueError("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+t.padding.length+" array.");var r=void 0,s=void 0;if("number"==typeof t.padding[0])r=[t.padding[0],t.padding[0]],s=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,2!==t.padding[0].length)throw new l.ValueError("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+t.padding[0].length+" array.");if(r=t.padding[0],2!==t.padding[1].length)throw new l.ValueError("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+t.padding[1].length+" array.");s=t.padding[1]}n.padding=[r,s]}return n.inputSpec=[new u.InputSpec({ndim:4})],n}return r(t,e),t.prototype.computeOutputShape=function(e){return e=c.getExactlyOneShape(e),"channelsFirst"===this.dataFormat?[e[0],e[1],null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null]:[e[0],null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,e[3]]},t.prototype.call=function(e,t){return s.spatial2dPadding(c.getExactlyOneTensor(e),this.padding,this.dataFormat)},t.prototype.getConfig=function(){var t={padding:this.padding,dataFormat:this.dataFormat},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(u.Layer);t.ZeroPadding2D=d,c.ClassNameMap.register("ZeroPadding2D",d)},Uujx:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClipProgram=function(e,t,n){this.variableNames=["A"],this.outputShape=e;var r=t.toFixed(20),o=n.toFixed(20);this.userCode="\n      void main() {\n        float value = getAAtOutCoords();\n        if (isNaN(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, "+r+", "+o+"));\n      }\n    "}},V6aD:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("9Nf/"),o=n("t41L");t.tidy=o.Tracking.tidy,t.keep=o.Tracking.keep,t.dispose=o.Tracking.dispose,t.time=o.Tracking.time,t.grad=r.Gradients.grad,t.valueAndGrad=r.Gradients.valueAndGrad,t.grads=r.Gradients.grads,t.valueAndGrads=r.Gradients.valueAndGrads,t.variableGrads=r.Gradients.variableGrads,t.customGrad=r.Gradients.customGrad},VFyW:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("5WUj"),s=n("qmZh"),u=n("lbmW"),l=n("DjcB"),c=n("yJL4"),d=n("TPCB"),h=n("Q1Fz"),p=n("np2E"),g=function(e){function t(t){var n=e.call(this,t)||this;return n.supportsMasking=!0,n.axis=null==t.axis?-1:t.axis,n.momentum=null==t.momentum?.99:t.momentum,n.epsilon=null==t.epsilon?.001:t.epsilon,n.center=null==t.center||t.center,n.scale=null==t.scale||t.scale,n.betaInitializer=d.getInitializer(t.betaInitializer||"zeros"),n.gammaInitializer=d.getInitializer(t.gammaInitializer||"ones"),n.movingMeanInitializer=d.getInitializer(t.movingMeanInitializer||"zeros"),n.movingVarianceInitializer=d.getInitializer(t.movingVarianceInitializer||"ones"),n.betaConstraint=u.getConstraint(t.betaConstraint),n.gammaConstraint=u.getConstraint(t.gammaConstraint),n.betaRegularizer=h.getRegularizer(t.betaRegularizer),n.gammaRegularizer=h.getRegularizer(t.gammaRegularizer),n}return r(t,e),t.prototype.build=function(e){e=p.getExactlyOneShape(e);var t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new c.ValueError("Axis "+t+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(e)+".");this.inputSpec=[new l.InputSpec({ndim:e.length,axes:(r={},r[t]=n,r)})];var r,o=[n];this.scale&&(this.gamma=this.addWeight("gamma",o,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",o,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",o,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",o,null,this.movingVarianceInitializer,null,!1),this.built=!0},t.prototype.call=function(e,t){var n=this,r=null!=t.training&&t.training,u=p.getExactlyOneTensor(e),l=s.shape(u),d=l.length,h=o.range(d),g=this.axis>=0?this.axis:this.axis+d;h.splice(g,1);var m=p.pyListRepeat(1,d);m[g]=l[g];var v=h.slice();v.sort();var _=!o.isEqual(v,o.range(d).slice(0,d-1));if(!r)return function(){if(_){var e=s.reshape(n.movingMean.read(),m),t=s.reshape(n.movingVariance.read(),m),r=n.center?s.reshape(n.beta.read(),m):null,o=n.scale?s.reshape(n.gamma.read(),m):null;return s.batchNormalization(u,e,t,r,o,n.epsilon)}return s.batchNormalization(u,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();throw new c.NotImplementedError("BatchNormalization.call() has not been implemented for training mode yet.")},t.prototype.getConfig=function(){var t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:d.serializeInitializer(this.betaInitializer),gammaInitializer:d.serializeInitializer(this.gammaInitializer),movingMeanInitializer:d.serializeInitializer(this.movingMeanInitializer),movingVarianceInitializer:d.serializeInitializer(this.movingVarianceInitializer),betaRegularizer:h.serializeRegularizer(this.betaRegularizer),gammaRegularizer:h.serializeRegularizer(this.gammaRegularizer),betaConstraint:u.serializeConstraint(this.betaConstraint),gammaConstraint:u.serializeConstraint(this.gammaConstraint)},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(l.Layer);t.BatchNormalization=g,p.ClassNameMap.register("BatchNormalization",g)},VKbu:function(e,t,n){"use strict";var r=n("TToO").__extends,o=n("TToO").__decorate,s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function u(value){try{c(r.next(value))}catch(e){s(e)}}function l(value){try{c(r.throw(value))}catch(e){s(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,l)}c((r=r.apply(e,t||[])).next())})},u=this&&this.__generator||function(e,t){var f,y,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(f)throw new TypeError("Generator is already executing.");for(;o;)try{if(f=1,y&&(n=y[2&r[0]?"return":r[0]?"throw":"next"])&&!(n=n.call(y,r[1])).done)return n;switch(y=0,n&&(r=[0,n.value]),r[0]){case 0:case 1:n=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,y=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){o.label=r[1];break}if(6===r[0]&&o.label<n[1]){o.label=n[1],n=r;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(r);break}n[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],y=0}finally{f=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var l=n("JV7f"),c=n("qmZh"),d=n("DjcB"),h=n("MZV5"),p=n("yJL4"),g=n("AQHg"),m=n("np2E"),v=n("g4zD");function _(e,t){return s(this,void 0,void 0,function(){var n,r,o,s;return u(this,function(u){switch(u.label){case 0:return null!=(n=e.modelTopology).model_config&&(n=n.model_config),r=v.convertPythonicToTs(n),o=g.deserialize(r,t),null==e.weightsManifest?[3,2]:[4,l.loadWeights(e.weightsManifest,e.pathPrefix,o.weights.map(function(e){return e.name}))];case 1:s=u.sent(),o.loadWeights(s,null,!0),u.label=2;case 2:return[2,o]}})})}t.modelFromJSON=_,t.loadModelInternal=function(e){return s(this,void 0,void 0,function(){var t;return u(this,function(n){switch(n.label){case 0:return[4,fetch(e)];case 1:return[4,n.sent().json()];case 2:if(null==(t=n.sent()).modelTopology)throw new p.ValueError('Missing field "modelTopology" from model JSON at path'+e);if(null==t.weightsManifest)throw new p.ValueError('Missing field "weightsManifest" from model JSON at path'+e);return t.pathPrefix=e.substring(0,e.lastIndexOf("/")),[2,_(t)]}})})};var w=function(e){function t(t){var n=e.call(this,{inputs:[],outputs:[]})||this;if(t=t||{},n.trainable=!0,n._updatable=!0,n.built=!1,n.name=null!=t.name?t.name:c.getUid("sequential_"),null!=t.layers)for(var r=0,o=t.layers;r<o.length;r++)n.add(o[r]);return n}return r(t,e),n=t,t.prototype.add=function(e){if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new p.ValueError("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var x=d.Input({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(x)}if(1!==e.inboundNodes.length)throw new p.ValueError("A layer added to a Sequential model must not already be connected somewhere else. Model received layer "+e.name+" which has "+e.inboundNodes.length+" pre-existing inbound connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new p.ValueError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=d.getSourceInputs(this.outputs[0]),new d.Node({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:m.pyListRepeat(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(function(x){return x.shape}),outputShapes:this.outputs[0].shape})}else{var t=e.apply(this.outputs[0]);if(Array.isArray(t))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.outputs=[t],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1},t.prototype.pop=function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},t.prototype.call=function(e,t){return null==this.model&&this.build(),this.model.call(e,t)},t.prototype.build=function(e){if(0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new h.Model({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.model.updatable=this.updatable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},t.prototype.setWeights=function(weights){null==this.model&&this.build(),this.model.setWeights(weights)},Object.defineProperty(t.prototype,"updatable",{get:function(){return this._updatable},set:function(value){this.built&&(this.model.updatable=value),this._updatable=value},enumerable:!0,configurable:!0}),t.prototype.evaluate=function(x,y,e){if(void 0===e&&(e={}),!this.built)throw new p.RuntimeError("The model needs to be compiled before being used.");return this.model.evaluate(x,y,e)},t.prototype.predict=function(x,e){return void 0===e&&(e={}),null==this.model&&this.build(),this.model.predict(x,e)},t.prototype.predictOnBatch=function(x){return null==this.model&&this.build(),this.model.predictOnBatch(x)},t.prototype.compile=function(e){this.build(),this.model.compile(e),this.optimizer=this.model.optimizer,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},t.prototype.fit=function(x,y,e){return void 0===e&&(e={}),s(this,void 0,void 0,function(){return u(this,function(t){if(!this.built)throw new p.RuntimeError("The model needs to be compiled before being used.");return[2,this.model.fit(x,y,e)]})})},t.fromConfig=function(e,t){var r=new e({});if(!(r instanceof n))throw new p.ValueError("Sequential.fromConfig called on non-Sequential input: "+r);if(!(t instanceof Array))throw new p.ValueError("Sequential.fromConfig called without an array of configs");if(null==t[0].className||"Merge"===t[0].className)throw new p.ValueError("Legacy serialization format not supported yet.");for(var o=0,s=t;o<s.length;o++){var u=g.deserialize(s[o]);r.add(u)}return r},o([l.doc({heading:"Models",subheading:"Classes"})],t.prototype,"add",null),o([l.doc({heading:"Models",subheading:"Classes",configParamIndices:[2]})],t.prototype,"evaluate",null),o([l.doc({heading:"Models",subheading:"Classes",configParamIndices:[1]})],t.prototype,"predict",null),o([l.doc({heading:"Models",subheading:"Classes",configParamIndices:[2]})],t.prototype,"fit",null),n=o([l.doc({heading:"Models",subheading:"Classes"})],t);var n}(h.Model);t.Sequential=w,m.ClassNameMap.register("Sequential",w)},VOQS:function(e,t,n){(function(e){var r;!function(e,o,s){function u(f,e){return e.c=f.c,e.s0=f.s0,e.s1=f.s1,e.s2=f.s2,e}function l(e,t){var n=new function(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var i=0;i<e.length;i++){var n=.02519603282416938*(t+=e.charCodeAt(i));n-=t=n>>>0,t=(n*=t)>>>0,t+=4294967296*(n-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}(e),r=t&&t.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+1.1102230246251565e-16*(2097152*o()|0)},o.quick=o,r&&("object"==typeof r&&u(r,n),o.state=function(){return u(n,{})}),o}o&&o.exports?o.exports=l:n("LGuY")&&n("nErl")?void 0===(r=(function(){return l}).call(t,n,t,o))||(o.exports=r):this.alea=l}(0,"object"==typeof e&&e,n("LGuY"))}).call(t,n("3IRH")(e))},VSJw:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("/u4k");t.ReverseProgram=function(){return function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,1!==n){var o=e.map(function(n,i){return function(i){return-1!==t.indexOf(i)&&1!==e[i]?e[i]+" - coords["+i+"] - 1":"coords["+i+"]"}(i)}).join(","),s=r.getCoordsDataType(n);this.userCode="\n      void main() {\n        "+s+" coords = getOutputCoords();\n        setOutput(getX("+o+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+e[0]+" - coord - 1));\n        }\n      "}}()},VUgH:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("dMOq");t.area={vgMark:"area",encodeEntry:function(e){return r({},o.baseEncodeEntry(e,{size:"ignore",orient:"include"}),o.pointPosition("x",e,"zeroOrMin"),o.pointPosition("y",e,"zeroOrMin"),o.pointPosition2(e,"zeroOrMin"))}}},VYUM:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("xdLA"),s=n("utsZ"),u=n("gqjM"),l=n("zEzE"),c=n("efV4"),d=n("dMOq"),h=n("KIOn");t.text={vgMark:"text",encodeEntry:function(e){var t=e.config,n=e.encoding,p=e.height,g=e.markDef,m=n.text;return r({},d.baseEncodeEntry(e,{size:"ignore",orient:"ignore"}),d.pointPosition("x",e,function(e,t){return u.isFieldDef(t)&&t.type===l.QUANTITATIVE?{field:{group:"width"},offset:-5}:{value:e.scale.textXRangeStep/2}}(t,m)),d.pointPosition("y",e,h.mid(p)),d.text(e),d.nonPosition("size",e,r({},g.size?{defaultValue:g.size}:{},{vgChannel:"fontSize"})),d.valueIfDefined("align",function(e,t,n){if(void 0===(e.align||c.getMarkConfig("align",e,n)))return s.channelHasField(t,o.X)||s.channelHasField(t,o.LONGITUDE)?"center":"right"}(e.markDef,n,t)))}}},W2nU:function(e,t){var n,r,o=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function l(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(e){r=u}}();var c,d=[],h=!1,p=-1;function g(){h&&c&&(h=!1,c.length?d=c.concat(d):p=-1,d.length&&m())}function m(){if(!h){var e=l(g);h=!0;for(var t=d.length;t;){for(c=d,d=[];++p<t;)c&&c[p].run();p=-1,t=d.length}c=null,h=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function v(e,t){this.fun=e,this.array=t}function _(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];d.push(new v(e,t)),1!==d.length||h||l(m)},v.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=_,o.addListener=_,o.once=_,o.off=_,o.removeListener=_,o.removeAllListeners=_,o.emit=_,o.prependListener=_,o.prependOnceListener=_,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},WPJw:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("JV7f"),o=n("z2hB");t.castTensor=function(x,e,t){if(!r.util.hasEncodingLoss(x.dtype,e))return r.Tensor.make(x.shape,{dataId:x.dataId},e);if("int32"===e)return t.int(x);if("bool"===e)return t.notEqual(x,o.ArrayOps.scalar(0,x.dtype));throw new Error("Error in Cast: unknown dtype argument ("+e+")")},t.reshapeTensor=function(x,e){return r.Tensor.make(e,{dataId:x.dataId},x.dtype)}},Wa0b:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMarkSpecificConfigMixins=function(e,t){var n,value=e[t];return void 0!==value?((n={})[t]={value:value},n):{}}},Wriu:function(e,t){e.exports={name:"vega-lite",author:'Jeffrey Heer, Dominik Moritz, Kanit "Ham" Wongsuphasawat',version:"2.3.1",collaborators:["Kanit Wongsuphasawat <kanitw@gmail.com> (http://kanitw.yellowpigz.com)","Dominik Moritz <domoritz@cs.washington.edu> (https://www.domoritz.de)","Jeffrey Heer <jheer@uw.edu> (http://jheer.org)"],homepage:"https://vega.github.io/vega-lite/",description:"Vega-Lite is a concise high-level language for interactive visualization.",main:"build/src/index.js",unpkg:"build/vega-lite.min.js",jsdelivr:"build/vega-lite.min.js",types:"typings/vega-lite.d.ts",bin:{vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2vg:"./bin/vl2vg"},directories:{test:"test"},scripts:{pretsc:"mkdir -p build && rm -rf build/*/** && cp package.json build/",prebuild:"mkdir -p build/site build/test-gallery",build:"npm run build:only","build:only":"tsc && cp package.json build && browserify src/index.ts -p tsify -d -s vl | exorcist build/vega-lite.js.map > build/vega-lite.js",postbuild:"node node_modules/uglify-js/bin/uglifyjs build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && npm run schema","build:examples":"npm run data && npm run build:only && npm run build:examples-only","build:examples-only":"npm run build:example && npm run build:examples-normalized","build:examples-normalized":"rm -f examples/specs/normalized/*.vl.json && scripts/build-normalized-examples","build:example":"TZ=America/Los_Angeles scripts/build-examples.sh","build:toc":"bundle exec jekyll build -q && scripts/generate-toc","build:site":"browserify site/static/main.ts -p [tsify -p site] -d | exorcist build/site/main.js.map > build/site/main.js","build:versions":"scripts/update-version.sh","build:test-gallery":"browserify test-gallery/main.ts -p [tsify -p test-gallery] -d > build/test-gallery/main.js","check:examples":"scripts/check-examples.sh","check:schema":"scripts/check-schema.sh",clean:"rm -rf build && rm -f vega-lite.* & find -E src test site examples -regex '.*\\.(js|js.map|d.ts)' -delete && rm -f examples/compiled/*.png && find site/examples ! -name 'index.md' -type f -exec rm -f {} +",data:"rsync -r node_modules/vega-datasets/data/* data",deploy:"scripts/deploy.sh","deploy:gh":"scripts/deploy-gh.sh","deploy:schema":"scripts/deploy-schema.sh",prestart:"npm run data && npm run build && scripts/index-examples",start:"nodemon -x 'npm run build:test-gallery' & browser-sync start --server --files 'build/test-gallery/main.js' --index 'test-gallery/index.html'",poststart:"rm examples/all-examples.json",preschema:"npm run prebuild",schema:"ts-json-schema-generator --path tsconfig.json --type TopLevelSpec > build/vega-lite-schema.json && npm run renameschema && cp build/vega-lite-schema.json _data/",renameschema:"scripts/rename-schema.sh",presite:"npm run prebuild && npm run data && npm run build:site && npm run build:toc && npm run build:versions && scripts/create-example-pages",site:"bundle exec jekyll serve --incremental",lint:"tslint -p .",test:"npm run build:only && npm run test:only && npm run test:runtime && npm run lint",posttest:"npm run schema && npm run data && npm run mocha:examples","test:nocompile":"npm run test:only && npm run test:runtime && npm run lint && npm run mocha:examples","test:only":"nyc --reporter=html --reporter=text-summary npm run mocha:test","test:runtime":"TZ=America/Los_Angeles wdio wdio.conf.js","test:runtime:generate":"rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true npm run test:runtime","test:debug":"tsc && mocha --recursive --debug-brk --inspect build/test","test:debug-examples":"tsc && npm run schema && mocha --recursive --debug-brk --inspect build/examples","mocha:test":"mocha --require source-map-support/register --reporter dot --recursive build/test","mocha:examples":"mocha --require source-map-support/register --reporter dot --recursive build/examples",codecov:"nyc report --reporter=json && codecov -f coverage/*.json","watch:build":"watchify src/index.ts -p tsify -v -d -s vl -o 'exorcist build/vega-lite.js.map > build/vega-lite.js'","watch:test":"nodemon -x 'npm test'",watch:"nodemon -x 'npm run build && npm run test:nocompile' # already ran schema in build"},repository:{type:"git",url:"https://github.com/vega/vega-lite.git"},license:"BSD-3-Clause",bugs:{url:"https://github.com/vega/vega-lite/issues"},devDependencies:{"@types/chai":"^4.1.2","@types/d3":"^4.13.0","@types/highlight.js":"^9.12.2","@types/mkdirp":"^0.5.2","@types/mocha":"^2.2.48","@types/node":"^9.4.7","@types/webdriverio":"^4.10.0",ajv:"^6.2.1","browser-sync":"^2.23.6","browserify-shim":"^3.8.14",browserify:"^16.1.1",chai:"^4.1.2",cheerio:"^1.0.0-rc.2",chromedriver:"^2.36.0",codecov:"^3.0.0",d3:"^4.13.0",exorcist:"^1.0.1","highlight.js":"^9.12.0",mkdirp:"^0.5.1",mocha:"^5.0.4",nodemon:"^1.17.1",nyc:"^11.4.1","source-map-support":"^0.5.3","svg2png-many":"^0.0.7","ts-json-schema-generator":"^0.21.0","ts-node":"^5.0.1",tsify:"^3.0.4","tslint-eslint-rules":"^5.1.0",tslint:"5.9.1",typescript:"^2.7.2","uglify-js":"^3.3.14","vega-datasets":"^1.18.0","vega-embed":"^3.1.1","vega-tooltip":"^0.6.1",vega:"^3.2.1",watchify:"^3.11.0","wdio-chromedriver-service":"^0.1.2","wdio-dot-reporter":"0.0.9","wdio-mocha-framework":"^0.5.13","wdio-static-server-service":"^1.0.1",webdriverio:"^4.12.0","yaml-front-matter":"^4.0.0"},dependencies:{"@types/json-stable-stringify":"^1.0.32","vega-typings":"^0.2.11","json-stable-stringify":"^1.0.1",tslib:"^1.9.0","vega-event-selector":"^2.0.0","vega-util":"^1.7.0",yargs:"^11.0.0"}}},XFvI:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("XPNO");function o(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function s(e,t){if(!e)throw new Error(t)}function u(e,t){if(void 0===t&&(t=[]),Array.isArray(e))for(var i=0;i<e.length;++i)u(e[i],t);else t.push(e);return t}function l(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}function c(e){if("float32"===e)return t.NAN_FLOAT32;if("int32"===e)return t.NAN_INT32;if("bool"===e)return t.NAN_BOOL;throw new Error("Unknown dtype "+e)}function d(e,n){if(isNaN(e))return!0;if("float32"===n)return!1;if("int32"===n)return e===t.NAN_INT32;if("bool"===n)return e===t.NAN_BOOL;throw new Error("Unknown dtype "+n)}function h(a){return a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array}function p(e){if(null==e)return[];if(e instanceof r.Tensor)return[e];var t,n=[],o=e;if(t=o,!Array.isArray(t)&&"object"!=typeof t)return[];for(var k in o){var s=u(o[k]).filter(function(x){return x instanceof r.Tensor});n.push.apply(n,s)}return n}t.shuffle=o,t.clamp=function(e,x,t){return Math.max(e,Math.min(x,t))},t.randUniform=function(a,b){return Math.random()*(b-a)+a},t.distSquared=function(a,b){for(var e=0,i=0;i<a.length;i++){var t=Number(a[i])-Number(b[i]);e+=t*t}return e},t.assert=s,t.assertShapesMatch=function(e,t,n){void 0===n&&(n=""),s(l(e,t),n+"Shapes "+e+" and "+t+" must match")},t.assertTypesMatch=function(a,b){s(a.dtype===b.dtype,"The dtypes of the first ("+a.dtype+") and second ("+b.dtype+") input must match")},t.flatten=u,t.inferShape=function(e){if(h(e))return[e.length];if(!Array.isArray(e))return[];for(var t=[];e instanceof Array;)t.push(e.length),e=e[0];return t},t.sizeFromShape=function(e){if(0===e.length)return 1;for(var t=e[0],i=1;i<e.length;i++)t*=e[i];return t},t.isScalarShape=function(e){return 0===e.length},t.arraysEqual=l,t.isInt=function(a){return a%1==0},t.tanh=function(x){if(null!=Math.tanh)return Math.tanh(x);if(x===1/0)return 1;if(x===-1/0)return-1;var e=Math.exp(2*x);return(e-1)/(e+1)},t.sizeToSquarishShape=function(e){for(var a=Math.floor(Math.sqrt(e));a>1;--a)if(e%a==0)return[a,e/a];return[1,e]},t.createShuffledIndices=function(e){for(var t=new Uint32Array(e),i=0;i<e;++i)t[i]=i;return o(t),t},t.rightPad=function(a,e){return e<=a.length?a:a+" ".repeat(e-a.length)},t.repeatedTry=function(e,t,n){return void 0===t&&(t=function(e){return 0}),new Promise(function(r,o){var s=0,u=function(){if(e())r();else{var l=t(++s);null!=n&&s>=n?o():setTimeout(u,l)}};setTimeout(u,0)})},t.getQueryParams=function(e){var t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return function(e,t,value){e[decodeURIComponent(n[0])]=decodeURIComponent(value||"")}(t,0,n[1]),n.join("=")}),t},t.inferFromImplicitShape=function(e,t){for(var n=1,r=-1,i=0;i<e.length;++i)if(e[i]>0)n*=e[i];else if(-1===e[i]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(e[i]<=0)throw Error("Shapes can not be <= 0. Found "+e[i]+" at dim "+i);if(-1===r){if(t>0&&t!==n)throw Error("Size ("+t+") must match the product of shape "+e);return e}if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var o=e.slice();return o[r]=t/n,o},t.NAN_INT32=1<<31,t.NAN_BOOL=255,t.NAN_FLOAT32=NaN,t.getNaN=c,t.isValNaN=d,t.squeezeShape=function(e,t){for(var n=[],r=[],j=0,i=0;i<e.length;++i){if(null!=t){if(t[j]===i&&e[i]>1)throw new Error("Can't squeeze axis "+i+" since its dim '"+e[i]+"' is not 1");(null==t[j]||t[j]>i)&&1===e[i]&&(n.push(e[i]),r.push(i)),t[j]<=i&&j++}e[i]>1&&(n.push(e[i]),r.push(i))}return{newShape:n,keptDims:r}},t.getTypedArrayFromDType=function(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n},t.isTensorInList=function(e,t){for(var i=0;i<t.length;i++)if(t[i].id===e.id)return!0;return!1},t.checkForNaN=function(e,t,n){for(var i=0;i<e.length;i++)if(d(e[i],t))throw Error("The result of the '"+n+"' has NaNs.")},t.flattenNameArrayMap=function(e,t){var n=[];if(e instanceof r.Tensor)n.push(e);else for(var o=e,i=0;i<t.length;i++)n.push(o[t[i]]);return n},t.unflattenToNameArrayMap=function(e,t){if(e.length!==t.length)throw new Error("Cannot unflatten Tensor[], keys and arrays are not of same length.");for(var n={},i=0;i<e.length;i++)n[e[i]]=t[i];return n},t.hasEncodingLoss=function(e,t){return!("float32"===t||"int32"===t&&"float32"!==e||"bool"===t&&"bool"===e)},t.copyTypedArray=function(e,t){if(null==t||"float32"===t)return new Float32Array(e);if("int32"===t){for(var n=new Int32Array(e.length),i=0;i<n.length;++i)n[i]=d(o=e[i],"int32")?c("int32"):o;return n}if("bool"===t){var r=new Uint8Array(e.length);for(i=0;i<r.length;++i){var o;d(o=e[i],"bool")?r[i]=c("bool"):0!==Math.round(o)&&(r[i]=1)}return r}throw new Error("Unknown data type "+t)},t.isTypedArray=h,t.bytesPerElement=function(e){if("float32"===e||"int32"===e)return 4;if("bool"===e)return 1;throw new Error("Unknown dtype "+e)},t.isFunction=function(f){return!!(f&&f.constructor&&f.call&&f.apply)},t.extractTensorsFromContainer=function(e){return p(e)},t.extractTensorsFromAny=p},XGtb:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.aggregate=n("dQN6"),t.axis=n("2CTY"),t.bin=n("NDl6"),t.channel=n("xdLA"),t.compositeMark=n("Td0G");var r=n("oTxn");t.compile=r.compile,t.config=n("77UE"),t.data=n("8Wnz"),t.datetime=n("1dKF"),t.encoding=n("utsZ"),t.facet=n("Rnp6"),t.fieldDef=n("gqjM"),t.legend=n("JFC7"),t.mark=n("D6ZG"),t.scale=n("rxHH"),t.sort=n("7AlL"),t.spec=n("ooBR"),t.stack=n("6xrs"),t.timeUnit=n("jfp2"),t.transform=n("ODV5"),t.type=n("zEzE"),t.util=n("Xq4m"),t.validate=n("nkjP"),t.version=n("Wriu").version},XPNO:function(e,t,n){"use strict";var r=n("TToO").__extends,o=n("TToO").__decorate,s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function u(value){try{c(r.next(value))}catch(e){s(e)}}function l(value){try{c(r.throw(value))}catch(e){s(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,l)}c((r=r.apply(e,t||[])).next())})},u=this&&this.__generator||function(e,t){var f,y,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(f)throw new TypeError("Generator is already executing.");for(;o;)try{if(f=1,y&&(n=y[2&r[0]?"return":r[0]?"throw":"next"])&&!(n=n.call(y,r[1])).done)return n;switch(y=0,n&&(r=[0,n.value]),r[0]){case 0:case 1:n=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,y=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){o.label=r[1];break}if(6===r[0]&&o.label<n[1]){o.label=n[1],n=r;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(r);break}n[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],y=0}finally{f=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var l=n("w3wY"),c=n("v/P2"),d=n("m3RX"),h=n("jb1O"),p=n("XFvI");t.TensorBuffer=function(){function e(e,t,n){if(this.shape=e,this.dtype=t,this.values=n,null!=n){var r=n.length,o=p.sizeFromShape(e);p.assert(r===o,"Length of values '"+r+"' does not match the size inferred by the shape '"+o+"'")}this.values=n||p.getTypedArrayFromDType(t,p.sizeFromShape(e)),this.strides=v(e),this.size=p.sizeFromShape(e)}return e.prototype.set=function(value){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];0===e.length&&(e=[0]),p.assert(e.length===this.rank,"The number of provided coordinates ("+e.length+") must match the rank ("+this.rank+")");var n=this.locToIndex(e);this.values[n]=value},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];0===e.length&&(e=[0]);for(var n=e[e.length-1],i=0;i<e.length-1;++i)n+=this.strides[i]*e[i];return this.values[n]},e.prototype.locToIndex=function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],i=0;i<e.length-1;++i)t+=this.strides[i]*e[i];return t},e.prototype.indexToLoc=function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),i=0;i<t.length-1;++i)t[i]=Math.floor(e/this.strides[i]),e-=t[i]*this.strides[i];return t[t.length-1]=e,t},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return g.make(this.shape,{values:this.values},this.dtype)},o([l.doc({heading:"Tensors",subheading:"Creation"})],e.prototype,"set",null),o([l.doc({heading:"Tensors",subheading:"Creation"})],e.prototype,"get",null),o([l.doc({heading:"Tensors",subheading:"Creation"})],e.prototype,"toTensor",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e)}();var g=function(){function e(e,n,r,o){this.isDisposed=!1,this.size=p.sizeFromShape(e),null!=r&&p.assert(this.size===r.length,"Constructing tensor of shape ("+this.size+") should match the length of values ("+r.length+")"),this.shape=e,this.dtype=n||"float32",this.strides=v(e),this.dataId=null!=o?o:{},this.id=t.nextId++,this.rankType=this.rank<5?this.rank.toString():"higher",c.ENV.engine.registerTensor(this),null!=r&&c.ENV.engine.write(this.dataId,r)}return t=e,e.make=function(e,n,r){return new t(e,r,n.values,n.dataId)},e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),p.assert(1===this.size,"The array must have only 1 element."),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},e.prototype.as3D=function(e,t,n){return this.throwIfDisposed(),this.reshape([e,t,n])},e.prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),this.reshape([e,t,n,r])},e.prototype.asType=function(e){return this.throwIfDisposed(),d.cast(this,e)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.throwIfDisposed(),0===e.length&&(e=[0]);for(var n=e[e.length-1],i=0;i<e.length-1;++i)n+=this.strides[i]*e[i];return this.dataSync()[n]},e.prototype.buffer=function(){return d.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.data=function(){return s(this,void 0,void 0,function(){return u(this,function(e){return this.throwIfDisposed(),[2,c.ENV.engine.read(this.dataId)]})})},e.prototype.dataSync=function(){return this.throwIfDisposed(),c.ENV.engine.readSync(this.dataId)},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,c.ENV.engine.disposeTensor(this))},e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(e){return void 0===e&&(e=!1),d.print(this,e)},e.prototype.reshape=function(e){return this.throwIfDisposed(),d.reshape(this,e)},e.prototype.reshapeAs=function(x){return this.throwIfDisposed(),this.reshape(x.shape)},e.prototype.expandDims=function(e){return void 0===e&&(e=0),d.expandDims(this,e)},e.prototype.squeeze=function(e){return this.throwIfDisposed(),d.squeeze(this,e)},e.prototype.clone=function(){return this.throwIfDisposed(),d.clone(this)},e.prototype.toString=function(){return h.tensorToString(this,!0)},e.prototype.tile=function(e){return this.throwIfDisposed(),d.tile(this,e)},e.prototype.gather=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),d.gather(this,e,t)},e.prototype.matMul=function(b,e,t){return void 0===e&&(e=!1),void 0===t&&(t=!1),this.throwIfDisposed(),d.matMul(this,b,e,t)},e.prototype.norm=function(e,t,n){return void 0===e&&(e="euclidean"),void 0===t&&(t=null),void 0===n&&(n=!1),this.throwIfDisposed(),d.norm(this,e,t,n)},e.prototype.slice=function(e,t){return this.throwIfDisposed(),d.slice(this,e,t)},e.prototype.reverse=function(e){return this.throwIfDisposed(),d.reverse(this,e)},e.prototype.concat=function(x,e){return void 0===e&&(e=0),this.throwIfDisposed(),d.concat([this,x],e)},e.prototype.stack=function(x,e){return void 0===e&&(e=0),d.stack([this,x],e)},e.prototype.pad=function(e,t){return void 0===t&&(t=0),d.pad(this,e,t)},e.prototype.batchNormalization=function(e,t,n,r,o){return void 0===n&&(n=.001),this.throwIfDisposed(),d.batchNormalization(this,e,t,n,r,o)},e.prototype.logSumExp=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),d.logSumExp(this,e,t)},e.prototype.sum=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),d.sum(this,e,t)},e.prototype.mean=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),d.mean(this,e,t)},e.prototype.min=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),d.min(this,e,t)},e.prototype.max=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),d.max(this,e,t)},e.prototype.argMin=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),d.argMin(this,e)},e.prototype.argMax=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),d.argMax(this,e)},e.prototype.cast=function(e){return this.throwIfDisposed(),d.cast(this,e)},e.prototype.add=function(x){return this.throwIfDisposed(),d.add(this,x)},e.prototype.addStrict=function(x){return this.throwIfDisposed(),d.addStrict(this,x)},e.prototype.sub=function(x){return this.throwIfDisposed(),d.sub(this,x)},e.prototype.subStrict=function(x){return this.throwIfDisposed(),d.subStrict(this,x)},e.prototype.pow=function(e){return this.throwIfDisposed(),d.pow(this,e)},e.prototype.powStrict=function(e){return this.throwIfDisposed(),d.powStrict(this,e)},e.prototype.mul=function(x){return this.throwIfDisposed(),d.mul(this,x)},e.prototype.mulStrict=function(x){return this.throwIfDisposed(),d.mulStrict(this,x)},e.prototype.div=function(x){return this.throwIfDisposed(),d.div(this,x)},e.prototype.divStrict=function(x){return this.throwIfDisposed(),d.divStrict(this,x)},e.prototype.minimum=function(x){return this.throwIfDisposed(),d.minimum(this,x)},e.prototype.minimumStrict=function(x){return this.throwIfDisposed(),d.minimumStrict(this,x)},e.prototype.maximum=function(x){return this.throwIfDisposed(),d.maximum(this,x)},e.prototype.maximumStrict=function(x){return this.throwIfDisposed(),d.maximumStrict(this,x)},e.prototype.squaredDifference=function(x){return this.throwIfDisposed(),d.squaredDifference(this,x)},e.prototype.squaredDifferenceStrict=function(x){return this.throwIfDisposed(),d.squaredDifferenceStrict(this,x)},e.prototype.transpose=function(e){return this.throwIfDisposed(),d.transpose(this,e)},e.prototype.notEqual=function(x){return this.throwIfDisposed(),d.notEqual(this,x)},e.prototype.notEqualStrict=function(x){return this.throwIfDisposed(),d.notEqualStrict(this,x)},e.prototype.less=function(x){return this.throwIfDisposed(),d.less(this,x)},e.prototype.lessStrict=function(x){return this.throwIfDisposed(),d.lessStrict(this,x)},e.prototype.equal=function(x){return this.throwIfDisposed(),d.equal(this,x)},e.prototype.equalStrict=function(x){return this.throwIfDisposed(),d.equalStrict(this,x)},e.prototype.lessEqual=function(x){return this.throwIfDisposed(),d.lessEqual(this,x)},e.prototype.lessEqualStrict=function(x){return this.throwIfDisposed(),d.lessEqualStrict(this,x)},e.prototype.greater=function(x){return this.throwIfDisposed(),d.greater(this,x)},e.prototype.greaterStrict=function(x){return this.throwIfDisposed(),d.greaterStrict(this,x)},e.prototype.greaterEqual=function(x){return this.throwIfDisposed(),d.greaterEqual(this,x)},e.prototype.greaterEqualStrict=function(x){return this.throwIfDisposed(),d.greaterEqualStrict(this,x)},e.prototype.logicalAnd=function(x){return this.throwIfDisposed(),d.logicalAnd(this,x)},e.prototype.logicalOr=function(x){return this.throwIfDisposed(),d.logicalOr(this,x)},e.prototype.logicalXor=function(x){return this.throwIfDisposed(),d.logicalXor(this,x)},e.prototype.where=function(e,x){return this.throwIfDisposed(),d.where(e,this,x)},e.prototype.neg=function(){return this.throwIfDisposed(),d.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),d.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),d.floor(this)},e.prototype.exp=function(){return this.throwIfDisposed(),d.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),d.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),d.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),d.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),d.sqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),d.square(this)},e.prototype.abs=function(){return this.throwIfDisposed(),d.abs(this)},e.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),d.clipByValue(this,e,t)},e.prototype.relu=function(){return this.throwIfDisposed(),d.relu(this)},e.prototype.elu=function(){return this.throwIfDisposed(),d.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),d.selu(this)},e.prototype.leakyRelu=function(e){return void 0===e&&(e=.2),this.throwIfDisposed(),d.leakyRelu(this,e)},e.prototype.prelu=function(e){return this.throwIfDisposed(),d.prelu(this,e)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),d.sigmoid(this)},e.prototype.sin=function(){return this.throwIfDisposed(),d.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),d.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),d.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),d.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),d.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),d.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),d.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),d.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),d.tanh(this)},e.prototype.step=function(e){return void 0===e&&(e=0),this.throwIfDisposed(),d.step(this,e)},e.prototype.softmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),d.softmax(this,e)},e.prototype.resizeBilinear=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),d.image.resizeBilinear(this,e,t)},e.prototype.conv1d=function(e,t,n,r,o,s){return void 0===r&&(r="NWC"),void 0===o&&(o=1),this.throwIfDisposed(),d.conv1d(this,e,t,n,r,o,s)},e.prototype.conv2d=function(e,t,n,r,o,s){return void 0===r&&(r="NHWC"),void 0===o&&(o=[1,1]),this.throwIfDisposed(),d.conv2d(this,e,t,n,r,o,s)},e.prototype.conv2dTranspose=function(e,t,n,r,o){return this.throwIfDisposed(),d.conv2dTranspose(this,e,t,n,r,o)},e.prototype.depthwiseConv2D=function(e,t,n,r,o,s){return void 0===r&&(r="NHWC"),void 0===o&&(o=[1,1]),this.throwIfDisposed(),d.depthwiseConv2d(this,e,t,n,r,o,s)},e.prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),d.avgPool(this,e,t,n,r)},e.prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),d.maxPool(this,e,t,n,r)},e.prototype.minPool=function(e,t,n,r){return this.throwIfDisposed(),d.minPool(this,e,t,n,r)},e.prototype.localResponseNormalization=function(radius,e,t,n,r){return void 0===radius&&(radius=5),void 0===e&&(e=1),void 0===t&&(t=1),void 0===n&&(n=.5),void 0===r&&(r="acrossChannels"),d.localResponseNormalization(this,radius,e,t,n,r)},e.prototype.variable=function(e,t,n){return void 0===e&&(e=!0),this.throwIfDisposed(),m.variable(this,e,t,n)},e.nextId=0,o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"flatten",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"asScalar",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"as1D",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"as2D",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"as3D",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"as4D",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"asType",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"buffer",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"data",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"dataSync",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"dispose",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"toFloat",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"toInt",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"toBool",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"print",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"reshape",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"reshapeAs",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"expandDims",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"squeeze",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"clone",null),o([l.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"toString",null),t=o([l.doc({heading:"Tensors",subheading:"Classes"})],e);var t}();t.Tensor=g;var m=function(e){function t(t,r,o){void 0===r&&(r=!0);var s=e.call(this,t.shape,t.dtype,null,t.dataId)||this;return s.trainable=r,s.name=o,null==s.name&&(s.name=n.nextVarId.toString(),n.nextVarId++),c.ENV.engine.registerVariable(s),s}return r(t,e),n=t,t.variable=function(e,t,r,o){return void 0===t&&(t=!0),null!=o&&o!==e.dtype&&(e=e.asType(o)),new n(e,t,r)},t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!p.arraysEqual(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");c.ENV.engine.disposeTensor(this),this.dataId=e.dataId,c.ENV.engine.registerTensor(this)},t.nextVarId=0,o([l.doc({heading:"Tensors",subheading:"Classes"})],t.prototype,"assign",null),o([l.doc({heading:"Tensors",subheading:"Creation"})],t,"variable",null),n=o([l.doc({heading:"Tensors",subheading:"Classes"})],t);var n}(g);function v(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var i=t-3;i>=0;--i)n[i]=n[i+1]*e[i+1];return n}t.Variable=m,t.variable=m.variable},XSKZ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o,s=function(e,t,n){return r=t||u,o=n||w,O(e.trim()).map(S)},u="view",l="[",c="]",d="{",h="}",p=":",g=",",m="@",v=">",_=/[[\]{}]/,w={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function E(e,i,t,n,r){for(var o,s=0,u=e.length;i<u;++i){if(o=e[i],!s&&o===t)return i;r&&r.indexOf(o)>=0?--s:n&&n.indexOf(o)>=0&&++s}return i}function O(e){for(var t=[],n=0,r=e.length,i=0;i<r;)i=E(e,i,g,l+d,c+h),t.push(e.substring(n,i).trim()),n=++i;if(0===t.length)throw"Empty event selector: "+e;return t}function S(e){return"["===e[0]?function(e){var b,t,n=e.length,i=1;if((i=E(e,i,c,l,c))===n)throw"Empty between selector: "+e;if(2!==(b=O(e.substring(1,i))).length)throw"Between selector must have two elements: "+e;if((e=e.slice(i+1).trim())[0]!==v)throw"Expected '>' after between selector: "+e;return b=b.map(S),(t=S(e.slice(1).trim())).between?{between:b,stream:t}:(t.between=b,t)}(e):function(e){var j,t,n={source:r},s=[],u=[0,0],v=0,w=0,O=e.length,i=0;if(e[O-1]===h){if(!((i=e.lastIndexOf(d))>=0))throw"Unmatched right brace: "+e;try{u=function(e){var a=e.split(g);if(!e.length||a.length>2)throw e;return a.map(function(t){var x=+t;if(x!=x)throw e;return x})}(e.substring(i+1,O-1))}catch(t){throw"Invalid throttle specification: "+e}O=(e=e.slice(0,i).trim()).length,i=0}if(!O)throw e;if(e[0]===m&&(v=++i),(j=E(e,i,p))<O&&(s.push(e.substring(w,j).trim()),w=i=++j),(i=E(e,i,l))===O)s.push(e.substring(w,O).trim());else if(s.push(e.substring(w,i).trim()),t=[],(w=++i)===O)throw"Unmatched left bracket: "+e;for(;i<O;){if((i=E(e,i,c))===O)throw"Unmatched left bracket: "+e;if(t.push(e.substring(w,i).trim()),i<O-1&&e[++i]!==l)throw"Expected left bracket: "+e;w=++i}if(!(O=s.length)||_.test(s[O-1]))throw"Invalid event selector: "+e;return O>1?(n.type=s[1],v?n.markname=s[0].slice(1):o.hasOwnProperty(s[0])?n.marktype=s[0]:n.source=s[0]):n.type=s[0],"!"===n.type.slice(-1)&&(n.consume=!0,n.type=n.type.slice(0,-1)),null!=t&&(n.filter=t),u[0]&&(n.throttle=u[0]),u[1]&&(n.debounce=u[1]),n}(e)}n.d(t,"selector",function(){return s})},XVV2:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version="0.6.1"},Xq4m:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("EbtV"),o=n("Bsgt"),s=n("OAHl");function u(e,t){return e.indexOf(t)>-1}function l(e,t){return e.filter(function(e){return!u(t,e)})}function c(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,o=t;r<o.length;r++)e=d(e,o[r]);return e}function d(e,t){if("object"!=typeof t||null===t)return e;for(var n in t)t.hasOwnProperty(n)&&void 0!==t[n]&&("object"!=typeof t[n]||o.isArray(t[n])||null===t[n]?e[n]=t[n]:"object"!=typeof e[n]||null===e[n]?e[n]=c(o.isArray(t[n].constructor)?[]:{},t[n]):c(e[n],t[n]));return e}function h(e){return JSON.parse(JSON.stringify(e))}t.pick=function(e,t){for(var n={},r=0,o=t;r<o.length;r++){var s=o[r];e.hasOwnProperty(s)&&(n[s]=e[s])}return n},t.omit=function(e,t){for(var n=h(e),r=0,o=t;r<o.length;r++)delete n[o[r]];return n},t.stringify=r,t.hash=function(a){if(o.isNumber(a))return a;var e=o.isString(a)?a:r(a);if(e.length<100)return e;for(var t=0,i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t&=t;return t},t.contains=u,t.without=l,t.union=function(e,t){return e.concat(l(t,e))},t.some=function(e,f){for(var i=0,k=0;k<e.length;k++)if(f(e[k],k,i++))return!0;return!1},t.every=function(e,f){for(var i=0,k=0;k<e.length;k++)if(!f(e[k],k,i++))return!1;return!0},t.flatten=function(e){return[].concat.apply([],e)},t.mergeDeep=c,t.unique=function(e,f){for(var t,n=[],r={},o=0,s=e;o<s.length;o++){var u=s[o];(t=f(u))in r||(r[t]=1,n.push(u))}return n},t.differ=function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t[n]&&e[n]&&t[n]!==e[n])return!0;return!1},t.hasIntersection=function(a,b){for(var e in a)if(e in b)return!0;return!1},t.isNumeric=function(e){return!isNaN(e)},t.differArray=function(e,t){if(e.length!==t.length)return!0;e.sort(),t.sort();for(var i=0;i<e.length;i++)if(t[i]!==e[i])return!0;return!1},t.keys=Object.keys,t.vals=function(x){var e=[];for(var k in x)x.hasOwnProperty(k)&&e.push(x[k]);return e},t.flagKeys=function(f){return t.keys(f)},t.duplicate=h,t.isBoolean=function(b){return!0===b||!1===b},t.varName=function(e){var t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t},t.logicalExpr=function e(t,n){return s.isLogicalNot(t)?"!("+e(t.not,n)+")":s.isLogicalAnd(t)?"("+t.and.map(function(and){return e(and,n)}).join(") && (")+")":s.isLogicalOr(t)?"("+t.or.map(function(t){return e(t,n)}).join(") || (")+")":n(t)},t.deleteNestedProperty=function(e,n){for(var r=!0;n.length>0&&r;){for(var o=e,i=0;i<n.length-1;i++)o=o[n[i]];delete o[n.pop()],0!==t.keys(o).length&&(r=!1)}},t.titlecase=function(e){return e.charAt(0).toUpperCase()+e.substr(1)},t.accessPath=function(e){return"["+o.splitAccessPath(e).map(o.stringValue).join("][")+"]"}},YC5c:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("xdLA"),s=n("8Wnz"),u=n("gqjM"),l=n("D6ZG"),c=n("NKzF"),d=n("zEzE"),h=n("Xq4m"),p=n("OMxB"),g=n("rPAV");t.parseProjection=function e(t){t.component.projection=p.isUnitModel(t)?function(e){var t=e.specifiedProjection,n=e.markDef,c=e.config,h=e.encoding,p=n&&n.type===l.GEOSHAPE,m=h&&o.GEOPOSITION_CHANNELS.some(function(e){return u.isFieldDef(h[e])});if(p||m){var v=[];return[[o.LONGITUDE,o.LATITUDE],[o.LONGITUDE2,o.LATITUDE2]].forEach(function(t){(e.channelHasField(t[0])||e.channelHasField(t[1]))&&v.push({signal:e.getName("geojson_"+v.length)})}),e.channelHasField(o.SHAPE)&&e.fieldDef(o.SHAPE).type===d.GEOJSON&&v.push({signal:e.getName("geojson_"+v.length)}),0===v.length&&v.push(e.requestDataName(s.MAIN)),new g.ProjectionComponent(e.projectionName(!0),r({},c.projection||{},t||{}),[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")],v)}}(t):function(t){if(0!==t.children.length){var n,r=h.every(t.children,function(t){e(t);var r=t.component.projection;if(r){if(n){var o=function(e,t){var n=h.every(c.PROJECTION_PROPERTIES,function(n){return!e.explicit.hasOwnProperty(n)&&!t.explicit.hasOwnProperty(n)||!(!e.explicit.hasOwnProperty(n)||!t.explicit.hasOwnProperty(n)||h.stringify(e.get(n))!==h.stringify(t.get(n)))});if(h.stringify(e.size)===h.stringify(t.size)){if(n)return e;if(h.stringify(e.explicit)===h.stringify({}))return t;if(h.stringify(t.explicit)===h.stringify({}))return e}return null}(n,r);return o&&(n=o),!!o}return n=r,!0}return!0});if(n&&r){var o=t.projectionName(!0),s=new g.ProjectionComponent(o,n.specifiedProjection,n.size,h.duplicate(n.data));return t.children.forEach(function(e){e.component.projection&&(s.data=s.data.concat(e.component.projection.data),e.renameProjection(e.component.projection.get("name"),o),e.component.projection.merged=!0)}),s}}}(t)}},YFgP:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var s=n("Bsgt"),u=n("utsZ"),l=n("utsZ"),c=n("gqjM"),d=n("KMAE"),h=n("Wa0b");function p(e){return!!e.type}t.BOXPLOT="box-plot",t.isBoxPlotDef=p,t.BOXPLOT_STYLES=["boxWhisker","box","boxMid"],t.VL_ONLY_BOXPLOT_CONFIG_PROPERTY_INDEX={box:["size","color","extent"],boxWhisker:["color"],boxMid:["color"]};var g=["x","y","color","detail","opacity","size"];function m(e){return r({},e,{encoding:u.reduce(e.encoding,function(e,n,r){return g.indexOf(r)>-1?e[r]=n:d.warn(d.message.incompatibleChannel(r,t.BOXPLOT)),e},{})})}t.filterUnsupportedChannels=m,t.normalizeBoxPlot=function(e,n){var u=(e=m(e)).mark,g=e.selection,v=o(e,["mark","encoding","selection","projection"]),_=void 0;s.isNumber(n.box.extent)&&(_=n.box.extent),p(u)&&u.extent&&"min-max"===u.extent&&(_=void 0);var w,E,O,S,A=function(e,n,r){var s=function(e,n){var r,s,u=e.encoding;if(o(e,["mark","encoding","projection"]),"vertical"===n?(s="y",r=u.y):(s="x",r=u.x),r&&r.aggregate){var l=r.aggregate,c=o(r,["aggregate"]);l!==t.BOXPLOT&&d.warn("Continuous axis should not have customized aggregation function "+l),r=c}return{continuousAxisChannelDef:r,continuousAxis:s}}(e,n),u=s.continuousAxisChannelDef,h=s.continuousAxis,p=e.encoding,g=void 0===r,m=[{op:"q1",field:u.field,as:"lower_box_"+u.field},{op:"q3",field:u.field,as:"upper_box_"+u.field},{op:"median",field:u.field,as:"mid_box_"+u.field}],v=[];m.push({op:"min",field:u.field,as:(g?"lower_whisker_":"min_")+u.field}),m.push({op:"max",field:u.field,as:(g?"upper_whisker_":"max_")+u.field}),g||(v=[{calculate:"datum.upper_box_"+u.field+" - datum.lower_box_"+u.field,as:"iqr_"+u.field},{calculate:"min(datum.upper_box_"+u.field+" + datum.iqr_"+u.field+" * "+r+", datum.max_"+u.field+")",as:"upper_whisker_"+u.field},{calculate:"max(datum.lower_box_"+u.field+" - datum.iqr_"+u.field+" * "+r+", datum.min_"+u.field+")",as:"lower_whisker_"+u.field}]);var _=[],w=[],E=[],O={};return l.forEach(p,function(e,n){if(n!==h)if(c.isFieldDef(e)){if(e.aggregate&&e.aggregate!==t.BOXPLOT)m.push({op:e.aggregate,field:e.field,as:c.vgField(e)});else if(void 0===e.aggregate){var r=c.vgField(e),o=e.bin;o?w.push({bin:o,field:e.field,as:r}):e.timeUnit&&E.push({timeUnit:e.timeUnit,field:e.field,as:r}),_.push(r)}O[n]={field:c.vgField(e),type:e.type}}else O[n]=p[n]}),{transform:[].concat(w,E,[{aggregate:m,groupby:_}],v),continuousAxisChannelDef:u,continuousAxis:h,encodingWithoutContinuousAxis:O}}(e,function(e){var n=e.mark,r=e.encoding;if(o(e,["mark","encoding","projection"]),c.isFieldDef(r.x)&&c.isContinuous(r.x)){if(c.isFieldDef(r.y)&&c.isContinuous(r.y)){if(void 0===r.x.aggregate&&r.y.aggregate===t.BOXPLOT)return"vertical";if(void 0===r.y.aggregate&&r.x.aggregate===t.BOXPLOT)return"horizontal";if(r.x.aggregate===t.BOXPLOT&&r.y.aggregate===t.BOXPLOT)throw new Error("Both x and y cannot have aggregate");return p(n)&&n.orient?n.orient:"vertical"}return"horizontal"}if(c.isFieldDef(r.y)&&c.isContinuous(r.y))return"vertical";throw new Error("Need a valid continuous axis for boxplots")}(e),_),T=A.transform,N=A.continuousAxisChannelDef,M=A.continuousAxis,C=A.encodingWithoutContinuousAxis,D=C.size,R=o(C,["color","size"]),I=D?{size:D}:h.getMarkSpecificConfigMixins(n.box,"size"),P={};return N.scale&&(P.scale=N.scale),N.axis&&(P.axis=N.axis),r({},v,{transform:T,layer:[{mark:{type:"rule",style:"boxWhisker"},encoding:r((w={},w[M]=r({field:"lower_whisker_"+N.field,type:N.type},P),w[M+"2"]={field:"lower_box_"+N.field,type:N.type},w),R,h.getMarkSpecificConfigMixins(n.boxWhisker,"color"))},{mark:{type:"rule",style:"boxWhisker"},encoding:r((E={},E[M]={field:"upper_box_"+N.field,type:N.type},E[M+"2"]={field:"upper_whisker_"+N.field,type:N.type},E),R,h.getMarkSpecificConfigMixins(n.boxWhisker,"color"))},r({},g?{selection:g}:{},{mark:{type:"bar",style:"box"},encoding:r((O={},O[M]={field:"lower_box_"+N.field,type:N.type},O[M+"2"]={field:"upper_box_"+N.field,type:N.type},O),C,C.color?{}:h.getMarkSpecificConfigMixins(n.box,"color"),I)}),{mark:{type:"tick",style:"boxMid"},encoding:r((S={},S[M]={field:"mid_box_"+N.field,type:N.type},S),R,h.getMarkSpecificConfigMixins(n.boxMid,"color"),I)}]})}},YHsL:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("WT6e"),o=function(){},s=n("INQx"),u=n("6GVX"),l=n("XHgV"),c=n("Uo70"),d=n("bfOx"),h=n("Xjw4"),p=n("GuVZ"),g=n("j06o"),m=n("jevj"),v=n("9Sd6"),_=n("1T37"),w=n("kZql"),E=function(){function e(){this.navLinks=[{path:"polynominalregretion",label:"Polynominal regretion"},{path:"learnedDigits",label:"Learned digits (MNIST)",hidden:!w.a.production}]}return e.prototype.ngOnInit=function(){},e}(),O=r._2({encapsulation:0,styles:[[""]],data:{}});function S(e){return r._27(0,[(e()(),r._4(0,0,null,null,6,"a",[["class","mat-tab-link"],["mat-tab-link",""],["routerLinkActive",""]],[[1,"aria-disabled",0],[1,"tabIndex",0],[2,"mat-tab-disabled",null],[2,"mat-tab-label-active",null],[1,"target",0],[8,"href",4]],[[null,"click"]],function(e,t,n){var o=!0;return"click"===t&&(o=!1!==r._16(e,1)._handleClick(n)&&o),"click"===t&&(o=!1!==r._16(e,2).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&o),o},null,null)),r._3(1,147456,[[2,4]],0,u.h,[u.i,r.k,r.y,l.a,[2,c.m],[8,null]],{active:[0,"active"]},null),r._3(2,671744,[[4,4]],0,d.n,[d.l,d.a,h.h],{routerLink:[0,"routerLink"]},null),r._3(3,1720320,[["rla",4]],2,d.m,[d.l,r.k,r.C,r.h],{routerLinkActive:[0,"routerLinkActive"]},null),r._23(603979776,3,{links:1}),r._23(603979776,4,{linksWithHrefs:1}),(e()(),r._25(6,null,["\n    ","\n  "]))],function(e,t){e(t,1,0,r._16(t,3).isActive),e(t,2,0,t.context.$implicit.path),e(t,3,0,"")},function(e,t){e(t,0,0,r._16(t,1).disabled.toString(),r._16(t,1).tabIndex,r._16(t,1).disabled,r._16(t,1).active,r._16(t,2).target,r._16(t,2).href),e(t,6,0,t.context.$implicit.label)})}function A(e){return r._27(0,[(e()(),r._4(0,0,null,null,10,"mat-toolbar",[["class","mat-toolbar"],["color","primary"]],[[2,"mat-toolbar-multiple-rows",null],[2,"mat-toolbar-single-row",null]],null,null,p.b,p.a)),r._3(1,4243456,null,1,g.a,[r.k,l.a,h.d],{color:[0,"color"]},null),r._23(603979776,1,{_toolbarRows:1}),(e()(),r._25(-1,0,["\n  "])),(e()(),r._4(4,0,null,1,5,"mat-toolbar-row",[["class","mat-toolbar-row"]],null,null,null,null,null)),r._3(5,16384,[[1,4]],0,g.c,[],null,null),(e()(),r._25(-1,null,["\n    "])),(e()(),r._4(7,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),r._25(-1,null,["Tensorflow Examples"])),(e()(),r._25(-1,null,["\n  "])),(e()(),r._25(-1,0,["\n"])),(e()(),r._25(-1,null,["\n"])),(e()(),r._4(12,0,null,null,6,"nav",[["class","mat-tab-nav-bar"],["mat-tab-nav-bar",""]],null,null,null,m.b,m.a)),r._3(13,3325952,null,1,u.i,[r.k,[2,v.c],r.y,r.h,_.g],null,null),r._23(603979776,2,{_tabLinks:1}),(e()(),r._25(-1,0,["\n  "])),(e()(),r.Z(16777216,null,0,1,null,S)),r._3(17,802816,null,0,h.j,[r.N,r.K,r.r],{ngForOf:[0,"ngForOf"]},null),(e()(),r._25(-1,0,["\n"])),(e()(),r._25(-1,null,["\n"])),(e()(),r._4(20,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),r._3(21,212992,null,0,d.p,[d.b,r.N,r.j,[8,null],r.h],null,null),(e()(),r._25(-1,null,["\n"]))],function(e,t){var n=t.component;e(t,1,0,"primary"),e(t,17,0,n.navLinks),e(t,21,0)},function(e,t){e(t,0,0,r._16(t,1)._toolbarRows.length,!r._16(t,1)._toolbarRows.length)})}var T=r._0("app-tensorflow-examples",E,function(e){return r._27(0,[(e()(),r._4(0,0,null,null,1,"app-tensorflow-examples",[],null,null,null,A,O)),r._3(1,114688,null,0,E,[],null,null)],function(e,t){e(t,1,0)},null)},{},{},[]),N=n("mu/C"),M=n("1OzB"),C=n("voZO"),D=n("GOEm"),R=n.n(D),I=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function u(value){try{c(r.next(value))}catch(e){s(e)}}function l(value){try{c(r.throw(value))}catch(e){s(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,l)}c((r=r.apply(e,t||[])).next())})},P=this&&this.__generator||function(e,t){var f,y,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(f)throw new TypeError("Generator is already executing.");for(;o;)try{if(f=1,y&&(n=y[2&r[0]?"return":r[0]?"throw":"next"])&&!(n=n.call(y,r[1])).done)return n;switch(y=0,n&&(r=[0,n.value]),r[0]){case 0:case 1:n=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,y=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){o.label=r[1];break}if(6===r[0]&&o.label<n[1]){o.label=n[1],n=r;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(r);break}n[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],y=0}finally{f=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},L=function(){function e(){}return e.prototype.plotData=function(e,t){return I(this,void 0,void 0,function(){var n,r,o,s;return P(this,function(u){switch(u.label){case 0:return[4,t.xs.data()];case 1:return n=u.sent(),[4,t.ys.data()];case 2:return r=u.sent(),o=Array.from(r).map(function(y,i){return{x:n[i],y:r[i]}}),s={$schema:"https://vega.github.io/schema/vega-lite/v2.json",width:300,height:300,data:{values:o},mark:{type:"point",orient:"vertical"},encoding:{x:{field:"x",type:"quantitative"},y:{field:"y",type:"quantitative"}}},[2,R()(e,s,{actions:!1})]}})})},e.prototype.plotDataAndPredictions=function(e,t,n){return I(this,void 0,void 0,function(){var r,o,s,u,l;return P(this,function(c){switch(c.label){case 0:return[4,t.xs.data()];case 1:return r=c.sent(),[4,t.ys.data()];case 2:return o=c.sent(),[4,n.data()];case 3:return s=c.sent(),u=Array.from(o).map(function(y,i){return{x:r[i],y:o[i],pred:s[i]}}),l={$schema:"https://vega.github.io/schema/vega-lite/v2.json",width:300,height:300,data:{values:u},layer:[{mark:{type:"point",orient:"vertical"},encoding:{x:{field:"x",type:"quantitative"},y:{field:"y",type:"quantitative"}}},{mark:{type:"line",orient:"vertical"},encoding:{x:{field:"x",type:"quantitative"},y:{field:"pred",type:"quantitative"},color:{value:"tomato"}}}]},[2,R()(e,l,{actions:!1})]}})})},e.prototype.renderCoefficients=function(e,t){e.innerHTML="<span>a="+t.a.toFixed(3)+", b="+t.b.toFixed(3)+", c="+t.c.toFixed(3)+",  d="+t.d.toFixed(3)+"</span>"},e}(),z=n("AJaF"),F=function(){function e(e){this.dataDrawer=e}return e.prototype.ngOnChanges=function(e){this.draw()},e.prototype.draw=function(){this.data&&(this.predictions?this.dataDrawer.plotDataAndPredictions(this.plot.nativeElement,this.data,this.predictions):this.dataDrawer.plotData(this.plot.nativeElement,this.data)),this.coeff&&this.dataDrawer.renderCoefficients(this.coeffContainer.nativeElement,this.coeff)},e}(),U=r._2({encapsulation:0,styles:[["mat-card-title[_ngcontent-%COMP%]{font-size:18px}"]],data:{}});function B(e){return r._27(0,[r._23(402653184,1,{plot:0}),r._23(402653184,2,{coeffContainer:0}),(e()(),r._4(2,0,null,null,19,"mat-card",[["appRaiseCard",""],["class","mat-card"]],null,[[null,"mouseenter"],[null,"mouseleave"]],function(e,t,n){var o=!0;return"mouseenter"===t&&(o=!1!==r._16(e,4).addRaisedClass()&&o),"mouseleave"===t&&(o=!1!==r._16(e,4).unraise()&&o),o},N.b,N.a)),r._3(3,49152,null,0,M.a,[],null,null),r._3(4,540672,null,0,C.a,[r.k],null,null),(e()(),r._25(-1,0,["\n  "])),(e()(),r._4(6,0,null,0,2,"mat-card-title",[["class","mat-card-title"]],null,null,null,null,null)),r._3(7,16384,null,0,M.j,[],null,null),(e()(),r._25(8,null,["\n    ","\n  "])),(e()(),r._25(-1,0,["\n  "])),(e()(),r._4(10,0,null,0,4,"mat-card-subtitle",[["class","mat-card-subtitle"]],null,null,null,null,null)),r._3(11,16384,null,0,M.i,[],null,null),(e()(),r._25(12,null,["\n    "," "])),(e()(),r._4(13,0,[[2,0],["coeff",1]],null,0,"span",[["class","coeff"]],null,null,null,null,null)),(e()(),r._25(-1,null,["\n  "])),(e()(),r._25(-1,0,["\n  "])),(e()(),r._4(16,0,null,0,4,"mat-card-content",[["class","mat-card-content"]],null,null,null,null,null)),r._3(17,16384,null,0,M.d,[],null,null),(e()(),r._25(-1,null,["\n    "])),(e()(),r._4(19,0,[[1,0],["plot",1]],null,0,"div",[["class","plot"]],null,null,null,null,null)),(e()(),r._25(-1,null,["\n  "])),(e()(),r._25(-1,0,["\n"])),(e()(),r._25(-1,null,["\n"]))],null,function(e,t){var n=t.component;e(t,8,0,n.caption),e(t,12,0,n.coeffCaption)})}var V=n("BTH+"),q=n("gsbp"),G=n("U/+3"),W=n("7u3n"),H=n("+j5Y"),X=function(){function e(){}return e.prototype.generateData=function(e,t,n){return void 0===n&&(n=.04),Object(z.tidy)(function(){var r=[Object(z.scalar)(t.a),Object(z.scalar)(t.b),Object(z.scalar)(t.c),Object(z.scalar)(t.d)],a=r[0],b=r[1],o=r[2],s=r[3],u=Object(z.randomUniform)([e],-1,1),l=Object(z.scalar)(3,"int32"),c=a.mul(u.pow(l)).add(b.mul(u.square())).add(o.mul(u)).add(s).add(Object(z.randomNormal)([e],0,n)),d=c.min(),h=c.max().sub(d);return{xs:u,ys:c.sub(d).div(h)}})},e.prototype.addDataPoint=function(e,t,n){return n},e}(),Y=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function u(value){try{c(r.next(value))}catch(e){s(e)}}function l(value){try{c(r.throw(value))}catch(e){s(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,l)}c((r=r.apply(e,t||[])).next())})},K=this&&this.__generator||function(e,t){var f,y,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(f)throw new TypeError("Generator is already executing.");for(;o;)try{if(f=1,y&&(n=y[2&r[0]?"return":r[0]?"throw":"next"])&&!(n=n.call(y,r[1])).done)return n;switch(y=0,n&&(r=[0,n.value]),r[0]){case 0:case 1:n=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,y=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){o.label=r[1];break}if(6===r[0]&&o.label<n[1]){o.label=n[1],n=r;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(r);break}n[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],y=0}finally{f=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},J=function(){function e(e){this.dataService=e,this.setPolynominal(),this.createOptimizer()}return Object.defineProperty(e.prototype,"trueCoefficients",{get:function(){return this._trueCoefficients||(this._trueCoefficients={a:-.8,b:-.2,c:.9,d:.5}),this._trueCoefficients},set:function(e){this._trueCoefficients=e,this.trainingData=null,this.predictionsBefore=this.predict(this.trainingData.xs),this.predictionsAfter=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainingData",{get:function(){return this._trainingData||(this._trainingData=this.dataService.generateData(100,this.trueCoefficients)),this._trainingData},set:function(e){this._trainingData=e},enumerable:!0,configurable:!0}),e.prototype.addTrainingPoint=function(x,y){this.dataService.addDataPoint(x,y,this._trainingData)},e.prototype.setPolynominal=function(a,b,e,t){void 0===a&&(a=Math.random()),void 0===b&&(b=Math.random()),void 0===e&&(e=Math.random()),void 0===t&&(t=Math.random()),this.a=Object(z.variable)(Object(z.scalar)(a)),this.b=Object(z.variable)(Object(z.scalar)(b)),this.c=Object(z.variable)(Object(z.scalar)(e)),this.d=Object(z.variable)(Object(z.scalar)(t))},e.prototype.createOptimizer=function(e,t){void 0===e&&(e=75),void 0===t&&(t=.5),this.numIterations=e,this.optimizer=z.train.sgd(t)},e.prototype.predict=function(x){var e=this;return Object(z.tidy)(function(){return e.a.mul(x.pow(Object(z.scalar)(3,"int32"))).add(e.b.mul(x.square())).add(e.c.mul(x)).add(e.d)})},e.prototype.loss=function(e,t){return e.sub(t).square().mean()},e.prototype.train=function(e,t,n){return void 0===n&&(n=this.numIterations),Y(this,void 0,void 0,function(){var r,o=this;return K(this,function(s){switch(s.label){case 0:r=0,s.label=1;case 1:return r<n?(this.optimizer.minimize(function(){var n=o.predict(e);return o.loss(n,t)}),[4,Object(z.nextFrame)()]):[3,4];case 2:s.sent(),s.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},Object.defineProperty(e.prototype,"currentCoefficients",{get:function(){return Object.assign({},{a:this.a.dataSync()[0],b:this.b.dataSync()[0],c:this.c.dataSync()[0],d:this.d.dataSync()[0]})},enumerable:!0,configurable:!0}),e.prototype.learnCoefficients=function(e,t){return void 0===e&&(e=this.numIterations),void 0===t&&(t=10),Y(this,void 0,void 0,function(){var i;return K(this,function(n){switch(n.label){case 0:i=e,n.label=1;case 1:return i>0?[4,this.train(this.trainingData.xs,this.trainingData.ys,Math.min(t,i))]:[3,4];case 2:n.sent(),this.predictionsAfter=this.predict(this.trainingData.xs),n.label=3;case 3:return i-=t,[3,1];case 4:return[2]}})})},e}(),Z=n("8I7R"),Q=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function u(value){try{c(r.next(value))}catch(e){s(e)}}function l(value){try{c(r.throw(value))}catch(e){s(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,l)}c((r=r.apply(e,t||[])).next())})},$=this&&this.__generator||function(e,t){var f,y,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(f)throw new TypeError("Generator is already executing.");for(;o;)try{if(f=1,y&&(n=y[2&r[0]?"return":r[0]?"throw":"next"])&&!(n=n.call(y,r[1])).done)return n;switch(y=0,n&&(r=[0,n.value]),r[0]){case 0:case 1:n=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,y=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){o.label=r[1];break}if(6===r[0]&&o.label<n[1]){o.label=n[1],n=r;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(r);break}n[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],y=0}finally{f=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},ee=function(){function e(e,t){this.polyService=e,this.headlineAnimation=t,this.isLearning=!1}return e.prototype.ngOnInit=function(){return Q(this,void 0,void 0,function(){return $(this,function(e){return this.randomCoefficients=this.polyService.currentCoefficients,[2]})})},e.prototype.learn=function(){return Q(this,void 0,void 0,function(){var e;return $(this,function(t){switch(t.label){case 0:return this.isLearning=!0,this.headlineAnimation.stopAnimation(),[4,this.polyService.learnCoefficients(50,10)];case 1:return t.sent(),this.learnedCoefficients=this.polyService.currentCoefficients,[4,this.polyService.loss(this.polyService.predictionsAfter,this.polyService.trainingData.ys).data()];case 2:return e=t.sent(),this.currentLoss=e[0],this.isLearning=!1,this.headlineAnimation.startAnimation(),[2]}})})},e.prototype.setRandomCoefficients=function(){this.polyService.trueCoefficients={a:10*Math.random()-5,b:10*Math.random()-5,c:10*Math.random()-5,d:10*Math.random()-5}},e}(),te=r._2({encapsulation:0,styles:[[".drawings[_ngcontent-%COMP%]{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-pack:distribute;justify-content:space-around;-webkit-box-align:center;-ms-flex-align:center;align-items:center}app-data-drawer[_ngcontent-%COMP%]{margin-right:1rem}"]],data:{}});function ne(e){return r._27(0,[(e()(),r._4(0,0,null,null,48,"mat-card",[["appRaiseCard",""],["class","mat-card"]],null,[[null,"mouseenter"],[null,"mouseleave"]],function(e,t,n){var o=!0;return"mouseenter"===t&&(o=!1!==r._16(e,2).addRaisedClass()&&o),"mouseleave"===t&&(o=!1!==r._16(e,2).unraise()&&o),o},N.b,N.a)),r._3(1,49152,null,0,M.a,[],null,null),r._3(2,540672,null,0,C.a,[r.k],null,null),(e()(),r._25(-1,0,["\n  "])),(e()(),r._4(4,0,null,0,2,"mat-card-title",[["class","mat-card-title"]],null,null,null,null,null)),r._3(5,16384,null,0,M.j,[],null,null),(e()(),r._25(-1,null,["Fitting data to a syntetic curve"])),(e()(),r._25(-1,0,["\n  "])),(e()(),r._4(8,0,null,0,7,"mat-card-subtitle",[["class","mat-card-subtitle"]],null,null,null,null,null)),r._3(9,16384,null,0,M.i,[],null,null),(e()(),r._25(-1,null,["Utilizing tensorflow.js for polynominal regretion and vega to plot"])),(e()(),r._4(11,0,null,null,0,"br",[],null,null,null,null,null)),(e()(),r._25(-1,null,["\n    Inspired from "])),(e()(),r._4(13,0,null,null,1,"a",[["href","https://github.com/tensorflow/tfjs-examples/tree/master/polynomial-regression-core"],["target","_blank"]],null,null,null,null,null)),(e()(),r._25(-1,null,["Tensorflow.js example"])),(e()(),r._25(-1,null,["\n  "])),(e()(),r._25(-1,0,["\n  "])),(e()(),r._4(17,0,null,0,14,"mat-card-content",[["class","drawings mat-card-content"]],null,null,null,null,null)),r._3(18,16384,null,0,M.d,[],null,null),(e()(),r._25(-1,null,["\n    "])),(e()(),r._4(20,0,null,null,2,"app-data-drawer",[["caption","Training data (synthetic)"],["coeffCaption","True coefficients:"]],null,null,null,B,U)),r._3(21,573440,null,0,F,[L],{caption:[0,"caption"],coeffCaption:[1,"coeffCaption"],data:[2,"data"],coeff:[3,"coeff"]},null),(e()(),r._25(-1,null,["\n    "])),(e()(),r._25(-1,null,["\n    "])),(e()(),r._4(24,0,null,null,2,"app-data-drawer",[["caption","Fit curve with random coefficients (before training)"],["coeffCaption","Random coefficients:"]],null,null,null,B,U)),r._3(25,573440,null,0,F,[L],{caption:[0,"caption"],coeffCaption:[1,"coeffCaption"],data:[2,"data"],coeff:[3,"coeff"],predictions:[4,"predictions"]},null),(e()(),r._25(-1,null,["\n    "])),(e()(),r._25(-1,null,["\n    "])),(e()(),r._4(28,0,null,null,2,"app-data-drawer",[["caption","Fit curve with learned coefficients (after training)"],["coeffCaption","Learned coefficients:"]],null,null,null,B,U)),r._3(29,573440,null,0,F,[L],{caption:[0,"caption"],coeffCaption:[1,"coeffCaption"],data:[2,"data"],coeff:[3,"coeff"],predictions:[4,"predictions"]},null),(e()(),r._25(-1,null,["\n    "])),(e()(),r._25(-1,null,["\n\n  "])),(e()(),r._25(-1,0,["\n  "])),(e()(),r._4(33,0,null,0,14,"mat-card-actions",[["class","mat-card-actions"]],[[2,"mat-card-actions-align-end",null]],null,null,null,null)),r._3(34,16384,null,0,M.b,[],null,null),(e()(),r._25(-1,null,["\n    "])),(e()(),r._4(36,16777216,null,null,3,"button",[["color","accent"],["mat-raised-button",""],["matTooltip","Do you see how the toolbar animation is flickering? That's because the gpu is utilized."],["matTooltipPosition","after"]],[[8,"disabled",0]],[[null,"click"],[null,"longpress"],[null,"keydown"],[null,"touchend"]],function(e,t,n){var o=!0,s=e.component;return"longpress"===t&&(o=!1!==r._16(e,38).show()&&o),"keydown"===t&&(o=!1!==r._16(e,38)._handleKeydown(n)&&o),"touchend"===t&&(o=!1!==r._16(e,38)._handleTouchend()&&o),"click"===t&&(o=!1!==s.learn()&&o),o},V.d,V.b)),r._3(37,180224,null,0,q.b,[r.k,l.a,G.g],{disabled:[0,"disabled"],color:[1,"color"]},null),r._3(38,147456,null,0,W.d,[H.c,r.k,_.d,r.N,r.y,l.a,G.d,G.g,W.b,[2,v.c],[2,W.a]],{position:[0,"position"],message:[1,"message"]},null),(e()(),r._25(-1,0,["\n      Learn (50 iterations)\n    "])),(e()(),r._25(-1,null,["\n    "])),(e()(),r._4(41,0,null,null,2,"button",[["color","accent"],["mat-raised-button",""]],[[8,"disabled",0]],[[null,"click"]],function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.setRandomCoefficients()&&r),r},V.d,V.b)),r._3(42,180224,null,0,q.b,[r.k,l.a,G.g],{disabled:[0,"disabled"],color:[1,"color"]},null),(e()(),r._25(-1,0,["\n      Set random training data\n    "])),(e()(),r._25(-1,null,["\n    "])),(e()(),r._4(45,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),r._25(46,null,["Current loss: ",""])),(e()(),r._25(-1,null,["\n  "])),(e()(),r._25(-1,0,["\n"])),(e()(),r._25(-1,null,["\n"]))],function(e,t){var n=t.component;e(t,21,0,"Training data (synthetic)","True coefficients:",n.polyService.trainingData,n.polyService.trueCoefficients),e(t,25,0,"Fit curve with random coefficients (before training)","Random coefficients:",n.polyService.trainingData,n.randomCoefficients,n.polyService.predictionsBefore),e(t,29,0,"Fit curve with learned coefficients (after training)","Learned coefficients:",n.polyService.trainingData,n.learnedCoefficients,n.polyService.predictionsAfter),e(t,37,0,n.isLearning,"accent"),e(t,38,0,"after","Do you see how the toolbar animation is flickering? That's because the gpu is utilized."),e(t,42,0,n.isLearning,"accent")},function(e,t){var n=t.component;e(t,33,0,"end"===r._16(t,34).align),e(t,36,0,r._16(t,37).disabled||null),e(t,41,0,r._16(t,42).disabled||null),e(t,46,0,null==n.currentLoss?null:n.currentLoss.toFixed(5))})}var re=r._0("app-tensorflow-examples",ee,function(e){return r._27(0,[(e()(),r._4(0,0,null,null,1,"app-tensorflow-examples",[],null,null,null,ne,te)),r._3(1,114688,null,0,ee,[J,Z.a],null,null)],function(e,t){e(t,1,0)},null)},{},{},[]),ie=n("aLBl"),ae=n("Bp8q"),oe=function(){function e(){}return e.prototype.ngOnChanges=function(e){e.batch&&e.batch.currentValue&&this.showTestResults(this.batch,this.predictions,this.labels),e.accuracyValues&&e.accuracyValues.currentValue&&this.plotAccuracies(this.accuracyValues),e.lossValues&&e.lossValues.currentValue&&this.plotLosses(this.lossValues)},e.prototype.showTestResults=function(e,t,n){var r=e.xs.shape[0];this.totalPredictions=r,this.totalCorrect=0,this.images.nativeElement.innerHTML="";for(var i=0;i<r;i++){var o=e.xs.slice([i,0],[1,e.xs.shape[1]]),s=document.createElement("div");s.className="pred-container";var u=document.createElement("canvas");this.draw(o.flatten(),u);var l=document.createElement("div"),c=t[i],d=c===n[i];this.totalCorrect+=d?1:0,l.className="pred "+(d?"pred-correct":"pred-incorrect"),l.innerText="pred: "+c,s.appendChild(l),s.appendChild(u),this.images.nativeElement.appendChild(s)}},e.prototype.plotLosses=function(e){R()(this.lossCanvas.nativeElement,{$schema:"https://vega.github.io/schema/vega-lite/v2.json",data:{values:e},mark:{type:"line",orient:"vertical"},width:260,encoding:{x:{field:"batch",type:"quantitative"},y:{field:"loss",type:"quantitative"},color:{field:"set",type:"nominal",legend:null}}},{width:360}),this.lossLabel="last loss: "+e[e.length-1].loss.toFixed(2)},e.prototype.plotAccuracies=function(e){R()(this.accuracyCanvas.nativeElement,{$schema:"https://vega.github.io/schema/vega-lite/v2.json",data:{values:e},width:260,mark:{type:"line",orient:"vertical",legend:null},encoding:{x:{field:"batch",type:"quantitative"},y:{field:"accuracy",type:"quantitative"},color:{field:"set",type:"nominal",legend:null}}},{width:360}),this.accuracyLabel="last accuracy: "+(100*e[e.length-1].accuracy).toFixed(2)+"%"},e.prototype.draw=function(e,t){var n=[28,28],r=n[0],o=n[1];t.width=r,t.height=o;for(var s=t.getContext("2d"),u=new ImageData(r,o),l=e.dataSync(),i=0;i<o*r;++i){var j=4*i;u.data[j+0]=255*l[i],u.data[j+1]=255*l[i],u.data[j+2]=255*l[i],u.data[j+3]=255}s.putImageData(u,0,0)},e}(),se=r._2({encapsulation:0,styles:[[".results[_ngcontent-%COMP%]{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.accuracy-result[_ngcontent-%COMP%], .loss-result[_ngcontent-%COMP%]{-webkit-box-flex:1;-ms-flex:1 1 50%;flex:1 1 50%}  .images{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}  .images .pred-container{margin-right:2rem}  .images .pred-container .pred{background-color:green}  .images .pred-container .pred.pred-incorrect{background-color:red}"]],data:{}});function ue(e){return r._27(0,[(e()(),r._4(0,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),r._25(-1,null,["Predicted images"]))],null,null)}function le(e){return r._27(0,[(e()(),r._4(0,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),r._25(1,null,["",""]))],null,function(e,t){var n=t.component;e(t,1,0,"Result: "+n.totalCorrect+" of "+n.totalPredictions+" recognized correctly.")})}function ce(e){return r._27(0,[r._23(402653184,1,{lossCanvas:0}),r._23(402653184,2,{accuracyCanvas:0}),r._23(402653184,3,{images:0}),(e()(),r._4(3,0,null,null,26,"div",[["class","results"]],null,null,null,null,null)),(e()(),r._25(-1,null,["\n  "])),(e()(),r._4(5,0,null,null,6,"div",[["class","accuracy-result"]],null,null,null,null,null)),(e()(),r._25(-1,null,["\n    "])),(e()(),r._4(7,0,[[2,0],["accuracyCanvas",1]],null,0,"div",[],null,null,null,null,null)),(e()(),r._25(-1,null,["\n    "])),(e()(),r._4(9,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),r._25(10,null,["",""])),(e()(),r._25(-1,null,["\n  "])),(e()(),r._25(-1,null,["\n  "])),(e()(),r._4(13,0,null,null,6,"div",[["class","loss-result"]],null,null,null,null,null)),(e()(),r._25(-1,null,["\n    "])),(e()(),r._4(15,0,[[1,0],["lossCanvas",1]],null,0,"div",[],null,null,null,null,null)),(e()(),r._25(-1,null,["\n    "])),(e()(),r._4(17,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),r._25(18,null,["",""])),(e()(),r._25(-1,null,["\n  "])),(e()(),r._25(-1,null,["\n\n  "])),(e()(),r.Z(16777216,null,null,1,null,ue)),r._3(22,16384,null,0,h.k,[r.N,r.K],{ngIf:[0,"ngIf"]},null),(e()(),r._25(-1,null,["\n  "])),(e()(),r._4(24,0,[[3,0],["images",1]],null,1,"div",[["class","images"]],null,null,null,null,null)),(e()(),r._25(-1,null,["\n  "])),(e()(),r._25(-1,null,["\n  "])),(e()(),r.Z(16777216,null,null,1,null,le)),r._3(28,16384,null,0,h.k,[r.N,r.K],{ngIf:[0,"ngIf"]},null),(e()(),r._25(-1,null,["\n"])),(e()(),r._25(-1,null,["\n\n"]))],function(e,t){var n=t.component;e(t,22,0,n.batch),e(t,28,0,n.batch)},function(e,t){var n=t.component;e(t,10,0,"Last accuracy: "+n.accuracyLabel),e(t,18,0,"Last loss: "+n.lossLabel)})}var fe=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function u(value){try{c(r.next(value))}catch(e){s(e)}}function l(value){try{c(r.throw(value))}catch(e){s(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,l)}c((r=r.apply(e,t||[])).next())})},de=this&&this.__generator||function(e,t){var f,y,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(f)throw new TypeError("Generator is already executing.");for(;o;)try{if(f=1,y&&(n=y[2&r[0]?"return":r[0]?"throw":"next"])&&!(n=n.call(y,r[1])).done)return n;switch(y=0,n&&(r=[0,n.value]),r[0]){case 0:case 1:n=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,y=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){o.label=r[1];break}if(6===r[0]&&o.label<n[1]){o.label=n[1],n=r;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(r);break}n[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],y=0}finally{f=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},he=function(){function e(){this.shuffledTrainIndex=0,this.shuffledTestIndex=0}return e.prototype.load=function(){return fe(this,void 0,void 0,function(){var e,t,n,r,o,s,u,l,c=this;return de(this,function(d){switch(d.label){case 0:return e=new Image,t=document.createElement("canvas"),n=t.getContext("2d"),r=new Promise(function(r,o){e.crossOrigin="",e.onload=function(){e.width=e.naturalWidth,e.height=e.naturalHeight;var o=new ArrayBuffer(20384e4);t.width=e.width,t.height=5e3;for(var i=0;i<13;i++){var s=new Float32Array(o,784*i*5e3*4,392e4);n.drawImage(e,0,5e3*i,e.width,5e3,0,0,e.width,5e3);for(var u=n.getImageData(0,0,t.width,t.height),j=0;j<u.data.length/4;j++)s[j]=u.data[4*j]/255}c.datasetImages=new Float32Array(o),r()},e.src="assets/mnist/mnist_images.png"}),o=fetch("assets/mnist/mnist_labels_uint8",{mode:"arraybuffer"}),[4,Promise.all([r,o])];case 1:return s=d.sent(),u=this,l=Uint8Array.bind,[4,s[1].arrayBuffer()];case 2:return u.datasetLabels=new(l.apply(Uint8Array,[void 0,d.sent()])),this.trainIndices=z.util.createShuffledIndices(55e3),this.testIndices=z.util.createShuffledIndices(1e4),this.trainImages=this.datasetImages.slice(0,4312e4),this.testImages=this.datasetImages.slice(4312e4),this.trainLabels=this.datasetLabels.slice(0,55e4),this.testLabels=this.datasetLabels.slice(55e4),[2]}})})},e.prototype.nextTrainBatch=function(e){var t=this;return this.nextBatch(e,[this.trainImages,this.trainLabels],function(){return t.shuffledTrainIndex=(t.shuffledTrainIndex+1)%t.trainIndices.length,t.trainIndices[t.shuffledTrainIndex]})},e.prototype.nextTestBatch=function(e){var t=this;return this.nextBatch(e,[this.testImages,this.testLabels],function(){return t.shuffledTestIndex=(t.shuffledTestIndex+1)%t.testIndices.length,t.testIndices[t.shuffledTestIndex]})},e.prototype.nextBatch=function(e,t,n){for(var r=new Float32Array(784*e),o=new Uint8Array(10*e),i=0;i<e;i++){var s=n(),u=t[0].slice(784*s,784*s+784);r.set(u,784*i);var l=t[1].slice(10*s,10*s+10);o.set(l,10*i)}return{xs:Object(z.tensor2d)(r,[e,784]),labels:Object(z.tensor2d)(o,[e,10])}},e}(),pe=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function u(value){try{c(r.next(value))}catch(e){s(e)}}function l(value){try{c(r.throw(value))}catch(e){s(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,l)}c((r=r.apply(e,t||[])).next())})},ge=this&&this.__generator||function(e,t){var f,y,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(f)throw new TypeError("Generator is already executing.");for(;o;)try{if(f=1,y&&(n=y[2&r[0]?"return":r[0]?"throw":"next"])&&!(n=n.call(y,r[1])).done)return n;switch(y=0,n&&(r=[0,n.value]),r[0]){case 0:case 1:n=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,y=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){o.label=r[1];break}if(6===r[0]&&o.label<n[1]){o.label=n[1],n=r;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(r);break}n[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],y=0}finally{f=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},me=.15,ve=function(){function e(e){this.mnistData=e,this.isTraining=!1,this.model=Object(z.sequential)(),this.model.add(z.layers.conv2d({inputShape:[28,28,1],kernelSize:5,filters:8,strides:1,activation:"relu",kernelInitializer:"VarianceScaling"})),this.model.add(z.layers.maxPooling2d({poolSize:[2,2],strides:[2,2]})),this.model.add(z.layers.conv2d({kernelSize:5,filters:16,strides:1,activation:"relu",kernelInitializer:"VarianceScaling"})),this.model.add(z.layers.maxPooling2d({poolSize:[2,2],strides:[2,2]})),this.model.add(z.layers.flatten()),this.model.add(z.layers.dense({units:10,kernelInitializer:"VarianceScaling",activation:"softmax"})),this.optimizer=z.train.sgd(me),this.model.compile({optimizer:this.optimizer,loss:"categoricalCrossentropy",metrics:["accuracy"]})}return e.prototype.train=function(){return pe(this,void 0,void 0,function(){var i,e,t,n,r;return ge(this,function(o){switch(o.label){case 0:this.isTraining=!0,this.lossValues=[],this.accuracyValues=[],i=0,o.label=1;case 1:return i<100?(e=this.mnistData.nextTrainBatch(64),t=void 0,n=void 0,i%5==0&&(t=this.mnistData.nextTestBatch(1e3),n=[t.xs.reshape([1e3,28,28,1]),t.labels]),[4,this.model.fit(e.xs.reshape([64,28,28,1]),e.labels,{batchSize:64,validationData:n,epochs:1})]):[3,5];case 2:return r=o.sent(),this.lossValues=this.lossValues.concat([{batch:i,loss:r.history.loss[0],set:"train"}]),null!=t&&(this.accuracyValues=this.accuracyValues.concat([{batch:i,accuracy:r.history.acc[0],set:"train"}])),e.xs.dispose(),e.labels.dispose(),null!=t&&(t.xs.dispose(),t.labels.dispose()),[4,Object(z.nextFrame)()];case 3:o.sent(),o.label=4;case 4:return i++,[3,1];case 5:return this.isTraining=!1,[2]}})})},e.prototype.predict=function(){var e=this;this.testBatch=this.mnistData.nextTestBatch(100),Object(z.tidy)(function(){var t=e.model.predict(e.testBatch.xs.reshape([-1,28,28,1]));e.labels=Array.from(e.testBatch.labels.argMax(1).dataSync()),e.predictions=Array.from(t.argMax(1).dataSync())})},e}(),ye=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function u(value){try{c(r.next(value))}catch(e){s(e)}}function l(value){try{c(r.throw(value))}catch(e){s(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,l)}c((r=r.apply(e,t||[])).next())})},be=this&&this.__generator||function(e,t){var f,y,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(f)throw new TypeError("Generator is already executing.");for(;o;)try{if(f=1,y&&(n=y[2&r[0]?"return":r[0]?"throw":"next"])&&!(n=n.call(y,r[1])).done)return n;switch(y=0,n&&(r=[0,n.value]),r[0]){case 0:case 1:n=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,y=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){o.label=r[1];break}if(6===r[0]&&o.label<n[1]){o.label=n[1],n=r;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(r);break}n[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],y=0}finally{f=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},xe=function(){function e(e,t,n){this.data=e,this.deepnet=t,this.headlineAnimation=n,this.hasBeenTrained=!1,this.errorLoadingData=!1}return e.prototype.ngOnInit=function(){var e=this;setTimeout(function(){return ye(e,void 0,void 0,function(){var e;return be(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,3,4]),this.isLoading=!0,[4,this.data.load()];case 1:return t.sent(),[3,4];case 2:return e=t.sent(),console.error("error loading mnist data",e),this.errorLoadingData=!0,[3,4];case 3:return this.isLoading=!1,[7];case 4:return[2]}})})},200)},e.prototype.train=function(){return ye(this,void 0,void 0,function(){var e=this;return be(this,function(t){switch(t.label){case 0:return[4,this.headlineAnimation.runWithoutAnimations(function(){return ye(e,void 0,void 0,function(){return be(this,function(e){switch(e.label){case 0:return[4,this.deepnet.train()];case 1:return e.sent(),[2]}})})})];case 1:return t.sent(),this.hasBeenTrained=!0,[2]}})})},e.prototype.predict=function(){var e=this;this.headlineAnimation.runWithoutAnimations(function(){return e.deepnet.predict()})},Object.defineProperty(e.prototype,"isTraining",{get:function(){return this.deepnet.isTraining},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accuracyValues",{get:function(){return this.deepnet.accuracyValues},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lossValues",{get:function(){return this.deepnet.lossValues},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"predictions",{get:function(){return this.deepnet.predictions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batch",{get:function(){return this.deepnet.testBatch},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labels",{get:function(){return this.deepnet.labels},enumerable:!0,configurable:!0}),e}(),_e=r._2({encapsulation:0,styles:[[""]],data:{}});function we(e){return r._27(0,[(e()(),r._4(0,0,null,null,8,"div",[],null,null,null,null,null)),(e()(),r._25(-1,null,["\n      "])),(e()(),r._4(2,0,null,null,2,"mat-spinner",[["class","mat-spinner mat-progress-spinner"],["color","accent"],["mode","indeterminate"],["role","progressbar"]],[[4,"width","px"],[4,"height","px"]],null,null,ie.b,ie.a)),r._3(3,573440,null,0,ae.c,[r.k,l.a,[2,h.d]],{color:[0,"color"]},null),(e()(),r._25(-1,null,["\n      "])),(e()(),r._25(-1,null,["\n      "])),(e()(),r._4(6,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),r._25(-1,null,["\n        Fetching MNIST images...\n      "])),(e()(),r._25(-1,null,["\n    "]))],function(e,t){e(t,3,0,"accent")},function(e,t){e(t,2,0,r._16(t,3)._elementSize,r._16(t,3)._elementSize)})}function Ee(e){return r._27(0,[(e()(),r._4(0,0,null,null,1,"div",[["class","mat-error"]],null,null,null,null,null)),(e()(),r._25(-1,null,["There was an error loading the data. Try again later."]))],null,null)}function Oe(e){return r._27(0,[(e()(),r._4(0,0,null,null,2,"app-ui",[],null,null,null,ce,se)),r._3(1,573440,null,0,oe,[],{batch:[0,"batch"],predictions:[1,"predictions"],labels:[2,"labels"],lossValues:[3,"lossValues"],accuracyValues:[4,"accuracyValues"]},null),(e()(),r._25(-1,null,["\n    "]))],function(e,t){var n=t.component;e(t,1,0,n.batch,n.predictions,n.labels,n.lossValues,n.accuracyValues)},null)}function Se(e){return r._27(0,[(e()(),r._4(0,0,null,null,36,"mat-card",[["appRaiseCard",""],["class","mat-card"]],null,[[null,"mouseenter"],[null,"mouseleave"]],function(e,t,n){var o=!0;return"mouseenter"===t&&(o=!1!==r._16(e,2).addRaisedClass()&&o),"mouseleave"===t&&(o=!1!==r._16(e,2).unraise()&&o),o},N.b,N.a)),r._3(1,49152,null,0,M.a,[],null,null),r._3(2,540672,null,0,C.a,[r.k],null,null),(e()(),r._25(-1,0,["\n  "])),(e()(),r._4(4,0,null,0,2,"mat-card-title",[["class","mat-card-title"]],null,null,null,null,null)),r._3(5,16384,null,0,M.j,[],null,null),(e()(),r._25(-1,null,["\n    Learn handwritten digits!\n  "])),(e()(),r._25(-1,0,["\n  "])),(e()(),r._4(8,0,null,0,2,"mat-card-subtitle",[["class","mat-card-subtitle"]],null,null,null,null,null)),r._3(9,16384,null,0,M.i,[],null,null),(e()(),r._25(-1,null,["\n    Using the mnist digist.\n  "])),(e()(),r._25(-1,0,["\n  "])),(e()(),r._4(12,0,null,0,11,"mat-card-content",[["class","mat-card-content"]],null,null,null,null,null)),r._3(13,16384,null,0,M.d,[],null,null),(e()(),r._25(-1,null,["\n    "])),(e()(),r.Z(16777216,null,null,1,null,we)),r._3(16,16384,null,0,h.k,[r.N,r.K],{ngIf:[0,"ngIf"]},null),(e()(),r._25(-1,null,["\n    "])),(e()(),r.Z(16777216,null,null,1,null,Ee)),r._3(19,16384,null,0,h.k,[r.N,r.K],{ngIf:[0,"ngIf"]},null),(e()(),r._25(-1,null,["\n    "])),(e()(),r.Z(16777216,null,null,1,null,Oe)),r._3(22,16384,null,0,h.k,[r.N,r.K],{ngIf:[0,"ngIf"]},null),(e()(),r._25(-1,null,["\n  "])),(e()(),r._25(-1,0,["\n  "])),(e()(),r._4(25,0,null,0,10,"mat-card-actions",[["class","mat-card-actions"]],[[2,"mat-card-actions-align-end",null]],null,null,null,null)),r._3(26,16384,null,0,M.b,[],null,null),(e()(),r._25(-1,null,["\n    "])),(e()(),r._4(28,0,null,null,2,"button",[["color","accent"],["mat-raised-button",""]],[[8,"disabled",0]],[[null,"click"]],function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.train()&&r),r},V.d,V.b)),r._3(29,180224,null,0,q.b,[r.k,l.a,G.g],{disabled:[0,"disabled"],color:[1,"color"]},null),(e()(),r._25(-1,0,["\n      Train\n    "])),(e()(),r._25(-1,null,["\n    "])),(e()(),r._4(32,0,null,null,2,"button",[["color","accent"],["mat-raised-button",""]],[[8,"disabled",0]],[[null,"click"]],function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.predict()&&r),r},V.d,V.b)),r._3(33,180224,null,0,q.b,[r.k,l.a,G.g],{disabled:[0,"disabled"],color:[1,"color"]},null),(e()(),r._25(-1,0,["\n      Predict\n    "])),(e()(),r._25(-1,null,["\n\n  "])),(e()(),r._25(-1,0,["\n"])),(e()(),r._25(-1,null,["\n"]))],function(e,t){var n=t.component;e(t,16,0,n.isLoading),e(t,19,0,n.errorLoadingData),e(t,22,0,!n.isLoading&&!n.errorLoadingData),e(t,29,0,n.isLoading||n.isTraining||n.errorLoadingData,"accent"),e(t,33,0,n.isLoading||n.errorLoadingData,"accent")},function(e,t){e(t,25,0,"end"===r._16(t,26).align),e(t,28,0,r._16(t,29).disabled||null),e(t,32,0,r._16(t,33).disabled||null)})}var Ae=r._0("app-learned-digits",xe,function(e){return r._27(0,[(e()(),r._4(0,0,null,null,1,"app-learned-digits",[],null,null,null,Se,_e)),r._3(1,114688,null,0,xe,[he,ve,Z.a],null,null)],function(e,t){e(t,1,0)},null)},{},{},[]),ke=n("7DMc"),Te=n("6sdf"),Ne=n("Mcof"),Me=n("z7Rf"),Ce=n("ItHS"),De=n("OE0E"),Re=n("NwsS"),Ie=n("fTri"),Pe=n("AP/s"),Le=n("TBIh"),ze=n("704W"),je=n("bkcK"),Fe=n("ZuzD"),Ue=n("sqmn"),Be=n("kJ/S"),Ve=n("4rwD"),qe=n("86rF"),Ge=n("JkvL"),We=n("+76Z"),He=n("fAE3"),Xe=function(){};n.d(t,"TensorflowExamplesModuleNgFactory",function(){return Ye});var Ye=r._1(o,[],function(e){return r._12([r._13(512,r.j,r.X,[[8,[s.a,T,re,Ae]],[3,r.j],r.w]),r._13(4608,h.m,h.l,[r.t,[2,h.v]]),r._13(4608,ke.v,ke.v,[]),r._13(6144,v.b,null,[h.d]),r._13(4608,v.c,v.c,[[2,v.b]]),r._13(4608,l.a,l.a,[]),r._13(4608,G.i,G.i,[l.a]),r._13(4608,G.h,G.h,[G.i,r.y,h.d]),r._13(136192,G.d,G.b,[[3,G.d],h.d]),r._13(5120,G.l,G.k,[[3,G.l],[2,G.j],h.d]),r._13(5120,G.g,G.e,[[3,G.g],r.y,l.a]),r._13(4608,Te.b,Te.b,[]),r._13(4608,c.d,c.d,[]),r._13(5120,_.d,_.b,[[3,_.d],r.y,l.a]),r._13(5120,_.g,_.f,[[3,_.g],l.a,r.y]),r._13(4608,H.i,H.i,[_.d,_.g,r.y,h.d]),r._13(5120,H.e,H.j,[[3,H.e],h.d]),r._13(4608,H.h,H.h,[_.g,h.d]),r._13(5120,H.f,H.m,[[3,H.f],h.d]),r._13(4608,H.c,H.c,[H.i,H.e,r.j,H.h,H.f,r.g,r.q,r.y,h.d]),r._13(5120,H.k,H.l,[H.c]),r._13(4608,Ne.d,Ne.d,[l.a]),r._13(135680,Ne.a,Ne.a,[Ne.d,r.y]),r._13(5120,W.b,W.c,[H.c]),r._13(5120,Me.d,Me.a,[[3,Me.d],[2,Ce.a],De.c,[2,h.d]]),r._13(5120,Re.a,Re.b,[H.c]),r._13(4608,De.f,c.e,[[2,c.i],[2,c.n]]),r._13(4608,X,X,[]),r._13(4608,J,J,[X]),r._13(4608,L,L,[]),r._13(4608,he,he,[]),r._13(4608,ve,ve,[he]),r._13(512,h.c,h.c,[]),r._13(512,Ie.a,Ie.a,[]),r._13(512,ke.s,ke.s,[]),r._13(512,ke.h,ke.h,[]),r._13(512,v.a,v.a,[]),r._13(256,c.f,!0,[]),r._13(512,c.n,c.n,[[2,c.f]]),r._13(512,l.b,l.b,[]),r._13(512,c.x,c.x,[]),r._13(512,G.a,G.a,[]),r._13(512,q.c,q.c,[]),r._13(512,Te.c,Te.c,[]),r._13(512,Pe.c,Pe.c,[]),r._13(512,Le.c,Le.c,[]),r._13(512,ze.b,ze.b,[]),r._13(512,g.b,g.b,[]),r._13(512,je.g,je.g,[]),r._13(512,_.c,_.c,[]),r._13(512,H.g,H.g,[]),r._13(512,Ne.c,Ne.c,[]),r._13(512,W.e,W.e,[]),r._13(512,Me.c,Me.c,[]),r._13(512,M.h,M.h,[]),r._13(512,c.o,c.o,[]),r._13(512,c.v,c.v,[]),r._13(512,Fe.a,Fe.a,[]),r._13(512,Ue.c,Ue.c,[]),r._13(512,c.t,c.t,[]),r._13(512,Re.d,Re.d,[]),r._13(512,Be.h,Be.h,[]),r._13(512,Ve.b,Ve.b,[]),r._13(512,qe.b,qe.b,[]),r._13(512,u.j,u.j,[]),r._13(512,Ge.b,Ge.b,[]),r._13(512,We.b,We.b,[]),r._13(512,ae.b,ae.b,[]),r._13(512,He.a,He.a,[]),r._13(512,d.o,d.o,[[2,d.t],[2,d.l]]),r._13(512,Xe,Xe,[]),r._13(512,o,o,[]),r._13(256,W.a,{showDelay:0,hideDelay:0,touchendHideDelay:1500},[]),r._13(256,Be.a,!1,[]),r._13(1024,d.j,function(){return[[{path:"",component:E,children:[{path:"polynominalregretion",component:ee},{path:"learnedDigits",component:xe}]}]]},[])])})},YODX:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={};n.d(r,"aggregate",function(){return ti}),n.d(r,"bin",function(){return ri}),n.d(r,"collect",function(){return oi}),n.d(r,"compare",function(){return si}),n.d(r,"countpattern",function(){return li}),n.d(r,"cross",function(){return fi}),n.d(r,"density",function(){return hi}),n.d(r,"extent",function(){return gi}),n.d(r,"facet",function(){return yi}),n.d(r,"field",function(){return xi}),n.d(r,"filter",function(){return wi}),n.d(r,"flatten",function(){return Oi}),n.d(r,"fold",function(){return Si}),n.d(r,"formula",function(){return Ai}),n.d(r,"generate",function(){return ki}),n.d(r,"impute",function(){return Mi}),n.d(r,"joinaggregate",function(){return Ci}),n.d(r,"key",function(){return Ri}),n.d(r,"lookup",function(){return Pi}),n.d(r,"multiextent",function(){return Li}),n.d(r,"multivalues",function(){return ji}),n.d(r,"params",function(){return Ui}),n.d(r,"pivot",function(){return Bi}),n.d(r,"prefacet",function(){return qi}),n.d(r,"project",function(){return Gi}),n.d(r,"proxy",function(){return Wi}),n.d(r,"relay",function(){return Hi}),n.d(r,"sample",function(){return Xi}),n.d(r,"sequence",function(){return Yi}),n.d(r,"sieve",function(){return Ki}),n.d(r,"subflow",function(){return mi}),n.d(r,"tupleindex",function(){return Ji}),n.d(r,"values",function(){return Zi}),n.d(r,"window",function(){return na});var o={};n.d(o,"bound",function(){return Cl}),n.d(o,"identifier",function(){return Rl}),n.d(o,"mark",function(){return Il}),n.d(o,"overlap",function(){return Fl}),n.d(o,"render",function(){return Gl}),n.d(o,"viewlayout",function(){return nc});var s={};n.d(s,"interpolate",function(){return Lf}),n.d(s,"interpolateArray",function(){return Nf}),n.d(s,"interpolateBasis",function(){return gf}),n.d(s,"interpolateBasisClosed",function(){return mf}),n.d(s,"interpolateDate",function(){return Mf}),n.d(s,"interpolateNumber",function(){return Cf}),n.d(s,"interpolateObject",function(){return Df}),n.d(s,"interpolateRound",function(){return zf}),n.d(s,"interpolateString",function(){return Pf}),n.d(s,"interpolateTransformCss",function(){return Vf}),n.d(s,"interpolateTransformSvg",function(){return qf}),n.d(s,"interpolateZoom",function(){return Hf}),n.d(s,"interpolateRgb",function(){return _f}),n.d(s,"interpolateRgbBasis",function(){return kf}),n.d(s,"interpolateRgbBasisClosed",function(){return Tf}),n.d(s,"interpolateHsl",function(){return Yf}),n.d(s,"interpolateHslLong",function(){return Kf}),n.d(s,"interpolateLab",function(){return Jf}),n.d(s,"interpolateHcl",function(){return Qf}),n.d(s,"interpolateHclLong",function(){return $f}),n.d(s,"interpolateCubehelix",function(){return td}),n.d(s,"interpolateCubehelixLong",function(){return nd}),n.d(s,"quantize",function(){return rd});var u={};n.d(u,"schemeCategory10",function(){return ch}),n.d(u,"schemeAccent",function(){return fh}),n.d(u,"schemeDark2",function(){return dh}),n.d(u,"schemePaired",function(){return hh}),n.d(u,"schemePastel1",function(){return ph}),n.d(u,"schemePastel2",function(){return gh}),n.d(u,"schemeSet1",function(){return mh}),n.d(u,"schemeSet2",function(){return vh}),n.d(u,"schemeSet3",function(){return yh}),n.d(u,"interpolateBrBG",function(){return _h}),n.d(u,"schemeBrBG",function(){return xh}),n.d(u,"interpolatePRGn",function(){return Eh}),n.d(u,"schemePRGn",function(){return wh}),n.d(u,"interpolatePiYG",function(){return Sh}),n.d(u,"schemePiYG",function(){return Oh}),n.d(u,"interpolatePuOr",function(){return kh}),n.d(u,"schemePuOr",function(){return Ah}),n.d(u,"interpolateRdBu",function(){return Nh}),n.d(u,"schemeRdBu",function(){return Th}),n.d(u,"interpolateRdGy",function(){return Ch}),n.d(u,"schemeRdGy",function(){return Mh}),n.d(u,"interpolateRdYlBu",function(){return Rh}),n.d(u,"schemeRdYlBu",function(){return Dh}),n.d(u,"interpolateRdYlGn",function(){return Ph}),n.d(u,"schemeRdYlGn",function(){return Ih}),n.d(u,"interpolateSpectral",function(){return zh}),n.d(u,"schemeSpectral",function(){return Lh}),n.d(u,"interpolateBuGn",function(){return Fh}),n.d(u,"schemeBuGn",function(){return jh}),n.d(u,"interpolateBuPu",function(){return Bh}),n.d(u,"schemeBuPu",function(){return Uh}),n.d(u,"interpolateGnBu",function(){return qh}),n.d(u,"schemeGnBu",function(){return Vh}),n.d(u,"interpolateOrRd",function(){return Wh}),n.d(u,"schemeOrRd",function(){return Gh}),n.d(u,"interpolatePuBuGn",function(){return Xh}),n.d(u,"schemePuBuGn",function(){return Hh}),n.d(u,"interpolatePuBu",function(){return Kh}),n.d(u,"schemePuBu",function(){return Yh}),n.d(u,"interpolatePuRd",function(){return Zh}),n.d(u,"schemePuRd",function(){return Jh}),n.d(u,"interpolateRdPu",function(){return $h}),n.d(u,"schemeRdPu",function(){return Qh}),n.d(u,"interpolateYlGnBu",function(){return tp}),n.d(u,"schemeYlGnBu",function(){return ep}),n.d(u,"interpolateYlGn",function(){return rp}),n.d(u,"schemeYlGn",function(){return np}),n.d(u,"interpolateYlOrBr",function(){return ap}),n.d(u,"schemeYlOrBr",function(){return ip}),n.d(u,"interpolateYlOrRd",function(){return sp}),n.d(u,"schemeYlOrRd",function(){return op}),n.d(u,"interpolateBlues",function(){return lp}),n.d(u,"schemeBlues",function(){return up}),n.d(u,"interpolateGreens",function(){return fp}),n.d(u,"schemeGreens",function(){return cp}),n.d(u,"interpolateGreys",function(){return hp}),n.d(u,"schemeGreys",function(){return dp}),n.d(u,"interpolatePurples",function(){return gp}),n.d(u,"schemePurples",function(){return pp}),n.d(u,"interpolateReds",function(){return vp}),n.d(u,"schemeReds",function(){return mp}),n.d(u,"interpolateOranges",function(){return bp}),n.d(u,"schemeOranges",function(){return yp}),n.d(u,"interpolateCubehelixDefault",function(){return xp}),n.d(u,"interpolateRainbow",function(){return Op}),n.d(u,"interpolateWarm",function(){return _p}),n.d(u,"interpolateCool",function(){return wp}),n.d(u,"interpolateViridis",function(){return Ap}),n.d(u,"interpolateMagma",function(){return kp}),n.d(u,"interpolateInferno",function(){return Tp}),n.d(u,"interpolatePlasma",function(){return Np});var l={};n.d(l,"axisticks",function(){return Hp}),n.d(l,"datajoin",function(){return Xp}),n.d(l,"encode",function(){return Jp}),n.d(l,"legendentries",function(){return eg}),n.d(l,"linkpath",function(){return og}),n.d(l,"pie",function(){return cg}),n.d(l,"scale",function(){return pg}),n.d(l,"sortitems",function(){return vg}),n.d(l,"stack",function(){return yg}),n.d(l,"validTicks",function(){return qp});var c={};n.d(c,"contour",function(){return jg}),n.d(c,"geojson",function(){return Fg}),n.d(c,"geopath",function(){return Vb}),n.d(c,"geopoint",function(){return qb}),n.d(c,"geoshape",function(){return Gb}),n.d(c,"graticule",function(){return Wb}),n.d(c,"projection",function(){return Hb});var d={};n.d(d,"force",function(){return Px});var h={};n.d(h,"nest",function(){return I_}),n.d(h,"pack",function(){return j_}),n.d(h,"partition",function(){return B_}),n.d(h,"stratify",function(){return q_}),n.d(h,"tree",function(){return H_}),n.d(h,"treelinks",function(){return Y_}),n.d(h,"treemap",function(){return Z_});var p={};n.d(p,"voronoi",function(){return Pw});var g={};n.d(g,"wordcloud",function(){return Kw});var m={};n.d(m,"crossfilter",function(){return eE}),n.d(m,"resolvefilter",function(){return nE});var v=n("Bsgt");function _(e){var t=e||v.identity,n=[],r={};return n.add=function(e){var o=t(e);return r[o]||(r[o]=1,n.push(e)),n},n.remove=function(e){var o,s=t(e);return r[s]&&(r[s]=0,(o=n.indexOf(e))>=0&&n.splice(o,1)),n},n}var w=Symbol("vega_id"),E=1;function O(e){return!(!e||!S(e))}function S(e){return e[w]}function A(e,t){return e[w]=t,e}function T(e){var t=e===Object(e)?e:{data:e};return S(t)?t:A(t,E++)}function N(e){return M(e,T({}))}function M(e,t){for(var k in e)t[k]=e[k];return t}function C(e,t){return A(t,S(e))}function D(e){return e&&e.constructor===R}function R(){var e=[],t=[],n=[],r=[],o=[],s=!1;return{constructor:R,insert:function(t){for(var n=Object(v.array)(t),i=0,r=n.length;i<r;++i)e.push(n[i]);return this},remove:function(e){for(var a=Object(v.isFunction)(e)?r:t,n=Object(v.array)(e),i=0,o=n.length;i<o;++i)a.push(n[i]);return this},modify:function(e,t,value){var r={field:t,value:Object(v.constant)(value)};return Object(v.isFunction)(e)?(r.filter=e,o.push(r)):(r.tuple=e,n.push(r)),this},encode:function(e,t){return Object(v.isFunction)(e)?o.push({filter:e,field:t}):n.push({tuple:e,field:t}),this},reflow:function(){return s=!0,this},pulse:function(u,l){var c,i,d,h,f,p,g;for(i=0,d=e.length;i<d;++i)u.add.push(T(e[i]));for(c={},i=0,d=t.length;i<d;++i)c[S(p=t[i])]=p;for(i=0,d=r.length;i<d;++i)f=r[i],l.forEach(function(e){f(e)&&(c[S(e)]=e)});for(g in c)u.rem.push(c[g]);function m(e,f,t){t?e[f]=t(e):u.encode=f,s||(c[S(e)]=e)}for(c={},i=0,d=n.length;i<d;++i)m((h=n[i]).tuple,h.field,h.value),u.modifies(h.field);for(i=0,d=o.length;i<d;++i)f=(h=o[i]).filter,l.forEach(function(e){f(e)&&m(e,h.field,h.value)}),u.modifies(h.field);if(s)u.mod=t.length||r.length?l.filter(function(e){return c.hasOwnProperty(S(e))}):l.slice();else for(g in c)u.mod.push(c[g]);return u}}}var I="_:mod:_";function P(){Object.defineProperty(this,I,{writable:!0,value:{}})}var L=P.prototype;L.set=function(e,t,value,n){var r=this,o=r[e],s=r[I];return null!=t&&t>=0?(o[t]!==value||n)&&(o[t]=value,s[t+":"+e]=-1,s[e]=-1):(o!==value||n)&&(r[e]=value,s[e]=Object(v.isArray)(value)?1+value.length:-1),r},L.modified=function(e,t){var k,n=this[I];if(!arguments.length){for(k in n)if(n[k])return!0;return!1}if(Object(v.isArray)(e)){for(k=0;k<e.length;++k)if(n[e[k]])return!0;return!1}return null!=t&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},L.clear=function(){return this[I]={},this};var z=0,F=new P;function U(e,t,n,r){this.id=++z,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}var B=U.prototype;function V(e){return function(t){var f=this.flags;return 0===arguments.length?!!(f&e):(this.flags=t?f|e:f&~e,this)}}B.targets=function(){return this._targets||(this._targets=_(v.id))},B.set=function(value){return this.value!==value?(this.value=value,1):0},B.skip=V(1),B.modified=V(2),B.parameters=function(e,t){t=!1!==t;var n,value,r,i,o=this,s=o._argval=o._argval||new P,u=o._argops=o._argops||[],l=[];function c(e,n,value){value instanceof U?(value!==o&&(t&&value.targets().add(o),l.push(value)),u.push({op:value,name:e,index:n})):s.set(e,n,value)}for(n in e)if(value=e[n],"pulse"===n)Object(v.array)(value).forEach(function(e){e instanceof U?e!==o&&(e.targets().add(o),l.push(e)):Object(v.error)("Pulse parameters must be operator instances.")}),o.source=value;else if(Object(v.isArray)(value))for(s.set(n,-1,Array(r=value.length)),i=0;i<r;++i)c(n,i,value[i]);else c(n,-1,value);return this.marshall().clear(),l},B.marshall=function(e){var t,i,n,r,o,s=this._argval||F,u=this._argops;if(u&&(n=u.length))for(i=0;i<n;++i)o=(r=(t=u[i]).op).modified()&&r.stamp===e,s.set(t.name,t.index,r.value,o);return s},B.evaluate=function(e){if(this._update){var t=this.marshall(e.stamp),n=this._update(t,e);if(t.clear(),n!==this.value)this.value=n;else if(!this.modified())return e.StopPropagation}},B.run=function(e){return e.stamp<=this.stamp?e.StopPropagation:(this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.stamp=e.stamp,this.pulse=t,t||e);var t};var q=0;function G(e,t,n){this.id=++q,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function W(e,t,n){return new G(e,t,n)}var H=G.prototype;function X(){}function Y(e,f){var t=new X;if(e instanceof X)e.each(function(value,e){t.set(e,value)});else if(Array.isArray(e)){var n,i=-1,r=e.length;if(null==f)for(;++i<r;)t.set(i,e[i]);else for(;++i<r;)t.set(f(n=e[i],i,e),n)}else if(e)for(var o in e)t.set(o,e[o]);return t}H._filter=v.truthy,H._apply=v.identity,H.targets=function(){return this._targets||(this._targets=_(v.id))},H.consume=function(e){return arguments.length?(this._consume=!!e,this):!!this._consume},H.receive=function(e){if(this._filter(e)){for(var t=this.value=this._apply(e),n=this._targets,r=n?n.length:0,i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},H.filter=function(e){var t=W(e);return this.targets().add(t),t},H.apply=function(e){var t=W(null,e);return this.targets().add(t),t},H.merge=function(){var e=W();this.targets().add(e);for(var i=0,t=arguments.length;i<t;++i)arguments[i].targets().add(e);return e},H.throttle=function(e){var t=-1;return this.filter(function(){var n=Date.now();return n-t>e?(t=n,1):0})},H.debounce=function(e){var t=W();return this.targets().add(W(null,null,Object(v.debounce)(e,function(e){var n=e.dataflow;t.receive(e),n&&n.run&&n.run()}))),t},H.between=function(a,b){var e=!1;return a.targets().add(W(null,null,function(){e=!0})),b.targets().add(W(null,null,function(){e=!1})),this.filter(function(){return e})},X.prototype=Y.prototype={constructor:X,has:function(e){return"$"+e in this},get:function(e){return this["$"+e]},set:function(e,value){return this["$"+e]=value,this},remove:function(e){var t="$"+e;return t in this&&delete this[t]},clear:function(){for(var e in this)"$"===e[0]&&delete this[e]},keys:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)"$"===t[0]&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)"$"===t[0]&&++e;return e},empty:function(){for(var e in this)if("$"===e[0])return!1;return!0},each:function(f){for(var e in this)"$"===e[0]&&f(this[e],e.slice(1),this)}};var K=Y;function J(){return{}}function Z(e,t,value){e[t]=value}function Q(){return K()}function $(e,t,value){e.set(t,value)}function ee(){}var te=K.prototype;ee.prototype=(function(e,f){var t=new ee;if(e instanceof ee)e.each(function(value){t.add(value)});else if(e){var i=-1,n=e.length;if(null==f)for(;++i<n;)t.add(e[i]);else for(;++i<n;)t.add(f(e[i],i,e))}return t}).prototype={constructor:ee,has:te.has,add:function(value){return this["$"+(value+="")]=value,this},remove:te.remove,clear:te.clear,values:te.keys,size:te.size,empty:te.empty,each:te.each};var ne={value:function(){}};function re(){for(var e,i=0,t=arguments.length,n={};i<t;++i){if(!(e=arguments[i]+"")||e in n)throw new Error("illegal type: "+e);n[e]=[]}return new ie(n)}function ie(e){this._=e}function ae(e,t){for(var n,i=0,r=e.length;i<r;++i)if((n=e[i]).name===t)return n.value}function oe(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=ne,e=e.slice(0,i).concat(e.slice(i+1));break}return null!=n&&e.push({name:t,value:n}),e}ie.prototype=re.prototype={constructor:ie,on:function(e,t){var n,r,o=this._,s=(r=o,(e+"").trim().split(/^|\s+/).map(function(e){var t="",i=e.indexOf(".");if(i>=0&&(t=e.slice(i+1),e=e.slice(0,i)),e&&!r.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}})),i=-1,u=s.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++i<u;)if(n=(e=s[i]).type)o[n]=oe(o[n],e.name,t);else if(null==t)for(n in o)o[n]=oe(o[n],e.name,null);return this}for(;++i<u;)if((n=(e=s[i]).type)&&(n=ae(o[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new ie(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,o=new Array(n),i=0;i<n;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,n=(r=this._[e]).length;i<n;++i)r[i].value.apply(t,o)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};var se=re,ue=function(e,t){var n,r,o,s,u=se("beforesend","progress","load","error"),l=K(),c=new XMLHttpRequest,d=null,h=null,p=0;function g(e){var t,r=c.status;if(!r&&function(e){var t=e.responseType;return t&&"text"!==t?e.response:e.responseText}(c)||r>=200&&r<300||304===r){if(o)try{t=o.call(n,c)}catch(e){return void u.call("error",n,e)}else t=c;u.call("load",n,t)}else u.call("error",n,e)}if("undefined"==typeof XDomainRequest||"withCredentials"in c||!/^(http(s)?:)?\/\//.test(e)||(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=c.ontimeout=g:c.onreadystatechange=function(e){c.readyState>3&&g(e)},c.onprogress=function(e){u.call("progress",n,e)},n={header:function(e,value){return e=(e+"").toLowerCase(),arguments.length<2?l.get(e):(null==value?l.remove(e):l.set(e,value+""),n)},mimeType:function(value){return arguments.length?(r=null==value?null:value+"",n):r},responseType:function(value){return arguments.length?(s=value,n):s},timeout:function(value){return arguments.length?(p=+value,n):p},user:function(value){return arguments.length<1?d:(d=null==value?null:value+"",n)},password:function(value){return arguments.length<1?h:(h=null==value?null:value+"",n)},response:function(value){return o=value,n},get:function(e,t){return n.send("GET",e,t)},post:function(e,t){return n.send("POST",e,t)},send:function(t,o,g){return c.open(t,e,!0,d,h),null==r||l.has("accept")||l.set("accept",r+",*/*"),c.setRequestHeader&&l.each(function(value,e){c.setRequestHeader(e,value)}),null!=r&&c.overrideMimeType&&c.overrideMimeType(r),null!=s&&(c.responseType=s),p>0&&(c.timeout=p),null==g&&"function"==typeof o&&(g=o,o=null),null!=g&&1===g.length&&(g=function(e){return function(t,n){e(null==t?n:null)}}(g)),null!=g&&n.on("error",g).on("load",function(e){g(null,e)}),u.call("beforesend",n,c),c.send(null==o?null:o),n},abort:function(){return c.abort(),n},on:function(){var value=u.on.apply(u,arguments);return value===u?n:value}},null!=t){if("function"!=typeof t)throw new Error("invalid callback: "+t);return n.get(t)}return n},le=function(e,t){return function(n,r){var o=ue(n).mimeType(e).response(t);if(null!=r){if("function"!=typeof r)throw new Error("invalid callback: "+r);return o.get(r)}return o}},ce=(le("text/html",function(e){return document.createRange().createContextualFragment(e.responseText)}),le("application/json",function(e){return JSON.parse(e.responseText)}),le("text/plain",function(e){return e.responseText}),le("application/xml",function(e){var t=e.responseXML;if(!t)throw new Error("parse error");return t}),{}),fe={},de=34,he=10,pe=13;function ge(e){return new Function("d","return {"+e.map(function(e,i){return JSON.stringify(e)+": d["+i+"]"}).join(",")+"}")}var me=function(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,f){var t,r=[],o=e.length,s=0,u=0,l=o<=0,c=!1;function d(){if(l)return fe;if(c)return c=!1,ce;var i,t,j=s;if(e.charCodeAt(j)===de){for(;s++<o&&e.charCodeAt(s)!==de||e.charCodeAt(++s)===de;);return(i=s)>=o?l=!0:(t=e.charCodeAt(s++))===he?c=!0:t===pe&&(c=!0,e.charCodeAt(s)===he&&++s),e.slice(j+1,i-1).replace(/""/g,'"')}for(;s<o;){if((t=e.charCodeAt(i=s++))===he)c=!0;else if(t===pe)c=!0,e.charCodeAt(s)===he&&++s;else if(t!==n)continue;return e.slice(j,i)}return l=!0,e.slice(j,o)}for(e.charCodeAt(o-1)===he&&--o,e.charCodeAt(o-1)===pe&&--o;(t=d())!==fe;){for(var h=[];t!==ce&&t!==fe;)h.push(t),t=d();f&&null==(h=f(h,u++))||r.push(h)}return r}function o(t){return t.map(s).join(e)}function s(e){return null==e?"":t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,f){var t,n,o=r(e,function(e,i){if(t)return t(e,i-1);n=e,t=f?function(e,f){var t=ge(e);return function(n,i){return f(t(n),i,e)}}(e,f):ge(e)});return o.columns=n||[],o},parseRows:r,format:function(t,n){return null==n&&(n=function(e){var t=Object.create(null),n=[];return e.forEach(function(e){for(var r in e)r in t||n.push(t[r]=r)}),n}(t)),[n.map(s).join(e)].concat(t.map(function(t){return n.map(function(e){return s(t[e])}).join(e)})).join("\n")},formatRows:function(e){return e.map(o).join("\n")}}},ve=me(",").parse,ye=me("\t").parse,be=function(e,t){return function(n,r,o){arguments.length<3&&(o=r,r=null);var s=ue(n).mimeType(e);return s.row=function(e){return arguments.length?s.response(function(e,t){return function(n){return e(n.responseText,t)}}(t,r=e)):r},s.row(r),o?s.get(o):s}};be("text/csv",ve),be("text/tab-separated-values",ye);var xe=/^([A-Za-z]+:)?\/\//,_e="file://",we=["mimeType","responseType","user","password"],Ee=function(e){return{options:e||{},sanitize:Ae,load:Se,file:Te,http:ke}};function Oe(e,t){return Object(v.extend)({},e.options,t)}function Se(e,t){var n=this;return n.sanitize(e,t).then(function(e){var r=e.href;return e.localFile?n.file(r):n.http(r,t)})}function Ae(e,t){return t=Oe(this,t),new Promise(function(n,r){var o,s,u,l,c={href:null};null!=e&&"string"==typeof e?(s=xe.test(e),(l=t.baseURL)&&!s&&(Me(e,"/")||"/"===l[l.length-1]||(e="/"+e),e=l+e),u=(o=Me(e,_e))||"file"===t.mode||"http"!==t.mode&&!s&&Ne(),o?e=e.slice(_e.length):Me(e,"//")&&("file"===t.defaultProtocol?(e=e.slice(2),u=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(c,"localFile",{value:!!u}),c.href=e,t.target&&(c.target=t.target+""),n(c)):r("Sanitize failure, invalid URI: "+Object(v.stringValue)(e))})}function ke(e,t){return t=Oe(this,t),new Promise(function(n,r){var o,s=ue(e);for(o in t.headers)s.header(o,t.headers[o]);we.forEach(function(e){t[e]&&s[e](t[e])}),s.on("error",function(t){r(t||"Error loading URL: "+e)}).on("load",function(e){var t=e&&e.responseText;e&&0!==e.status?n(t):r(t||"Error")}).get()})}function Te(e){return new Promise(function(t,n){var f=Ne();f?f.readFile(e,function(e,r){e?n(e):t(r)}):n("No file system access for "+e)})}function Ne(){var e=n(3);return e&&Object(v.isFunction)(e.readFile)?e:null}function Me(e,t){return null!=e&&0===e.lastIndexOf(t,0)}var Ce={boolean:v.toBoolean,integer:v.toNumber,number:v.toNumber,date:v.toDate,string:v.toString,unknown:v.identity},De=[function(e){return"true"===e||"false"===e||!0===e||!1===e},function(e){return Le(e)&&(e=+e)==~~e},Le,function(e){return!isNaN(Date.parse(e))}],Re=["boolean","integer","number","date"];function Ie(e,t){if(!e||!e.length)return"unknown";var value,i,n,j,r,o=De.slice();for(i=0,n=e.length;i<n;++i){for(value=t?e[i][t]:e[i],j=0;j<o.length;++j)null==(r=value)||r!=r||o[j](value)||(o.splice(j,1),--j);if(0===o.length)return"string"}return Re[De.indexOf(o[0])]}function Pe(e,t){return t.reduce(function(t,n){return t[n]=Ie(e,n),t},{})}function Le(e){return!(isNaN(+e)||e instanceof Date)}function ze(e){return function(t,n){var r={delimiter:e};return je(t,n?Object(v.extend)(n,r):r)}}function je(e,t){return t.header&&(e=t.header.map(v.stringValue).join(t.delimiter)+"\n"+e),me(t.delimiter).parse(e+"")}var Fe=n("8eNT"),Ue=function(x){return x},Be=function(e){if(null==e)return Ue;var t,n,r=e.scale[0],o=e.scale[1],s=e.translate[0],u=e.translate[1];return function(e,i){i||(t=n=0);var j=2,l=e.length,c=new Array(l);for(c[0]=(t+=e[0])*r+s,c[1]=(n+=e[1])*o+u;j<l;)c[j]=e[j],++j;return c}},Ve=function(e,t){for(var n,j=e.length,i=j-t;i<--j;)n=e[i],e[i++]=e[j],e[j]=n},qe=function(e,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return Ge(e,t)})}:Ge(e,t)};function Ge(e,t){var n=t.id,r=t.bbox,o=null==t.properties?{}:t.properties,s=We(e,t);return null==n&&null==r?{type:"Feature",properties:o,geometry:s}:null==r?{type:"Feature",id:n,properties:o,geometry:s}:{type:"Feature",id:n,bbox:r,properties:o,geometry:s}}function We(e,t){var n=Be(e.transform),r=e.arcs;function o(i,e){e.length&&e.pop();for(var a=r[i<0?~i:i],k=0,t=a.length;k<t;++k)e.push(n(a[k],k));i<0&&Ve(e,t)}function s(e){return n(e)}function u(e){for(var t=[],i=0,n=e.length;i<n;++i)o(e[i],t);return t.length<2&&t.push(t[0]),t}function l(e){for(var t=u(e);t.length<4;)t.push(t[0]);return t}function c(e){return e.map(l)}return function e(t){var n,r=t.type;switch(r){case"GeometryCollection":return{type:r,geometries:t.geometries.map(e)};case"Point":n=s(t.coordinates);break;case"MultiPoint":n=t.coordinates.map(s);break;case"LineString":n=u(t.arcs);break;case"MultiLineString":n=t.arcs.map(u);break;case"Polygon":n=c(t.arcs);break;case"MultiPolygon":n=t.arcs.map(c);break;default:return null}return{type:r,coordinates:n}}(t)}var He=function(e){return We(e,(function(e,t,n){var r,i,o;if(arguments.length>1)r=function(e,t,n){var r,o=[],s=[];function u(i){var j=i<0?~i:i;(s[j]||(s[j]=[])).push({i:i,g:r})}function l(e){e.forEach(u)}function c(e){e.forEach(l)}return function e(t){switch(r=t,t.type){case"GeometryCollection":t.geometries.forEach(e);break;case"LineString":l(t.arcs);break;case"MultiLineString":case"Polygon":c(t.arcs);break;case"MultiPolygon":t.arcs.forEach(c)}}(t),s.forEach(null==n?function(e){o.push(e[0].i)}:function(e){n(e[0].g,e[e.length-1].g)&&o.push(e[0].i)}),o}(0,t,n);else for(i=0,r=new Array(o=e.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:function(e,t){var n={},r={},o={},s=[],u=-1;function l(e,t){for(var k in e){var f=e[k];delete t[f.start],delete f.start,delete f.end,f.forEach(function(i){n[i<0?~i:i]=1}),s.push(f)}}return t.forEach(function(i,j){var n,r=e.arcs[i<0?~i:i];r.length<3&&!r[1][0]&&!r[1][1]&&(n=t[++u],t[u]=i,t[j]=n)}),t.forEach(function(i){var f,t,n=function(i){var t,n=e.arcs[i<0?~i:i],r=n[0];return e.transform?(t=[0,0],n.forEach(function(e){t[0]+=e[0],t[1]+=e[1]})):t=n[n.length-1],i<0?[t,r]:[r,t]}(i),s=n[0],u=n[1];if(f=o[s])if(delete o[f.end],f.push(i),f.end=u,t=r[u]){delete r[t.start];var l=t===f?f:f.concat(t);r[l.start=f.start]=o[l.end=t.end]=l}else r[f.start]=o[f.end]=f;else if(f=r[u])if(delete r[f.start],f.unshift(i),f.start=s,t=o[s]){delete o[t.end];var c=t===f?f:t.concat(f);r[c.start=t.start]=o[c.end=f.end]=c}else r[f.start]=o[f.end]=f;else r[(f=[i]).start=s]=o[f.end=u]=f}),l(o,r),l(r,o),t.forEach(function(i){n[i<0?~i:i]||s.push([i])}),s}(e,r)}}).apply(this,arguments))},Xe={dsv:je,csv:ze(","),tsv:ze("\t"),json:Fe.a,topojson:function(e,t){var n,r,o;return e=Object(Fe.a)(e,t),n=t&&(o=t.feature)?qe:t&&(o=t.mesh)?He:Object(v.error)("Missing TopoJSON feature or mesh parameter."),(r=(r=e.objects[o])?n(e,r):Object(v.error)("Invalid TopoJSON object: "+o))&&r.features||[r]}},Ye=function(e,t){return arguments.length>1?(Xe[e]=t,this):Xe.hasOwnProperty(e)?Xe[e]:null},Ke=new Date,Je=new Date;function Ze(e,t,n,r){function o(t){return e(t=new Date(+t)),t}return o.floor=o,o.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},o.round=function(e){var t=o(e),n=o.ceil(e);return e-t<n-e?t:n},o.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},o.range=function(n,r,s){var u,l=[];if(n=o.ceil(n),s=null==s?1:Math.floor(s),!(n<r&&s>0))return l;do{l.push(u=new Date(+n)),t(n,s),e(n)}while(u<n&&n<r);return l},o.filter=function(n){return Ze(function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})},n&&(o.count=function(t,r){return Ke.setTime(+t),Je.setTime(+r),e(Ke),e(Je),Math.floor(n(Ke,Je))},o.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?o.filter(r?function(t){return r(t)%e==0}:function(t){return o.count(0,t)%e==0}):o:null}),o}var Qe=Ze(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});Qe.every=function(k){return k=Math.floor(k),isFinite(k)&&k>0?k>1?Ze(function(e){e.setTime(Math.floor(e/k)*k)},function(e,t){e.setTime(+e+t*k)},function(e,t){return(t-e)/k}):Qe:null};var $e=Qe,et=6e4,tt=6048e5,nt=Ze(function(e){e.setTime(1e3*Math.floor(e/1e3))},function(e,t){e.setTime(+e+1e3*t)},function(e,t){return(t-e)/1e3},function(e){return e.getUTCSeconds()}),rt=Ze(function(e){e.setTime(Math.floor(e/et)*et)},function(e,t){e.setTime(+e+t*et)},function(e,t){return(t-e)/et},function(e){return e.getMinutes()}),it=Ze(function(e){var t=e.getTimezoneOffset()*et%36e5;t<0&&(t+=36e5),e.setTime(36e5*Math.floor((+e-t)/36e5)+t)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getHours()}),at=Ze(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*et)/864e5},function(e){return e.getDate()-1});function ot(i){return Ze(function(e){e.setDate(e.getDate()-(e.getDay()+7-i)%7),e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*et)/tt})}var st=ot(0),ut=ot(1),lt=(ot(2),ot(3),ot(4)),ct=(ot(5),ot(6),Ze(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()})),ft=Ze(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});ft.every=function(k){return isFinite(k=Math.floor(k))&&k>0?Ze(function(e){e.setFullYear(Math.floor(e.getFullYear()/k)*k),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t*k)}):null};var dt=ft,ht=Ze(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*et)},function(e,t){return(t-e)/et},function(e){return e.getUTCMinutes()}),pt=Ze(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getUTCHours()}),gt=Ze(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/864e5},function(e){return e.getUTCDate()-1});function mt(i){return Ze(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-i)%7),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/tt})}var vt=mt(0),yt=mt(1),bt=(mt(2),mt(3),mt(4)),xt=(mt(5),mt(6),Ze(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()})),_t=Ze(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});_t.every=function(k){return isFinite(k=Math.floor(k))&&k>0?Ze(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/k)*k),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t*k)}):null};var wt=_t;function Et(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Ot(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function St(y){return{y:y,m:0,d:1,H:0,M:0,S:0,L:0}}var At,kt,Tt,Nt,Mt,Ct={"-":"",_:" ",0:"0"},Dt=/^\s*\d+/,Rt=/^%/,It=/[\\^$*+?|[\]().{}]/g;function Pt(value,e,t){var n=value<0?"-":"",r=(n?-value:value)+"",o=r.length;return n+(o<t?new Array(t-o+1).join(e)+r:r)}function Lt(e){return e.replace(It,"\\$&")}function zt(e){return new RegExp("^(?:"+e.map(Lt).join("|")+")","i")}function jt(e){for(var t={},i=-1,n=e.length;++i<n;)t[e[i].toLowerCase()]=i;return t}function Ft(e,t,i){var n=Dt.exec(t.slice(i,i+1));return n?(e.w=+n[0],i+n[0].length):-1}function Ut(e,t,i){var n=Dt.exec(t.slice(i,i+1));return n?(e.u=+n[0],i+n[0].length):-1}function Bt(e,t,i){var n=Dt.exec(t.slice(i,i+2));return n?(e.U=+n[0],i+n[0].length):-1}function Vt(e,t,i){var n=Dt.exec(t.slice(i,i+2));return n?(e.V=+n[0],i+n[0].length):-1}function qt(e,t,i){var n=Dt.exec(t.slice(i,i+2));return n?(e.W=+n[0],i+n[0].length):-1}function Gt(e,t,i){var n=Dt.exec(t.slice(i,i+4));return n?(e.y=+n[0],i+n[0].length):-1}function Wt(e,t,i){var n=Dt.exec(t.slice(i,i+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),i+n[0].length):-1}function Ht(e,t,i){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(i,i+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),i+n[0].length):-1}function Xt(e,t,i){var n=Dt.exec(t.slice(i,i+2));return n?(e.m=n[0]-1,i+n[0].length):-1}function Yt(e,t,i){var n=Dt.exec(t.slice(i,i+2));return n?(e.d=+n[0],i+n[0].length):-1}function Kt(e,t,i){var n=Dt.exec(t.slice(i,i+3));return n?(e.m=0,e.d=+n[0],i+n[0].length):-1}function Jt(e,t,i){var n=Dt.exec(t.slice(i,i+2));return n?(e.H=+n[0],i+n[0].length):-1}function Zt(e,t,i){var n=Dt.exec(t.slice(i,i+2));return n?(e.M=+n[0],i+n[0].length):-1}function Qt(e,t,i){var n=Dt.exec(t.slice(i,i+2));return n?(e.S=+n[0],i+n[0].length):-1}function $t(e,t,i){var n=Dt.exec(t.slice(i,i+3));return n?(e.L=+n[0],i+n[0].length):-1}function en(e,t,i){var n=Dt.exec(t.slice(i,i+6));return n?(e.L=Math.floor(n[0]/1e3),i+n[0].length):-1}function tn(e,t,i){var n=Rt.exec(t.slice(i,i+1));return n?i+n[0].length:-1}function nn(e,t,i){var n=Dt.exec(t.slice(i));return n?(e.Q=+n[0],i+n[0].length):-1}function rn(e,t,i){var n=Dt.exec(t.slice(i));return n?(e.Q=1e3*+n[0],i+n[0].length):-1}function an(e,t){return Pt(e.getDate(),t,2)}function on(e,t){return Pt(e.getHours(),t,2)}function sn(e,t){return Pt(e.getHours()%12||12,t,2)}function un(e,t){return Pt(1+at.count(dt(e),e),t,3)}function ln(e,t){return Pt(e.getMilliseconds(),t,3)}function cn(e,t){return ln(e,t)+"000"}function fn(e,t){return Pt(e.getMonth()+1,t,2)}function dn(e,t){return Pt(e.getMinutes(),t,2)}function hn(e,t){return Pt(e.getSeconds(),t,2)}function pn(e){var t=e.getDay();return 0===t?7:t}function gn(e,t){return Pt(st.count(dt(e),e),t,2)}function mn(e,t){var n=e.getDay();return e=n>=4||0===n?lt(e):lt.ceil(e),Pt(lt.count(dt(e),e)+(4===dt(e).getDay()),t,2)}function vn(e){return e.getDay()}function yn(e,t){return Pt(ut.count(dt(e),e),t,2)}function bn(e,t){return Pt(e.getFullYear()%100,t,2)}function xn(e,t){return Pt(e.getFullYear()%1e4,t,4)}function _n(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Pt(t/60|0,"0",2)+Pt(t%60,"0",2)}function wn(e,t){return Pt(e.getUTCDate(),t,2)}function En(e,t){return Pt(e.getUTCHours(),t,2)}function On(e,t){return Pt(e.getUTCHours()%12||12,t,2)}function Sn(e,t){return Pt(1+gt.count(wt(e),e),t,3)}function An(e,t){return Pt(e.getUTCMilliseconds(),t,3)}function kn(e,t){return An(e,t)+"000"}function Tn(e,t){return Pt(e.getUTCMonth()+1,t,2)}function Nn(e,t){return Pt(e.getUTCMinutes(),t,2)}function Mn(e,t){return Pt(e.getUTCSeconds(),t,2)}function Cn(e){var t=e.getUTCDay();return 0===t?7:t}function Dn(e,t){return Pt(vt.count(wt(e),e),t,2)}function Rn(e,t){var n=e.getUTCDay();return e=n>=4||0===n?bt(e):bt.ceil(e),Pt(bt.count(wt(e),e)+(4===wt(e).getUTCDay()),t,2)}function In(e){return e.getUTCDay()}function Pn(e,t){return Pt(yt.count(wt(e),e),t,2)}function Ln(e,t){return Pt(e.getUTCFullYear()%100,t,2)}function zn(e,t){return Pt(e.getUTCFullYear()%1e4,t,4)}function jn(){return"+0000"}function Fn(){return"%"}function Un(e){return+e}function Bn(e){return Math.floor(+e/1e3)}function Vn(e){return At=function(t){var n=e.dateTime,r=e.date,o=e.time,s=e.periods,u=e.days,l=e.shortDays,c=e.months,d=e.shortMonths,h=zt(s),p=jt(s),g=zt(u),m=jt(u),v=zt(l),_=jt(l),w=zt(c),E=jt(c),O=zt(d),S=jt(d),A={a:function(e){return l[e.getDay()]},A:function(e){return u[e.getDay()]},b:function(e){return d[e.getMonth()]},B:function(e){return c[e.getMonth()]},c:null,d:an,e:an,f:cn,H:on,I:sn,j:un,L:ln,m:fn,M:dn,p:function(e){return s[+(e.getHours()>=12)]},Q:Un,s:Bn,S:hn,u:pn,U:gn,V:mn,w:vn,W:yn,x:null,X:null,y:bn,Y:xn,Z:_n,"%":Fn},T={a:function(e){return l[e.getUTCDay()]},A:function(e){return u[e.getUTCDay()]},b:function(e){return d[e.getUTCMonth()]},B:function(e){return c[e.getUTCMonth()]},c:null,d:wn,e:wn,f:kn,H:En,I:On,j:Sn,L:An,m:Tn,M:Nn,p:function(e){return s[+(e.getUTCHours()>=12)]},Q:Un,s:Bn,S:Mn,u:Cn,U:Dn,V:Rn,w:In,W:Pn,x:null,X:null,y:Ln,Y:zn,Z:jn,"%":Fn},N={a:function(e,t,i){var n=v.exec(t.slice(i));return n?(e.w=_[n[0].toLowerCase()],i+n[0].length):-1},A:function(e,t,i){var n=g.exec(t.slice(i));return n?(e.w=m[n[0].toLowerCase()],i+n[0].length):-1},b:function(e,t,i){var n=O.exec(t.slice(i));return n?(e.m=S[n[0].toLowerCase()],i+n[0].length):-1},B:function(e,t,i){var n=w.exec(t.slice(i));return n?(e.m=E[n[0].toLowerCase()],i+n[0].length):-1},c:function(e,t,i){return D(e,n,t,i)},d:Yt,e:Yt,f:en,H:Jt,I:Jt,j:Kt,L:$t,m:Xt,M:Zt,p:function(e,t,i){var n=h.exec(t.slice(i));return n?(e.p=p[n[0].toLowerCase()],i+n[0].length):-1},Q:nn,s:rn,S:Qt,u:Ut,U:Bt,V:Vt,w:Ft,W:qt,x:function(e,t,i){return D(e,r,t,i)},X:function(e,t,i){return D(e,o,t,i)},y:Wt,Y:Gt,Z:Ht,"%":tn};function M(e,t){return function(n){var r,o,s,u=[],i=-1,j=0,l=e.length;for(n instanceof Date||(n=new Date(+n));++i<l;)37===e.charCodeAt(i)&&(u.push(e.slice(j,i)),null!=(o=Ct[r=e.charAt(++i)])?r=e.charAt(++i):o="e"===r?" ":"0",(s=t[r])&&(r=s(n,o)),u.push(r),j=i+1);return u.push(e.slice(j,i)),u.join("")}}function C(e,t){return function(n){var r,o,s=St(1900);if(D(s,e,n+="",0)!=n.length)return null;if("Q"in s)return new Date(s.Q);if("p"in s&&(s.H=s.H%12+12*s.p),"V"in s){if(s.V<1||s.V>53)return null;"w"in s||(s.w=1),"Z"in s?(r=(o=(r=Ot(St(s.y))).getUTCDay())>4||0===o?yt.ceil(r):yt(r),r=gt.offset(r,7*(s.V-1)),s.y=r.getUTCFullYear(),s.m=r.getUTCMonth(),s.d=r.getUTCDate()+(s.w+6)%7):(r=(o=(r=t(St(s.y))).getDay())>4||0===o?ut.ceil(r):ut(r),r=at.offset(r,7*(s.V-1)),s.y=r.getFullYear(),s.m=r.getMonth(),s.d=r.getDate()+(s.w+6)%7)}else("W"in s||"U"in s)&&("w"in s||(s.w="u"in s?s.u%7:"W"in s?1:0),o="Z"in s?Ot(St(s.y)).getUTCDay():t(St(s.y)).getDay(),s.m=0,s.d="W"in s?(s.w+6)%7+7*s.W-(o+5)%7:s.w+7*s.U-(o+6)%7);return"Z"in s?(s.H+=s.Z/100|0,s.M+=s.Z%100,Ot(s)):t(s)}}function D(e,t,n,j){for(var r,o,i=0,s=t.length,u=n.length;i<s;){if(j>=u)return-1;if(37===(r=t.charCodeAt(i++))){if(r=t.charAt(i++),!(o=N[r in Ct?t.charAt(i++):r])||(j=o(e,n,j))<0)return-1}else if(r!=n.charCodeAt(j++))return-1}return j}return A.x=M(r,A),A.X=M(o,A),A.c=M(n,A),T.x=M(r,T),T.X=M(o,T),T.c=M(n,T),{format:function(e){var f=M(e+="",A);return f.toString=function(){return e},f},parse:function(e){var t=C(e+="",Et);return t.toString=function(){return e},t},utcFormat:function(e){var f=M(e+="",T);return f.toString=function(){return e},f},utcParse:function(e){var t=C(e,Ot);return t.toString=function(){return e},t}}}(),kt=At.format,Tt=At.parse,Nt=At.utcFormat,Mt=At.utcParse,At}Vn({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),Date.prototype.toISOString||Nt("%Y-%m-%dT%H:%M:%S.%LZ"),+new Date("2000-01-01T00:00:00.000Z")||Mt("%Y-%m-%dT%H:%M:%S.%LZ");var qn=function(e,t,n){var r=Ye((t=t||{}).type||"json");return r||Object(v.error)("Unknown data format type: "+t.type),e=r(e,t),t.parse&&function(e,t,n){if(e.length){n=n||Tt;var r,o,s,i,j,u,l,c=e.columns||Object.keys(e[0]);for("auto"===t&&(t=Pe(e,c)),r=(c=Object.keys(t)).map(function(e){var r,o,s=t[e];if(s&&(0===s.indexOf("date:")||0===s.indexOf("utc:")))return("'"===(o=(r=s.split(/:(.+)?/,2))[1])[0]&&"'"===o[o.length-1]||'"'===o[0]&&'"'===o[o.length-1])&&(o=o.slice(1,-1)),"utc"===r[0]?Mt(o):n(o);if(!Ce[s])throw Error("Illegal format pattern: "+e+":"+s);return Ce[s]}),i=0,u=e.length,l=c.length;i<u;++i)for(o=e[i],j=0;j<l;++j)o[s=c[j]]=r[j](o[s])}}(e,t.parse,n),e.hasOwnProperty("columns")&&delete e.columns,e},Gn={skip:!0},Wn={};function Hn(e,t,n){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}var Xn=Hn.prototype;function Yn(a,b){return a?function(e,i){return a(e,i)&&b(e,i)}:b}function Kn(e,t){var n=[];return Object(v.visitArray)(e,t,function(e){n.push(e)}),n}function Jn(e,t){var n={};return e.visit(t,function(e){n[S(e)]=1}),function(e){return n[S(e)]?null:e}}function Zn(e,t,n,r){var o,s,i,u,f,l=this,c=0;for(this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n,i=0,u=n.length;i<u;++i)if((o=n[i]).stamp===t){if(o.fields)for(f in s=l.fields||(l.fields={}),o.fields)s[f]=1;o.changed(l.ADD)&&(c|=l.ADD),o.changed(l.REM)&&(c|=l.REM),o.changed(l.MOD)&&(c|=l.MOD)}this.changes=c}Xn.StopPropagation=Wn,Xn.ADD=1,Xn.REM=2,Xn.MOD=4,Xn.ADD_REM=3,Xn.ADD_MOD=5,Xn.ALL=7,Xn.REFLOW=8,Xn.SOURCE=16,Xn.NO_SOURCE=32,Xn.NO_FIELDS=64,Xn.fork=function(e){return new Hn(this.dataflow).init(this,e)},Xn.addAll=function(){var e=this;return this.source&&this.source.length!==this.add.length?((e=new Hn(this.dataflow).init(this)).add=e.source,e):e},Xn.init=function(e,t){var n=this;return n.stamp=e.stamp,n.encode=e.encode,!e.fields||64&t||(n.fields=e.fields),1&t?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),2&t?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),4&t?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),32&t?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source),n},Xn.runAfter=function(e){this.dataflow.runAfter(e)},Xn.changed=function(e){var f=e||7;return 1&f&&this.add.length||2&f&&this.rem.length||4&f&&this.mod.length},Xn.reflow=function(e){if(e)return this.fork(7).reflow();var t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(4,Jn(this,1))),this},Xn.modifies=function(e){var t=Object(v.array)(e),n=this.fields||(this.fields={});return t.forEach(function(f){n[f]=!0}),this},Xn.modified=function(e){var t=this.fields;return!(!this.mod.length||!t)&&(arguments.length?Object(v.isArray)(e)?e.some(function(f){return t[f]}):t[e]:!!t)},Xn.filter=function(e,t){var n=this;return 1&e&&(n.addF=Yn(n.addF,t)),2&e&&(n.remF=Yn(n.remF,t)),4&e&&(n.modF=Yn(n.modF,t)),16&e&&(n.srcF=Yn(n.srcF,t)),n},Xn.materialize=function(e){var t=this;return 1&(e=e||7)&&t.addF&&(t.add=Kn(t.add,t.addF),t.addF=null),2&e&&t.remF&&(t.rem=Kn(t.rem,t.remF),t.remF=null),4&e&&t.modF&&(t.mod=Kn(t.mod,t.modF),t.modF=null),16&e&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},Xn.visit=function(e,t){var n,sum,r=this,o=t;return 16&e?(Object(v.visitArray)(r.source,r.srcF,o),r):(1&e&&Object(v.visitArray)(r.add,r.addF,o),2&e&&Object(v.visitArray)(r.rem,r.remF,o),4&e&&Object(v.visitArray)(r.mod,r.modF,o),8&e&&(n=r.source)&&((sum=r.add.length+r.mod.length)===n.length||(sum?Object(v.visitArray)(n,Jn(r,5),o):Object(v.visitArray)(n,r.srcF,o))),r)};var Qn=Object(v.inherits)(Zn,Hn);function $n(e,t){try{t(e)}catch(t){e.error(t)}}Qn.fork=function(e){var t=new Hn(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&t.ADD&&this.visit(t.ADD,function(e){return t.add.push(e)}),e&t.REM&&this.visit(t.REM,function(e){return t.rem.push(e)}),e&t.MOD&&this.visit(t.MOD,function(e){return t.mod.push(e)})),t},Qn.changed=function(e){return this.changes&e},Qn.modified=function(e){var t=this,n=t.fields;return n&&t.changes&t.MOD?Object(v.isArray)(e)?e.some(function(f){return n[f]}):n[e]:0},Qn.filter=function(){Object(v.error)("MultiPulse does not support filtering.")},Qn.materialize=function(){Object(v.error)("MultiPulse does not support materialization.")},Qn.visit=function(e,t){var n=this,r=n.pulses,o=r.length,i=0;if(e&n.SOURCE)for(;i<o;++i)r[i].visit(e,t);else for(;i<o;++i)r[i].stamp===n.stamp&&r[i].visit(e,t);return n};var er={skip:!1,force:!1};function tr(e){this.cmp=e,this.nodes=[]}var nr=tr.prototype;function rr(e,t,n,r){var o,s,u;for(o=e[n];n>t&&r(o,s=e[u=n-1>>1])<0;)e[n]=s,n=u;return e[n]=o}function ir(e,t,n){for(var r,o=t,s=e.length,u=e[t],l=2*t+1;l<s;)(r=l+1)<s&&n(e[l],e[r])>=0&&(l=r),e[t]=e[l],l=2*(t=l)+1;return e[t]=u,rr(e,o,t,n)}function ar(){this._log=Object(v.logger)(),this.logLevel(v.Error),this._clock=0,this._rank=0;try{this._loader=Ee()}catch(e){}this._touched=_(v.id),this._pulses={},this._pulse=null,this._heap=new tr(function(a,b){return a.qrank-b.qrank}),this._postrun=[]}nr.size=function(){return this.nodes.length},nr.clear=function(){return this.nodes=[],this},nr.peek=function(){return this.nodes[0]},nr.push=function(x){var e=this.nodes;return e.push(x),rr(e,0,e.length-1,this.cmp)},nr.pop=function(){var e,t=this.nodes,n=t.pop();return t.length?(e=t[0],t[0]=n,ir(t,0,this.cmp)):e=n,e},nr.replace=function(e){var t=this.nodes,n=t[0];return t[0]=e,ir(t,0,this.cmp),n},nr.pushpop=function(e){var t=this.nodes,n=t[0];return t.length&&this.cmp(n,e)<0&&(t[0]=e,e=n,ir(t,0,this.cmp)),e};var or=ar.prototype;function sr(e){return function(){return this._log[e].apply(this,arguments)}}function ur(e,t){U.call(this,e,null,t)}or.stamp=function(){return this._clock},or.loader=function(e){return arguments.length?(this._loader=e,this):this._loader},or.cleanThreshold=1e4,or.add=function(e,t,n,r){var o,s=1;return e instanceof U?o=e:e&&e.prototype instanceof U?o=new e:Object(v.isFunction)(e)?o=new U(null,e):(s=0,o=new U(e,t)),this.rank(o),s&&(r=n,n=t),n&&this.connect(o,o.parameters(n,r)),this.touch(o),o},or.connect=function(e,t){var i,n,r=e.rank;for(i=0,n=t.length;i<n;++i)if(r<t[i].rank)return void this.rerank(e)},or.rank=function(e){e.rank=++this._rank},or.rerank=function(e){for(var t,n,i,r=[e];r.length;)if(this.rank(t=r.pop()),n=t._targets)for(i=n.length;--i>=0;)r.push(t=n[i]),t===e&&Object(v.error)("Cycle detected in dataflow graph.")},or.pulse=function(e,t,n){this.touch(e,n||er);var r=new Hn(this,this._clock+(this._pulse?0:1)),o=e.pulse&&e.pulse.source||[];return r.target=e,this._pulses[e.id]=t.pulse(r,o),this},or.touch=function(e,t){var n=t||er;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this},or.update=function(e,value,t){var n=t||er;return(e.set(value)||n.force)&&this.touch(e,n),this},or.changeset=R,or.ingest=function(e,t,n){return this.pulse(e,this.changeset().insert(qn(t,n)))},or.request=function(e,t,n){var r=this,o=r._pending||function(e){var t,n,r=new Promise(function(a,e){t=a,n=e});return r.requests=0,r.done=function(){0==--r.requests&&e.runAfter(function(){e._pending=null;try{e.run(),t(e)}catch(e){n(e)}})},e._pending=r}(r);o.requests+=1,r.loader().load(t,{context:"dataflow"}).then(function(t){r.ingest(e,t,n)},function(e){r.error("Loading failed",t,e)}).catch(function(e){r.error("Data ingestion failed",t,e)}).then(o.done,o.done)},or.events=function(e,t,n,r){for(var o,s=this,u=W(n,r),l=function(e){e.dataflow=s;try{u.receive(e)}catch(e){s.error(e)}finally{s.run()}},i=0,c=(o="string"==typeof e&&"undefined"!=typeof document?document.querySelectorAll(e):Object(v.array)(e)).length;i<c;++i)o[i].addEventListener(t,l);return u},or.on=function(e,t,n,r,o){return(e instanceof U?function(e,t,n,r,o,s){var u,l;void 0===r?l=n:(u=Object(v.isFunction)(r)?r:Object(v.constant)(r),(l=new U(null,r=n?function(e,t){var value=u(e,t);return n.skip()?value:n.skip(!0).value=value}:u,o,!1)).modified(s&&s.force),l.rank=0,n&&(l.skip(!0),l.value=n.value,l.targets().add(n))),t.targets().add(l)}:function(e,t,n,r,o,s){var u,l,c=Object(v.extend)({},s,Gn);Object(v.isFunction)(n)||(n=Object(v.constant)(n)),void 0===r?u=function(t){e.touch(n(t))}:Object(v.isFunction)(r)?(l=new U(null,r,o,!1),u=function(t){var r,o=n(t);l.evaluate(t),D(r=l.value)?e.pulse(o,r,s):e.update(o,r,c)}):u=function(t){e.update(n(t),r,c)},t.apply(u)})(this,e,t,n,r,o),this},or.run=function(e){var t,n,r,o,s=this,u=0,l=s.logLevel();if(s._pending)return s.info("Awaiting requests, delaying dataflow run."),0;if(s._pulse)return s.error("Dataflow invoked recursively. Use the runAfter method to queue invocation."),0;if(!s._touched.length)return s.info("Dataflow invoked, but nothing to do."),0;s._pulse=new Hn(s,++s._clock,e),l>=v.Info&&(r=Date.now(),s.debug("-- START PROPAGATION ("+s._clock+") -----")),s._touched.forEach(function(e){s._enqueue(e,!0)}),s._touched=_(v.id);try{for(;s._heap.size()>0;)(t=s._heap.pop()).rank===t.qrank?(n=t.run(s._getPulse(t,e)),l>=v.Debug&&s.debug(t.id,n===Wn?"STOP":n,t),n!==Wn&&(s._pulse=n,t._targets&&t._targets.forEach(function(e){s._enqueue(e)})),++u):s._enqueue(t,!0)}catch(e){o=e}if(s._pulses={},s._pulse=null,l>=v.Info&&(r=Date.now()-r,s.info("> Pulse "+s._clock+": "+u+" operators; "+r+"ms")),o&&(s._postrun=[],s.error(o)),s._onrun)try{s._onrun(s,u,o)}catch(e){s.error(e)}if(s._postrun.length){var c=s._postrun;s._postrun=[],c.sort(function(a,b){return b.priority-a.priority}).forEach(function(e){$n(s,e.callback)})}return u},or.runAsync=function(){return this._pending||Promise.resolve(this.run())},or.runAfter=function(e,t,n){this._pulse||t?this._postrun.push({priority:n||0,callback:e}):$n(this,e)},or._enqueue=function(e,t){var n=!this._pulses[e.id];n&&(this._pulses[e.id]=this._pulse),(n||t)&&(e.qrank=e.rank,this._heap.push(e))},or._getPulse=function(e,t){var n,r=e.source,o=this._clock;return r&&Object(v.isArray)(r)?new Zn(this,o,n=r.map(function(e){return e.pulse}),t):(n=this._pulses[e.id],r&&((r=r.pulse)&&r!==Wn?r.stamp===o&&n.target!==e?n=r:n.source=r.source:n.source=[]),n)},or.error=sr("error"),or.warn=sr("warn"),or.info=sr("info"),or.debug=sr("debug"),or.logLevel=sr("level");var lr=Object(v.inherits)(ur,U);lr.run=function(e){return e.stamp<=this.stamp?e.StopPropagation:(this.skip()?this.skip(!1):t=this.evaluate(e),(t=t||e)!==e.StopPropagation&&(this.pulse=t),this.stamp=e.stamp,t);var t},lr.evaluate=function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},lr.transform=function(){};var cr={};function fr(e){var t=dr(e);return t&&t.Definition||null}function dr(e){return e=e&&e.toLowerCase(),cr.hasOwnProperty(e)?cr[e]:null}function hr(e){return e&&e.length?1===e.length?e[0]:(f=e,function(x){for(var e=f.length,i=1,k=String(f[0](x));i<e;++i)k+="|"+f[i](x);return k}):function(){return""};var f}function pr(e,t,n){return n||e+(t?"_"+t:"")}var gr={values:yr({name:"values",init:"cell.store = true;",set:"cell.data.values()",idx:-1}),count:yr({name:"count",set:"cell.num"}),__count__:yr({name:"count",set:"this.missing + this.valid"}),missing:yr({name:"missing",set:"this.missing"}),valid:yr({name:"valid",set:"this.valid"}),sum:yr({name:"sum",init:"this.sum = 0;",add:"this.sum += v;",rem:"this.sum -= v;",set:"this.sum"}),mean:yr({name:"mean",init:"this.mean = 0;",add:"var d = v - this.mean; this.mean += d / this.valid;",rem:"var d = v - this.mean; this.mean -= this.valid ? d / this.valid : this.mean;",set:"this.mean"}),average:yr({name:"average",set:"this.mean",req:["mean"],idx:1}),variance:yr({name:"variance",init:"this.dev = 0;",add:"this.dev += d * (v - this.mean);",rem:"this.dev -= d * (v - this.mean);",set:"this.valid > 1 ? this.dev / (this.valid-1) : 0",req:["mean"],idx:1}),variancep:yr({name:"variancep",set:"this.valid > 1 ? this.dev / this.valid : 0",req:["variance"],idx:2}),stdev:yr({name:"stdev",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid-1)) : 0",req:["variance"],idx:2}),stdevp:yr({name:"stdevp",set:"this.valid > 1 ? Math.sqrt(this.dev / this.valid) : 0",req:["variance"],idx:2}),stderr:yr({name:"stderr",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid * (this.valid-1))) : 0",req:["variance"],idx:2}),distinct:yr({name:"distinct",set:"cell.data.distinct(this.get)",req:["values"],idx:3}),ci0:yr({name:"ci0",set:"cell.data.ci0(this.get)",req:["values"],idx:3}),ci1:yr({name:"ci1",set:"cell.data.ci1(this.get)",req:["values"],idx:3}),median:yr({name:"median",set:"cell.data.q2(this.get)",req:["values"],idx:3}),q1:yr({name:"q1",set:"cell.data.q1(this.get)",req:["values"],idx:3}),q3:yr({name:"q3",set:"cell.data.q3(this.get)",req:["values"],idx:3}),argmin:yr({name:"argmin",init:"this.argmin = null;",add:"if (v < this.min) this.argmin = t;",rem:"if (v <= this.min) this.argmin = null;",set:"this.argmin || cell.data.argmin(this.get)",req:["min"],str:["values"],idx:3}),argmax:yr({name:"argmax",init:"this.argmax = null;",add:"if (v > this.max) this.argmax = t;",rem:"if (v >= this.max) this.argmax = null;",set:"this.argmax || cell.data.argmax(this.get)",req:["max"],str:["values"],idx:3}),min:yr({name:"min",init:"this.min = null;",add:"if (v < this.min || this.min === null) this.min = v;",rem:"if (v <= this.min) this.min = NaN;",set:"this.min = (isNaN(this.min) ? cell.data.min(this.get) : this.min)",str:["values"],idx:4}),max:yr({name:"max",init:"this.max = null;",add:"if (v > this.max || this.max === null) this.max = v;",rem:"if (v >= this.max) this.max = NaN;",set:"this.max = (isNaN(this.max) ? cell.data.max(this.get) : this.max)",str:["values"],idx:4})},mr=Object.keys(gr);function vr(e,t){return gr[e](t)}function yr(e){return function(t){var n=Object(v.extend)({init:"",add:"",rem:"",idx:0},e);return n.out=t||e.name,n}}function br(a,b){return a.idx-b.idx}function xr(e,t){var n=t||v.identity,r="var cell = this.cell; this.valid = 0; this.missing = 0;",o="this.cell = cell; this.init();",s="if(v==null){++this.missing; return;} if(v!==v) return; ++this.valid;",u="if(v==null){--this.missing; return;} if(v!==v) return; --this.valid;",l="var cell = this.cell;";return function(e,t){var n,r=e.reduce(function e(t,a){function n(n){t[n]||e(t,t[n]=gr[n]())}return a.req&&a.req.forEach(n),a.str&&a.str.forEach(n),t},e.reduce(function(e,a){return e[a.name]=a,e},{})),o=[];for(n in r)o.push(r[n]);return o.sort(br)}(e).forEach(function(a){r+=a.init,s+=a.add,u+=a.rem}),e.slice().sort(br).forEach(function(a){l+="t['"+a.out+"']="+a.set+";"}),l+="return t;",(o=Function("cell",o)).prototype.init=Function(r),o.prototype.add=Function("v","t",s),o.prototype.rem=Function("v","t",u),o.prototype.set=Function("t",l),o.prototype.get=n,o.fields=e.map(function(e){return e.out}),o}var _r=function(e){var t,n,r,o,i,s,u,l=e.maxbins||20,c=e.base||10,d=Math.log(c),h=e.divide||[5,2],p=e.extent[0],g=e.extent[1],m=g-p;if(e.step)t=e.step;else if(e.steps){for(o=m/l,i=0,s=e.steps.length;i<s&&e.steps[i]<o;++i);t=e.steps[Math.max(0,i-1)]}else{for(n=Math.ceil(Math.log(l)/d),r=e.minstep||0,t=Math.max(r,Math.pow(c,Math.round(Math.log(m)/d)-n));Math.ceil(m/t)>l;)t*=c;for(i=0,s=h.length;i<s;++i)(o=t/h[i])>=r&&m/o<=l&&(t=o)}return o=Math.log(t),u=Math.pow(c,-(o>=0?0:1+~~(-o/d))-1),(e.nice||void 0===e.nice)&&(p=p<(o=Math.floor(p/t+u)*t)?o-t:o,g=Math.ceil(g/t)*t),{start:p,stop:g,step:t}},wr=function(e,f){var a,t=[],n=e.length,i=-1;if(null==f)for(;++i<n;)isNaN(a=Er(e[i]))||t.push(a);else for(;++i<n;)isNaN(a=Er(f(e[i],i,e)))||t.push(a);return t};function Er(x){return null===x?NaN:+x}var Or=Math.random;function Sr(e){Or=e}var Ar=function(a,b){return a<b?-1:a>b?1:a>=b?0:NaN},kr=function(e){var f;return 1===e.length&&(f=e,e=function(e,x){return Ar(f(e),x)}),{left:function(a,x,t,n){for(null==t&&(t=0),null==n&&(n=a.length);t<n;){var r=t+n>>>1;e(a[r],x)<0?t=r+1:n=r}return t},right:function(a,x,t,n){for(null==t&&(t=0),null==n&&(n=a.length);t<n;){var r=t+n>>>1;e(a[r],x)>0?n=r:t=r+1}return t}}},Tr=kr(Ar),Nr=Tr.right,Mr=Tr.left,Cr=Nr,Dr=function(x){return null===x?NaN:+x},Rr=function(e,t){var value,n,r,o=e.length,i=-1;if(null==t){for(;++i<o;)if(null!=(value=e[i])&&value>=value)for(n=r=value;++i<o;)null!=(value=e[i])&&(n>value&&(n=value),r<value&&(r=value))}else for(;++i<o;)if(null!=(value=t(e[i],i,e))&&value>=value)for(n=r=value;++i<o;)null!=(value=t(e[i],i,e))&&(n>value&&(n=value),r<value&&(r=value));return[n,r]},Ir=(Array,function(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(r);++i<r;)o[i]=e+i*n;return o}),Pr=Math.sqrt(50),Lr=Math.sqrt(10),zr=Math.sqrt(2),jr=function(e,t,n){var r,o,s,u,i=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((r=t<e)&&(o=e,e=t,t=o),0===(u=Fr(e,t,n))||!isFinite(u))return[];if(u>0)for(e=Math.ceil(e/u),t=Math.floor(t/u),s=new Array(o=Math.ceil(t-e+1));++i<o;)s[i]=(e+i)*u;else for(e=Math.floor(e*u),t=Math.ceil(t*u),s=new Array(o=Math.ceil(e-t+1));++i<o;)s[i]=(e-i)/u;return r&&s.reverse(),s};function Fr(e,t,n){var r=(t-e)/Math.max(0,n),o=Math.floor(Math.log(r)/Math.LN10),s=r/Math.pow(10,o);return o>=0?(s>=Pr?10:s>=Lr?5:s>=zr?2:1)*Math.pow(10,o):-Math.pow(10,-o)/(s>=Pr?10:s>=Lr?5:s>=zr?2:1)}function Ur(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),o=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),s=r/o;return s>=Pr?o*=10:s>=Lr?o*=5:s>=zr&&(o*=2),t<e?-o:o}var Br=function(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1},Vr=function(e,t,n){if(null==n&&(n=Dr),r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),s=+n(e[o],o,e);return s+(+n(e[o+1],o+1,e)-s)*(i-o)}},qr=function(e,t){var value,n,r=e.length,i=-1;if(null==t){for(;++i<r;)if(null!=(value=e[i])&&value>=value)for(n=value;++i<r;)null!=(value=e[i])&&value>n&&(n=value)}else for(;++i<r;)if(null!=(value=t(e[i],i,e))&&value>=value)for(n=value;++i<r;)null!=(value=t(e[i],i,e))&&value>n&&(n=value);return n},Gr=function(e){for(var t,n,r,o=e.length,i=-1,j=0;++i<o;)j+=e[i].length;for(n=new Array(j);--o>=0;)for(t=(r=e[o]).length;--t>=0;)n[--j]=r[t];return n},Wr=function(e,t){for(var i=t.length,n=new Array(i);i--;)n[i]=e[t[i]];return n},Hr=function(e,t,n,f){var a,i,j,r,o=wr(e,f),s=o.length,u=t;for(j=0,r=Array(u);j<u;++j){for(a=0,i=0;i<s;++i)a+=o[~~(Or()*s)];r[j]=a/s}return[Vr(r.sort(Ar),n/2),Vr(r,1-n/2)]},Xr=function(e,f){var t=wr(e,f);return[Vr(t.sort(Ar),.25),Vr(t,.5),Vr(t,.75)]},Yr=function(e,t){null==t&&(t=e,e=0);var a,b,n,r={min:function(e){return arguments.length?(n=b-(a=e||0),r):a},max:function(e){return arguments.length?(n=(b=e||0)-a,r):b},sample:function(){return a+Math.floor(n*Or())},pdf:function(x){return x===Math.floor(x)&&x>=a&&x<b?1/n:0},cdf:function(x){var e=Math.floor(x);return e<a?0:e>=b?1:(e-a+1)/n},icdf:function(e){return e>=0&&e<=1?a-1+Math.floor(e*n):NaN}};return r.min(e).max(t)},Kr=function(e,t){var n,r,o=NaN,s={mean:function(e){return arguments.length?(n=e||0,o=NaN,s):n},stdev:function(e){return arguments.length?(r=null==e?1:e,o=NaN,s):r},sample:function(){var e,t,x=0,y=0;if(o==o)return x=o,o=NaN,x;do{e=(x=2*Or()-1)*x+(y=2*Or()-1)*y}while(0===e||e>1);return t=Math.sqrt(-2*Math.log(e)/e),o=n+y*t*r,n+x*t*r},pdf:function(x){var e=Math.exp(Math.pow(x-n,2)/(-2*Math.pow(r,2)));return 1/(r*Math.sqrt(2*Math.PI))*e},cdf:function(x){var e,t=(x-n)/r,o=Math.abs(t);if(o>37)e=0;else{var s=Math.exp(-o*o/2);o<7.07106781186547?(e=s*((((((.0352624965998911*o+.700383064443688)*o+6.37396220353165)*o+33.912866078383)*o+112.079291497871)*o+221.213596169931)*o+220.206867912376),e/=((((((.0883883476483184*o+1.75566716318264)*o+16.064177579207)*o+86.7807322029461)*o+296.564248779674)*o+637.333633378831)*o+793.826512519948)*o+440.413735824752):e=s/(o+1/(o+2/(o+3/(o+4/(o+.65)))))/2.506628274631}return t>0?1-e:e},icdf:function(e){if(e<=0||e>=1)return NaN;var x=2*e-1,t=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),a=2/(Math.PI*t)+Math.log(1-Math.pow(x,2))/2,b=Math.log(1-x*x)/t,o=(x>0?1:-1)*Math.sqrt(Math.sqrt(a*a-b)-a);return n+r*Math.SQRT2*o}};return s.mean(e).stdev(t)},Jr=function(e,t){var n=Kr(),r={},o=0;return r.data=function(n){return arguments.length?(e=n,o=n?n.length:0,r.bandwidth(t)):e},r.bandwidth=function(n){return arguments.length?(!(t=n)&&e&&(s=(o=e).length,l=((u=Xr(o))[2]-u[0])/1.34,t=1.06*Math.min(Math.sqrt(function(e,t){var value,n,r=e.length,o=0,i=-1,s=0,sum=0;for(1;++i<r;)isNaN(value=Dr(e[i]))||(sum+=(n=value-s)*(value-(s+=n/++o)));if(o>1)return sum/(o-1)}(o)),l)*Math.pow(s,-.2)),r):t;var o,s,u,l},r.sample=function(){return e[~~(Or()*o)]+t*n.sample()},r.pdf=function(x){for(var y=0,i=0;i<o;++i)y+=n.pdf((x-e[i])/t);return y/t/o},r.cdf=function(x){for(var y=0,i=0;i<o;++i)y+=n.cdf((x-e[i])/t);return y/o},r.icdf=function(){throw Error("KDE icdf not supported.")},r.data(e)},Zr=function(e,weights){var t,n={},r=0;return n.weights=function(e){return arguments.length?(t=function(x){var i,e=[],sum=0;for(i=0;i<r;++i)sum+=e[i]=null==x[i]?1:+x[i];for(i=0;i<r;++i)e[i]/=sum;return e}(weights=e||[]),n):weights},n.distributions=function(t){return arguments.length?(t?(r=t.length,e=t):(r=0,e=[]),n.weights(weights)):e},n.sample=function(){for(var n=Or(),o=e[r-1],s=t[0],i=0;i<r-1;s+=t[++i])if(n<s){o=e[i];break}return o.sample()},n.pdf=function(x){for(var n=0,i=0;i<r;++i)n+=t[i]*e[i].pdf(x);return n},n.cdf=function(x){for(var n=0,i=0;i<r;++i)n+=t[i]*e[i].cdf(x);return n},n.icdf=function(){throw Error("Mixture icdf not supported.")},n.distributions(e).weights(weights)},Qr=function(e,t){null==t&&(t=null==e?1:e,e=0);var a,b,n,r={min:function(e){return arguments.length?(n=b-(a=e||0),r):a},max:function(e){return arguments.length?(n=(b=e||0)-a,r):b},sample:function(){return a+n*Or()},pdf:function(x){return x>=a&&x<=b?1/n:0},cdf:function(x){return x<a?0:x>b?1:(x-a)/n},icdf:function(e){return e>=0&&e<=1?a+e*n:NaN}};return r.min(e).max(t)};function $r(e){this._key=e?Object(v.field)(e):S,this.reset()}var ei=$r.prototype;function ti(e){ur.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}ei.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},ei.add=function(e){this._add.push(e)},ei.rem=function(e){this._rem.push(e)},ei.values=function(){if(this._get=null,0===this._rem.length)return this._add;var i,j,e,a=this._add,t=this._rem,k=this._key,n=a.length,r=t.length,x=Array(n-r),o={};for(i=0;i<r;++i)o[k(t[i])]=1;for(i=0,j=0;i<n;++i)o[k(e=a[i])]?o[k(e)]=0:x[j++]=e;return this._rem=[],this._add=x},ei.distinct=function(e){for(var t,n=this.values(),r=n.length,o={},s=0;--r>=0;)t=e(n[r])+"",o.hasOwnProperty(t)||(o[t]=1,++s);return s},ei.extent=function(e){if(this._get!==e||!this._ext){var t=this.values(),i=Object(v.extentIndex)(t,e);this._ext=[t[i[0]],t[i[1]]],this._get=e}return this._ext},ei.argmin=function(e){return this.extent(e)[0]||{}},ei.argmax=function(e){return this.extent(e)[1]||{}},ei.min=function(e){var t=this.extent(e)[0];return null!=t?e(t):1/0},ei.max=function(e){var t=this.extent(e)[1];return null!=t?e(t):-1/0},ei.quartile=function(e){return this._get===e&&this._q||(this._q=Xr(this.values(),e),this._get=e),this._q},ei.q1=function(e){return this.quartile(e)[0]},ei.q2=function(e){return this.quartile(e)[1]},ei.q3=function(e){return this.quartile(e)[2]},ei.ci=function(e){return this._get===e&&this._ci||(this._ci=Hr(this.values(),1e3,.05,e),this._get=e),this._ci},ei.ci0=function(e){return this.ci(e)[0]},ei.ci1=function(e){return this.ci(e)[1]},ti.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:mr},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};var ni=Object(v.inherits)(ti,ur);function ri(e){ur.call(this,null,e)}ni.transform=function(e,t){var n,r=this,o=t.fork(t.NO_SOURCE|t.NO_FIELDS);return this.stamp=o.stamp,this.value&&((n=e.modified())||t.modified(this._inputs))?(this._prev=this.value,this.value=n?this.init(e):{},t.visit(t.SOURCE,function(e){r.add(e)})):(this.value=this.value||this.init(e),t.visit(t.REM,function(e){r.rem(e)}),t.visit(t.ADD,function(e){r.add(e)})),o.modifies(this._outputs),r._drop=!1!==e.drop,e.cross&&r._dims.length>1&&(r._drop=!1,this.cross()),r.changes(o)},ni.cross=function(){var e=this,t=e.value,n=e._dnames,r=n.map(function(){return{}}),o=n.length;function s(e){var t,i,s,u;for(t in e)for(s=e[t].tuple,i=0;i<o;++i)r[i][u=s[n[i]]]=u}s(e._prev),s(t),function s(u,l,c){var k,d,h=n[c],p=r[c++];for(k in p)l[h]=p[k],d=u?u+"|"+k:k,c<o?s(d,l,c):t[d]||e.cell(d,l)}("",{},0)},ni.init=function(e){var t=this._inputs=[],n=this._outputs=[],r={};function o(e){for(var f,n=Object(v.array)(Object(v.accessorFields)(e)),i=0,o=n.length;i<o;++i)r[f=n[i]]||(r[f]=1,t.push(f))}this._dims=Object(v.array)(e.groupby),this._dnames=this._dims.map(function(e){var t=Object(v.accessorName)(e);return o(e),n.push(t),t}),this.cellkey=e.key?e.key:hr(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];var s,u,l,c,d,i,h=e.fields||[null],p=e.ops||["count"],g=e.as||[],m=h.length,_={};for(m!==p.length&&Object(v.error)("Unmatched number of fields and aggregate ops."),i=0;i<m;++i)u=p[i],null==(s=h[i])&&"count"!==u&&Object(v.error)("Null aggregate field specified."),d=pr(u,c=Object(v.accessorName)(s),g[i]),n.push(d),"count"!==u?((l=_[c])||(o(s),(l=_[c]=[]).field=s,this._measures.push(l)),"count"!==u&&(this._countOnly=!1),l.push(vr(u,d))):this._counts.push(d);return this._measures=this._measures.map(function(e){return xr(e,e.field)}),{}},ni.cellkey=hr(),ni.cell=function(e,t){var n=this.value[e];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},ni.newcell=function(e,t){var n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){var i,r=this._measures,o=r.length;for(n.agg=Array(o),i=0;i<o;++i)n.agg[i]=new r[i](n)}return n.store&&(n.data=new $r),n},ni.newtuple=function(e,t){var i,n,r=this._dnames,o=this._dims,x={};for(i=0,n=o.length;i<n;++i)x[r[i]]=o[i](e);return t?C(t.tuple,x):T(x)},ni.add=function(e){var t,i,n,r=this.cellkey(e),o=this.cell(r,e);if(o.num+=1,!this._countOnly)for(o.store&&o.data.add(e),i=0,n=(t=o.agg).length;i<n;++i)t[i].add(t[i].get(e),e)},ni.rem=function(e){var t,i,n,r=this.cellkey(e),o=this.cell(r,e);if(o.num-=1,!this._countOnly)for(o.store&&o.data.rem(e),i=0,n=(t=o.agg).length;i<n;++i)t[i].rem(t[i].get(e),e)},ni.celltuple=function(e){var t,i,n,r=e.tuple,o=this._counts;for(e.store&&e.data.values(),i=0,n=o.length;i<n;++i)r[o[i]]=e.num;if(!this._countOnly)for(i=0,n=(t=e.agg).length;i<n;++i)t[i].set(r);return r},ni.changes=function(e){var t,n,i,r,o=this._adds,s=this._mods,u=this._prev,l=this._drop,c=e.add,d=e.rem,h=e.mod;if(u)for(n in u)t=u[n],l&&!t.num||d.push(t.tuple);for(i=0,r=this._alen;i<r;++i)c.push(this.celltuple(o[i])),o[i]=null;for(i=0,r=this._mlen;i<r;++i)(0===(t=s[i]).num&&l?d:h).push(this.celltuple(t)),s[i]=null;return this._alen=this._mlen=0,this._prev=null,e},ri.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};var ii=Object(v.inherits)(ri,ur);ii.transform=function(e,t){var n,r=this._bins(e),o=r.start,s=r.step,u=e.as||["bin0","bin1"],l=u[0],c=u[1];return n=e.modified()?(t=t.reflow(!0)).SOURCE:t.modified(Object(v.accessorFields)(e.field))?t.ADD_MOD:t.ADD,t.visit(n,function(e){var t=r(e);e[l]=t,e[c]=null==t?null:o+s*(1+(t-o)/s)}),t.modifies(u)},ii._bins=function(e){if(this.value&&!e.modified())return this.value;var a,t,n=e.field,r=_r(e),o=r.start,s=r.stop,u=r.step;null!=(a=e.anchor)&&(t=a-(o+u*Math.floor((a-o)/u)),o+=t,s+=t);var f=function(e){var t=n(e);return null==t?null:(t=Math.max(o,Math.min(+t,s-u)),o+u*Math.floor((t-o)/u))};return f.start=o,f.stop=s,f.step=u,this.value=Object(v.accessor)(f,Object(v.accessorFields)(n),e.name||"bin_"+Object(v.accessorName)(n))};var ai=function(e,t,n){var r=e,o=t||[],s=n||[],u={},l=0;return{add:function(e){s.push(e)},remove:function(e){u[r(e)]=++l},size:function(){return o.length},data:function(e,t){return l&&(o=o.filter(function(e){return!u[r(e)]}),u={},l=0),t&&e&&o.sort(e),s.length&&(o=e?Object(v.merge)(e,o,s.sort(e)):o.concat(s),s=[]),o}}};function oi(e){ur.call(this,[],e)}function si(e){U.call(this,null,ui,e)}function ui(e){return this.value&&!e.modified()?this.value:Object(v.compare)(e.fields,e.orders)}function li(e){ur.call(this,null,e)}oi.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},Object(v.inherits)(oi,ur).transform=function(e,t){var n=t.fork(t.ALL),r=ai(S,this.value,n.materialize(n.ADD).add),o=e.sort,s=t.changed()||o&&(e.modified("sort")||t.modified(o.fields));return n.visit(n.REM,r.remove),this.modified(s),this.value=n.source=r.data(o,s),t.source&&t.source.root&&(this.value.root=t.source.root),n},Object(v.inherits)(si,U),li.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};var ci=Object(v.inherits)(li,ur);function fi(e){ur.call(this,null,e)}ci.transform=function(e,t){function n(t){return function(n){for(var r,o=function(t,n,r){switch(e.case){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase()}return t.match(r)}(l(n),0,s)||[],i=0,c=o.length;i<c;++i)u.test(r=o[i])||t(r)}}var r=this._parameterCheck(e,t),o=this._counts,s=this._match,u=this._stop,l=e.field,c=e.as||["text","count"],d=n(function(e){o[e]=1+(o[e]||0)}),h=n(function(e){o[e]-=1});return r?t.visit(t.SOURCE,d):(t.visit(t.ADD,d),t.visit(t.REM,h)),this._finish(t,c)},ci._parameterCheck=function(e,t){var n=!1;return!e.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),!e.modified("pattern")&&this._match||(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},ci._finish=function(e,t){var n,r,o,s=this._counts,u=this._tuples||(this._tuples={}),l=t[0],c=t[1],d=e.fork(e.NO_SOURCE|e.NO_FIELDS);for(n in s)r=u[n],o=s[n]||0,!r&&o?(u[n]=r=T({}),r[l]=n,r[c]=o,d.add.push(r)):0===o?(r&&d.rem.push(r),s[n]=null,u[n]=null):r[c]!==o&&(r[c]=o,d.mod.push(r));return d.modifies(t)},fi.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},Object(v.inherits)(fi,ur).transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=this.value,o=e.as||["a","b"],a=o[0],b=o[1];return!r||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter")?(r&&(n.rem=r),r=t.materialize(t.SOURCE).source,n.add=this.value=function(e,a,b,t){for(var j,n,r=[],o={},s=e.length,i=0;i<s;++i)for(o[a]=n=e[i],j=0;j<s;++j)o[b]=e[j],t(o)&&(r.push(T(o)),(o={})[a]=n);return r}(r,a,b,e.filter||v.truthy)):n.mod=r,n.source=this.value,n.modifies(o)};var di={kde:Jr,mixture:Zr,normal:Kr,uniform:Qr};function hi(e){ur.call(this,null,e)}var pi=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}];function gi(e){ur.call(this,[1/0,-1/0],e)}function mi(e,t){U.call(this,e),this.parent=t}hi.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number",default:100},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:pi.concat({key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:pi},{name:"weights",type:"number",array:!0}]})},{name:"as",type:"string",array:!0,default:["value","density"]}]},Object(v.inherits)(hi,ur).transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=function e(t,n){var r=t.function;di.hasOwnProperty(r)||Object(v.error)("Unknown distribution function: "+r);var o=di[r]();for(var s in t)"field"===s?o.data((t.from||n()).map(t[s])):"distributions"===s?o[s](t[s].map(function(t){return e(t,n)})):"function"==typeof o[s]&&o[s](t[s]);return o}(e.distribution,function(e){return function(){return e.materialize(e.SOURCE).source}}(t)),o=e.method||"pdf";"pdf"!==o&&"cdf"!==o&&Object(v.error)("Invalid density method: "+o),e.extent||r.data||Object(v.error)("Missing density extent parameter."),o=r[o];var s=e.as||["value","density"],u=e.extent||Rr(r.data()),l=(u[1]-u[0])/(e.steps||100),c=Ir(u[0],u[1]+l/2,l).map(function(e){var t={};return t[s[0]]=e,t[s[1]]=o(e),T(t)});this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n},gi.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},Object(v.inherits)(gi,ur).transform=function(e,t){var n=this.value,r=e.field,o=n[0],s=n[1],u=t.ADD;(t.changed()||t.modified(r.fields)||e.modified("field"))&&(u=t.SOURCE,o=1/0,s=-1/0),t.visit(u,function(e){var t=r(e);null!=t&&((t=+t)<o&&(o=t),t>s&&(s=t))}),this.value=[o,s]};var vi=Object(v.inherits)(mi,U);function yi(e){ur.call(this,{},e),this._keys=Object(v.fastmap)();var a=this._targets=[];a.active=0,a.forEach=function(f){for(var i=0,e=a.active;i<e;++i)f(a[i],i,a)}}vi.connect=function(e){return this.targets().add(e),e.source=this},vi.add=function(e){this.value.add.push(e)},vi.rem=function(e){this.value.rem.push(e)},vi.mod=function(e){this.value.mod.push(e)},vi.init=function(e){this.value.init(e,e.NO_SOURCE)},vi.evaluate=function(){return this.value};var bi=Object(v.inherits)(yi,ur);function xi(e){U.call(this,null,_i,e)}function _i(e){return this.value&&!e.modified()?this.value:Object(v.isArray)(e.name)?Object(v.array)(e.name).map(function(f){return Object(v.field)(f)}):Object(v.field)(e.name,e.as)}function wi(e){ur.call(this,Object(v.fastmap)(),e)}function Ei(e,t){return e?e.map(function(f,i){return t[i]||Object(v.accessorName)(f)}):null}function Oi(e){ur.call(this,[],e)}function Si(e){ur.call(this,[],e)}function Ai(e){ur.call(this,null,e)}function ki(e){ur.call(this,[],e)}bi.activate=function(e){this._targets[this._targets.active++]=e},bi.subflow=function(e,t,n,r){var o,s,u=this.value,l=u.hasOwnProperty(e)&&u[e];return l?l.value.stamp<n.stamp&&(l.init(n),this.activate(l)):(s=r||(s=this._group[e])&&s.tuple,l=(o=n.dataflow).add(new mi(n.fork(n.NO_SOURCE),this)).connect(t(o,e,s)),u[e]=l,this.activate(l)),l},bi.transform=function(e,t){var n=t.dataflow,r=this,o=e.key,s=e.subflow,u=this._keys,l=e.modified("key");function c(e){return r.subflow(e,s,t)}return this._group=e.group||{},this._targets.active=0,t.visit(t.REM,function(e){var t=S(e),k=u.get(t);void 0!==k&&(u.delete(t),c(k).rem(e))}),t.visit(t.ADD,function(e){var k=o(e);u.set(S(e),k),c(k).add(e)}),l||t.modified(o.fields)?t.visit(t.MOD,function(e){var t=S(e),n=u.get(t),r=o(e);n===r?c(r).mod(e):(u.set(t,r),c(n).rem(e),c(r).add(e))}):t.changed(t.MOD)&&t.visit(t.MOD,function(e){c(u.get(S(e))).mod(e)}),l&&t.visit(t.REFLOW,function(e){var t=S(e),n=u.get(t),r=o(e);n!==r&&(u.set(t,r),c(n).rem(e),c(r).add(e))}),u.empty>n.cleanThreshold&&n.runAfter(u.clean),t},Object(v.inherits)(xi,U),wi.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},Object(v.inherits)(wi,ur).transform=function(e,t){var n=t.dataflow,r=this.value,o=t.fork(),s=o.add,u=o.rem,l=o.mod,c=e.expr,d=!0;function h(t){var n=S(t),b=c(t,e),o=r.get(n);b&&o?(r.delete(n),s.push(t)):b||o?d&&b&&!o&&l.push(t):(r.set(n,1),u.push(t))}return t.visit(t.REM,function(e){var t=S(e);r.has(t)?r.delete(t):u.push(e)}),t.visit(t.ADD,function(t){c(t,e)?s.push(t):r.set(S(t),1)}),t.visit(t.MOD,h),e.modified()&&(d=!1,t.visit(t.REFLOW,h)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),o},Oi.Definition={type:"Flatten",metadata:{generates:!0,source:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0}]},Object(v.inherits)(Oi,ur).transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,o=Ei(r,e.as||[]),s=o.length;return n.rem=this.value,t.visit(t.SOURCE,function(e){for(var j,t,u,l=r.map(function(f){return f(e)}),c=l.reduce(function(e,a){return Math.max(e,a.length)},0),i=0;i<c;++i){for(t=N(e),j=0;j<s;++j)t[o[j]]=null==(u=l[j][i])?null:u;n.add.push(t)}}),this.value=n.source=n.add,n.modifies(o)},Si.Definition={type:"Fold",metadata:{generates:!0,source:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},Object(v.inherits)(Si,ur).transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,o=r.map(v.accessorName),s=e.as||["key","value"],k=s[0],u=s[1],l=r.length;return n.rem=this.value,t.visit(t.SOURCE,function(e){for(var t,i=0;i<l;++i)(t=N(e))[k]=o[i],t[u]=r[i](e),n.add.push(t)}),this.value=n.source=n.add,n.modifies(s)},Ai.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},Object(v.inherits)(Ai,ur).transform=function(e,t){var n=e.expr,r=e.as,o=e.modified(),s=e.initonly?t.ADD:o?t.SOURCE:t.modified(n.fields)?t.ADD_MOD:t.ADD;return o&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(s,function(t){t[r]=n(t,e)})},Object(v.inherits)(ki,ur).transform=function(e,t){var n,r,o,s=this.value,u=t.fork(t.ALL),l=e.size-s.length,c=e.generator;if(l>0){for(n=[];--l>=0;)n.push(o=T(c(e))),s.push(o);u.add=u.add.length?u.materialize(u.ADD).add.concat(n):n}else r=s.slice(0,-l),u.rem=u.rem.length?u.materialize(u.REM).rem.concat(r):r,s=s.slice(-l);return u.source=this.value=s,u};var Ti={value:"value",median:function(e,t){var value,n=e.length,i=-1,r=[];if(null==t)for(;++i<n;)isNaN(value=Dr(e[i]))||r.push(value);else for(;++i<n;)isNaN(value=Dr(t(e[i],i,e)))||r.push(value);return Vr(r.sort(Ar),.5)},mean:function(e,t){var value,n=e.length,r=n,i=-1,sum=0;if(null==t)for(;++i<n;)isNaN(value=Dr(e[i]))?--r:sum+=value;else for(;++i<n;)isNaN(value=Dr(t(e[i],i,e)))?--r:sum+=value;if(r)return sum/r},min:function(e,t){var value,n,r=e.length,i=-1;if(null==t){for(;++i<r;)if(null!=(value=e[i])&&value>=value)for(n=value;++i<r;)null!=(value=e[i])&&n>value&&(n=value)}else for(;++i<r;)if(null!=(value=t(e[i],i,e))&&value>=value)for(n=value;++i<r;)null!=(value=t(e[i],i,e))&&n>value&&(n=value);return n},max:qr},Ni=[];function Mi(e){ur.call(this,[],e)}function Ci(e){ti.call(this,e)}Mi.Definition={type:"Impute",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},Object(v.inherits)(Mi,ur).transform=function(e,t){var n,value,r,o,s,i,j,u,l,c,d=t.fork(t.ALL),h=function(e){var t,n=e.method||Ti.value;if(null!=Ti[n])return n===Ti.value?(t=void 0!==e.value?e.value:0,function(){return t}):Ti[n];Object(v.error)("Unrecognized imputation method: "+n)}(e),p=function(e){var f=e.field;return function(e){return e?f(e):NaN}}(e),g=Object(v.accessorName)(e.field),m=Object(v.accessorName)(e.key),_=(e.groupby||[]).map(v.accessorName),w=function(e,t,n,r){var o,s,u,i,j,k,l,c,d=function(f){return f(c)},h=[],p=r?r.slice():[],g={},m={};for(p.forEach(function(k,i){g[k]=i+1}),i=0,l=e.length;i<l;++i)k=n(c=e[i]),j=g[k]||(g[k]=p.push(k)),(u=m[s=(o=t?t.map(d):Ni)+""])||(u=m[s]=[],h.push(u),u.values=o),u[j-1]=c;return h.domain=p,h}(t.source,e.groupby,e.key,e.keyvals),E=[],O=this.value,S=w.domain.length;for(s=0,u=w.length;s<u;++s)for(r=(n=w[s]).values,value=NaN,j=0;j<S;++j)if(null==n[j]){for(o=w.domain[j],c={_impute:!0},i=0,l=r.length;i<l;++i)c[_[i]]=r[i];c[m]=o,c[g]=isNaN(value)?value=h(n,p):value,E.push(T(c))}return E.length&&(d.add=d.materialize(d.ADD).add.concat(E)),O.length&&(d.rem=d.materialize(d.REM).rem.concat(O)),this.value=E,d},Ci.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:mr},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};var Di=Object(v.inherits)(Ci,ti);function Ri(e){U.call(this,null,Ii,e)}function Ii(e){return this.value&&!e.modified()?this.value:Object(v.key)(e.fields,e.flat)}function Pi(e){ur.call(this,{},e)}function Li(e){U.call(this,null,zi,e)}function zi(e){if(this.value&&!e.modified())return this.value;var i,t,n,r=1/0,o=-1/0,s=e.extents;for(i=0,t=s.length;i<t;++i)(n=s[i])[0]<r&&(r=n[0]),n[1]>o&&(o=n[1]);return[r,o]}function ji(e){U.call(this,null,Fi,e)}function Fi(e){return this.value&&!e.modified()?this.value:e.values.reduce(function(e,t){return e.concat(t)},[])}function Ui(e){ur.call(this,null,e)}function Bi(e){ti.call(this,e)}Di.transform=function(e,t){var n,r=this,o=e.modified();return r.value&&(o||t.modified(r._inputs))?(n=r.value=o?r.init(e):{},t.visit(t.SOURCE,function(e){r.add(e)})):(n=r.value=r.value||this.init(e),t.visit(t.REM,function(e){r.rem(e)}),t.visit(t.ADD,function(e){r.add(e)})),r.changes(),t.visit(t.SOURCE,function(e){Object(v.extend)(e,n[r.cellkey(e)].tuple)}),t.reflow(o).modifies(this._outputs)},Di.changes=function(){var i,e,t=this._adds,n=this._mods;for(i=0,e=this._alen;i<e;++i)this.celltuple(t[i]),t[i]=null;for(i=0,e=this._mlen;i<e;++i)this.celltuple(n[i]),n[i]=null;this._alen=this._mlen=0},Object(v.inherits)(Ri,U),Pi.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},Object(v.inherits)(Pi,ur).transform=function(e,t){var n,r,o=t,s=e.as,u=e.fields,l=e.index,c=e.values,d=null==e.default?null:e.default,h=e.modified(),p=h?t.SOURCE:t.ADD,g=u.length;return c?(r=c.length,g>1&&!s&&Object(v.error)('Multi-field lookup requires explicit "as" parameter.'),s&&s.length!==g*r&&Object(v.error)('The "as" parameter has too few output field names.'),s=s||c.map(v.accessorName),n=function(e){for(var j,t,i=0,k=0;i<g;++i)if(null==(t=l.get(u[i](e))))for(j=0;j<r;++j,++k)e[s[k]]=d;else for(j=0;j<r;++j,++k)e[s[k]]=c[j](t)}):(s||Object(v.error)("Missing output field names."),n=function(e){for(var t,i=0;i<g;++i)t=l.get(u[i](e)),e[s[i]]=null==t?d:t}),h?o=t.reflow(!0):p|=u.some(function(k){return t.modified(k.fields)})?t.MOD:0,t.visit(p,n),o.modifies(s)},Object(v.inherits)(Li,U),Object(v.inherits)(ji,U),Object(v.inherits)(Ui,ur),Ui.prototype.transform=function(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)},Bi.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:mr,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};var Vi=Object(v.inherits)(Bi,ti);function qi(e){yi.call(this,e)}function Gi(e){ur.call(this,null,e)}function Wi(e){ur.call(this,null,e)}function Hi(e){ur.call(this,null,e)}function Xi(e){ur.call(this,[],e),this.count=0}function Yi(e){ur.call(this,null,e)}function Ki(e){ur.call(this,null,e),this.modified(!0)}function Ji(e){ur.call(this,Object(v.fastmap)(),e)}function Zi(e){ur.call(this,null,e)}Vi._transform=Vi.transform,Vi.transform=function(e,t){return this._transform(function(e,t){var n=e.field,value=e.value,r=("count"===e.op?"__count__":e.op)||"sum",o=Object(v.accessorFields)(n).concat(Object(v.accessorFields)(value)),s=function(e,t,n){var r={},o=[];return n.visit(n.SOURCE,function(t){var k=e(t);r[k]||(r[k]=1,o.push(k))}),o.sort(function(e,t){return(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t==t?-1:t!=t&&e==e?1:0)}),t?o.slice(0,t):o}(n,e.limit||0,t);return{key:e.key,groupby:e.groupby,ops:s.map(function(){return r}),fields:s.map(function(k){return function(k,e,value,t){return Object(v.accessor)(function(t){return e(t)===k?value(t):NaN},t,k+"")}(k,n,value,o)}),as:s.map(function(k){return k+""}),modified:e.modified.bind(e)}}(e,t),t)},Object(v.inherits)(qi,yi).transform=function(e,t){var n=this,r=e.subflow,o=e.field;return(e.modified("field")||o&&t.modified(Object(v.accessorFields)(o)))&&Object(v.error)("PreFacet does not support field modification."),this._targets.active=0,t.visit(t.MOD,function(e){var s=n.subflow(S(e),r,t,e);o?o(e).forEach(function(e){s.mod(e)}):s.mod(e)}),t.visit(t.ADD,function(e){var s=n.subflow(S(e),r,t,e);o?o(e).forEach(function(e){s.add(T(e))}):s.add(e)}),t.visit(t.REM,function(e){var s=n.subflow(S(e),r,t,e);o?o(e).forEach(function(e){s.rem(e)}):s.rem(e)}),t},Gi.Definition={type:"Project",metadata:{generates:!0,changes:!0,modifies:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},Object(v.inherits)(Gi,ur).transform=function(e,t){var n,r,o=e.fields,s=Ei(e.fields,e.as||[]),u=o?function(e,t){return function(e,t,n,r){for(var i=0,o=n.length;i<o;++i)t[r[i]]=n[i](e);return t}(e,t,o,s)}:M;return this.value?r=this.value:(t=t.addAll(),r=this.value={}),n=t.fork(t.NO_SOURCE),t.visit(t.REM,function(e){var t=S(e);n.rem.push(r[t]),r[t]=null}),t.visit(t.ADD,function(e){var t=u(e,T({}));r[S(e)]=t,n.add.push(t)}),t.visit(t.MOD,function(e){n.mod.push(u(e,r[S(e)]))}),n},Object(v.inherits)(Wi,ur).transform=function(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation},Object(v.inherits)(Hi,ur).transform=function(e,t){var n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,function(e){var t=S(e);n.rem.push(r[t]),r[t]=null}),t.visit(t.ADD,function(e){var t=N(e);r[S(e)]=t,n.add.push(t)}),t.visit(t.MOD,function(e){n.mod.push(M(e,r[S(e)]))})),n},Xi.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},Object(v.inherits)(Xi,ur).transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=e.modified("size"),o=e.size,s=this.value,u=this.count,l=0,c=s.reduce(function(e,t){return e[S(t)]=1,e},{});function d(e){var t,r;s.length<o?s.push(e):(r=~~((u+1)*Or()))<s.length&&r>=l&&(c[S(t=s[r])]&&n.rem.push(t),s[r]=e),++u}if(t.rem.length&&(t.visit(t.REM,function(e){var t=S(e);c[t]&&(c[t]=-1,n.rem.push(e)),--u}),s=s.filter(function(e){return-1!==c[S(e)]})),(t.rem.length||r)&&s.length<o&&t.source&&(l=u=s.length,t.visit(t.SOURCE,function(e){c[S(e)]||d(e)}),l=-1),r&&s.length>o){for(var i=0,h=s.length-o;i<h;++i)c[S(s[i])]=-1,n.rem.push(s[i]);s=s.slice(h)}return t.mod.length&&t.visit(t.MOD,function(e){c[S(e)]&&n.mod.push(e)}),t.add.length&&t.visit(t.ADD,d),(t.add.length||l<0)&&(n.add=s.filter(function(e){return!c[S(e)]})),this.count=u,this.value=n.source=s,n},Yi.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1}],output:["value"]},Object(v.inherits)(Yi,ur).transform=function(e,t){if(!this.value||e.modified()){var n=t.materialize().fork(t.MOD);return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Ir(e.start,e.stop,e.step||1).map(T),n.add=t.add.concat(this.value),n}},Object(v.inherits)(Ki,ur).transform=function(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation},Object(v.inherits)(Ji,ur).transform=function(e,t){var n=t.dataflow,r=e.field,o=this.value,s=!0;function u(e){o.set(r(e),e)}return e.modified("field")||t.modified(r.fields)?(o.clear(),t.visit(t.SOURCE,u)):t.changed()?(t.visit(t.REM,function(e){o.delete(r(e))}),t.visit(t.ADD,u)):s=!1,this.modified(s),o.empty>n.cleanThreshold&&n.runAfter(o.clean),t.fork()},Object(v.inherits)(Zi,ur).transform=function(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(e.sort):t.source).map(e.field))};var Qi={row_number:function(){return{next:function(e){return e.index+1}}},rank:function(){var e;return{init:function(){e=1},next:function(t){var i=t.index,n=t.data;return i&&t.compare(n[i-1],n[i])?e=i+1:e}}},dense_rank:function(){var e;return{init:function(){e=1},next:function(t){var i=t.index,n=t.data;return i&&t.compare(n[i-1],n[i])?++e:e}}},percent_rank:function(){var e=Qi.rank(),t=e.next;return{init:e.init,next:function(e){return(t(e)-1)/(e.data.length-1)}}},cume_dist:function(){var e;return{init:function(){e=0},next:function(t){var i=t.index,n=t.data,r=t.compare;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){(t=+t)>0||Object(v.error)("ntile num must be greater than zero.");var n=Qi.cume_dist(),r=n.next;return{init:n.init,next:function(e){return Math.ceil(t*r(e))}}},lag:function(e,t){return t=+t||1,{next:function(n){var i=n.index-t;return i>=0?e(n.data[i]):null}}},lead:function(e,t){return t=+t||1,{next:function(n){var i=n.index+t,r=n.data;return i<r.length?e(r[i]):null}}},first_value:function(e){return{next:function(t){return e(t.data[t.i0])}}},last_value:function(e){return{next:function(t){return e(t.data[t.i1-1])}}},nth_value:function(e,t){return(t=+t)>0||Object(v.error)("nth_value nth must be greater than zero."),{next:function(n){var i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null}}}},$i=Object.keys(Qi);function ea(e){var t=Object(v.array)(e.ops),n=Object(v.array)(e.fields),r=Object(v.array)(e.params),o=Object(v.array)(e.as),s=this.outputs=[],u=this.windows=[],l={},c={},d=!0,h=[],p=[];function g(f){Object(v.array)(Object(v.accessorFields)(f)).forEach(function(e){l[e]=1})}g(e.sort),t.forEach(function(e,i){var t=n[i],l=Object(v.accessorName)(t),m=pr(e,l,o[i]);if(g(t),s.push(m),Qi.hasOwnProperty(e))u.push(function(e,t,o,s){var u=Qi[e](n[i],r[i]);return{init:u.init||v.zero,update:function(e,t){t[s]=u.next(e)}}}(e,0,0,m));else{if(null==t&&"count"!==e&&Object(v.error)("Null aggregate field specified."),"count"===e)return void h.push(m);d=!1;var _=c[l];_||((_=c[l]=[]).field=t,p.push(_)),_.push(vr(e,m))}}),(h.length||p.length)&&(this.cell=function(e,t,n){e=e.map(function(e){return xr(e,e.field)});var r={num:0,agg:null,store:!1,count:t};if(!n)for(var o=e.length,a=r.agg=Array(o),i=0;i<o;++i)a[i]=new e[i](r);if(r.store)var s=r.data=new $r;return r.add=function(e){if(r.num+=1,!n){s&&s.add(e);for(var i=0;i<o;++i)a[i].add(a[i].get(e),e)}},r.rem=function(e){if(r.num-=1,!n){s&&s.rem(e);for(var i=0;i<o;++i)a[i].rem(a[i].get(e),e)}},r.set=function(e){var i,o;for(s&&s.values(),i=0,o=t.length;i<o;++i)e[t[i]]=r.num;if(!n)for(i=0,o=a.length;i<o;++i)a[i].set(e)},r.init=function(){r.num=0,s&&s.reset();for(var i=0;i<o;++i)a[i].init()},r}(p,h,d)),this.inputs=Object.keys(l)}var ta=ea.prototype;function na(e){ur.call(this,{},e),this._mlen=0,this._mods=[]}ta.init=function(){this.windows.forEach(function(e){e.init()}),this.cell&&this.cell.init()},ta.update=function(e,t){var j,n=this.cell,r=this.windows,o=e.data,s=r&&r.length;if(n){for(j=e.p0;j<e.i0;++j)n.rem(o[j]);for(j=e.p1;j<e.i1;++j)n.add(o[j]);n.set(t)}for(j=0;j<s;++j)r[j].update(e,t)},na.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:$i.concat(mr)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};var ra=Object(v.inherits)(na,ur);function ia(e,t,n){var r=n.sort,o=r&&!n.ignorePeers,s=n.frame||[null,0],u=e.data(r),l=u.length,i=0,b=o?kr(r):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:u,compare:r||Object(v.constant)(-1)};for(t.init();i<l;++i)aa(c,s,i,l),o&&oa(c,b),t.update(c,u[i])}function aa(e,f,i,t){e.p0=e.i0,e.p1=e.i1,e.i0=null==f[0]?0:Math.max(0,i-Math.abs(f[0])),e.i1=null==f[1]?t:Math.min(t,i+Math.abs(f[1])+1),e.index=i}function oa(e,t){var n=e.i0,r=e.i1-1,o=e.compare,s=e.data,u=s.length-1;n>0&&!o(s[n],s[n-1])&&(e.i0=t.left(s,s[n])),r<u&&!o(s[r],s[r+1])&&(e.i1=t.right(s,s[r]))}function sa(b){this.clear(),b&&this.union(b)}ra.transform=function(e,t){var i,n,r=this,o=r.state,s=e.modified();this.stamp=t.stamp,o&&!s||(o=r.state=new ea(e));var u=hr(e.groupby);function l(e){return r.group(u(e))}for(s||t.modified(o.inputs)?(r.value={},t.visit(t.SOURCE,function(e){l(e).add(e)})):(t.visit(t.REM,function(e){l(e).remove(e)}),t.visit(t.ADD,function(e){l(e).add(e)})),i=0,n=r._mlen;i<n;++i)ia(r._mods[i],o,e);return r._mlen=0,r._mods=[],t.reflow(s).modifies(o.outputs)},ra.group=function(e){var t=this.value[e];return t||((t=this.value[e]=ai(S)).stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t};var ua=sa.prototype;ua.clone=function(){return new sa(this)},ua.clear=function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},ua.empty=function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},ua.set=function(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},ua.add=function(x,y){return x<this.x1&&(this.x1=x),y<this.y1&&(this.y1=y),x>this.x2&&(this.x2=x),y>this.y2&&(this.y2=y),this},ua.expand=function(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},ua.round=function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},ua.translate=function(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},ua.rotate=function(e,x,y){var t=Math.cos(e),n=Math.sin(e),r=x-x*t+y*n,o=y-x*n-y*t,s=this.x1,u=this.x2,l=this.y1,c=this.y2;return this.clear().add(t*s-n*l+r,n*s+t*l+o).add(t*s-n*c+r,n*s+t*c+o).add(t*u-n*l+r,n*u+t*l+o).add(t*u-n*c+r,n*u+t*c+o)},ua.union=function(b){return b.x1<this.x1&&(this.x1=b.x1),b.y1<this.y1&&(this.y1=b.y1),b.x2>this.x2&&(this.x2=b.x2),b.y2>this.y2&&(this.y2=b.y2),this},ua.intersect=function(b){return b.x1>this.x1&&(this.x1=b.x1),b.y1>this.y1&&(this.y1=b.y1),b.x2<this.x2&&(this.x2=b.x2),b.y2<this.y2&&(this.y2=b.y2),this},ua.encloses=function(b){return b&&this.x1<=b.x1&&this.x2>=b.x2&&this.y1<=b.y1&&this.y2>=b.y2},ua.alignsWith=function(b){return b&&(this.x1==b.x1||this.x2==b.x2||this.y1==b.y1||this.y2==b.y2)},ua.intersects=function(b){return b&&!(this.x2<b.x1||this.x1>b.x2||this.y2<b.y1||this.y1>b.y2)},ua.contains=function(x,y){return!(x<this.x1||x>this.x2||y<this.y1||y>this.y2)},ua.width=function(){return this.x2-this.x1},ua.height=function(){return this.y2-this.y1};var la,ca=0,fa=function(e,t){var n,r=[];return n={id:"gradient_"+ca++,x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:r,stop:function(e,t){return r.push({offset:e,color:t}),n}}};function da(e){this.mark=e,this.bounds=this.bounds||new sa}function ha(e){da.call(this,e),this.items=this.items||[]}Object(v.inherits)(ha,da);try{if(!(la=n(4)))throw 1}catch(e){try{la=n(5)}catch(zr){la=null}}function pa(e,t){return function(e,t){if("undefined"!=typeof document&&document.createElement){var n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}(e,t)||function(e,t){if(la)try{return new la(e,t)}catch(e){}return null}(e,t)||null}function ga(){return("undefined"!=typeof Image?Image:null)||la&&la.Image||null}function ma(e){this._pending=0,this._loader=e||Ee()}var va=ma.prototype;function ya(e){e._pending+=1}function ba(e){e._pending-=1}va.pending=function(){return this._pending},va.sanitizeURL=function(e){var t=this;return ya(t),t._loader.sanitize(e,{context:"href"}).then(function(e){return ba(t),e}).catch(function(){return ba(t),null})},va.loadImage=function(e){var t=this,n=ga();return ya(t),t._loader.sanitize(e,{context:"image"}).then(function(e){var r=e.href;if(!r||!n)throw{url:r};var o=new n;return o.onload=function(){ba(t),o.loaded=!0},o.onerror=function(){ba(t),o.loaded=!1},o.src=r,o}).catch(function(e){return ba(t),{loaded:!1,width:0,height:0,src:e&&e.url||""}})},va.ready=function(){var e=this;return new Promise(function(t){!function n(value){e.pending()?setTimeout(function(){n(!0)},10):t(value)}(!1)})};var xa=Math.PI,_a=2*xa,wa=_a-1e-6;function Ea(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Oa(){return new Ea}Ea.prototype=Oa.prototype={constructor:Ea,moveTo:function(x,y){this._+="M"+(this._x0=this._x1=+x)+","+(this._y0=this._y1=+y)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(x,y){this._+="L"+(this._x1=+x)+","+(this._y1=+y)},quadraticCurveTo:function(e,t,x,y){this._+="Q"+ +e+","+ +t+","+(this._x1=+x)+","+(this._y1=+y)},bezierCurveTo:function(e,t,n,r,x,y){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+x)+","+(this._y1=+y)},arcTo:function(e,t,n,r,o){var s=this._x1,u=this._y1,l=(n=+n)-(e=+e),c=(r=+r)-(t=+t),d=s-e,h=u-t,p=d*d+h*h;if((o=+o)<0)throw new Error("negative radius: "+o);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(p>1e-6)if(Math.abs(h*l-c*d)>1e-6&&o){var g=n-s,m=r-u,v=l*l+c*c,_=g*g+m*m,w=Math.sqrt(v),E=Math.sqrt(p),O=o*Math.tan((xa-Math.acos((v+p-_)/(2*w*E)))/2),S=O/E,A=O/w;Math.abs(S-1)>1e-6&&(this._+="L"+(e+S*d)+","+(t+S*h)),this._+="A"+o+","+o+",0,0,"+ +(h*g>d*m)+","+(this._x1=e+A*l)+","+(this._y1=t+A*c)}else this._+="L"+(this._x1=e)+","+(this._y1=t)},arc:function(x,y,e,t,n,r){x=+x,y=+y;var o=(e=+e)*Math.cos(t),s=e*Math.sin(t),u=x+o,l=y+s,c=1^r,d=r?t-n:n-t;if(e<0)throw new Error("negative radius: "+e);null===this._x1?this._+="M"+u+","+l:(Math.abs(this._x1-u)>1e-6||Math.abs(this._y1-l)>1e-6)&&(this._+="L"+u+","+l),e&&(d<0&&(d=d%_a+_a),d>wa?this._+="A"+e+","+e+",0,1,"+c+","+(x-o)+","+(y-s)+"A"+e+","+e+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):d>1e-6&&(this._+="A"+e+","+e+",0,"+ +(d>=xa)+","+c+","+(this._x1=x+e*Math.cos(n))+","+(this._y1=y+e*Math.sin(n))))},rect:function(x,y,e,t){this._+="M"+(this._x0=this._x1=+x)+","+(this._y0=this._y1=+y)+"h"+ +e+"v"+ +t+"h"+-e+"Z"},toString:function(){return this._}};var Sa=Oa,Aa=function(x){return function(){return x}},ka=Math.abs,Ta=Math.atan2,Na=Math.cos,Ma=Math.max,Ca=Math.min,Da=Math.sin,Ra=Math.sqrt,Ia=1e-12,Pa=Math.PI,La=Pa/2,za=2*Pa;function ja(x){return x>=1?La:x<=-1?-La:Math.asin(x)}function Fa(e){return e.innerRadius}function Ua(e){return e.outerRadius}function Ba(e){return e.startAngle}function Va(e){return e.endAngle}function qa(e){return e&&e.padAngle}function Ga(e,t,n,r,o,s,u){var l=e-n,c=t-r,d=(u?s:-s)/Ra(l*l+c*c),h=d*c,p=-d*l,g=e+h,m=t+p,v=n+h,_=r+p,w=(g+v)/2,E=(m+_)/2,O=v-g,S=_-m,A=O*O+S*S,T=o-s,N=g*_-v*m,M=(S<0?-1:1)*Ra(Ma(0,T*T*A-N*N)),C=(N*S-O*M)/A,D=(-N*O-S*M)/A,R=(N*S+O*M)/A,I=(-N*O+S*M)/A,P=C-w,L=D-E,z=R-w,F=I-E;return P*P+L*L>z*z+F*F&&(C=R,D=I),{cx:C,cy:D,x01:-h,y01:-p,x11:C*(o/T-1),y11:D*(o/T-1)}}function Wa(e){this._context=e}Wa.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;default:this._context.lineTo(x,y)}}};var Ha=function(e){return new Wa(e)};function Xa(e){return e[0]}function Ya(e){return e[1]}var Ka=function(){var x=Xa,y=Ya,e=Aa(!0),t=null,n=Ha,r=null;function o(o){var i,s,u,l=o.length,c=!1;for(null==t&&(r=n(u=Sa())),i=0;i<=l;++i)!(i<l&&e(s=o[i],i,o))===c&&((c=!c)?r.lineStart():r.lineEnd()),c&&r.point(+x(s,i,o),+y(s,i,o));if(u)return r=null,u+""||null}return o.x=function(e){return arguments.length?(x="function"==typeof e?e:Aa(+e),o):x},o.y=function(e){return arguments.length?(y="function"==typeof e?e:Aa(+e),o):y},o.defined=function(t){return arguments.length?(e="function"==typeof t?t:Aa(!!t),o):e},o.curve=function(e){return arguments.length?(n=e,null!=t&&(r=n(t)),o):n},o.context=function(e){return arguments.length?(null==e?t=r=null:r=n(t=e),o):t},o},Ja=function(){var e=Xa,t=null,n=Aa(0),r=Ya,o=Aa(!0),s=null,u=Ha,l=null;function c(c){var i,j,k,d,h,p=c.length,g=!1,m=new Array(p),v=new Array(p);for(null==s&&(l=u(h=Sa())),i=0;i<=p;++i){if(!(i<p&&o(d=c[i],i,c))===g)if(g=!g)j=i,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),k=i-1;k>=j;--k)l.point(m[k],v[k]);l.lineEnd(),l.areaEnd()}g&&(m[i]=+e(d,i,c),v[i]=+n(d,i,c),l.point(t?+t(d,i,c):m[i],r?+r(d,i,c):v[i]))}if(h)return l=null,h+""||null}function d(){return Ka().defined(o).curve(u).context(s)}return c.x=function(n){return arguments.length?(e="function"==typeof n?n:Aa(+n),t=null,c):e},c.x0=function(t){return arguments.length?(e="function"==typeof t?t:Aa(+t),c):e},c.x1=function(e){return arguments.length?(t=null==e?null:"function"==typeof e?e:Aa(+e),c):t},c.y=function(e){return arguments.length?(n="function"==typeof e?e:Aa(+e),r=null,c):n},c.y0=function(e){return arguments.length?(n="function"==typeof e?e:Aa(+e),c):n},c.y1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:Aa(+e),c):r},c.lineX0=c.lineY0=function(){return d().x(e).y(n)},c.lineY1=function(){return d().x(e).y(r)},c.lineX1=function(){return d().x(t).y(n)},c.defined=function(e){return arguments.length?(o="function"==typeof e?e:Aa(!!e),c):o},c.curve=function(e){return arguments.length?(u=e,null!=s&&(l=u(s)),c):u},c.context=function(e){return arguments.length?(null==e?s=l=null:l=u(s=e),c):s},c};function Za(e){this._curve=e}Za.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(a,e){this._curve.point(e*Math.sin(a),e*-Math.cos(a))}},Array;var Qa={draw:function(e,t){var n=Math.sqrt(t/Pa);e.moveTo(n,0),e.arc(0,0,n,0,za)}},$a=(Math.sqrt(1/3),Math.sin(Pa/10),Math.sin(7*Pa/10),Math.sin(za/10),Math.cos(za/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12),function(){});function eo(e,x,y){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+x)/6,(e._y0+4*e._y1+y)/6)}function to(e){this._context=e}function no(e){this._context=e}function ro(e){this._context=e}function io(e,t){this._basis=new to(e),this._beta=t}to.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:eo(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:eo(this,x,y)}this._x0=this._x1,this._x1=x,this._y0=this._y1,this._y1=y}},no.prototype={areaStart:$a,areaEnd:$a,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._x2=x,this._y2=y;break;case 1:this._point=2,this._x3=x,this._y3=y;break;case 2:this._point=3,this._x4=x,this._y4=y,this._context.moveTo((this._x0+4*this._x1+x)/6,(this._y0+4*this._y1+y)/6);break;default:eo(this,x,y)}this._x0=this._x1,this._x1=x,this._y0=this._y1,this._y1=y}},ro.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var e=(this._x0+4*this._x1+x)/6,t=(this._y0+4*this._y1+y)/6;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 3:this._point=4;default:eo(this,x,y)}this._x0=this._x1,this._x1=x,this._y0=this._y1,this._y1=y}},io.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var x=this._x,y=this._y,j=x.length-1;if(j>0)for(var e,t=x[0],n=y[0],r=x[j]-t,o=y[j]-n,i=-1;++i<=j;)this._basis.point(this._beta*x[i]+(1-this._beta)*(t+(e=i/j)*r),this._beta*y[i]+(1-this._beta)*(n+e*o));this._x=this._y=null,this._basis.lineEnd()},point:function(x,y){this._x.push(+x),this._y.push(+y)}};var ao=function e(t){function n(e){return 1===t?new to(e):new io(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function oo(e,x,y){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-x),e._y2+e._k*(e._y1-y),e._x2,e._y2)}function so(e,t){this._context=e,this._k=(1-t)/6}so.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:oo(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2,this._x1=x,this._y1=y;break;case 2:this._point=3;default:oo(this,x,y)}this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var uo=function e(t){function n(e){return new so(e,t)}return n.tension=function(t){return e(+t)},n}(0);function lo(e,t){this._context=e,this._k=(1-t)/6}lo.prototype={areaStart:$a,areaEnd:$a,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._x3=x,this._y3=y;break;case 1:this._point=2,this._context.moveTo(this._x4=x,this._y4=y);break;case 2:this._point=3,this._x5=x,this._y5=y;break;default:oo(this,x,y)}this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var co=function e(t){function n(e){return new lo(e,t)}return n.tension=function(t){return e(+t)},n}(0);function fo(e,t){this._context=e,this._k=(1-t)/6}fo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:oo(this,x,y)}this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var ho=function e(t){function n(e){return new fo(e,t)}return n.tension=function(t){return e(+t)},n}(0);function po(e,x,y){var t=e._x1,n=e._y1,r=e._x2,o=e._y2;if(e._l01_a>Ia){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,s=3*e._l01_a*(e._l01_a+e._l12_a);t=(t*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/s,n=(n*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/s}if(e._l23_a>Ia){var b=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);r=(r*b+e._x1*e._l23_2a-x*e._l12_2a)/u,o=(o*b+e._y1*e._l23_2a-y*e._l12_2a)/u}e._context.bezierCurveTo(t,n,r,o,e._x2,e._y2)}function go(e,t){this._context=e,this._alpha=t}go.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){if(x=+x,y=+y,this._point){var e=this._x2-x,t=this._y2-y;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+t*t,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;break;case 2:this._point=3;default:po(this,x,y)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var mo=function e(t){function n(e){return t?new go(e,t):new so(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function vo(e,t){this._context=e,this._alpha=t}vo.prototype={areaStart:$a,areaEnd:$a,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(x,y){if(x=+x,y=+y,this._point){var e=this._x2-x,t=this._y2-y;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+t*t,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=x,this._y3=y;break;case 1:this._point=2,this._context.moveTo(this._x4=x,this._y4=y);break;case 2:this._point=3,this._x5=x,this._y5=y;break;default:po(this,x,y)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var yo=function e(t){function n(e){return t?new vo(e,t):new lo(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function bo(e,t){this._context=e,this._alpha=t}bo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){if(x=+x,y=+y,this._point){var e=this._x2-x,t=this._y2-y;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+t*t,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:po(this,x,y)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var xo=function e(t){function n(e){return t?new bo(e,t):new fo(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function _o(e){this._context=e}function wo(x){return x<0?-1:1}function Eo(e,t,n){var r=e._x1-e._x0,o=t-e._x1,s=(e._y1-e._y0)/(r||o<0&&-0),u=(n-e._y1)/(o||r<0&&-0),l=(s*o+u*r)/(r+o);return(wo(s)+wo(u))*Math.min(Math.abs(s),Math.abs(u),.5*Math.abs(l))||0}function Oo(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function So(e,t,n){var r=e._x0,o=e._x1,s=e._y1,u=(o-r)/3;e._context.bezierCurveTo(r+u,e._y0+u*t,o-u,s-u*n,o,s)}function Ao(e){this._context=e}function ko(e){this._context=new To(e)}function To(e){this._context=e}function No(e){this._context=e}function Mo(x){var i,e,t=x.length-1,a=new Array(t),b=new Array(t),n=new Array(t);for(a[0]=0,b[0]=2,n[0]=x[0]+2*x[1],i=1;i<t-1;++i)a[i]=1,b[i]=4,n[i]=4*x[i]+2*x[i+1];for(a[t-1]=2,b[t-1]=7,n[t-1]=8*x[t-1]+x[t],i=1;i<t;++i)b[i]-=e=a[i]/b[i-1],n[i]-=e*n[i-1];for(a[t-1]=n[t-1]/b[t-1],i=t-2;i>=0;--i)a[i]=(n[i]-a[i+1])/b[i];for(b[t-1]=(x[t]+a[t-1])/2,i=0;i<t-1;++i)b[i]=2*x[i+1]-a[i+1];return[a,b]}function Co(e,t){this._context=e,this._t=t}_o.prototype={areaStart:$a,areaEnd:$a,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(x,y){x=+x,y=+y,this._point?this._context.lineTo(x,y):(this._point=1,this._context.moveTo(x,y))}},Ao.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:So(this,this._t0,Oo(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){var e=NaN;if(y=+y,(x=+x)!==this._x1||y!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;break;case 2:this._point=3,So(this,Oo(this,e=Eo(this,x,y)),e);break;default:So(this,this._t0,e=Eo(this,x,y))}this._x0=this._x1,this._x1=x,this._y0=this._y1,this._y1=y,this._t0=e}}},(ko.prototype=Object.create(Ao.prototype)).point=function(x,y){Ao.prototype.point.call(this,y,x)},To.prototype={moveTo:function(x,y){this._context.moveTo(y,x)},closePath:function(){this._context.closePath()},lineTo:function(x,y){this._context.lineTo(y,x)},bezierCurveTo:function(e,t,n,r,x,y){this._context.bezierCurveTo(t,e,r,n,y,x)}},No.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var x=this._x,y=this._y,e=x.length;if(e)if(this._line?this._context.lineTo(x[0],y[0]):this._context.moveTo(x[0],y[0]),2===e)this._context.lineTo(x[1],y[1]);else for(var t=Mo(x),n=Mo(y),r=0,o=1;o<e;++r,++o)this._context.bezierCurveTo(t[0][r],n[0][r],t[1][r],n[1][r],x[o],y[o]);(this._line||0!==this._line&&1===e)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(x,y){this._x.push(+x),this._y.push(+y)}},Co.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,y),this._context.lineTo(x,y);else{var e=this._x*(1-this._t)+x*this._t;this._context.lineTo(e,this._y),this._context.lineTo(e,y)}}this._x=x,this._y=y}};var Do={basis:{curve:function(e){return new to(e)}},"basis-closed":{curve:function(e){return new no(e)}},"basis-open":{curve:function(e){return new ro(e)}},bundle:{curve:ao,tension:"beta",value:.85},cardinal:{curve:uo,tension:"tension",value:0},"cardinal-open":{curve:ho,tension:"tension",value:0},"cardinal-closed":{curve:co,tension:"tension",value:0},"catmull-rom":{curve:mo,tension:"alpha",value:.5},"catmull-rom-closed":{curve:yo,tension:"alpha",value:.5},"catmull-rom-open":{curve:xo,tension:"alpha",value:.5},linear:{curve:Ha},"linear-closed":{curve:function(e){return new _o(e)}},monotone:{horizontal:function(e){return new ko(e)},vertical:function(e){return new Ao(e)}},natural:{curve:function(e){return new No(e)}},step:{curve:function(e){return new Co(e,.5)}},"step-after":{curve:function(e){return new Co(e,1)}},"step-before":{curve:function(e){return new Co(e,0)}}};function Ro(e,t,n){var r=Do.hasOwnProperty(e)&&Do[e],o=null;return r&&(o=r.curve||r[t||"vertical"],r.tension&&null!=n&&(o=o[r.tension](n))),o}var Io={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Po=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/],Lo=function(e){var t,n,r,o,s,u,l,i,j,c,d,h=[];for(i=0,c=(t=e.slice().replace(Po[0],"###$1").split(Po[1]).slice(1)).length;i<c;++i){for(r=(n=t[i]).slice(1).trim().replace(Po[2],"$1###$2").split(Po[3]),o=[u=n.charAt(0)],j=0,d=r.length;j<d;++j)(s=+r[j])===s&&o.push(s);if(l=Io[u.toLowerCase()],o.length-1>l)for(j=1,d=o.length;j<d;j+=l)h.push([u].concat(o.slice(j,j+l)));else h.push(o)}return h},zo={},jo={},Fo=[].join;function Uo(e){var t=Fo.call(e);if(jo[t])return jo[t];var n=e[0],r=e[1],o=e[2],s=e[3],u=e[4],l=e[5],c=e[6],d=e[7],h=d*u,p=-c*l,g=c*u,m=d*l,v=Math.cos(o),_=Math.sin(o),w=Math.cos(s),E=Math.sin(s),O=.5*(s-o),S=Math.sin(.5*O),A=8/3*S*S/Math.sin(O),T=n+v-A*_,N=r+_+A*v,M=n+w,C=r+E,D=M+A*E,R=C-A*w;return jo[t]=[h*T+p*N,g*T+m*N,h*D+p*R,g*D+m*R,h*M+p*C,g*M+m*C]}var Bo=["l",0,0,0,0,0,0,0];function Vo(e,t){var n=Bo[0]=e[0];if("a"===n||"A"===n)Bo[1]=t*e[1],Bo[2]=t*e[2],Bo[6]=t*e[6],Bo[7]=t*e[7];else for(var i=1,r=e.length;i<r;++i)Bo[i]=t*e[i];return Bo}var qo=function(e,t,n,r,o){var s,u,l,c,d,h=null,x=0,y=0,p=0,g=0;null==n&&(n=0),null==r&&(r=0),null==o&&(o=1),e.beginPath&&e.beginPath();for(var i=0,m=t.length;i<m;++i){switch(s=t[i],1!==o&&(s=Vo(s,o)),s[0]){case"l":e.lineTo((x+=s[1])+n,(y+=s[2])+r);break;case"L":e.lineTo((x=s[1])+n,(y=s[2])+r);break;case"h":e.lineTo((x+=s[1])+n,y+r);break;case"H":e.lineTo((x=s[1])+n,y+r);break;case"v":e.lineTo(x+n,(y+=s[1])+r);break;case"V":e.lineTo(x+n,(y=s[1])+r);break;case"m":e.moveTo((x+=s[1])+n,(y+=s[2])+r);break;case"M":e.moveTo((x=s[1])+n,(y=s[2])+r);break;case"c":e.bezierCurveTo(x+s[1]+n,y+s[2]+r,(p=x+s[3])+n,(g=y+s[4])+r,(u=x+s[5])+n,(l=y+s[6])+r),x=u,y=l;break;case"C":e.bezierCurveTo(s[1]+n,s[2]+r,(p=s[3])+n,(g=s[4])+r,(x=s[5])+n,(y=s[6])+r);break;case"s":e.bezierCurveTo((p=2*x-p)+n,(g=2*y-g)+r,x+s[1]+n,y+s[2]+r,(u=x+s[3])+n,(l=y+s[4])+r),p=x+s[1],g=y+s[2],x=u,y=l;break;case"S":e.bezierCurveTo((p=2*x-p)+n,(g=2*y-g)+r,s[1]+n,s[2]+r,(u=s[3])+n,(l=s[4])+r),x=u,y=l,p=s[1],g=s[2];break;case"q":e.quadraticCurveTo((p=x+s[1])+n,(g=y+s[2])+r,(u=x+s[3])+n,(l=y+s[4])+r),x=u,y=l;break;case"Q":e.quadraticCurveTo(s[1]+n,s[2]+r,(u=s[3])+n,(l=s[4])+r),x=u,y=l,p=s[1],g=s[2];break;case"t":u=x+s[1],l=y+s[2],null===h[0].match(/[QqTt]/)?(p=x,g=y):"t"===h[0]?(p=2*x-c,g=2*y-d):"q"===h[0]&&(p=2*x-p,g=2*y-g),c=p,d=g,e.quadraticCurveTo(p+n,g+r,u+n,l+r),p=(x=u)+s[1],g=(y=l)+s[2];break;case"T":e.quadraticCurveTo((p=2*x-p)+n,(g=2*y-g)+r,(u=s[1])+n,(l=s[2])+r),x=u,y=l;break;case"a":Go(e,x+n,y+r,[s[1],s[2],s[3],s[4],s[5],s[6]+x+n,s[7]+y+r]),x+=s[6],y+=s[7];break;case"A":Go(e,x+n,y+r,[s[1],s[2],s[3],s[4],s[5],s[6]+n,s[7]+r]),x=s[6],y=s[7];break;case"z":case"Z":e.closePath()}h=s}};function Go(e,x,y,t){for(var n=function(x,y,e,t,n,r,o,s,u){var l=Fo.call(arguments);if(zo[l])return zo[l];var c=o*(Math.PI/180),d=Math.sin(c),h=Math.cos(c),p=h*(s-x)*.5+d*(u-y)*.5,g=h*(u-y)*.5-d*(s-x)*.5,m=p*p/((e=Math.abs(e))*e)+g*g/((t=Math.abs(t))*t);m>1&&(e*=m=Math.sqrt(m),t*=m);var v=h/e,_=d/e,w=-d/t,E=h/t,O=v*s+_*u,S=w*s+E*u,A=v*x+_*y,T=w*x+E*y,N=1/((A-O)*(A-O)+(T-S)*(T-S))-.25;N<0&&(N=0);var M=Math.sqrt(N);r==n&&(M=-M);var C=.5*(O+A)-M*(T-S),D=.5*(S+T)+M*(A-O),R=Math.atan2(S-D,O-C),I=Math.atan2(T-D,A-C)-R;I<0&&1===r?I+=2*Math.PI:I>0&&0===r&&(I-=2*Math.PI);for(var P=Math.ceil(Math.abs(I/(.5*Math.PI+.001))),L=[],i=0;i<P;++i)L[i]=[C,D,R+i*I/P,R+(i+1)*I/P,e,t,d,h];return zo[l]=L}(t[5],t[6],t[0],t[1],t[3],t[4],t[2],x,y),i=0;i<n.length;++i){var r=Uo(n[i]);e.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5])}}var Wo=2*Math.PI,Ho=Math.sqrt(3)/2,Xo={circle:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Wo)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),x=-n/2;e.rect(x,x,n,n)}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Ho*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Ho*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Ho*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Ho*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}}};function Yo(e){return Xo.hasOwnProperty(e)?Xo[e]:function(e){if(!Ko.hasOwnProperty(e)){var t=Lo(e);Ko[e]={draw:function(e,n){qo(e,t,0,0,Math.sqrt(n)/2)}}}return Ko[e]}(e)}var Ko={};function Jo(e){return e.x}function Zo(e){return e.y}function Qo(e){return e.width}function $o(e){return e.height}function es(e){return function(){return e}}var ts=function(){var x=Jo,y=Zo,e=Qo,t=$o,n=es(0),r=null;function o(o,s,u){var l,c=null!=s?s:+x.call(this,o),d=null!=u?u:+y.call(this,o),h=+e.call(this,o),p=+t.call(this,o),g=+n.call(this,o);if(r||(r=l=Sa()),g<=0)r.rect(c,d,h,p);else{var m=c+h,v=d+p;r.moveTo(c+g,d),r.lineTo(m-g,d),r.quadraticCurveTo(m,d,m,d+g),r.lineTo(m,v-g),r.quadraticCurveTo(m,v,m-g,v),r.lineTo(c+g,v),r.quadraticCurveTo(c,v,c,v-g),r.lineTo(c,d+g),r.quadraticCurveTo(c,d,c+g,d),r.closePath()}if(l)return r=null,l+""||null}return o.x=function(e){return arguments.length?(x="function"==typeof e?e:es(+e),o):x},o.y=function(e){return arguments.length?(y="function"==typeof e?e:es(+e),o):y},o.width=function(t){return arguments.length?(e="function"==typeof t?t:es(+t),o):e},o.height=function(e){return arguments.length?(t="function"==typeof e?e:es(+e),o):t},o.cornerRadius=function(e){return arguments.length?(n="function"==typeof e?e:es(+e),o):n},o.context=function(e){return arguments.length?(r=null==e?null:e,o):r},o},ns=Math.PI,rs=function(){var x,y,e,t,n,r,o,s,u=null;function l(e,t,l){var c=l/2;if(n){var d=o-t,h=e-r;if(d||h){var p=Math.sqrt(d*d+h*h),g=(d/=p)*s,m=(h/=p)*s,v=Math.atan2(h,d);u.moveTo(r-g,o-m),u.lineTo(e-d*c,t-h*c),u.arc(e,t,c,v-ns,v),u.lineTo(r+g,o+m),u.arc(r,o,s,v,v+ns)}else u.arc(e,t,c,0,2*ns);u.closePath()}else n=1;r=e,o=t,s=c}function c(r){var i,o,s,c=r.length,d=!1;for(null==u&&(u=s=Sa()),i=0;i<=c;++i)!(i<c&&t(o=r[i],i,r))===d&&(d=!d)&&(n=0),d&&l(+x(o,i,r),+y(o,i,r),+e(o,i,r));if(s)return u=null,s+""||null}return c.x=function(e){return arguments.length?(x=e,c):x},c.y=function(e){return arguments.length?(y=e,c):y},c.size=function(t){return arguments.length?(e=t,c):e},c.defined=function(e){return arguments.length?(t=e,c):t},c.context=function(e){return arguments.length?(u=null==e?null:e,c):u},c};function is(e){return e.x||0}function as(e){return e.y||0}function os(e){return e.cornerRadius||0}function ss(e){return!(!1===e.defined)}var us=function(){var e=Fa,t=Ua,n=Aa(0),r=null,o=Ba,s=Va,u=qa,l=null;function c(){var c,d,x,h=+e.apply(this,arguments),p=+t.apply(this,arguments),g=o.apply(this,arguments)-La,m=s.apply(this,arguments)-La,v=ka(m-g),_=m>g;if(l||(l=c=Sa()),p<h&&(d=p,p=h,h=d),p>Ia)if(v>za-Ia)l.moveTo(p*Na(g),p*Da(g)),l.arc(0,0,p,g,m,!_),h>Ia&&(l.moveTo(h*Na(m),h*Da(m)),l.arc(0,0,h,m,g,_));else{var w,E,O=g,S=m,A=g,T=m,N=v,M=v,C=u.apply(this,arguments)/2,D=C>Ia&&(r?+r.apply(this,arguments):Ra(h*h+p*p)),R=Ca(ka(p-h)/2,+n.apply(this,arguments)),I=R,P=R;if(D>Ia){var L=ja(D/h*Da(C)),z=ja(D/p*Da(C));(N-=2*L)>Ia?(A+=L*=_?1:-1,T-=L):(N=0,A=T=(g+m)/2),(M-=2*z)>Ia?(O+=z*=_?1:-1,S-=z):(M=0,O=S=(g+m)/2)}var F=p*Na(O),U=p*Da(O),B=h*Na(T),V=h*Da(T);if(R>Ia){var q=p*Na(S),G=p*Da(S),W=h*Na(A),H=h*Da(A);if(v<Pa){var X=N>Ia?function(e,t,n,r,o,s,u,l){var c=W-F,d=H-U,h=u-q,p=l-G,g=(h*(U-G)-p*(F-q))/(p*c-h*d);return[F+g*c,U+g*d]}(0,0,0,0,0,0,B,V):[B,V],Y=F-X[0],K=U-X[1],J=q-X[0],Z=G-X[1],Q=1/Da(((x=(Y*J+K*Z)/(Ra(Y*Y+K*K)*Ra(J*J+Z*Z)))>1?0:x<-1?Pa:Math.acos(x))/2),$=Ra(X[0]*X[0]+X[1]*X[1]);I=Ca(R,(h-$)/(Q-1)),P=Ca(R,(p-$)/(Q+1))}}M>Ia?P>Ia?(w=Ga(W,H,F,U,p,P,_),E=Ga(q,G,B,V,p,P,_),l.moveTo(w.cx+w.x01,w.cy+w.y01),P<R?l.arc(w.cx,w.cy,P,Ta(w.y01,w.x01),Ta(E.y01,E.x01),!_):(l.arc(w.cx,w.cy,P,Ta(w.y01,w.x01),Ta(w.y11,w.x11),!_),l.arc(0,0,p,Ta(w.cy+w.y11,w.cx+w.x11),Ta(E.cy+E.y11,E.cx+E.x11),!_),l.arc(E.cx,E.cy,P,Ta(E.y11,E.x11),Ta(E.y01,E.x01),!_))):(l.moveTo(F,U),l.arc(0,0,p,O,S,!_)):l.moveTo(F,U),h>Ia&&N>Ia?I>Ia?(w=Ga(B,V,q,G,h,-I,_),E=Ga(F,U,W,H,h,-I,_),l.lineTo(w.cx+w.x01,w.cy+w.y01),I<R?l.arc(w.cx,w.cy,I,Ta(w.y01,w.x01),Ta(E.y01,E.x01),!_):(l.arc(w.cx,w.cy,I,Ta(w.y01,w.x01),Ta(w.y11,w.x11),!_),l.arc(0,0,h,Ta(w.cy+w.y11,w.cx+w.x11),Ta(E.cy+E.y11,E.cx+E.x11),_),l.arc(E.cx,E.cy,I,Ta(E.y11,E.x11),Ta(E.y01,E.x01),!_))):l.arc(0,0,h,T,A,_):l.lineTo(B,V)}else l.moveTo(0,0);if(l.closePath(),c)return l=null,c+""||null}return c.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,a=(+o.apply(this,arguments)+ +s.apply(this,arguments))/2-Pa/2;return[Na(a)*n,Da(a)*n]},c.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:Aa(+t),c):e},c.outerRadius=function(e){return arguments.length?(t="function"==typeof e?e:Aa(+e),c):t},c.cornerRadius=function(e){return arguments.length?(n="function"==typeof e?e:Aa(+e),c):n},c.padRadius=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:Aa(+e),c):r},c.startAngle=function(e){return arguments.length?(o="function"==typeof e?e:Aa(+e),c):o},c.endAngle=function(e){return arguments.length?(s="function"==typeof e?e:Aa(+e),c):s},c.padAngle=function(e){return arguments.length?(u="function"==typeof e?e:Aa(+e),c):u},c.context=function(e){return arguments.length?(l=null==e?null:e,c):l},c}().startAngle(function(e){return e.startAngle||0}).endAngle(function(e){return e.endAngle||0}).padAngle(function(e){return e.padAngle||0}).innerRadius(function(e){return e.innerRadius||0}).outerRadius(function(e){return e.outerRadius||0}).cornerRadius(os),ls=Ja().x(is).y1(as).y0(function(e){return(e.y||0)+(e.height||0)}).defined(ss),cs=Ja().y(as).x1(is).x0(function(e){return(e.x||0)+(e.width||0)}).defined(ss),fs=Ka().x(is).y(as).defined(ss),ds=ts().x(is).y(as).width(function(e){return e.width||0}).height(function(e){return e.height||0}).cornerRadius(os),hs=function(){var e=Aa(Qa),t=Aa(64),n=null;function r(){var r;if(n||(n=r=Sa()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return r.type=function(t){return arguments.length?(e="function"==typeof t?t:Aa(t),r):e},r.size=function(e){return arguments.length?(t="function"==typeof e?e:Aa(+e),r):t},r.context=function(e){return arguments.length?(n=null==e?null:e,r):n},r}().type(function(e){return Yo(e.shape||"circle")}).size(function(e){return null==e.size?64:e.size}),ps=rs().x(is).y(as).defined(ss).size(function(e){return e.size||1});function gs(e,t,x,y){return ds.context(e)(t,x,y)}var ms,vs=function(e,t){return t.stroke&&0!==t.opacity&&0!==t.strokeOpacity&&e.expand(null!=t.strokeWidth?+t.strokeWidth:1),e},ys=2*Math.PI,bs=ys/4,xs=ys-1e-8;function _s(e){return ms=e,_s}function ws(){}function Es(x,y){ms.add(x,y)}_s.beginPath=ws,_s.closePath=ws,_s.moveTo=Es,_s.lineTo=Es,_s.rect=function(x,y,e,t){Es(x,y),Es(x+e,y+t)},_s.quadraticCurveTo=function(e,t,n,r){Es(e,t),Es(n,r)},_s.bezierCurveTo=function(e,t,n,r,o,s){Es(e,t),Es(n,r),Es(o,s)},_s.arc=function(e,t,n,r,o,s){if(Math.abs(o-r)>xs)return Es(e-n,t-n),void Es(e+n,t+n);var u,i,x,y,l=1/0,c=-1/0,d=1/0,h=-1/0;function p(a){x=n*Math.cos(a),y=n*Math.sin(a),x<l&&(l=x),x>c&&(c=x),y<d&&(d=y),y>h&&(h=y)}if(p(r),p(o),o!==r)if((r%=ys)<0&&(r+=ys),(o%=ys)<0&&(o+=ys),o<r&&(s=!s,u=r,r=o,o=u),s)for(o-=ys,u=r-r%bs,i=0;i<4&&u>o;++i,u-=bs)p(u);else for(u=r-r%bs+bs,i=0;i<4&&u<o;++i,u+=bs)p(u);Es(e+l,t+d),Es(e+c,t+h)};var Os=function(e,t,value){return value.id?function(e,t,n){for(var r=n.width(),o=n.height(),s=t.stops,i=0,u=s.length,l=e.createLinearGradient(n.x1+t.x1*r,n.y1+t.y1*o,n.x1+t.x2*r,n.y1+t.y2*o);i<u;++i)l.addColorStop(s[i].offset,s[i].color);return l}(e,value,t.bounds):value},Ss=function(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=Os(e,t,t.fill),!0)},As=[],ks=function(e,t,n){var r=null!=(r=t.strokeWidth)?r:1;return!(r<=0)&&(n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=Os(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||As),e.lineDashOffset=t.strokeDashOffset||0),!0)};function Ts(a,b){return a.zindex-b.zindex||a.index-b.index}function Ns(e){if(!e.zdirty)return e.zitems;var t,i,n,r=e.items,o=[];for(i=0,n=r.length;i<n;++i)(t=r[i]).index=i,t.zindex&&o.push(t);return e.zdirty=!1,e.zitems=o.sort(Ts)}function Ms(e,t){var i,n,r=e.items;if(r&&r.length){var o=Ns(e);if(o&&o.length){for(i=0,n=r.length;i<n;++i)r[i].zindex||t(r[i]);r=o}for(i=0,n=r.length;i<n;++i)t(r[i])}}function Cs(e,t){var n,i,r=e.items;if(!r||!r.length)return null;var o=Ns(e);for(o&&o.length&&(r=o),i=r.length;--i>=0;)if(n=t(r[i]))return n;if(r===o)for(i=(r=e.items).length;--i>=0;)if(!r[i].zindex&&(n=t(r[i])))return n;return null}function Ds(e){return function(t,n,r){Ms(n,function(n){r&&!r.intersects(n.bounds)||Rs(e,t,n,n)})}}function Rs(e,t,n,r){var o=null==n.opacity?1:n.opacity;0!==o&&(e(t,r)||(n.fill&&Ss(t,n,o)&&t.fill(),n.stroke&&ks(t,n,o)&&t.stroke()))}var Is=function(){return!0};function Ps(e){return e||(e=Is),function(t,n,x,y,r,o){return t.pixelRatio>1&&(x*=t.pixelRatio,y*=t.pixelRatio),Cs(n,function(n){var b=n.bounds;if((!b||b.contains(r,o))&&b)return e(t,n,x,y,r,o)?n:void 0})}}function Ls(e,t){return function(n,r,x,y){var o,s,u=Array.isArray(r)?r[0]:r,l=null==t?u.fill:t,c=u.stroke&&n.isPointInStroke;return c&&(s=u.strokeCap,n.lineWidth=null!=(o=u.strokeWidth)?o:1,n.lineCap=null!=s?s:"butt"),!e(n,r)&&(l&&n.isPointInPath(x,y)||c&&n.isPointInStroke(x,y))}}function zs(e){return Ps(Ls(e))}var js=function(x,y){return"translate("+x+","+y+")"},Fs=function(e){return js(e.x||0,e.y||0)},Us=function(e,t){function n(e,n){var x=n.x||0,y=n.y||0;e.translate(x,y),e.beginPath(),t(e,n),e.translate(-x,-y)}return{type:e,tag:"path",nested:!1,attr:function(e,n){e("transform",Fs(n)),e("d",t(null,n))},bound:function(e,n){return t(_s(e),n),vs(e,n).translate(n.x||0,n.y||0)},draw:Ds(n),pick:zs(n)}},Bs=Us("arc",function(e,t){return us.context(e)(t)}),Vs=function(e,t){function n(e,n){e.beginPath(),t(e,n)}var r,o=Ls(n);return{type:e,tag:"path",nested:!0,attr:function(e,n){var r=n.mark.items;r.length&&e("d",t(null,r))},bound:function(e,n){var r=n.items;return 0===r.length?e:(t(_s(e),r),vs(e,r[0]))},draw:(r=n,function(e,t,n){!t.items.length||n&&!n.intersects(t.bounds)||Rs(r,e,t.items[0],t.items)}),pick:function(e,t,x,y,n,r){var s=t.items,b=t.bounds;return!s||!s.length||b&&!b.contains(n,r)?null:(e.pixelRatio>1&&(x*=e.pixelRatio,y*=e.pixelRatio),o(e,s,x,y)?s[0]:null)}}},qs=Vs("area",function(e,t){var n=t[0];return("horizontal"===n.orient?cs:ls).curve(Ro(n.interpolate||"linear",n.orient,n.tension)).context(e)(t)}),Gs=1;function Ws(){Gs=1}var Hs=function(e,t,n){var r=t.clip,o=e._defs,s=t.clip_id||(t.clip_id="clip"+Gs++),u=o.clipping[s]||(o.clipping[s]={id:s});return Object(v.isFunction)(r)?u.path=r(null):(u.width=n.width||0,u.height=n.height||0),"url(#"+s+")"},Xs={type:"group",tag:"g",nested:!1,attr:function(e,t){e("transform",Fs(t))},bound:function(e,t){if(!t.clip&&t.items)for(var n=t.items,j=0,r=n.length;j<r;++j)e.union(n[j].bounds);return(t.clip||t.width||t.height)&&vs(e.add(0,0).add(t.width||0,t.height||0),t),e.translate(t.x||0,t.y||0)},draw:function(e,t,n){var r=this;Ms(t,function(t){var o,s,u=t.x||0,l=t.y||0,c=t.width||0,d=t.height||0;e.save(),e.translate(u,l),(t.stroke||t.fill)&&(s=null==t.opacity?1:t.opacity)>0&&(e.beginPath(),gs(e,t,o=t.stroke?.5:0,o),t.fill&&Ss(e,t,s)&&e.fill(),t.stroke&&ks(e,t,s)&&e.stroke()),t.clip&&(e.beginPath(),e.rect(0,0,c,d),e.clip()),n&&n.translate(-u,-l),Ms(t,function(t){r.draw(e,t,n)}),n&&n.translate(u,l),e.restore()})},pick:function(e,t,x,y,n,r){if(t.bounds&&!t.bounds.contains(n,r)||!t.items)return null;var o=this;return Cs(t,function(s){var u,l,c,b;if(!(b=s.bounds)||b.contains(n,r))return l=s.x||0,c=s.y||0,e.save(),e.translate(l,c),l=n-l,c=r-c,u=Cs(s,function(e){return function(e,x,y){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(l,c)}(e)?o.pick(e,x,y,l,c):null}),e.restore(),u||((u=!1!==t.interactive&&(s.fill||s.stroke)&&l>=0&&l<=s.width&&c>=0&&c<=s.height)?s:null)})},background:function(e,t){var n=t.stroke?.5:0;e("class","background"),e("d",gs(null,t,n,n))},foreground:function(e,t,n){e("clip-path",t.clip?Hs(n,t,t):null)}};function Ys(e,t){var n=e.image;return n&&n.url===e.url||(n={loaded:!1,width:0,height:0},t.loadImage(e.url).then(function(t){e.image=t,e.image.url=e.url})),n}function Ks(e,t){return"center"===e?t/2:"right"===e?t:0}function Js(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var Zs={type:"image",tag:"image",nested:!1,attr:function(e,t,n){var r=Ys(t,n),x=t.x||0,y=t.y||0,o=(null!=t.width?t.width:r.width)||0,s=(null!=t.height?t.height:r.height)||0,a=!1===t.aspect?"none":"xMidYMid";x-=Ks(t.align,o),y-=Js(t.baseline,s),e("href",r.src||"","http://www.w3.org/1999/xlink","xlink:href"),e("transform",js(x,y)),e("width",o),e("height",s),e("preserveAspectRatio",a)},bound:function(e,t){var n=t.image,x=t.x||0,y=t.y||0,r=(null!=t.width?t.width:n&&n.width)||0,o=(null!=t.height?t.height:n&&n.height)||0;return x-=Ks(t.align,r),y-=Js(t.baseline,o),e.set(x,y,x+r,y+o)},draw:function(e,t,n){var r=this;Ms(t,function(t){if(!n||n.intersects(t.bounds)){var o,s,u,l,c=Ys(t,r),x=t.x||0,y=t.y||0,d=(null!=t.width?t.width:c.width)||0,h=(null!=t.height?t.height:c.height)||0;x-=Ks(t.align,d),y-=Js(t.baseline,h),!1!==t.aspect&&(u=t.width/t.height,(s=c.width/c.height)==s&&u==u&&s!==u&&(u<s?(y+=(h-(l=d/s))/2,h=l):(x+=(d-(l=h*s))/2,d=l))),c.loaded&&(e.globalAlpha=null!=(o=t.opacity)?o:1,e.drawImage(c,x,y,d,h))}})},pick:Ps(),get:Ys,xOffset:Ks,yOffset:Js},Qs=Vs("line",function(e,t){var n=t[0];return fs.curve(Ro(n.interpolate||"linear",n.orient,n.tension)).context(e)(t)});function $s(e,t){var n=t.path;if(null==n)return!0;var r=t.pathCache;r&&r.path===n||((t.pathCache=r=Lo(n)).path=n),qo(e,r,t.x,t.y)}var eu={type:"path",tag:"path",nested:!1,attr:function(e,t){e("transform",Fs(t)),e("d",t.path)},bound:function(e,t){return $s(_s(e),t)?e.set(0,0,0,0):vs(e,t)},draw:Ds($s),pick:zs($s)};function tu(e,t){e.beginPath(),gs(e,t)}var nu={type:"rect",tag:"path",nested:!1,attr:function(e,t){e("d",gs(null,t))},bound:function(e,t){var x,y;return vs(e.set(x=t.x||0,y=t.y||0,x+t.width||0,y+t.height||0),t)},draw:Ds(tu),pick:zs(tu)};function ru(e,t,n){var r,o,s,u;return!(!t.stroke||!ks(e,t,n)||(r=t.x||0,o=t.y||0,s=null!=t.x2?t.x2:r,u=null!=t.y2?t.y2:o,e.beginPath(),e.moveTo(r,o),e.lineTo(s,u),0))}var iu,au,ou={type:"rule",tag:"line",nested:!1,attr:function(e,t){e("transform",Fs(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function(e,t){var n,r;return vs(e.set(n=t.x||0,r=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r),t)},draw:function(e,t,n){Ms(t,function(t){if(!n||n.intersects(t.bounds)){var r=null==t.opacity?1:t.opacity;r&&ru(e,t,r)&&e.stroke()}})},pick:Ps(function(e,t,x,y){return!!e.isPointInStroke&&ru(e,t,1)&&e.isPointInStroke(x,y)})},su=Us("shape",function(e,t){return(t.mark.shape||t.shape).context(e)(t)}),uu=Us("symbol",function(e,t){return hs.context(e)(t)}),lu={height:pu,measureWidth:du,estimateWidth:cu,width:cu,canvas:gu};function cu(e){return au=pu(e),fu(mu(e))}function fu(e){return~~(.8*e.length*au)}function du(e){return iu.font=vu(e),hu(mu(e))}function hu(e){return iu.measureText(e).width}function pu(e){return null!=e.fontSize?e.fontSize:11}function gu(e){iu=e&&(iu=pa(1,1))?iu.getContext("2d"):null,lu.width=iu?du:cu}function mu(e){var t=e.text;return null==t?"":e.limit>0?function(e){var t,n=+e.limit,r=e.text+"";if(iu?(iu.font=vu(e),t=hu):(au=pu(e),t=fu),t(r)<n)return r;var o,s=e.ellipsis||"\u2026",u="rtl"===e.dir,l=0,c=r.length;if(n-=t(s),u){for(;l<c;)t(r.slice(o=l+c>>>1))>n?l=o+1:c=o;return s+r.slice(l)}for(;l<c;)t(r.slice(0,o=1+(l+c>>>1)))<n?l=o:c=o-1;return r.slice(0,l)+s}(e):t+""}function vu(e,t){var n=e.font;return t&&n&&(n=String(n).replace(/"/g,"'")),(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+pu(e)+"px "+(n||"sans-serif")}function yu(e){var t=e.baseline,n=pu(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:0)}gu(!0);var bu={left:"start",center:"middle",right:"end"},xu=new sa;function _u(e,t,n){var r,o,s=lu.height(t),a=t.align,u=t.radius||0,x=t.x||0,y=t.y||0,l=t.dx||0,c=(t.dy||0)+yu(t)-Math.round(.8*s);return u&&(o=(t.theta||0)-Math.PI/2,x+=u*Math.cos(o),y+=u*Math.sin(o)),r=lu.width(t),"center"===a?l-=r/2:"right"===a&&(l-=r),e.set(l+=x,c+=y,l+r,c+s),t.angle&&!n&&e.rotate(t.angle*Math.PI/180,x,y),e.expand(n||!r?0:1)}var wu={arc:Bs,area:qs,group:Xs,image:Zs,line:Qs,path:eu,rect:nu,rule:ou,shape:su,symbol:uu,text:{type:"text",tag:"text",nested:!1,attr:function(e,t){var n,r=t.dx||0,o=(t.dy||0)+yu(t),x=t.x||0,y=t.y||0,a=t.angle||0,s=t.radius||0;s&&(n=(t.theta||0)-Math.PI/2,x+=s*Math.cos(n),y+=s*Math.sin(n)),e("text-anchor",bu[t.align]||"start"),a?(n=js(x,y)+" rotate("+a+")",(r||o)&&(n+=" "+js(r,o))):n=js(x+r,y+o),e("transform",n)},bound:_u,draw:function(e,t,n){Ms(t,function(t){var r,x,y,o,s,u;n&&!n.intersects(t.bounds)||(u=mu(t))&&0!==(r=null==t.opacity?1:t.opacity)&&(e.font=vu(t),e.textAlign=t.align||"left",x=t.x||0,y=t.y||0,(o=t.radius)&&(s=(t.theta||0)-Math.PI/2,x+=o*Math.cos(s),y+=o*Math.sin(s)),t.angle&&(e.save(),e.translate(x,y),e.rotate(t.angle*Math.PI/180),x=y=0),x+=t.dx||0,y+=(t.dy||0)+yu(t),t.fill&&Ss(e,t,r)&&e.fillText(u,x,y),t.stroke&&ks(e,t,r)&&e.strokeText(u,x,y),t.angle&&e.restore())})},pick:Ps(function(e,t,x,y,n,r){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var b=_u(xu,t,!0),a=-t.angle*Math.PI/180,o=Math.cos(a),s=Math.sin(a),u=t.x,l=t.y;return b.contains(o*n-s*r+(u-u*o+l*s),s*n+o*r+(l-u*s-l*o))})},trail:Vs("trail",function(e,t){return ps.context(e)(t)})},Eu=function(e,t,n){var r=wu[e.mark.marktype];return r.nested&&(e=e.mark),(t||r.bound)(e.bounds||(e.bounds=new sa),e,n)},Ou={mark:null},Su=function(e,t,n){var i,r,o,b,s=wu[e.marktype],u=s.bound,l=e.items,c=l&&l.length;if(s.nested)return c?o=l[0]:(Ou.mark=e,o=Ou),b=Eu(o,u,n),t&&t.union(b)||b;if(t=t||e.bounds&&e.bounds.clear()||new sa,c)for(i=0,r=l.length;i<r;++i)t.union(Eu(l[i],u,n));return e.bounds=t},Au=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","interpolate","tension","orient","defined","url","path","x2","y2","size","shape","text","angle","theta","radius","dx","dy","font","fontSize","fontWeight","fontStyle","fontVariant"];function ku(e,t){return JSON.stringify(e,Au,t)}function Tu(e){return function e(t){var n,i,r,o=t.marktype,s=t.items;if(s)for(i=0,r=s.length;i<r;++i)s[i][n=o?"mark":"group"]=t,s[i].zindex&&(s[i][n].zdirty=!0),"group"===(o||n)&&e(s[i]);return o&&Su(t),t}("string"==typeof e?JSON.parse(e):e)}function Nu(e){arguments.length?this.root=Tu(e):(this.root=Cu({marktype:"group",name:"root",role:"frame"}),this.root.items=[new ha(this.root)])}var Mu=Nu.prototype;function Cu(e,t){return{bounds:new sa,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0}}function Du(e,t,n){return!e&&"undefined"!=typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function Ru(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function Iu(e,t,n,r){var b,a=e.childNodes[t];return a&&a.tagName.toLowerCase()===n.toLowerCase()||(b=a||null,a=Du(e.ownerDocument,n,r),e.insertBefore(a,b)),a}function Pu(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function Lu(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function zu(e){this._active=null,this._handlers={},this._loader=e||Ee()}Mu.toJSON=function(e){return ku(this.root,e||0)},Mu.mark=function(e,t,n){var r=Cu(e,t=t||this.root.items[0]);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r};var ju=zu.prototype;function Fu(e){this._el=null,this._bgcolor=null,this._loader=new ma(e)}ju.initialize=function(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},ju.element=function(){return this._el},ju.origin=function(e){return this._origin=e||[0,0],this},ju.scene=function(e){return arguments.length?(this._scene=e,this):this._scene},ju.on=function(){},ju.off=function(){},ju._handlerIndex=function(e,t,n){for(var i=e?e.length:0;--i>=0;)if(e[i].type===t&&!n||e[i].handler===n)return i;return-1},ju.handlers=function(){var k,e=this._handlers,a=[];for(k in e)a.push.apply(a,e[k]);return a},ju.eventName=function(e){var i=e.indexOf(".");return i<0?e:e.slice(0,i)},ju.handleHref=function(e,t,n){this._loader.sanitize(n,{context:"href"}).then(function(t){var n=new MouseEvent(e.type,e),a=Du(null,"a");for(var r in t)a.setAttribute(r,t[r]);a.dispatchEvent(n)}).catch(function(){})},ju.handleTooltip=function(e,t,n){this._el.setAttribute("title",n||"")};var Uu=Fu.prototype;Uu.initialize=function(e,t,n,r,o){return this._el=e,this.resize(t,n,r,o)},Uu.element=function(){return this._el},Uu.scene=function(){return this._el&&this._el.firstChild},Uu.background=function(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},Uu.resize=function(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},Uu.dirty=function(){},Uu.render=function(e){var t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},Uu._render=function(){},Uu.renderAsync=function(e){var t=this.render(e);return this._ready?this._ready.then(function(){return t}):Promise.resolve(t)},Uu._load=function(e,t){var n=this,r=n._loader[e](t);if(!n._ready){var o=n._call;n._ready=n._loader.ready().then(function(e){e&&o(),n._ready=null})}return r},Uu.sanitizeURL=function(e){return this._load("sanitizeURL",e)},Uu.loadImage=function(e){return this._load("loadImage",e)};var Bu=function(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]};function Vu(e){zu.call(this,e),this._down=null,this._touch=null,this._first=!0}var qu=Object(v.inherits)(Vu,zu);function Gu(e,t,n){return function(r){var a=this._active,o=this.pickEvent(r);o===a?this.fire(e,r):(a&&a.exit||this.fire(n,r),this._active=o,this.fire(t,r),this.fire(e,r))}}function Wu(e){return function(t){this.fire(e,t),this._active=null}}qu.initialize=function(e,t,n){var r=this._canvas=e&&Ru(e,"canvas");if(r){var o=this;this.events.forEach(function(e){r.addEventListener(e,function(t){qu[e]?qu[e].call(o,t):o.fire(e,t)})})}return zu.prototype.initialize.call(this,e,t,n)},qu.canvas=function(){return this._canvas},qu.context=function(){return this._canvas.getContext("2d")},qu.events=["keydown","keypress","keyup","dragenter","dragleave","dragover","mousedown","mouseup","mousemove","mouseout","mouseover","click","dblclick","wheel","mousewheel","touchstart","touchmove","touchend"],qu.DOMMouseScroll=function(e){this.fire("mousewheel",e)},qu.mousemove=Gu("mousemove","mouseover","mouseout"),qu.dragover=Gu("dragover","dragenter","dragleave"),qu.mouseout=Wu("mouseout"),qu.dragleave=Wu("dragleave"),qu.mousedown=function(e){this._down=this._active,this.fire("mousedown",e)},qu.click=function(e){this._down===this._active&&(this.fire("click",e),this._down=null)},qu.touchstart=function(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire("touchstart",e,!0)},qu.touchmove=function(e){this.fire("touchmove",e,!0)},qu.touchend=function(e){this.fire("touchend",e,!0),this._touch=null},qu.fire=function(e,t,n){var i,r,a=n?this._touch:this._active,o=this._handlers[e];if("click"===e&&a&&a.href?this.handleHref(t,a,a.href):("mouseover"===e||"mouseout"===e)&&a&&a.tooltip&&this.handleTooltip(t,a,"mouseover"===e?a.tooltip:null),o)for(t.vegaType=e,i=0,r=o.length;i<r;++i)o[i].handler.call(this._obj,t,a)},qu.on=function(e,t){var n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(r[n]||(r[n]=[])).push({type:e,handler:t}),this},qu.off=function(e,t){var n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},qu.pickEvent=function(e){var t=Bu(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},qu.pick=function(e,x,y,t,n){var r=this.context();return wu[e.marktype].pick.call(this,r,e,x,y,t,n)};var Hu="undefined"!=typeof window&&window.devicePixelRatio||1;function Xu(e){Fu.call(this,e),this._redraw=!1,this._dirty=new sa}var Yu=Object(v.inherits)(Xu,Fu),Ku=Fu.prototype,Ju=new sa;function Zu(e){zu.call(this,e);var t=this;t._hrefHandler=$u(t,function(e,n){n&&n.href&&t.handleHref(e,n,n.href)}),t._tooltipHandler=$u(t,function(e,n){n&&n.tooltip&&t.handleTooltip(e,n,"mouseover"===e.type?n.tooltip:null)})}Yu.initialize=function(e,t,n,r,o){return this._canvas=pa(1,1),e&&(Pu(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),Ku.initialize.call(this,e,t,n,r,o)},Yu.resize=function(e,t,n,r){return Ku.resize.call(this,e,t,n,r),function(e,t,n,r,o){var s="undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,u=e.getContext("2d"),l=s?Hu:o;e.width=t*l,e.height=n*l,s&&1!==l&&(e.style.width=t+"px",e.style.height=n+"px"),u.pixelRatio=l,u.setTransform(l,0,0,l,l*r[0],l*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale),this._redraw=!0,this},Yu.canvas=function(){return this._canvas},Yu.context=function(){return this._canvas?this._canvas.getContext("2d"):null},Yu.dirty=function(e){var b=function(e,t){if(null==t)return e;for(var b=Ju.clear().union(e);null!=t;t=t.mark.group)b.translate(t.x||0,t.y||0);return b}(e.bounds,e.mark.group);this._dirty.union(b)},Yu._render=function(e){var t=this.context(),n=this._origin,r=this._width,o=this._height,b=this._dirty;return t.save(),this._redraw||b.empty()?(this._redraw=!1,b=null):b=function(e,b,t){return b.expand(1).round(),b.translate(-t[0]%1,-t[1]%1),e.beginPath(),e.rect(b.x1,b.y1,b.width(),b.height()),e.clip(),b}(t,b,n),this.clear(-n[0],-n[1],r,o),this.draw(t,e,b),t.restore(),this._dirty.clear(),this},Yu.draw=function(e,t,n){var r=wu[t.marktype];t.clip&&function(e,t){var n=t.clip;if(e.save(),e.beginPath(),Object(v.isFunction)(n))n(e);else{var r=t.group;e.rect(0,0,r.width||0,r.height||0)}e.clip()}(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},Yu.clear=function(x,y,e,t){var n=this.context();n.clearRect(x,y,e,t),null!=this._bgcolor&&(n.fillStyle=this._bgcolor,n.fillRect(x,y,e,t))};var Qu=Object(v.inherits)(Zu,zu);function $u(e,t){return function(n){var r=n.target.__data__;n.vegaType=n.type,r=Array.isArray(r)?r[0]:r,t.call(e._obj,n,r)}}function el(e,t,n){var r,o,s="<"+e;if(t)for(r in t)null!=(o=t[r])&&(s+=" "+r+'="'+o+'"');return n&&(s+=" "+n),s+">"}function tl(e){return"</"+e+">"}Qu.initialize=function(e,t,n){var r=this._svg;return r&&(r.removeEventListener("click",this._hrefHandler),r.removeEventListener("mouseover",this._tooltipHandler),r.removeEventListener("mouseout",this._tooltipHandler)),this._svg=r=e&&Ru(e,"svg"),r&&(r.addEventListener("click",this._hrefHandler),r.addEventListener("mouseover",this._tooltipHandler),r.addEventListener("mouseout",this._tooltipHandler)),zu.prototype.initialize.call(this,e,t,n)},Qu.svg=function(){return this._svg},Qu.on=function(e,t){var n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){var x={type:e,handler:t,listener:$u(this,t)};(r[n]||(r[n]=[])).push(x),this._svg&&this._svg.addEventListener(n,x.listener)}return this},Qu.off=function(e,t){var n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this};var nl={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},rl={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},il=Object.keys(rl),al=nl.xmlns;function ol(e){Fu.call(this,e),this._dirtyID=1,this._dirty=[],this._svg=null,this._root=null,this._defs=null}var sl=Object(v.inherits)(ol,Fu),ul=Fu.prototype;function ll(e,t,n){var i,r,o;for((e=Iu(e,n,"linearGradient",al)).setAttribute("id",t.id),e.setAttribute("x1",t.x1),e.setAttribute("x2",t.x2),e.setAttribute("y1",t.y1),e.setAttribute("y2",t.y2),i=0,r=t.stops.length;i<r;++i)(o=Iu(e,i,"stop",al)).setAttribute("offset",t.stops[i].offset),o.setAttribute("stop-color",t.stops[i].color);Pu(e,i)}function cl(e,t,n){var r;(e=Iu(e,n,"clipPath",al)).setAttribute("id",t.id),t.path?(r=Iu(e,0,"path",al)).setAttribute("d",t.path):((r=Iu(e,0,"rect",al)).setAttribute("x",0),r.setAttribute("y",0),r.setAttribute("width",t.width),r.setAttribute("height",t.height))}function fl(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function dl(e,t,n,r){var o,s=e._svg;if(!s&&(s=Du(o=t.ownerDocument,r,al),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},"g"===r))){var u=Du(o,"path",al);u.setAttribute("class","background"),s.appendChild(u),u.__data__=e;var l=Du(o,"g",al);s.appendChild(l),l.__data__=e}return!o&&s.previousSibling===n&&n||t.insertBefore(s,n?n.nextSibling:t.firstChild),s}sl.initialize=function(e,t,n,r){return e&&(this._svg=Iu(e,0,"svg",al),this._svg.setAttribute("class","marks"),Pu(e,1),this._root=Iu(this._svg,0,"g",al),Pu(this._svg,1)),this._defs={gradient:{},clipping:{}},this.background(this._bgcolor),ul.initialize.call(this,e,t,n,r)},sl.background=function(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),ul.background.apply(this,arguments)},sl.resize=function(e,t,n,r){return ul.resize.call(this,e,t,n,r),this._svg&&(this._svg.setAttribute("width",this._width*this._scale),this._svg.setAttribute("height",this._height*this._scale),this._svg.setAttribute("viewBox","0 0 "+this._width+" "+this._height),this._root.setAttribute("transform","translate("+this._origin+")")),this._dirty=[],this},sl.svg=function(){if(!this._svg)return null;var e={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var t in nl)e[t]=nl[t];var n=this._bgcolor?el("rect",{width:this._width,height:this._height,style:"fill: "+this._bgcolor+";"})+tl("rect"):"";return el("svg",e)+n+this._svg.innerHTML+tl("svg")},sl._render=function(e){return this._dirtyCheck()&&(this._dirtyAll&&this._resetDefs(),this.draw(this._root,e),Pu(this._root,1)),this.updateDefs(),this._dirty=[],++this._dirtyID,this},sl.updateDefs=function(){var e,t=this._svg,n=this._defs,r=n.el,o=0;for(e in n.gradient)r||(n.el=r=Iu(t,0,"defs",al)),ll(r,n.gradient[e],o++);for(e in n.clipping)r||(n.el=r=Iu(t,0,"defs",al)),cl(r,n.clipping[e],o++);r&&(0===o?(t.removeChild(r),n.el=null):Pu(r,o))},sl._resetDefs=function(){var e=this._defs;e.gradient={},e.clipping={}},sl.dirty=function(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},sl.isDirty=function(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},sl._dirtyCheck=function(){this._dirtyAll=!0;var e=this._dirty;if(!e.length)return!0;var t,n,r,o,i,s,u,l=++this._dirtyID;for(i=0,s=e.length;i<s;++i)(n=(t=e[i]).mark).marktype!==r&&(o=wu[r=n.marktype]),n.zdirty&&n.dirty!==l&&(this._dirtyAll=!1,n.dirty=l,fl(n.group,l)),t.exit?(o.nested&&n.items.length?(u=n.items[0])._svg&&this._update(o,u._svg,u):t._svg&&(u=t._svg.parentNode)&&u.removeChild(t._svg),t._svg=null):(t=o.nested?n.items[0]:t)._update!==l&&(t._svg&&t._svg.ownerSVGElement?this._update(o,t._svg,t):(this._dirtyAll=!1,fl(t,l)),t._update=l);return!this._dirtyAll},sl.draw=function(e,t,n){if(!this.isDirty(t))return t._svg;var r,o=this,s=wu[t.marktype],u=!1===t.interactive?"none":null,l="g"===s.tag,c=null,i=0;function d(e){var t=o.isDirty(e),n=dl(e,r,c,s.tag);t&&(o._update(s,n,e),l&&function(t,n,r){n=n.lastChild;var o,s=0;Ms(e,function(e){o=t.draw(n,e,o),++s}),Pu(n,1+s)}(o,n)),c=n,++i}return(r=dl(t,e,n,"g")).setAttribute("class",Lu(t)),l||r.style.setProperty("pointer-events",u),t.clip?r.setAttribute("clip-path",Hs(o,t,t.group)):r.removeAttribute("clip-path"),s.nested?t.items.length&&d(t.items[0]):Ms(t,d),Pu(r,i),r};var hl=null,pl=null,gl={group:function(e,t,n){pl=t.__values__,hl=t.childNodes[1],e.foreground(ml,n,this),hl=t.childNodes[0],e.background(ml,n,this);var value=!1===n.mark.interactive?"none":null;value!==pl.events&&(hl.style.setProperty("pointer-events",value),pl.events=value)},text:function(e,t,n){var r=mu(n);r!==pl.text&&(t.textContent=r,pl.text=r),(r=vu(n))!==pl.font&&(t.style.setProperty("font",r),pl.font=r)}};function ml(e,value,t){value!==pl[e]&&(null!=value?t?hl.setAttributeNS(t,e,value):hl.setAttribute(e,value):t?hl.removeAttributeNS(t,e):hl.removeAttribute(e),pl[e]=value)}function vl(e){Fu.call(this,e),this._text={head:"",bg:"",root:"",foot:"",defs:"",body:""},this._defs={gradient:{},clipping:{}}}sl._update=function(e,t,n){hl=t,pl=t.__values__,e.attr(ml,n,this);var r=gl[e.type];r&&r.call(this,e,t,n),this.style(hl,n)},sl.style=function(e,t){var i,n,r,o,value,s;if(null!=t)for(i=0,n=il.length;i<n;++i)(value=t[r=il[i]])!==pl[r]&&(o=rl[r],null==value?"fill"===o?e.style.setProperty(o,"none"):e.style.removeProperty(o):(value.id&&(this._defs.gradient[value.id]=value,value="url("+(s=void 0,"undefined"==typeof window?"":(s=window.location).hash?s.href.slice(0,-s.hash.length):s.href)+"#"+value.id+")"),e.style.setProperty(o,value+"")),pl[r]=value)};var yl,bl=Object(v.inherits)(vl,Fu),xl=Fu.prototype;function _l(e,value,t,n){yl[n||e]=value}function wl(e,t,n,r){if(null==e)return"";var i,o,s,u,value,l="";for("bgrect"===n&&!1===t.interactive&&(l+="pointer-events: none; "),"text"===n&&(l+="font: "+vu(e)+"; "),i=0,o=il.length;i<o;++i)u=rl[s=il[i]],null==(value=e[s])?"fill"===u&&(l+="fill: none; "):"transparent"!==value||"fill"!==u&&"stroke"!==u?(value.id&&(r.gradient[value.id]=value,value="url(#"+value.id+")"),l+=u+": "+value+"; "):l+=u+": none; ";return l?'style="'+l.trim()+'"':null}bl.resize=function(e,t,n,r){xl.resize.call(this,e,t,n,r);var o=this._origin,s=this._text,u={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var l in nl)u[l]=nl[l];s.head=el("svg",u);var c=this._bgcolor;return"transparent"!==c&&"none"!==c||(c=null),s.bg=c?el("rect",{width:this._width,height:this._height,style:"fill: "+c+";"})+tl("rect"):"",s.root=el("g",{transform:"translate("+o+")"}),s.foot=tl("g")+tl("svg"),this},bl.background=function(){var e=xl.background.apply(this,arguments);return arguments.length&&this._text.head&&this.resize(this._width,this._height,this._origin,this._scale),e},bl.svg=function(){var e=this._text;return e.head+e.bg+e.defs+e.root+e.body+e.foot},bl._render=function(e){return this._text.body=this.mark(e),this._text.defs=this.buildDefs(),this},bl.buildDefs=function(){var i,e,t,n,r=this._defs,o="";for(e in r.gradient){for(n=(t=r.gradient[e]).stops,o+=el("linearGradient",{id:e,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2}),i=0;i<n.length;++i)o+=el("stop",{offset:n[i].offset,"stop-color":n[i].color})+tl("stop");o+=tl("linearGradient")}for(e in r.clipping)t=r.clipping[e],o+=el("clipPath",{id:e}),o+=t.path?el("path",{d:t.path})+tl("path"):el("rect",{x:0,y:0,width:t.width,height:t.height})+tl("rect"),o+=tl("clipPath");return o.length>0?el("defs")+o+tl("defs"):""},bl.attributes=function(e,t){return yl={},e(_l,t,this),yl},bl.href=function(e){var t,n=this,r=e.href;if(r){if(t=n._hrefs&&n._hrefs[r])return t;n.sanitizeURL(r).then(function(e){e["xlink:href"]=e.href,e.href=null,(n._hrefs||(n._hrefs={}))[r]=e})}return null},bl.mark=function(e){var t,n=this,r=wu[e.marktype],o=r.tag,s=this._defs,u="";function l(l){var c=n.href(l);c&&(u+=el("a",c)),t="g"!==o?wl(l,e,o,s):null,u+=el(o,n.attributes(r.attr,l),t),"text"===o?u+=mu(l).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):"g"===o&&(u+=el("path",n.attributes(r.background,l),wl(l,e,"bgrect",s))+tl("path"),u+=el("g",n.attributes(r.foreground,l))+n.markGroup(l)+tl("g")),u+=tl(o),c&&(u+=tl("a"))}return"g"!==o&&!1===e.interactive&&(t='style="pointer-events: none;"'),u+=el("g",{class:Lu(e),"clip-path":e.clip?Hs(n,e,e.group):null},t),r.nested?e.items&&e.items.length&&l(e.items[0]):Ms(e,l),u+tl("g")},bl.markGroup=function(e){var t=this,n="";return Ms(e,function(e){n+=t.mark(e)}),n};var El={Canvas:"canvas",PNG:"png",SVG:"svg",None:"none"},Ol={};function Sl(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Ol[e]=t,this):Ol[e]}Ol.canvas=Ol.png={renderer:Xu,headless:Xu,handler:Vu},Ol.svg={renderer:ol,headless:vl,handler:Zu},Ol.none={};var Al=new sa,kl=function(e){var t=e.clip;if(Object(v.isFunction)(t))t(_s(Al.clear()));else{if(!t)return;Al.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(Al)},Tl=1e-9;function Nl(a,b,e){return a===b||("path"===e?Ml(a,b):a instanceof Date&&b instanceof Date?+a==+b:Object(v.isNumber)(a)&&Object(v.isNumber)(b)?Math.abs(a-b)<=Tl:a&&b&&(Object(v.isObject)(a)||Object(v.isObject)(b))?null!=a&&null!=b&&function(a,b){var e,i,t=Object.keys(a),n=Object.keys(b);if(t.length!==n.length)return!1;for(t.sort(),n.sort(),i=t.length-1;i>=0;i--)if(t[i]!=n[i])return!1;for(i=t.length-1;i>=0;i--)if(!Nl(a[e=t[i]],b[e],e))return!1;return typeof a==typeof b}(a,b):a==b)}function Ml(a,b){return Nl(Lo(a),Lo(b))}function Cl(e){ur.call(this,null,e)}function Dl(e,t,n){return t(e.bounds.clear(),e,n)}function Rl(e){ur.call(this,0,e)}function Il(e){ur.call(this,null,e)}Object(v.inherits)(Cl,ur).transform=function(e,t){var n,r=t.dataflow,o=e.mark,s=o.marktype,u=wu[s],l=u.bound,c=o.bounds;return u.nested?(o.items.length&&r.dirty(o.items[0]),c=Dl(o,l),o.items.forEach(function(e){e.bounds.clear().union(c)})):"group"===s||e.modified()?(t.visit(t.MOD,function(e){r.dirty(e)}),c.clear(),o.items.forEach(function(e){c.union(Dl(e,l))})):(n=t.changed(t.REM),t.visit(t.ADD,function(e){c.union(Dl(e,l))}),t.visit(t.MOD,function(e){n=n||c.alignsWith(e.bounds),r.dirty(e),c.union(Dl(e,l))}),n&&(c.clear(),o.items.forEach(function(e){c.union(e.bounds)}))),kl(o),t.modifies("bounds")},Rl.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},Object(v.inherits)(Rl,ur).transform=function(e,t){var n=function(e){var t=e._signals[":vega_identifier:"];return t||(e._signals[":vega_identifier:"]=t=e.add(0)),t}(t.dataflow),r=n.value,o=e.as;return t.visit(t.ADD,function(e){e[o]||(e[o]=++r)}),n.set(this.value=r),t},Object(v.inherits)(Il,ur).transform=function(e,t){var n=this.value;n||((n=t.dataflow.scenegraph().mark(e.markdef,function(e){var t=e.groups,n=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}(e),e.index)).group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this,n.clip=e.clip,n.interactive=e.interactive,this.value=n);var r="group"===n.marktype?ha:da;return t.visit(t.ADD,function(e){r.call(e,n)}),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t};var Pl="top",Ll="left",zl="right",jl="bottom";function Fl(e){ur.call(this,null,e)}var Ul={parity:function(e){return e.filter(function(e,i){return i%2?e.opacity=0:1})},greedy:function(e){var a;return e.filter(function(b,i){return i&&Bl(a.bounds,b.bounds)?b.opacity=0:(a=b,1)})}};function Bl(a,b){return!(a.x2-1<b.x1||a.x1+1>b.x2||a.y2-1<b.y1||a.y1+1>b.y2)}function Vl(e){for(var b,i=1,t=e.length,a=e[0].bounds;i<t;a=b,++i)if(Bl(a,b=e[i].bounds))return!0}function ql(e){var b=e.bounds;return b.width()>1&&b.height()>1}function Gl(e){ur.call(this,null,e)}Object(v.inherits)(Fl,ur).transform=function(e,t){var n=Ul[e.method]||Ul.parity,r=t.materialize(t.SOURCE).source;if(r){e.sort&&(r=r.slice().sort(e.sort)),"greedy"===e.method&&(r=r.filter(ql)),r.forEach(function(e){e.opacity=1});var o,s,u,b,l=r;if(l.length>=3&&Vl(l)){t=t.reflow(e.modified()).modifies("opacity");do{l=n(l)}while(l.length>=3&&Vl(l));l.length<3&&!Object(v.peek)(r).opacity&&(l.length>1&&(Object(v.peek)(l).opacity=0),Object(v.peek)(r).opacity=1)}if(e.boundScale){var c=(o=e.boundOrient,s=e.boundTolerance,u=e.boundScale.range(),b=new sa,o===Pl||o===jl?b.set(u[0],-1/0,u[1],1/0):b.set(-1/0,u[0],1/0,u[1]),b.expand(s||1),function(e){return b.encloses(e.bounds)});r.forEach(function(e){c(e)||(e.opacity=0)})}return t}},Object(v.inherits)(Gl,ur).transform=function(e,t){var n=t.dataflow;if(t.visit(t.ALL,function(e){n.dirty(e)}),t.fields&&t.fields.zindex){var r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}};function Wl(e,t){for(var i=0,n=e.length;i<n;++i)t.push(e[i])}function Hl(e){return{x1:0,y1:0,x2:e.width||0,y2:e.height||0}}function Xl(e){var b=e.bounds.clone();return b.empty()?b.set(0,0,0,0):b.translate(-(e.x||0),-(e.y||0))}function Yl(e,t){return"x1"===t?e.x||0:"y1"===t?e.y||0:"x2"===t?(e.x||0)+(e.width||0):"y2"===t?(e.y||0)+(e.height||0):void 0}function Kl(e,t){return e.bounds[t]}function Jl(e,t,n){var r=Object(v.isObject)(e)?e[t]:e;return null!=r?r:void 0!==n?n:0}function Zl(e){return e<0?Math.ceil(-e):0}function Ql(e,t,n,r,o,s,u,l,c,d,h,p,g,m){var i,j,k,v,b,_,w,x,y,E=n.length,O=0,S=0;if(!E)return O;for(i=h;i<E;i+=p)n[i]&&(O=u(O,c(n[i],d)));if(!t.length)return O;for(t.length>o&&(e.warn("Grid headers exceed limit: "+o),t=t.slice(0,o)),O+=s,j=0,v=t.length;j<v;++j)e.dirty(t[j]),t[j].mark.bounds.clear();for(i=h,j=0,v=t.length;j<v;++j,i+=p){for(b=(_=t[j]).mark.bounds,k=i;k>=0&&null==(w=n[k]);k-=g);l?(x=null==m?w.x:Math.round(w.bounds.x1+m*w.bounds.width()),y=O):(x=O,y=null==m?w.y:Math.round(w.bounds.y1+m*w.bounds.height())),b.union(_.bounds.translate(x-(_.x||0),y-(_.y||0))),_.x=x,_.y=y,e.dirty(_),S=u(S,b[d])}return S}function $l(e,t,n,r,o,s){if(t){e.dirty(t);var x=n,y=n;r?x=Math.round(o.x1+s*o.width()):y=Math.round(o.y1+s*o.height()),t.bounds.translate(x-(t.x||0),y-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=x,t.y=y,e.dirty(t)}}var ec=.5,tc=new sa;function nc(e){ur.call(this,null,e)}function rc(e,t,value){return e[t]===value?0:(e[t]=value,1)}function ic(e){var t=e.items[0].datum.orient;return t===Ll||t===zl}function ac(e,t,n,r){var i,o,s=t.items[0],u=s.datum,l=u.orient,c=function(e){var t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}(u),d=s.range,h=s.offset,p=s.position,g=s.minExtent,m=s.maxExtent,v=u.title&&s.items[c[2]].items[0],_=s.titlePadding,w=s.bounds,x=0,y=0;switch(tc.clear().union(w),w.clear(),(i=c[0])>-1&&w.union(s.items[i].bounds),(i=c[1])>-1&&w.union(s.items[i].bounds),l){case Pl:x=p||0,y=-h,o=Math.max(g,Math.min(m,-w.y1)),v&&(v.auto?(v.y=-(o+=_),o+=v.bounds.height(),w.add(v.bounds.x1,0).add(v.bounds.x2,0)):w.union(v.bounds)),w.add(0,-o).add(d,0);break;case Ll:x=-h,y=p||0,o=Math.max(g,Math.min(m,-w.x1)),v&&(v.auto?(v.x=-(o+=_),o+=v.bounds.width(),w.add(0,v.bounds.y1).add(0,v.bounds.y2)):w.union(v.bounds)),w.add(-o,0).add(0,d);break;case zl:x=n+h,y=p||0,o=Math.max(g,Math.min(m,w.x2)),v&&(v.auto?(v.x=o+=_,o+=v.bounds.width(),w.add(0,v.bounds.y1).add(0,v.bounds.y2)):w.union(v.bounds)),w.add(0,0).add(o,d);break;case jl:x=p||0,y=r+h,o=Math.max(g,Math.min(m,w.y2)),v&&(v.auto?(v.y=o+=_,o+=v.bounds.height(),w.add(v.bounds.x1,0).add(v.bounds.x2,0)):w.union(v.bounds)),w.add(0,0).add(d,o);break;default:x=s.x,y=s.y}return vs(w.translate(x,y),s),rc(s,"x",x+ec)|rc(s,"y",y+ec)&&(s.bounds=tc,e.dirty(s),s.bounds=w,e.dirty(s)),s.mark.bounds.clear().union(w)}function oc(e,t,n,r,o,s,u){var l,c,d,h=t.items[0],p=h.datum.orient,g=h.offset,m=h.bounds,x=0,y=0;switch(p===Pl||p===jl?(d=o,x=n[p]):p!==Ll&&p!==zl||(d=r,y=n[p]),tc.clear().union(m),m.clear(),h.items.forEach(function(e){m.union(e.bounds)}),l=Math.round(m.width())+2*h.padding-1,c=Math.round(m.height())+2*h.padding-1,p){case Ll:x-=l+g-Math.floor(d.x1),n.left+=c+n.margin;break;case zl:x+=g+Math.ceil(d.x2),n.right+=c+n.margin;break;case Pl:y-=c+g-Math.floor(d.y1),n.top+=l+n.margin;break;case jl:y+=g+Math.ceil(d.y2),n.bottom+=l+n.margin;break;case"top-left":x+=g,y+=g;break;case"top-right":x+=s-l-g,y+=g;break;case"bottom-left":x+=g,y+=u-c-g;break;case"bottom-right":x+=s-l-g,y+=u-c-g;break;default:x=h.x,y=h.y}return vs(m.set(x,y,x+l,y+c),h),rc(h,"x",x)|rc(h,"width",l)|rc(h,"y",y)|rc(h,"height",c)&&(h.bounds=tc,e.dirty(h),h.bounds=m,e.dirty(h)),h.mark.bounds.clear().union(m)}Object(v.inherits)(nc,ur).transform=function(e,t){var n=t.dataflow;return e.mark.items.forEach(function(t){e.layout&&function(e,t,n){var r,i,o,s,b,u,l,c,x,y,d,h,p,g=function(e){for(var t,n,r=e.items,o=r.length,i=0,s={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};i<o;++i)if(n=(t=r[i]).items,"group"===t.marktype)switch(t.role){case"axis":case"legend":break;case"row-header":Wl(n,s.rowheaders);break;case"row-footer":Wl(n,s.rowfooters);break;case"column-header":Wl(n,s.colheaders);break;case"column-footer":Wl(n,s.colfooters);break;case"row-title":s.rowtitle=n[0];break;case"column-title":s.coltitle=n[0];break;default:Wl(n,s.marks)}return s}(t),m=g.marks,v="flush"===n.bounds,_=v?Hl:Xl,w=new sa(0,0,0,0),E=Jl(n.align,"column"),O=Jl(n.align,"row"),S=Jl(n.padding,"column"),A=Jl(n.padding,"row"),T=n.offset,N=t.columns||n.columns||m.length,M=N<0?1:Math.ceil(m.length/N),C=M*N,D=[],R=[],I=[],P=[],L=m.length;for(i=0;i<N;++i)R[i]=0;for(i=0;i<M;++i)P[i]=0;for(i=0;i<L;++i)b=_(m[i]),s=~~(i/N),l=(o=i%N)?Math.ceil(_(m[i-1]).x2):0,c=s?Math.ceil(_(m[i-N]).y2):0,R[o]=Math.max(R[o],l),P[s]=Math.max(P[s],c),D.push(S+Zl(b.x1)),I.push(A+Zl(b.y1)),e.dirty(m[i]);for(i=0;i<L;++i)i%N==0&&(D[i]=0),i<N&&(I[i]=0);if("each"===E)for(o=1;o<N;++o){for(p=0,i=o;i<L;i+=N)p<D[i]&&(p=D[i]);for(i=o;i<L;i+=N)D[i]=p+R[o]}else if("all"===E){for(h=0,o=1;o<N;++o)h<R[o]&&(h=R[o]);for(p=0,i=0;i<L;++i)i%N&&p<D[i]&&(p=D[i]);for(i=0;i<L;++i)i%N&&(D[i]=p+h)}else for(o=1;o<N;++o)for(i=o;i<L;i+=N)D[i]+=R[o];if("each"===O)for(s=1;s<M;++s){for(p=0,r=(i=s*N)+N;i<r;++i)p<I[i]&&(p=I[i]);for(i=s*N;i<r;++i)I[i]=p+P[s]}else if("all"===O){for(h=0,s=1;s<M;++s)h<P[s]&&(h=P[s]);for(p=0,i=N;i<L;++i)p<I[i]&&(p=I[i]);for(i=N;i<L;++i)I[i]=p+h}else for(s=1;s<M;++s)for(r=(i=s*N)+N;i<r;++i)I[i]+=P[s];for(x=0,i=0;i<L;++i)l=(u=m[i]).x||0,u.x=x=D[i]+(i%N?x:0),u.bounds.translate(x-l,0);for(o=0;o<N;++o)for(y=0,i=o;i<L;i+=N)c=(u=m[i]).y||0,u.y=y+=I[i],u.bounds.translate(0,y-c);for(i=0;i<L;++i)m[i].mark.bounds.clear();for(i=0;i<L;++i)e.dirty(u=m[i]),w.union(u.mark.bounds.union(u.bounds));function z(a,b){return Math.floor(Math.min(a,b))}function F(a,b){return Math.ceil(Math.max(a,b))}_=v?Yl:Kl,d=Jl(n.headerBand,"row",null),x=Ql(e,g.rowheaders,m,0,M,-Jl(T,"rowHeader"),z,0,_,"x1",0,N,1,d),d=Jl(n.headerBand,"column",null),y=Ql(e,g.colheaders,m,0,N,-Jl(T,"columnHeader"),z,1,_,"y1",0,1,N,d),d=Jl(n.footerBand,"row",null),Ql(e,g.rowfooters,m,0,M,Jl(T,"rowFooter"),F,0,_,"x2",N-1,N,1,d),d=Jl(n.footerBand,"column",null),Ql(e,g.colfooters,m,0,N,Jl(T,"columnFooter"),F,1,_,"y2",C-N,1,N,d),g.rowtitle&&(p=x-Jl(T,"rowTitle"),d=Jl(n.titleBand,"row",.5),$l(e,g.rowtitle,p,0,w,d)),g.coltitle&&(p=y-Jl(T,"columnTitle"),d=Jl(n.titleBand,"column",.5),$l(e,g.coltitle,p,1,w,d))}(n,t,e.layout),function(e,t,n){var r,o,s,b,i,u,l=t.items,c=Math.max(0,t.width||0),d=Math.max(0,t.height||0),h=(new sa).set(0,0,c,d),p=h.clone(),g=h.clone(),m=h.clone(),v=[];for(i=0,u=l.length;i<u;++i)switch((o=l[i]).role){case"axis":p.union(b=ac(e,o,c,d)),(ic(o)?g:m).union(b);break;case"title":r=o;break;case"legend":v.push(o);break;case"frame":case"scope":case"row-header":case"row-footer":case"column-header":case"column-footer":g.union(o.bounds),m.union(o.bounds);break;default:h.union(o.bounds)}if(r&&(p.union(b=function(e,t,n){var r=t.items[0],o=r.datum.orient,s=r.offset,u=r.bounds,x=0,y=0;switch(tc.clear().union(u),o){case Pl:x=r.x,y=n.y1-s;break;case Ll:x=n.x1-s,y=r.y;break;case zl:x=n.x2+s,y=r.y;break;case jl:x=r.x,y=n.y2+s;break;default:x=r.x,y=r.y}return u.translate(x-r.x,y-r.y),rc(r,"x",x)|rc(r,"y",y)&&(r.bounds=tc,e.dirty(r),r.bounds=u,e.dirty(r)),t.bounds.clear().union(u)}(e,r,p)),(ic(r)?g:m).union(b)),v.length)for(s={left:0,right:0,top:0,bottom:0,margin:n.legendMargin||8},i=0,u=v.length;i<u;++i)if(b=oc(e,v[i],s,g,m,c,d),n.autosize&&"fit"===n.autosize.type){var _=v[i].items[0].datum.orient;_===Ll||_===zl?h.add(b.x1,0).add(b.x2,0):_!==Pl&&_!==jl||h.add(0,b.y1).add(0,b.y2)}else h.union(b);h.union(g).union(m).union(p),function(e,t,n,r){var o=r.autosize||{},s=o.type,u=e._width,l=e._height,c=e.padding();if(!(e._autosize<1)&&s){var d=Math.max(0,t.width||0),h=Math.max(0,Math.ceil(-n.x1)),p=Math.max(0,Math.ceil(n.x2-d)),g=Math.max(0,t.height||0),m=Math.max(0,Math.ceil(-n.y1)),v=Math.max(0,Math.ceil(n.y2-g));"padding"===o.contains&&(u-=c.left+c.right,l-=c.top+c.bottom),"none"===s?(h=0,m=0,d=u,g=l):"fit"===s?(d=Math.max(0,u-h-p),g=Math.max(0,l-m-v)):"fit-x"===s?(d=Math.max(0,u-h-p),l=g+m+v):"fit-y"===s?(u=d+h+p,g=Math.max(0,l-m-v)):"pad"===s&&(u=d+h+p,l=g+m+v),e._resizeView(u,l,d,g,[h,m],o.resize)}}(e,t,h,n)}(n,t,e)}),t};var sc="log",uc=function(e){return function(t){var n,r=t[0],o=t[1];return o<r&&(n=r,r=o,o=n),[e.invert(r),e.invert(o)]}},lc=function(e){return function(t){var n,r,i,o,s=e.range(),u=t[0],l=t[1],c=-1;for(l<u&&(r=u,u=l,l=r),i=0,o=s.length;i<o;++i)s[i]>=u&&s[i]<=l&&(c<0&&(c=i),n=i);if(!(c<0))return u=e.invertExtent(s[c]),l=e.invertExtent(s[n]),[void 0===u[0]?u[1]:u[0],void 0===l[1]?l[0]:l[1]]}},cc=function(e,t,n){var r=e-t+2*n;return e?r>0?r:1:0},fc=Array.prototype,dc=fc.map,hc=fc.slice,pc={name:"implicit"};function gc(e){var t=K(),n=[],r=pc;function o(o){var s=o+"",i=t.get(s);if(!i){if(r!==pc)return r;t.set(s,i=n.push(o))}return e[(i-1)%e.length]}return e=null==e?[]:hc.call(e),o.domain=function(e){if(!arguments.length)return n.slice();n=[],t=K();for(var r,s,i=-1,u=e.length;++i<u;)t.has(s=(r=e[i])+"")||t.set(s,n.push(r));return o},o.range=function(t){return arguments.length?(e=hc.call(t),o):e.slice()},o.unknown=function(e){return arguments.length?(r=e,o):r},o.copy=function(){return gc().domain(n).range(e).unknown(r)},o}var mc=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e};function vc(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function yc(){}var bc="\\s*([+-]?\\d+)\\s*",xc="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",_c="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",wc=/^#([0-9a-f]{3})$/,Ec=/^#([0-9a-f]{6})$/,Oc=new RegExp("^rgb\\("+[bc,bc,bc]+"\\)$"),Sc=new RegExp("^rgb\\("+[_c,_c,_c]+"\\)$"),Ac=new RegExp("^rgba\\("+[bc,bc,bc,xc]+"\\)$"),kc=new RegExp("^rgba\\("+[_c,_c,_c,xc]+"\\)$"),Tc=new RegExp("^hsl\\("+[xc,_c,_c]+"\\)$"),Nc=new RegExp("^hsla\\("+[xc,_c,_c,xc]+"\\)$"),Mc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Cc(e){var t;return e=(e+"").trim().toLowerCase(),(t=wc.exec(e))?new Lc((t=parseInt(t[1],16))>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):(t=Ec.exec(e))?Dc(parseInt(t[1],16)):(t=Oc.exec(e))?new Lc(t[1],t[2],t[3],1):(t=Sc.exec(e))?new Lc(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Ac.exec(e))?Rc(t[1],t[2],t[3],t[4]):(t=kc.exec(e))?Rc(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Tc.exec(e))?zc(t[1],t[2]/100,t[3]/100,1):(t=Nc.exec(e))?zc(t[1],t[2]/100,t[3]/100,t[4]):Mc.hasOwnProperty(e)?Dc(Mc[e]):"transparent"===e?new Lc(NaN,NaN,NaN,0):null}function Dc(e){return new Lc(e>>16&255,e>>8&255,255&e,1)}function Rc(e,t,b,a){return a<=0&&(e=t=b=NaN),new Lc(e,t,b,a)}function Ic(e){return e instanceof yc||(e=Cc(e)),e?new Lc((e=e.rgb()).r,e.g,e.b,e.opacity):new Lc}function Pc(e,t,b,n){return 1===arguments.length?Ic(e):new Lc(e,t,b,null==n?1:n)}function Lc(e,t,b,n){this.r=+e,this.g=+t,this.b=+b,this.opacity=+n}function zc(e,t,n,a){return a<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Fc(e,t,n,a)}function jc(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof Fc)return new Fc(e.h,e.s,e.l,e.opacity);if(e instanceof yc||(e=Cc(e)),!e)return new Fc;if(e instanceof Fc)return e;var t=(e=e.rgb()).r/255,n=e.g/255,b=e.b/255,r=Math.min(t,n,b),o=Math.max(t,n,b),s=NaN,u=o-r,l=(o+r)/2;return u?(s=t===o?(n-b)/u+6*(n<b):n===o?(b-t)/u+2:(t-n)/u+4,u/=l<.5?o+r:2-o-r,s*=60):u=l>0&&l<1?0:s,new Fc(s,u,l,e.opacity)}(e):new Fc(e,t,n,null==r?1:r)}function Fc(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Uc(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}mc(yc,Cc,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),mc(Lc,Pc,vc(yc,{brighter:function(k){return k=null==k?1/.7:Math.pow(1/.7,k),new Lc(this.r*k,this.g*k,this.b*k,this.opacity)},darker:function(k){return k=null==k?.7:Math.pow(.7,k),new Lc(this.r*k,this.g*k,this.b*k,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var a=this.opacity;return(1===(a=isNaN(a)?1:Math.max(0,Math.min(1,a)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===a?")":", "+a+")")}})),mc(Fc,jc,vc(yc,{brighter:function(k){return k=null==k?1/.7:Math.pow(1/.7,k),new Fc(this.h,this.s,this.l*k,this.opacity)},darker:function(k){return k=null==k?.7:Math.pow(.7,k),new Fc(this.h,this.s,this.l*k,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new Lc(Uc(e>=240?e-240:e+120,o,r),Uc(e,o,r),Uc(e<120?e+240:e-120,o,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var Bc=Math.PI/180,Vc=180/Math.PI,qc=.95047,Gc=1,Wc=1.08883,Hc=4/29,Xc=6/29,Yc=3*Xc*Xc,Kc=Xc*Xc*Xc;function Jc(e){if(e instanceof Qc)return new Qc(e.l,e.a,e.b,e.opacity);if(e instanceof af){var t=e.h*Bc;return new Qc(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}e instanceof Lc||(e=Ic(e));var b=nf(e.r),a=nf(e.g),n=nf(e.b),x=$c((.4124564*b+.3575761*a+.1804375*n)/qc),y=$c((.2126729*b+.7151522*a+.072175*n)/Gc);return new Qc(116*y-16,500*(x-y),200*(y-$c((.0193339*b+.119192*a+.9503041*n)/Wc)),e.opacity)}function Zc(e,a,b,t){return 1===arguments.length?Jc(e):new Qc(e,a,b,null==t?1:t)}function Qc(e,a,b,t){this.l=+e,this.a=+a,this.b=+b,this.opacity=+t}function $c(e){return e>Kc?Math.pow(e,1/3):e/Yc+Hc}function ef(e){return e>Xc?e*e*e:Yc*(e-Hc)}function tf(x){return 255*(x<=.0031308?12.92*x:1.055*Math.pow(x,1/2.4)-.055)}function nf(x){return(x/=255)<=.04045?x/12.92:Math.pow((x+.055)/1.055,2.4)}function rf(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof af)return new af(e.h,e.c,e.l,e.opacity);e instanceof Qc||(e=Jc(e));var t=Math.atan2(e.b,e.a)*Vc;return new af(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}(e):new af(e,t,n,null==r?1:r)}function af(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}mc(Qc,Zc,vc(yc,{brighter:function(k){return new Qc(this.l+18*(null==k?1:k),this.a,this.b,this.opacity)},darker:function(k){return new Qc(this.l-18*(null==k?1:k),this.a,this.b,this.opacity)},rgb:function(){var y=(this.l+16)/116,x=isNaN(this.a)?y:y+this.a/500,e=isNaN(this.b)?y:y-this.b/200;return y=Gc*ef(y),new Lc(tf(3.2404542*(x=qc*ef(x))-1.5371385*y-.4985314*(e=Wc*ef(e))),tf(-.969266*x+1.8760108*y+.041556*e),tf(.0556434*x-.2040259*y+1.0572252*e),this.opacity)}})),mc(af,rf,vc(yc,{brighter:function(k){return new af(this.h,this.c,this.l+18*(null==k?1:k),this.opacity)},darker:function(k){return new af(this.h,this.c,this.l-18*(null==k?1:k),this.opacity)},rgb:function(){return Jc(this).rgb()}}));var of=-.29227,sf=-.90649,uf=1.97294,lf=uf*sf,cf=1.78277*uf,ff=1.78277*of- -.14861*sf;function df(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof hf)return new hf(e.h,e.s,e.l,e.opacity);e instanceof Lc||(e=Ic(e));var t=e.g/255,b=e.b/255,n=(ff*b+lf*(e.r/255)-cf*t)/(ff+lf-cf),r=b-n,k=(uf*(t-n)-of*r)/sf,o=Math.sqrt(k*k+r*r)/(uf*n*(1-n)),s=o?Math.atan2(k,r)*Vc-120:NaN;return new hf(s<0?s+360:s,o,n,e.opacity)}(e):new hf(e,t,n,null==r?1:r)}function hf(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function pf(e,t,n,r,o){var s=e*e,u=s*e;return((1-3*e+3*s-u)*t+(4-6*s+3*u)*n+(1+3*e+3*s-3*u)*r+u*o)/6}mc(hf,df,vc(yc,{brighter:function(k){return k=null==k?1/.7:Math.pow(1/.7,k),new hf(this.h,this.s,this.l*k,this.opacity)},darker:function(k){return k=null==k?.7:Math.pow(.7,k),new hf(this.h,this.s,this.l*k,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*Bc,t=+this.l,a=isNaN(this.s)?0:this.s*t*(1-t),n=Math.cos(e),r=Math.sin(e);return new Lc(255*(t+a*(-.14861*n+1.78277*r)),255*(t+a*(of*n+sf*r)),255*(t+a*(uf*n)),this.opacity)}}));var gf=function(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],o=e[i+1];return pf((n-i/t)*t,i>0?e[i-1]:2*r-o,r,o,i<t-1?e[i+2]:2*o-r)}},mf=function(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t);return pf((n-i/t)*t,e[(i+t-1)%t],e[i%t],e[(i+1)%t],e[(i+2)%t])}},vf=function(x){return function(){return x}};function yf(a,e){return function(t){return a+t*e}}function bf(a,b){var e=b-a;return e?yf(a,e>180||e<-180?e-360*Math.round(e/360):e):vf(isNaN(a)?b:a)}function xf(a,b){var e=b-a;return e?yf(a,e):vf(isNaN(a)?b:a)}var _f=function e(y){var t=function(y){return 1==(y=+y)?xf:function(a,b){return b-a?function(a,b,y){return a=Math.pow(a,y),b=Math.pow(b,y)-a,y=1/y,function(e){return Math.pow(a+e*b,y)}}(a,b,y):vf(isNaN(a)?b:a)}}(y);function n(e,n){var r=t((e=Pc(e)).r,(n=Pc(n)).r),o=t(e.g,n.g),b=t(e.b,n.b),s=xf(e.opacity,n.opacity);return function(t){return e.r=r(t),e.g=o(t),e.b=b(t),e.opacity=s(t),e+""}}return n.gamma=e,n}(1);function wf(e){return function(t){var i,n,r=t.length,o=new Array(r),s=new Array(r),b=new Array(r);for(i=0;i<r;++i)n=Pc(t[i]),o[i]=n.r||0,s[i]=n.g||0,b[i]=n.b||0;return o=e(o),s=e(s),b=e(b),n.opacity=1,function(e){return n.r=o(e),n.g=s(e),n.b=b(e),n+""}}}var Ef,Of,Sf,Af,kf=wf(gf),Tf=wf(mf),Nf=function(a,b){var i,e=b?b.length:0,t=a?Math.min(e,a.length):0,x=new Array(t),n=new Array(e);for(i=0;i<t;++i)x[i]=Lf(a[i],b[i]);for(;i<e;++i)n[i]=b[i];return function(e){for(i=0;i<t;++i)n[i]=x[i](e);return n}},Mf=function(a,b){var e=new Date;return b-=a=+a,function(t){return e.setTime(a+b*t),e}},Cf=function(a,b){return b-=a=+a,function(e){return a+b*e}},Df=function(a,b){var k,i={},e={};for(k in null!==a&&"object"==typeof a||(a={}),null!==b&&"object"==typeof b||(b={}),b)k in a?i[k]=Lf(a[k],b[k]):e[k]=b[k];return function(t){for(k in i)e[k]=i[k](t);return e}},Rf=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,If=new RegExp(Rf.source,"g"),Pf=function(a,b){var e,t,n,r=Rf.lastIndex=If.lastIndex=0,i=-1,o=[],s=[];for(a+="",b+="";(e=Rf.exec(a))&&(t=If.exec(b));)(n=t.index)>r&&(n=b.slice(r,n),o[i]?o[i]+=n:o[++i]=n),(e=e[0])===(t=t[0])?o[i]?o[i]+=t:o[++i]=t:(o[++i]=null,s.push({i:i,x:Cf(e,t)})),r=If.lastIndex;return r<b.length&&(n=b.slice(r),o[i]?o[i]+=n:o[++i]=n),o.length<2?s[0]?function(b){return function(e){return b(e)+""}}(s[0].x):function(b){return function(){return b}}(b):(b=s.length,function(e){for(var t,i=0;i<b;++i)o[(t=s[i]).i]=t.x(e);return o.join("")})},Lf=function(a,b){var e,t=typeof b;return null==b||"boolean"===t?vf(b):("number"===t?Cf:"string"===t?(e=Cc(b))?(b=e,_f):Pf:b instanceof Cc?_f:b instanceof Date?Mf:Array.isArray(b)?Nf:"function"!=typeof b.valueOf&&"function"!=typeof b.toString||isNaN(b)?Df:Cf)(a,b)},zf=function(a,b){return b-=a=+a,function(e){return Math.round(a+b*e)}},jf=180/Math.PI,Ff={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Uf=function(a,b,e,t,n,f){var r,o,s;return(r=Math.sqrt(a*a+b*b))&&(a/=r,b/=r),(s=a*e+b*t)&&(e-=a*s,t-=b*s),(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o,s/=o),a*t<b*e&&(a=-a,b=-b,s=-s,r=-r),{translateX:n,translateY:f,rotate:Math.atan2(b,a)*jf,skewX:Math.atan(s)*jf,scaleX:r,scaleY:o}};function Bf(e,t,n,r){function o(e){return e.length?e.pop()+" ":""}return function(a,b){var s=[],u=[];return a=e(a),b=e(b),function(e,r,o,s,u,l){if(e!==o||r!==s){var i=u.push("translate(",null,t,null,n);l.push({i:i-4,x:Cf(e,o)},{i:i-2,x:Cf(r,s)})}else(o||s)&&u.push("translate("+o+t+s+n)}(a.translateX,a.translateY,b.translateX,b.translateY,s,u),function(a,b,e,t){a!==b?(a-b>180?b+=360:b-a>180&&(a+=360),t.push({i:e.push(o(e)+"rotate(",null,r)-2,x:Cf(a,b)})):b&&e.push(o(e)+"rotate("+b+r)}(a.rotate,b.rotate,s,u),function(a,b,e,t){a!==b?t.push({i:e.push(o(e)+"skewX(",null,r)-2,x:Cf(a,b)}):b&&e.push(o(e)+"skewX("+b+r)}(a.skewX,b.skewX,s,u),function(e,t,n,r,s,u){if(e!==n||t!==r){var i=s.push(o(s)+"scale(",null,",",null,")");u.push({i:i-4,x:Cf(e,n)},{i:i-2,x:Cf(t,r)})}else 1===n&&1===r||s.push(o(s)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,b.scaleX,b.scaleY,s,u),a=b=null,function(e){for(var t,i=-1,n=u.length;++i<n;)s[(t=u[i]).i]=t.x(e);return s.join("")}}}var Vf=Bf(function(value){return"none"===value?Ff:(Ef||(Ef=document.createElement("DIV"),Of=document.documentElement,Sf=document.defaultView),Ef.style.transform=value,value=Sf.getComputedStyle(Of.appendChild(Ef),null).getPropertyValue("transform"),Of.removeChild(Ef),value=value.slice(7,-1).split(","),Uf(+value[0],+value[1],+value[2],+value[3],+value[4],+value[5]))},"px, ","px)","deg)"),qf=Bf(function(value){return null==value?Ff:(Af||(Af=document.createElementNS("http://www.w3.org/2000/svg","g")),Af.setAttribute("transform",value),(value=Af.transform.baseVal.consolidate())?Uf((value=value.matrix).a,value.b,value.c,value.d,value.e,value.f):Ff)},", ",")",")"),Gf=Math.SQRT2;function Wf(x){return((x=Math.exp(x))+1/x)/2}var Hf=function(e,t){var i,n,r=e[0],o=e[1],s=e[2],u=t[2],l=t[0]-r,c=t[1]-o,d=l*l+c*c;if(d<1e-12)n=Math.log(u/s)/Gf,i=function(e){return[r+e*l,o+e*c,s*Math.exp(Gf*e*n)]};else{var h=Math.sqrt(d),p=(u*u-s*s+4*d)/(2*s*2*h),g=(u*u-s*s-4*d)/(2*u*2*h),m=Math.log(Math.sqrt(p*p+1)-p),v=Math.log(Math.sqrt(g*g+1)-g);n=(v-m)/Gf,i=function(e){var x,t=e*n,u=Wf(m),d=s/(2*h)*(u*(x=Gf*t+m,((x=Math.exp(2*x))-1)/(x+1))-function(x){return((x=Math.exp(x))-1/x)/2}(m));return[r+d*l,o+d*c,s*u/Wf(Gf*t+m)]}}return i.duration=1e3*n,i};function Xf(e){return function(t,n){var r=e((t=jc(t)).h,(n=jc(n)).h),o=xf(t.s,n.s),s=xf(t.l,n.l),u=xf(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=o(e),t.l=s(e),t.opacity=u(e),t+""}}}var Yf=Xf(bf),Kf=Xf(xf);function Jf(e,t){var n=xf((e=Zc(e)).l,(t=Zc(t)).l),a=xf(e.a,t.a),b=xf(e.b,t.b),r=xf(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=a(t),e.b=b(t),e.opacity=r(t),e+""}}function Zf(e){return function(t,n){var r=e((t=rf(t)).h,(n=rf(n)).h),o=xf(t.c,n.c),s=xf(t.l,n.l),u=xf(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=o(e),t.l=s(e),t.opacity=u(e),t+""}}}var Qf=Zf(bf),$f=Zf(xf);function ed(e){return function t(y){function n(t,n){var r=e((t=df(t)).h,(n=df(n)).h),o=xf(t.s,n.s),s=xf(t.l,n.l),u=xf(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=o(e),t.l=s(Math.pow(e,y)),t.opacity=u(e),t+""}}return y=+y,n.gamma=t,n}(1)}var td=ed(bf),nd=ed(xf),rd=function(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n},id=function(x){return function(){return x}},ad=function(x){return+x},od=[0,1];function sd(a,b){return(b-=a=+a)?function(x){return(x-a)/b}:id(b)}function ud(e,t,n,r){var o=e[0],s=e[1],u=t[0],l=t[1];return s<o?(o=n(s,o),u=r(l,u)):(o=n(o,s),u=r(u,l)),function(x){return u(o(x))}}function ld(e,t,n,r){var j=Math.min(e.length,t.length)-1,o=new Array(j),s=new Array(j),i=-1;for(e[j]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<j;)o[i]=n(e[i],e[i+1]),s[i]=r(t[i],t[i+1]);return function(x){var i=Cr(e,x,1,j)-1;return s[i](o[i](x))}}function cd(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp())}function fd(e,t){var n,r,o,s=od,u=od,l=Lf,c=!1;function d(){return n=Math.min(s.length,u.length)>2?ld:ud,r=o=null,h}function h(x){return(r||(r=n(s,u,c?function(e){return function(a,b){var t=e(a=+a,b=+b);return function(x){return x<=a?0:x>=b?1:t(x)}}}(e):e,l)))(+x)}return h.invert=function(y){return(o||(o=n(u,s,sd,c?function(e){return function(a,b){var t=e(a=+a,b=+b);return function(e){return e<=0?a:e>=1?b:t(e)}}}(t):t)))(+y)},h.domain=function(e){return arguments.length?(s=dc.call(e,ad),d()):s.slice()},h.range=function(e){return arguments.length?(u=hc.call(e),d()):u.slice()},h.rangeRound=function(e){return u=hc.call(e),l=zf,d()},h.clamp=function(e){return arguments.length?(c=!!e,d()):c},h.interpolate=function(e){return arguments.length?(l=e,d()):l},d()}var dd,hd=function(x,e){if((i=(x=e?x.toExponential(e-1):x.toExponential()).indexOf("e"))<0)return null;var i,t=x.slice(0,i);return[t.length>1?t[0]+t.slice(2):t,+x.slice(i+1)]},pd=function(x){return(x=hd(Math.abs(x)))?x[1]:NaN},gd=function(x,e){var t=hd(x,e);if(!t)return x+"";var n=t[0],r=t[1];return r<0?"0."+new Array(-r).join("0")+n:n.length>r+1?n.slice(0,r+1)+"."+n.slice(r+1):n+new Array(r-n.length+2).join("0")},md={"":function(x,e){x=x.toPrecision(e);e:for(var t,n=x.length,i=1,r=-1;i<n;++i)switch(x[i]){case".":r=t=i;break;case"0":0===r&&(r=i),t=i;break;case"e":break e;default:r>0&&(r=0)}return r>0?x.slice(0,r)+x.slice(t+1):x},"%":function(x,e){return(100*x).toFixed(e)},b:function(x){return Math.round(x).toString(2)},c:function(x){return x+""},d:function(x){return Math.round(x).toString(10)},e:function(x,e){return x.toExponential(e)},f:function(x,e){return x.toFixed(e)},g:function(x,e){return x.toPrecision(e)},o:function(x){return Math.round(x).toString(8)},p:function(x,e){return gd(100*x,e)},r:gd,s:function(x,e){var t=hd(x,e);if(!t)return x+"";var n=t[0],r=t[1],i=r-(dd=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=n.length;return i===o?n:i>o?n+new Array(i-o+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+hd(x,Math.max(0,e+i-1))[0]},X:function(x){return Math.round(x).toString(16).toUpperCase()},x:function(x){return Math.round(x).toString(16)}},vd=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;function yd(e){return new bd(e)}function bd(e){if(!(t=vd.exec(e)))throw new Error("invalid format: "+e);var t,n=t[1]||" ",r=t[2]||">",o=t[3]||"-",s=t[4]||"",u=!!t[5],l=t[6]&&+t[6],c=!!t[7],d=t[8]&&+t[8].slice(1),h=t[9]||"";"n"===h?(c=!0,h="g"):md[h]||(h=""),(u||"0"===n&&"="===r)&&(u=!0,n="0",r="="),this.fill=n,this.align=r,this.sign=o,this.symbol=s,this.zero=u,this.width=l,this.comma=c,this.precision=d,this.type=h}yd.prototype=bd.prototype,bd.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var xd,_d,wd,Ed=function(x){return x},Od=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"],Sd=function(e){var t,n,r=e.grouping&&e.thousands?(t=e.grouping,n=e.thousands,function(value,e){for(var i=value.length,r=[],j=0,o=t[0],s=0;i>0&&o>0&&(s+o+1>e&&(o=Math.max(1,e-s)),r.push(value.substring(i-=o,i+o)),!((s+=o+1)>e));)o=t[j=(j+1)%t.length];return r.reverse().join(n)}):Ed,o=e.currency,s=e.decimal,u=e.numerals?function(e){return function(value){return value.replace(/[0-9]/g,function(i){return e[+i]})}}(e.numerals):Ed,l=e.percent||"%";function c(e){var t=(e=yd(e)).fill,n=e.align,c=e.sign,d=e.symbol,h=e.zero,p=e.width,g=e.comma,m=e.precision,v=e.type,_="$"===d?o[0]:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",w="$"===d?o[1]:/[%p]/.test(v)?l:"",E=md[v],O=!v||/[defgprs%]/.test(v);function S(value){var i,e,o,l=_,d=w;if("c"===v)d=E(value)+d,value="";else{var S=(value=+value)<0;if(value=E(Math.abs(value),m),S&&0==+value&&(S=!1),l=(S?"("===c?c:"-":"-"===c||"("===c?"":c)+l,d=("s"===v?Od[8+dd/3]:"")+d+(S&&"("===c?")":""),O)for(i=-1,e=value.length;++i<e;)if(48>(o=value.charCodeAt(i))||o>57){d=(46===o?s+value.slice(i+1):value.slice(i))+d,value=value.slice(0,i);break}}g&&!h&&(value=r(value,1/0));var A=l.length+value.length+d.length,T=A<p?new Array(p-A+1).join(t):"";switch(g&&h&&(value=r(T+value,T.length?p-d.length:1/0),T=""),n){case"<":value=l+value+d+T;break;case"=":value=l+T+value+d;break;case"^":value=T.slice(0,A=T.length>>1)+l+value+d+T.slice(A);break;default:value=T+l+value+d}return u(value)}return m=null==m?v?6:12:/[gprs]/.test(v)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),S.toString=function(){return e+""},S}return{format:c,formatPrefix:function(e,value){var f=c(((e=yd(e)).type="f",e)),t=3*Math.max(-8,Math.min(8,Math.floor(pd(value)/3))),k=Math.pow(10,-t),n=Od[8+t/3];return function(value){return f(k*value)+n}}}};function Ad(e){return xd=Sd(e),_d=xd.format,wd=xd.formatPrefix,xd}Ad({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var kd=function(e,t,n){var r,o=e[0],s=e[e.length-1],u=Ur(o,s,null==t?10:t);switch((n=yd(null==n?",f":n)).type){case"s":var value=Math.max(Math.abs(o),Math.abs(s));return null!=n.precision||isNaN(r=function(e,value){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(pd(value)/3)))-pd(Math.abs(e)))}(u,value))||(n.precision=r),wd(n,value);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(r=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,pd(t)-pd(e))+1}(u,Math.max(Math.abs(o),Math.abs(s))))||(n.precision=r-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(r=function(e){return Math.max(0,-pd(Math.abs(e)))}(u))||(n.precision=r-2*("%"===n.type))}return _d(n)};function Td(e){var t=e.domain;return e.ticks=function(e){var n=t();return jr(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){return kd(t(),e,n)},e.nice=function(n){null==n&&(n=10);var r,o=t(),s=0,u=o.length-1,l=o[s],c=o[u];return c<l&&(r=l,l=c,c=r,r=s,s=u,u=r),(r=Fr(l,c,n))>0?r=Fr(l=Math.floor(l/r)*r,c=Math.ceil(c/r)*r,n):r<0&&(r=Fr(l=Math.ceil(l*r)/r,c=Math.floor(c*r)/r,n)),r>0?(o[s]=Math.floor(l/r)*r,o[u]=Math.ceil(c/r)*r,t(o)):r<0&&(o[s]=Math.ceil(l*r)/r,o[u]=Math.floor(c*r)/r,t(o)),e},e}function Nd(){var e=fd(sd,Cf);return e.copy=function(){return cd(e,Nd())},Td(e)}var Md=function(e,t){var n,r=0,o=(e=e.slice()).length-1,s=e[r],u=e[o];return u<s&&(n=r,r=o,o=n,n=s,s=u,u=n),e[r]=t.floor(s),e[o]=t.ceil(u),e};function Cd(a,b){return(b=Math.log(b/a))?function(x){return Math.log(x/a)/b}:id(b)}function Dd(a,b){return a<0?function(e){return-Math.pow(-b,e)*Math.pow(-a,1-e)}:function(e){return Math.pow(b,e)*Math.pow(a,1-e)}}function Rd(x){return isFinite(x)?+("1e"+x):x<0?0:x}function Id(e){return 10===e?Rd:e===Math.E?Math.exp:function(x){return Math.pow(e,x)}}function Pd(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(x){return Math.log(x)/e})}function Ld(f){return function(x){return-f(-x)}}function zd(x,e){return x<0?-Math.pow(-x,e):Math.pow(x,e)}function jd(){var e=1,t=fd(function(a,b){return(b=zd(b,e)-(a=zd(a,e)))?function(x){return(zd(x,e)-a)/b}:id(b)},function(a,b){return b=zd(b,e)-(a=zd(a,e)),function(t){return zd(a+b*t,1/e)}}),n=t.domain;return t.exponent=function(t){return arguments.length?(e=+t,n(n())):e},t.copy=function(){return cd(t,jd().exponent(e))},Td(t)}var Fd=1e3,Ud=60*Fd,Bd=60*Ud,Vd=24*Bd,qd=7*Vd,Gd=30*Vd,Wd=365*Vd;function Hd(e){return new Date(e)}function Xd(e){return e instanceof Date?+e:+new Date(+e)}function Yd(e,t,n,r,o,s,u,l,c){var d=fd(sd,Cf),h=d.invert,p=d.domain,g=c(".%L"),m=c(":%S"),v=c("%I:%M"),_=c("%I %p"),w=c("%a %d"),E=c("%b %d"),O=c("%B"),S=c("%Y"),A=[[u,1,Fd],[u,5,5*Fd],[u,15,15*Fd],[u,30,30*Fd],[s,1,Ud],[s,5,5*Ud],[s,15,15*Ud],[s,30,30*Ud],[o,1,Bd],[o,3,3*Bd],[o,6,6*Bd],[o,12,12*Bd],[r,1,Vd],[r,2,2*Vd],[n,1,qd],[t,1,Gd],[t,3,3*Gd],[e,1,Wd]];function T(l){return(u(l)<l?g:s(l)<l?m:o(l)<l?v:r(l)<l?_:t(l)<l?n(l)<l?w:E:e(l)<l?O:S)(l)}function N(t,n,r,o){if(null==t&&(t=10),"number"==typeof t){var s=Math.abs(r-n)/t,i=kr(function(i){return i[2]}).right(A,s);i===A.length?(o=Ur(n/Wd,r/Wd,t),t=e):i?(o=(i=A[s/A[i-1][2]<A[i][2]/s?i-1:i])[1],t=i[0]):(o=Math.max(Ur(n,r,t),1),t=l)}return null==o?t:t.every(o)}return d.invert=function(y){return new Date(h(y))},d.domain=function(e){return arguments.length?p(dc.call(e,Xd)):p().map(Hd)},d.ticks=function(e,t){var n,r=p(),o=r[0],s=r[r.length-1],u=s<o;return u&&(n=o,o=s,s=n),n=(n=N(e,o,s,t))?n.range(o,s+1):[],u?n.reverse():n},d.tickFormat=function(e,t){return null==t?T:c(t)},d.nice=function(e,t){var n=p();return(e=N(e,n[0],n[n.length-1],t))?p(Md(n,e)):d},d.copy=function(){return cd(d,Yd(e,t,n,r,o,s,u,l,c))},d}function Kd(){var e,t,n=gc().unknown(void 0),r=n.domain,o=n.range,s=[0,1],u=!1,l=0,c=0,d=.5;function h(){var n=r().length,h=s[1]<s[0],p=s[h-0],g=s[1-h],m=cc(n,l,c);e=(g-p)/(m||1),u&&(e=Math.floor(e)),p+=(g-p-e*(n-l))*d,t=e*(1-l),u&&(p=Math.round(p),t=Math.round(t));var v=Ir(n).map(function(i){return p+e*i});return o(h?v.reverse():v)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),h()):r()},n.range=function(e){return arguments.length?(s=[+e[0],+e[1]],h()):s.slice()},n.rangeRound=function(e){return s=[+e[0],+e[1]],u=!0,h()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(u=!!e,h()):u},n.padding=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),l=c,h()):l},n.paddingInner=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),h()):l},n.paddingOuter=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),h()):c},n.align=function(e){return arguments.length?(d=Math.max(0,Math.min(1,e)),h()):d},n.invertRange=function(e){if(null!=e[0]&&null!=e[1]){var a,b,n,u=+e[0],l=+e[1],c=s[1]<s[0],d=c?o().reverse():o(),h=d.length-1;if(u==u&&l==l&&(l<u&&(n=u,u=l,l=n),!(l<d[0]||u>s[1-c])))return a=Math.max(0,Nr(d,u)-1),b=u===l?a:Nr(d,l)-1,u-d[a]>t+1e-10&&++a,c&&(n=a,a=h-b,b=h-n),a>b?void 0:r().slice(a,b+1)}},n.invert=function(e){var value=n.invertRange([e,e]);return value?value[0]:value},n.copy=function(){return Kd().domain(r()).range(s).round(u).paddingInner(l).paddingOuter(c).align(d)},h()}var Jd=Array.prototype.map,Zd=Array.prototype.slice;function Qd(e){return Jd.call(e,function(x){return+x})}function $d(e,t){return arguments.length>1?(eh[e]=function(e,t){return function(){var n=t();return n.invertRange||(n.invertRange=n.invert?uc(n):n.invertExtent?lc(n):void 0),n.type=e,n}}(e,t),this):eh.hasOwnProperty(e)?eh[e]:void 0}var eh={identity:function e(){var t=[0,1];function n(x){return+x}return n.invert=n,n.domain=n.range=function(e){return arguments.length?(t=dc.call(e,ad),n):t.slice()},n.copy=function(){return e().domain(t)},Td(n)},linear:Nd,log:function e(){var t=fd(Cd,Dd).domain([1,10]),n=t.domain,r=10,o=Pd(10),s=Id(10);function u(){return o=Pd(r),s=Id(r),n()[0]<0&&(o=Ld(o),s=Ld(s)),t}return t.base=function(e){return arguments.length?(r=+e,u()):r},t.domain=function(e){return arguments.length?(n(e),u()):n()},t.ticks=function(e){var t,u=n(),l=u[0],c=u[u.length-1];(t=c<l)&&(i=l,l=c,c=i);var d,k,h,i=o(l),j=o(c),p=null==e?10:+e,g=[];if(!(r%1)&&j-i<p){if(i=Math.round(i)-1,j=Math.round(j)+1,l>0){for(;i<j;++i)for(k=1,d=s(i);k<r;++k)if(!((h=d*k)<l)){if(h>c)break;g.push(h)}}else for(;i<j;++i)for(k=r-1,d=s(i);k>=1;--k)if(!((h=d*k)<l)){if(h>c)break;g.push(h)}}else g=jr(i,j,Math.min(j-i,p)).map(s);return t?g.reverse():g},t.tickFormat=function(e,n){if(null==n&&(n=10===r?".0e":","),"function"!=typeof n&&(n=_d(n)),e===1/0)return n;null==e&&(e=10);var k=Math.max(1,r*e/t.ticks().length);return function(e){var i=e/s(Math.round(o(e)));return i*r<r-.5&&(i*=r),i<=k?n(e):""}},t.nice=function(){return n(Md(n(),{floor:function(x){return s(Math.floor(o(x)))},ceil:function(x){return s(Math.ceil(o(x)))}}))},t.copy=function(){return cd(t,e().base(r))},t},ordinal:gc,pow:jd,sqrt:function(){return jd().exponent(.5)},quantile:function e(){var t=[],n=[],r=[];function o(){var i=0,e=Math.max(1,n.length);for(r=new Array(e-1);++i<e;)r[i-1]=Vr(t,i/e);return s}function s(x){if(!isNaN(x=+x))return n[Cr(r,x)]}return s.invertExtent=function(y){var i=n.indexOf(y);return i<0?[NaN,NaN]:[i>0?r[i-1]:t[0],i<r.length?r[i]:t[t.length-1]]},s.domain=function(e){if(!arguments.length)return t.slice();t=[];for(var n,i=0,r=e.length;i<r;++i)null==(n=e[i])||isNaN(n=+n)||t.push(n);return t.sort(Ar),o()},s.range=function(e){return arguments.length?(n=hc.call(e),o()):n.slice()},s.quantiles=function(){return r.slice()},s.copy=function(){return e().domain(t).range(n)},s},quantize:function e(){var t=0,n=1,r=1,o=[.5],s=[0,1];function u(x){if(x<=x)return s[Cr(o,x,0,r)]}function l(){var i=-1;for(o=new Array(r);++i<r;)o[i]=((i+1)*n-(i-r)*t)/(r+1);return u}return u.domain=function(e){return arguments.length?(t=+e[0],n=+e[1],l()):[t,n]},u.range=function(e){return arguments.length?(r=(s=hc.call(e)).length-1,l()):s.slice()},u.invertExtent=function(y){var i=s.indexOf(y);return i<0?[NaN,NaN]:i<1?[t,o[0]]:i>=r?[o[r-1],n]:[o[i-1],o[i]]},u.copy=function(){return e().domain([t,n]).range(s)},Td(u)},threshold:function e(){var t=[.5],n=[0,1],r=1;function o(x){if(x<=x)return n[Cr(t,x,0,r)]}return o.domain=function(e){return arguments.length?(t=hc.call(e),r=Math.min(t.length,n.length-1),o):t.slice()},o.range=function(e){return arguments.length?(n=hc.call(e),r=Math.min(t.length,n.length-1),o):n.slice()},o.invertExtent=function(y){var i=n.indexOf(y);return[t[i-1],t[i]]},o.copy=function(){return e().domain(t).range(n)},o},time:function(){return Yd(dt,ct,st,at,it,rt,nt,$e,kt).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},utc:function(){return Yd(wt,xt,vt,gt,pt,ht,nt,$e,Nt).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])},band:Kd,point:function(){return function e(t){var n=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return e(n())},t}(Kd().paddingInner(1))},sequential:function e(t){var n=Nd(),r=0,o=1,s=!1;function u(){var e=n.domain();r=e[0],o=Object(v.peek)(e)-r}function l(x){var e=(x-r)/o;return t(s?Math.max(0,Math.min(1,e)):e)}return l.clamp=function(e){return arguments.length?(s=!!e,l):s},l.domain=function(e){return arguments.length?(n.domain(e),u(),l):n.domain()},l.interpolator=function(e){return arguments.length?(t=e,l):t},l.copy=function(){return e().domain(n.domain()).clamp(s).interpolator(t)},l.ticks=function(e){return n.ticks(e)},l.tickFormat=function(e,t){return n.tickFormat(e,t)},l.nice=function(e){return n.nice(e),u(),l},l},"bin-linear":function e(){var t=Nd(),n=[];function r(x){return t(x)}return r.domain=function(e){return arguments.length?(function(e){n=Qd(e),t.domain([n[0],Object(v.peek)(n)])}(e),r):n.slice()},r.range=function(e){return arguments.length?(t.range(e),r):t.range()},r.rangeRound=function(e){return arguments.length?(t.rangeRound(e),r):t.rangeRound()},r.interpolate=function(e){return arguments.length?(t.interpolate(e),r):t.interpolate()},r.invert=function(e){return t.invert(e)},r.ticks=function(e){var t=n.length,o=~~(t/(e||t));return o<2?r.domain():n.filter(function(x,i){return!(i%o)})},r.tickFormat=function(){return t.tickFormat.apply(t,arguments)},r.copy=function(){return e().domain(r.domain()).range(r.range())},r},"bin-ordinal":function e(){var t=[],n=[];function r(x){return null==x||x!=x?void 0:n[(Cr(t,x)-1)%n.length]}return r.domain=function(e){return arguments.length?(t=Qd(e),r):t.slice()},r.range=function(e){return arguments.length?(n=Zd.call(e),r):n.slice()},r.copy=function(){return e().domain(r.domain()).range(r.range())},r}};for(var th in eh)$d(th,eh[th]);function nh(e){for(var t=e.length/6|0,n=new Array(t),i=0;i<t;)n[i]="#"+e.slice(6*i,6*++i);return n}var rh=nh("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),ih=nh("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),ah=nh("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),oh=nh("4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac"),sh=nh("4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"),uh=new Array(3).concat("67a9cff7f7f7f1a340","0571b092c5defdb863e66101","0571b092c5def7f7f7fdb863e66101","2166ac67a9cfd1e5f0fee0b6f1a340b35806","2166ac67a9cfd1e5f0f7f7f7fee0b6f1a340b35806","2166ac4393c392c5ded1e5f0fee0b6fdb863e08214b35806","2166ac4393c392c5ded1e5f0f7f7f7fee0b6fdb863e08214b35806","0530612166ac4393c392c5ded1e5f0fee0b6fdb863e08214b358067f3b08","0530612166ac4393c392c5ded1e5f0f7f7f7fee0b6fdb863e08214b358067f3b08").map(nh),lh=function(e){for(var t=e.length/6|0,n=new Array(t),i=0;i<t;)n[i]="#"+e.slice(6*i,6*++i);return n},ch=lh("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),fh=lh("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),dh=lh("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),hh=lh("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),ph=lh("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),gh=lh("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),mh=lh("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),vh=lh("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),yh=lh("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),bh=function(e){return kf(e[e.length-1])},xh=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(lh),_h=bh(xh),wh=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(lh),Eh=bh(wh),Oh=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(lh),Sh=bh(Oh),Ah=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(lh),kh=bh(Ah),Th=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(lh),Nh=bh(Th),Mh=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(lh),Ch=bh(Mh),Dh=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(lh),Rh=bh(Dh),Ih=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(lh),Ph=bh(Ih),Lh=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(lh),zh=bh(Lh),jh=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(lh),Fh=bh(jh),Uh=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(lh),Bh=bh(Uh),Vh=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(lh),qh=bh(Vh),Gh=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(lh),Wh=bh(Gh),Hh=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(lh),Xh=bh(Hh),Yh=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(lh),Kh=bh(Yh),Jh=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(lh),Zh=bh(Jh),Qh=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(lh),$h=bh(Qh),ep=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(lh),tp=bh(ep),np=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(lh),rp=bh(np),ip=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(lh),ap=bh(ip),op=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(lh),sp=bh(op),up=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(lh),lp=bh(up),cp=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(lh),fp=bh(cp),dp=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(lh),hp=bh(dp),pp=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(lh),gp=bh(pp),mp=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(lh),vp=bh(mp),yp=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(lh),bp=bh(yp),xp=nd(df(300,.5,0),df(-240,.5,1)),_p=nd(df(-100,.75,.35),df(80,1.5,.8)),wp=nd(df(260,.75,.35),df(80,1.5,.8)),Ep=df(),Op=function(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return Ep.h=360*e-100,Ep.s=1.5-1.5*t,Ep.l=.8-.9*t,Ep+""};function Sp(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}var Ap=Sp(lh("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),kp=Sp(lh("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Tp=Sp(lh("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Np=Sp(lh("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),Mp={blueorange:uh},Cp={category10:ch,accent:fh,dark2:dh,paired:hh,pastel1:ph,pastel2:gh,set1:mh,set2:vh,set3:yh,category20:rh,category20b:ih,category20c:ah,tableau10:oh,tableau20:sh,viridis:Ap,magma:kp,inferno:Tp,plasma:Np,blueorange:kf(Object(v.peek)(uh))};function Dp(e,t){Cp[e]=u["interpolate"+t],Mp[e]=u["scheme"+t]}Dp("blues","Blues"),Dp("greens","Greens"),Dp("greys","Greys"),Dp("purples","Purples"),Dp("reds","Reds"),Dp("oranges","Oranges"),Dp("brownbluegreen","BrBG"),Dp("purplegreen","PRGn"),Dp("pinkyellowgreen","PiYG"),Dp("purpleorange","PuOr"),Dp("redblue","RdBu"),Dp("redgrey","RdGy"),Dp("redyellowblue","RdYlBu"),Dp("redyellowgreen","RdYlGn"),Dp("spectral","Spectral"),Dp("bluegreen","BuGn"),Dp("bluepurple","BuPu"),Dp("greenblue","GnBu"),Dp("orangered","OrRd"),Dp("purplebluegreen","PuBuGn"),Dp("purpleblue","PuBu"),Dp("purplered","PuRd"),Dp("redpurple","RdPu"),Dp("yellowgreenblue","YlGnBu"),Dp("yellowgreen","YlGn"),Dp("yelloworangebrown","YlOrBr"),Dp("yelloworangered","YlOrRd");var Rp=function(e,t){if(arguments.length>1)return Cp[e]=t,this;var n=e.split("-");return e=n[0],(n=+n[1]+1)&&Mp.hasOwnProperty(e)?Mp[e][n-1]:!n&&Cp.hasOwnProperty(e)?Cp[e]:void 0};function Ip(e,t){var n=t[0],r=Object(v.peek)(t)-n;return function(i){return e(n+i*r)}}function Pp(e,t,n){var r=n-t;return r?"linear"===e.type||"sequential"===e.type?function(e){return(e-t)/r}:e.copy().domain([t,n]).range([0,1]).interpolate(Lp):Object(v.constant)(0)}function Lp(a,b){var e=b-a;return function(i){return a+i*e}}function zp(e,t){var n=s[function(e){return"interpolate"+e.toLowerCase().split("-").map(function(e){return e[0].toUpperCase()+e.slice(1)}).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}var jp={millisecond:$e,second:nt,minute:rt,hour:it,day:at,week:st,month:ct,year:dt},Fp={millisecond:$e,second:nt,minute:ht,hour:pt,day:gt,week:vt,month:xt,year:wt};function Up(e){return jp.hasOwnProperty(e)&&jp[e]}function Bp(e){return Fp.hasOwnProperty(e)&&Fp[e]}function Vp(e,t){var n;return Object(v.isObject)(t)&&(n=t.step,t=t.interval),Object(v.isString)(t)&&(t="time"===e.type?Up(t):"utc"===e.type?Bp(t):Object(v.error)("Only time and utc scales accept interval strings."),n&&(t=t.every(n))),t}function qp(e,t,n){var r=e.range(),o=r[0],s=Object(v.peek)(r);if(o>s&&(r=s,s=o,o=r),t=t.filter(function(t){return!((t=e(t))<o||t>s)}),n>0&&t.length>1){for(var u=[t[0],Object(v.peek)(t)];t.length>n&&t.length>=3;)t=t.filter(function(e,i){return!(i%2)});t.length<3&&(t=u)}return t}function Gp(e,t){return e.ticks?e.ticks(t):e.domain()}function Wp(e,t,n){var r,o,s=e.tickFormat?e.tickFormat(t,n):String;return e.type===sc?(r=s,o=function(e){var t,n,r=yd(e||",");if(null==r.precision){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1}return t=_d(r),n=_d(".1f")(1)[1],function(x){var e,r,o=t(x),s=o.indexOf(n);if(s<0)return o;for(r=(e=function(e,t){var n,i=e.lastIndexOf("e");if(i>0)return i;for(i=e.length;--i>t;)if((n=e.charCodeAt(i))>=48&&n<=57)return i+1}(o,s))<o.length?o.slice(e):"";--e>s;)if("0"!==o[e]){++e;break}return o.slice(0,e)+r}}return _d(r)}(n),function(e){return r(e)?o(e):""}):s}function Hp(e){ur.call(this,null,e)}function Xp(e){ur.call(this,null,e)}function Yp(){return T({})}function Kp(e){return e.exit}function Jp(e){ur.call(this,null,e)}Object(v.inherits)(Hp,ur).transform=function(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,o=e.scale,s=null==e.count?e.values?e.values.length:10:Vp(o,e.count),u=e.format||Wp(o,s,e.formatSpecifier),l=e.values?qp(o,e.values,s):Gp(o,s);return r&&(n.rem=r),r=l.map(function(value,i){return T({index:i/(l.length-1),value:value,label:u(value)})}),e.extra&&r.push(T({index:-1,extra:{value:r[0].value},label:""})),n.source=r,n.add=r,this.value=r,n},Object(v.inherits)(Xp,ur).transform=function(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),o=e.item||Yp,s=e.key||S,u=this.value;return Object(v.isArray)(r.encode)&&(r.encode=null),u&&(e.modified("key")||t.modified(s))&&Object(v.error)("DataJoin does not support modified key function or fields."),u||(t=t.addAll(),this.value=u=Object(v.fastmap)().test(Kp),u.lookup=function(e){return u.get(s(e))}),t.visit(t.ADD,function(e){var k=s(e),x=u.get(k);x?x.exit?(u.empty--,r.add.push(x)):r.mod.push(x):(u.set(k,x=o(e)),r.add.push(x)),x.datum=e,x.exit=!1}),t.visit(t.MOD,function(e){var k=s(e),x=u.get(k);x&&(x.datum=e,r.mod.push(x))}),t.visit(t.REM,function(e){var k=s(e),x=u.get(k);e!==x.datum||x.exit||(r.rem.push(x),x.exit=!0,++u.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),e.clean&&u.empty>n.cleanThreshold&&n.runAfter(u.clean),r},Object(v.inherits)(Jp,ur).transform=function(e,t){var n=t.fork(t.ADD_REM),r=e.encoders,o=t.encode;if(Object(v.isArray)(o)){if(!n.changed()&&!o.every(function(e){return r[e]}))return t.StopPropagation;o=o[0]}var s="enter"===o,u=r.update||v.falsy,l=r.enter||v.falsy,c=r.exit||v.falsy,d=(o&&!s?r[o]:u)||v.falsy;if(t.changed(t.ADD)&&(t.visit(t.ADD,function(t){l(t,e),u(t,e),d!==v.falsy&&d!==u&&d(t,e)}),n.modifies(l.output),n.modifies(u.output),d!==v.falsy&&d!==u&&n.modifies(d.output)),t.changed(t.REM)&&c!==v.falsy&&(t.visit(t.REM,function(t){c(t,e)}),n.modifies(c.output)),s||d!==v.falsy){var h=t.MOD|(e.modified()?t.REFLOW:0);s?(t.visit(h,function(t){var r=l(t,e);(d(t,e)||r)&&n.mod.push(t)}),n.mod.length&&n.modifies(l.output)):t.visit(h,function(t){d(t,e)&&n.mod.push(t)}),n.mod.length&&n.modifies(d.output)}return n.changed()?n:t.StopPropagation};var Zp={};function Qp(e){var t=e.domain();return t.max=t.pop(),t}function $p(value,e){return isFinite(value)?e(value):null}function eg(e){ur.call(this,[],e)}Zp.quantile=function(e){var t=[-1/0].concat(e.quantiles());return t.max=1/0,t},Zp.quantize=function(e){var t=e.domain(),n=t[0],r=Object(v.peek)(t),o=e.range().length,s=new Array(o),i=0;for(s[0]=-1/0;++i<o;)s[i]=(i*r-(i-o)*n)/o;return s.max=1/0,s},Zp.threshold=function(e){var t=[-1/0].concat(e.domain());return t.max=1/0,t},Zp["bin-linear"]=Qp,Zp["bin-ordinal"]=Qp,Object(v.inherits)(eg,ur).transform=function(e,t){if(null!=this.value&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=0,o=this.value,s="gradient"===e.type,u=e.scale,l=null==e.count?5:Vp(u,e.count),c=e.format||Wp(u,l,e.formatSpecifier),d=e.values||function(e,t,n){if(s)return e.domain();var r=Zp[e.type];return r?r(e):Gp(e,t)}(u,l);if(c=function(e,t){return Zp[e.type]?function(e){return function(value,t,n){var r=n[t+1]||n.max||1/0,o=$p(value,e),s=$p(r,e);return o&&s?o+"\u2013"+s:s?"< "+s:"\u2265 "+o}}(t):function(e){return function(value){return e(value)}}(t)}(u,c),o&&(n.rem=o),s)var h=e.values?u.domain():d,p=Pp(u,h[0],Object(v.peek)(h));else{var g,m=e.size;Object(v.isFunction)(m)?(e.values||0!==u(d[0])||(d=d.slice(1)),g=d.reduce(function(t,value){return Math.max(t,m(value,e))},0)):m=Object(v.constant)(g=m||8)}return o=d.map(function(value,t){var n=T({index:t,label:c(value,t,d),value:value});return s?n.perc=p(value):(n.offset=g,n.size=m(value,e),n.total=Math.round(r),r+=n.size),n}),n.source=o,n.add=o,this.value=o,n};var tg=Object(v.fastmap)({line:sg,"line-radial":function(e,t,n,r){return sg(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))},arc:ug,"arc-radial":function(e,t,n,r){return ug(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))},curve:lg,"curve-radial":function(e,t,n,r){return lg(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))},"orthogonal-horizontal":function(e,t,n,r){return"M"+e+","+t+"V"+r+"H"+n},"orthogonal-vertical":function(e,t,n,r){return"M"+e+","+t+"H"+n+"V"+r},"orthogonal-radial":function(e,t,n,r){var o=Math.cos(e),s=Math.sin(e),u=Math.cos(n),l=Math.sin(n);return"M"+t*o+","+t*s+"A"+t+","+t+" 0 0,"+((Math.abs(n-e)>Math.PI?n<=e:n>e)?1:0)+" "+t*u+","+t*l+"L"+r*u+","+r*l},"diagonal-horizontal":function(e,t,n,r){var o=(e+n)/2;return"M"+e+","+t+"C"+o+","+t+" "+o+","+r+" "+n+","+r},"diagonal-vertical":function(e,t,n,r){var o=(t+r)/2;return"M"+e+","+t+"C"+e+","+o+" "+n+","+o+" "+n+","+r},"diagonal-radial":function(e,t,n,r){var o=Math.cos(e),s=Math.sin(e),u=Math.cos(n),l=Math.sin(n),c=(t+r)/2;return"M"+t*o+","+t*s+"C"+c*o+","+c*s+" "+c*u+","+c*l+" "+r*u+","+r*l}});function ng(e){return e.source.x}function rg(e){return e.source.y}function ig(e){return e.target.x}function ag(e){return e.target.y}function og(e){ur.call(this,{},e)}function sg(e,t,n,r){return"M"+e+","+t+"L"+n+","+r}function ug(e,t,n,r){var o=n-e,s=r-t,u=Math.sqrt(o*o+s*s)/2;return"M"+e+","+t+"A"+u+","+u+" "+180*Math.atan2(s,o)/Math.PI+" 0 1 "+n+","+r}function lg(e,t,n,r){var o=n-e,s=r-t,u=.2*(o+s),l=.2*(s-o);return"M"+e+","+t+"C"+(e+u)+","+(t+l)+" "+(n+l)+","+(r-u)+" "+n+","+r}function cg(e){ur.call(this,null,e)}og.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"as",type:"string",default:"path"}]},Object(v.inherits)(og,ur).transform=function(e,t){var n=e.sourceX||ng,r=e.sourceY||rg,o=e.targetX||ig,s=e.targetY||ag,u=e.as||"path",l=e.shape||"line",c=tg.get(l+"-"+(e.orient||"vertical"))||tg.get(l);return c||Object(v.error)("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,function(e){e[u]=c(n(e),r(e),o(e),s(e))}),t.reflow(e.modified()).modifies(u)},cg.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},Object(v.inherits)(cg,ur).transform=function(e,t){var i,n,r,o=e.as||["startAngle","endAngle"],s=o[0],u=o[1],l=e.startAngle||0,c=null!=e.endAngle?e.endAngle:2*Math.PI,d=t.source,h=d.map(e.field||v.one),p=h.length,a=l,k=(c-l)/function(e,t){for(var value,n=e.length,i=-1,sum=0;++i<n;)(value=+e[i])&&(sum+=value);return sum}(h),g=Ir(p);for(e.sort&&g.sort(function(a,b){return h[a]-h[b]}),i=0;i<p;++i)r=h[g[i]],(n=d[g[i]])[s]=a,n[u]=a+=r*k;return this.value=h,t.reflow(e.modified()).modifies(o)};var fg=Object(v.toSet)(["linear","pow","sqrt"]),dg=Object(v.toSet)(["linear",sc,"pow","sqrt","time","utc"]),hg=Object(v.toSet)(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","nice","zero","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function pg(e){ur.call(this,null,e),this.modified(!0)}function gg(e,t,n){return Object(v.isFunction)(e)&&(t||n)?Ip(e,mg(t||[0,1],n)):e}function mg(e,t){return t?e.slice().reverse():e}function vg(e){ur.call(this,null,e)}function yg(e){ur.call(this,null,e)}function bg(e,t,n,r,o){for(var s,u=(t-e.sum)/2,l=e.length,j=0;j<l;++j)(s=e[j])[r]=u,s[o]=u+=Math.abs(n(s))}function xg(e,t,n,r,o){for(var s,u=1/e.sum,l=0,c=e.length,j=0,d=0;j<c;++j)(s=e[j])[r]=l,s[o]=l=u*(d+=Math.abs(n(s)))}function _g(e,t,n,r,o){for(var s,u,l=0,c=0,d=e.length,j=0;j<d;++j)(s=n(u=e[j]))<0?(u[r]=c,u[o]=c+=s):(u[r]=l,u[o]=l+=s)}Object(v.inherits)(pg,ur).transform=function(e,t){var n,r=t.dataflow,o=this.value;for(n in o&&!e.modified("type")||(this.value=o=$d((e.type||"linear").toLowerCase())()),e)if(!hg[n]){if("padding"===n&&dg[o.type])continue;Object(v.isFunction)(o[n])?o[n](e[n]):r.warn("Unsupported scale property: "+n)}return function(e,t,n){var r=t.round||!1,o=t.range;if(null!=t.rangeStep)o=function(e,t,n){return"band"!==e&&"point"!==e&&Object(v.error)("Only band and point scales support rangeStep."),[0,t.rangeStep*cc(n,"point"===e?1:(null!=t.paddingInner?t.paddingInner:t.padding)||0,(null!=t.paddingOuter?t.paddingOuter:t.padding)||0)]}(e.type,t,n);else if(t.scheme){if(o=function(e,t,n){var r,o=t.scheme.toLowerCase(),s=Rp(o),u=t.schemeExtent;return s||Object(v.error)("Unrecognized scheme name: "+t.scheme),n="threshold"===e?n+1:"bin-ordinal"===e?n-1:"quantile"===e||"quantize"===e?+t.schemeCount||5:n,"sequential"===e?gg(s,u,t.reverse):!u&&(r=Rp(o+"-"+n))?r:Object(v.isFunction)(s)?function(e,t){for(var n=new Array(t),r=t-1||1,i=0;i<t;++i)n[i]=e(i/r);return n}(gg(s,u),n):"ordinal"===e?s:s.slice(0,n)}(e.type,t,n),Object(v.isFunction)(o))return e.interpolator(o)}else if(o&&"sequential"===e.type)return e.interpolator(kf(mg(o,t.reverse)));o&&t.interpolate&&e.interpolate?e.interpolate(zp(t.interpolate,t.interpolateGamma)):Object(v.isFunction)(e.round)?e.round(r):Object(v.isFunction)(e.rangeRound)&&e.interpolate(r?zf:Lf),o&&e.range(mg(o,t.reverse))}(o,e,function(e,t,n){var r=function(e,t){return t?(e.domain(t),t.length):-1}(e,t.domainRaw);if(r>-1)return r;var o,s,u=t.domain,l=e.type,c=t.zero||void 0===t.zero&&fg[l];return u?(dg[l]&&t.padding&&u[0]!==Object(v.peek)(u)&&(u=function(e,t,n,r,o){var s=Math.abs(Object(v.peek)(n)-n[0]),u=s/(s-2*r),l=e===sc?Object(v.zoomLog)(t,null,u):"sqrt"===e?Object(v.zoomPow)(t,null,u,.5):"pow"===e?Object(v.zoomPow)(t,null,u,o):Object(v.zoomLinear)(t,null,u);return(t=t.slice())[0]=l[0],t[t.length-1]=l[1],t}(l,u,t.range,t.padding,t.exponent)),(c||null!=t.domainMin||null!=t.domainMax||null!=t.domainMid)&&(o=(u=u.slice()).length-1||1,c&&(u[0]>0&&(u[0]=0),u[o]<0&&(u[o]=0)),null!=t.domainMin&&(u[0]=t.domainMin),null!=t.domainMax&&(u[o]=t.domainMax),null!=t.domainMid&&(((s=t.domainMid)<u[0]||s>u[o])&&n.warn("Scale domainMid exceeds domain min or max.",s),u.splice(o,0,s))),e.domain(u),"ordinal"===l&&e.unknown(void 0),t.nice&&e.nice&&e.nice(!0!==t.nice&&Vp(e,t.nice)||null),u.length):0}(o,e,r)),t.fork(t.NO_SOURCE|t.NO_FIELDS)},Object(v.inherits)(vg,ur).transform=function(e,t){var n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(e.sort),this.modified(n),t},yg.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:"zero",values:["zero","center","normalize"]},{name:"as",type:"string",array:!0,length:2,default:["y0","y1"]}]},Object(v.inherits)(yg,ur).transform=function(e,t){var n,i,r,o,s=e.as||["y0","y1"],u=s[0],l=s[1],c=e.field||v.one,d="center"===e.offset?bg:"normalize"===e.offset?xg:_g;for(n=function(e,t,n,r){var o,i,s,u,l,k,c,d,h,p=[],g=function(f){return f(l)};if(null==t)p.push(e.slice());else for(o={},i=0,s=e.length;i<s;++i)l=e[i],(c=o[k=t.map(g)])||(o[k]=c=[],p.push(c)),c.push(l);for(k=0,h=0,u=p.length;k<u;++k){for(i=0,d=0,s=(c=p[k]).length;i<s;++i)d+=Math.abs(r(c[i]));c.sum=d,d>h&&(h=d),n&&c.sort(n)}return p.max=h,p}(t.source,e.groupby,e.sort,c),i=0,r=n.length,o=n.max;i<r;++i)d(n[i],o,c,u,l);return t.reflow(e.modified()).modifies(s)};var wg=Array.prototype.slice,Eg=function(a,b){return a-b},Og=function(e){for(var i=0,t=e.length,n=e[t-1][1]*e[0][0]-e[t-1][0]*e[0][1];++i<t;)n+=e[i-1][1]*e[i][0]-e[i-1][0]*e[i][1];return n},Sg=function(x){return function(){return x}},Ag=function(e,t){for(var n,i=-1,r=t.length;++i<r;)if(n=kg(e,t[i]))return n;return 0};function kg(e,t){for(var x=t[0],y=t[1],n=-1,i=0,r=e.length,j=r-1;i<r;j=i++){var o=e[i],s=o[0],u=o[1],l=e[j],c=l[0],d=l[1];if(Tg(o,l,t))return 0;u>y!=d>y&&x<(c-s)*(y-u)/(d-u)+s&&(n=-n)}return n}function Tg(a,b,e){var i,t,n,r;return function(a,b,e){return(b[0]-a[0])*(e[1]-a[1])==(e[0]-a[0])*(b[1]-a[1])}(a,b,e)&&(t=a[i=+(a[0]===b[0])],r=b[i],t<=(n=e[i])&&n<=r||r<=n&&n<=t)}var Ng=function(){},Mg=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]],Cg=function(){var e=1,t=1,n=Br,r=l;function o(e){var t=n(e);if(Array.isArray(t))t=t.slice().sort(Eg);else{var r=Rr(e),o=r[0],u=r[1];t=Ur(o,u,t),t=Ir(Math.floor(o/t)*t,Math.floor(u/t)*t,t)}return t.map(function(value){return s(e,value)})}function s(n,value){var o=[],s=[];return function(n,value,r){var x,y,o,s,l,c=new Array,d=new Array;for(x=y=-1,Mg[(o=n[0]>=value)<<1].forEach(h);++x<e-1;)Mg[o|(o=n[x+1]>=value)<<1].forEach(h);for(Mg[o<<0].forEach(h);++y<t-1;){for(x=-1,Mg[(o=n[y*e+e]>=value)<<1|(s=n[y*e]>=value)<<2].forEach(h);++x<e-1;)l=s,Mg[o|(o=n[y*e+e+x+1]>=value)<<1|(s=n[y*e+x+1]>=value)<<2|l<<3].forEach(h);Mg[o|s<<3].forEach(h)}for(x=-1,Mg[(s=n[y*e]>=value)<<2].forEach(h);++x<e-1;)l=s,Mg[(s=n[y*e+x+1]>=value)<<2|l<<3].forEach(h);function h(e){var f,t,n=[e[0][0]+x,e[0][1]+y],o=[e[1][0]+x,e[1][1]+y],s=u(n),l=u(o);(f=d[s])?(t=c[l])?(delete d[f.end],delete c[t.start],f===t?(f.ring.push(o),r(f.ring)):c[f.start]=d[t.end]={start:f.start,end:t.end,ring:f.ring.concat(t.ring)}):(delete d[f.end],f.ring.push(o),d[f.end=l]=f):(f=c[l])?(t=d[s])?(delete c[f.start],delete d[t.end],f===t?(f.ring.push(o),r(f.ring)):c[t.start]=d[f.end]={start:t.start,end:f.end,ring:t.ring.concat(f.ring)}):(delete c[f.start],f.ring.unshift(n),c[f.start=s]=f):c[s]=d[l]={start:s,end:l,ring:[n,o]}}Mg[s<<3].forEach(h)}(n,value,function(e){r(e,n,value),Og(e)>0?o.push([e]):s.push(e)}),s.forEach(function(e){for(var t,i=0,n=o.length;i<n;++i)if(-1!==Ag((t=o[i])[0],e))return void t.push(e)}),{type:"MultiPolygon",value:value,coordinates:o}}function u(t){return 2*t[0]+t[1]*(e+1)*4}function l(n,r,value){n.forEach(function(n){var o,x=n[0],y=n[1],s=0|x,u=0|y,l=r[u*e+s];x>0&&x<e&&s===x&&(n[0]=x+(value-(o=r[u*e+s-1]))/(l-o)-.5),y>0&&y<t&&u===y&&(n[1]=y+(value-(o=r[(u-1)*e+s]))/(l-o)-.5)})}return o.contour=s,o.size=function(n){if(!arguments.length)return[e,t];var r=Math.ceil(n[0]),s=Math.ceil(n[1]);if(!(r>0&&s>0))throw new Error("invalid size");return e=r,t=s,o},o.thresholds=function(e){return arguments.length?(n="function"==typeof e?e:Array.isArray(e)?Sg(wg.call(e)):Sg(e),o):n},o.smooth=function(e){return arguments.length?(r=e?l:Ng,o):r===l},o};function Dg(e,t,n){for(var r=e.width,o=e.height,s=1+(n<<1),j=0;j<o;++j)for(var i=0,u=0;i<r+n;++i)i<r&&(u+=e.data[i+j*r]),i>=n&&(i>=s&&(u-=e.data[i-s+j*r]),t.data[i-n+j*r]=u/Math.min(i+1,r-1+s-i,s))}function Rg(e,t,n){for(var r=e.width,o=e.height,s=1+(n<<1),i=0;i<r;++i)for(var j=0,u=0;j<o+n;++j)j<o&&(u+=e.data[i+j*r]),j>=n&&(j>=s&&(u-=e.data[i+(j-s)*r]),t.data[i+(j-n)*r]=u/Math.min(j+1,o-1+s-j,s))}function Ig(e){return e[0]}function Pg(e){return e[1]}var Lg=["values","size"],zg=["x","y","size","cellSize","bandwidth"];function jg(e){ur.call(this,null,e)}function Fg(e){ur.call(this,null,e)}jg.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"number",default:!1},{name:"thresholds",type:"number",array:!0}]},Object(v.inherits)(jg,ur).transform=function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,r,o,k,s=t.fork(t.NO_SOURCE|t.NO_FIELDS),u=e.count||10;return e.values?(n=Cg(),r=Lg,o=e.values):(n=function(){var x=Ig,y=Pg,e=960,t=500,n=20,k=2,r=3*n,o=e+2*r>>k,s=t+2*r>>k,u=Sg(20);function l(e){var t=new Float32Array(o*s),l=new Float32Array(o*s);e.forEach(function(e,i,n){var u=x(e,i,n)+r>>k,l=y(e,i,n)+r>>k;u>=0&&u<o&&l>=0&&l<s&&++t[u+l*o]}),Dg({width:o,height:s,data:t},{width:o,height:s,data:l},n>>k),Rg({width:o,height:s,data:l},{width:o,height:s,data:t},n>>k),Dg({width:o,height:s,data:t},{width:o,height:s,data:l},n>>k),Rg({width:o,height:s,data:l},{width:o,height:s,data:t},n>>k),Dg({width:o,height:s,data:t},{width:o,height:s,data:l},n>>k),Rg({width:o,height:s,data:l},{width:o,height:s,data:t},n>>k);var d=u(t);if(!Array.isArray(d)){var h=qr(t);d=Ur(0,h,d),(d=Ir(0,Math.floor(h/d)*d,d)).shift()}return Cg().thresholds(d).size([o,s])(t).map(c)}function c(e){return e.value*=Math.pow(2,-2*k),e.coordinates.forEach(d),e}function d(e){e.forEach(h)}function h(e){e.forEach(p)}function p(e){e[0]=e[0]*Math.pow(2,k)-r,e[1]=e[1]*Math.pow(2,k)-r}function g(){return o=e+2*(r=3*n)>>k,s=t+2*r>>k,l}return l.x=function(e){return arguments.length?(x="function"==typeof e?e:Sg(+e),l):x},l.y=function(e){return arguments.length?(y="function"==typeof e?e:Sg(+e),l):y},l.size=function(n){if(!arguments.length)return[e,t];var r=Math.ceil(n[0]),o=Math.ceil(n[1]);if(!(r>=0||r>=0))throw new Error("invalid size");return e=r,t=o,g()},l.cellSize=function(e){if(!arguments.length)return 1<<k;if(!((e=+e)>=1))throw new Error("invalid cell size");return k=Math.floor(Math.log(e)/Math.LN2),g()},l.thresholds=function(e){return arguments.length?(u="function"==typeof e?e:Array.isArray(e)?Sg(wg.call(e)):Sg(e),l):u},l.bandwidth=function(e){if(!arguments.length)return Math.sqrt(n*(n+1));if(!((e=+e)>=0))throw new Error("invalid bandwidth");return n=Math.round((Math.sqrt(4*e*e+1)-1)/2),g()},l}(),r=zg,o=t.materialize(t.SOURCE).source),n.thresholds(e.thresholds||(e.nice?u:(k=u,function(e){for(var t=Rr(e),n=t[0],r=t[1]-n,o=[],i=1;i<=k;++i)o.push(n+r*i/(k+1));return o}))),r.forEach(function(t){null!=e[t]&&n[t](e[t])}),this.value&&(s.rem=this.value),o=o&&o.length?n(o).map(T):[],this.value=s.source=s.add=o,s},Fg.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},Object(v.inherits)(Fg,ur).transform=function(e,t){var n,r=this._features,o=this._points,s=e.fields,u=s&&s[0],l=s&&s[1],c=e.geojson,d=t.ADD;n=e.modified()||t.changed(t.REM)||t.modified(Object(v.accessorFields)(c))||u&&t.modified(Object(v.accessorFields)(u))||l&&t.modified(Object(v.accessorFields)(l)),this.value&&!n||(d=t.SOURCE,this._features=r=[],this._points=o=[]),c&&t.visit(d,function(e){r.push(c(e))}),u&&l&&(t.visit(d,function(e){var x=u(e),y=l(e);null!=x&&null!=y&&(x=+x)===x&&(y=+y)===y&&o.push([x,y])}),r=r.concat({type:"Feature",geometry:{type:"MultiPoint",coordinates:o}})),this.value={type:"FeatureCollection",features:r}};var Ug=function(){return new Bg};function Bg(){this.reset()}Bg.prototype={constructor:Bg,reset:function(){this.s=this.t=0},add:function(y){qg(Vg,y,this.t),qg(this,Vg.s,this.s),this.s?this.t+=Vg.t:this.s=Vg.t},valueOf:function(){return this.s}};var Vg=new Bg;function qg(e,a,b){var x=e.s=a+b,t=x-a;e.t=a-(x-t)+(b-t)}var Gg=1e-6,Wg=Math.PI,Hg=Wg/2,Xg=Wg/4,Yg=2*Wg,Kg=180/Wg,Jg=Wg/180,Zg=Math.abs,Qg=Math.atan,$g=Math.atan2,em=Math.cos,tm=Math.ceil,nm=Math.exp,rm=(Math,Math.log),im=Math.pow,am=Math.sin,om=Math.sign||function(x){return x>0?1:x<0?-1:0},sm=Math.sqrt,um=Math.tan;function lm(x){return x>1?0:x<-1?Wg:Math.acos(x)}function cm(x){return x>1?Hg:x<-1?-Hg:Math.asin(x)}function fm(){}function dm(e,t){e&&pm.hasOwnProperty(e.type)&&pm[e.type](e,t)}var hm={Feature:function(e,t){dm(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)dm(n[i].geometry,t)}},pm={Sphere:function(e,t){t.sphere()},Point:function(e,t){t.point((e=e.coordinates)[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)t.point((e=n[i])[0],e[1],e[2])},LineString:function(e,t){gm(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)gm(n[i],t,0)},Polygon:function(e,t){mm(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)mm(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)dm(n[i],t)}};function gm(e,t,n){var r,i=-1,o=e.length-n;for(t.lineStart();++i<o;)t.point((r=e[i])[0],r[1],r[2]);t.lineEnd()}function mm(e,t){var i=-1,n=e.length;for(t.polygonStart();++i<n;)gm(e[i],t,1);t.polygonEnd()}var vm,ym,bm,xm,_m,wm=function(e,t){e&&hm.hasOwnProperty(e.type)?hm[e.type](e,t):dm(e,t)},Em=Ug(),Om=Ug(),Sm={point:fm,lineStart:fm,lineEnd:fm,polygonStart:function(){Em.reset(),Sm.lineStart=Am,Sm.lineEnd=km},polygonEnd:function(){var e=+Em;Om.add(e<0?Yg+e:e),this.lineStart=this.lineEnd=this.point=fm},sphere:function(){Om.add(Yg)}};function Am(){Sm.point=Tm}function km(){Nm(vm,ym)}function Tm(e,t){Sm.point=Nm,vm=e,ym=t,bm=e*=Jg,xm=em(t=(t*=Jg)/2+Xg),_m=am(t)}function Nm(e,t){t=(t*=Jg)/2+Xg;var n=(e*=Jg)-bm,r=n>=0?1:-1,o=r*n,s=em(t),u=am(t),k=_m*u,l=xm*s+k*em(o),c=k*r*am(o);Em.add($g(c,l)),bm=e,xm=s,_m=u}function Mm(e){return[$g(e[1],e[0]),cm(e[2])]}function Cm(e){var t=e[0],n=e[1],r=em(n);return[r*em(t),r*am(t),am(n)]}function Dm(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function Rm(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function Im(a,b){a[0]+=b[0],a[1]+=b[1],a[2]+=b[2]}function Pm(e,k){return[e[0]*k,e[1]*k,e[2]*k]}function Lm(e){var t=sm(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var zm,jm,Fm,Um,Bm,Vm,qm,Gm,Wm,Hm,Xm=Ug(),Ym={point:Km,lineStart:Zm,lineEnd:Qm,polygonStart:function(){Ym.point=$m,Ym.lineStart=ev,Ym.lineEnd=tv,Xm.reset(),Sm.polygonStart()},polygonEnd:function(){Sm.polygonEnd(),Ym.point=Km,Ym.lineStart=Zm,Ym.lineEnd=Qm,Em<0?(zm=-(Fm=180),jm=-(Um=90)):Xm>Gg?Um=90:Xm<-Gg&&(jm=-90),Hm[0]=zm,Hm[1]=Fm}};function Km(e,t){Wm.push(Hm=[zm=e,Fm=e]),t<jm&&(jm=t),t>Um&&(Um=t)}function Jm(e,t){var n=Cm([e*Jg,t*Jg]);if(Gm){var r=Rm(Gm,n),o=Rm([r[1],-r[0],0],r);Lm(o),o=Mm(o);var s,u=e-Bm,l=u>0?1:-1,c=o[0]*Kg*l,d=Zg(u)>180;d^(l*Bm<c&&c<l*e)?(s=o[1]*Kg)>Um&&(Um=s):d^(l*Bm<(c=(c+360)%360-180)&&c<l*e)?(s=-o[1]*Kg)<jm&&(jm=s):(t<jm&&(jm=t),t>Um&&(Um=t)),d?e<Bm?nv(zm,e)>nv(zm,Fm)&&(Fm=e):nv(e,Fm)>nv(zm,Fm)&&(zm=e):Fm>=zm?(e<zm&&(zm=e),e>Fm&&(Fm=e)):e>Bm?nv(zm,e)>nv(zm,Fm)&&(Fm=e):nv(e,Fm)>nv(zm,Fm)&&(zm=e)}else Wm.push(Hm=[zm=e,Fm=e]);t<jm&&(jm=t),t>Um&&(Um=t),Gm=n,Bm=e}function Zm(){Ym.point=Jm}function Qm(){Hm[0]=zm,Hm[1]=Fm,Ym.point=Km,Gm=null}function $m(e,t){if(Gm){var n=e-Bm;Xm.add(Zg(n)>180?n+(n>0?360:-360):n)}else Vm=e,qm=t;Sm.point(e,t),Jm(e,t)}function ev(){Sm.lineStart()}function tv(){$m(Vm,qm),Sm.lineEnd(),Zg(Xm)>Gg&&(zm=-(Fm=180)),Hm[0]=zm,Hm[1]=Fm,Gm=null}function nv(e,t){return(t-=e)<0?t+360:t}function rv(a,b){return a[0]-b[0]}function iv(e,x){return e[0]<=e[1]?e[0]<=x&&x<=e[1]:x<e[0]||e[1]<x}var av,ov,sv,uv,lv,cv,fv,dv,hv,pv,gv,mv,vv,yv,bv,xv,_v={sphere:fm,point:wv,lineStart:Ov,lineEnd:kv,polygonStart:function(){_v.lineStart=Tv,_v.lineEnd=Nv},polygonEnd:function(){_v.lineStart=Ov,_v.lineEnd=kv}};function wv(e,t){e*=Jg;var n=em(t*=Jg);Ev(n*em(e),n*am(e),am(t))}function Ev(x,y,e){sv+=(x-sv)/++av,uv+=(y-uv)/av,lv+=(e-lv)/av}function Ov(){_v.point=Sv}function Sv(e,t){e*=Jg;var n=em(t*=Jg);yv=n*em(e),bv=n*am(e),xv=am(t),_v.point=Av,Ev(yv,bv,xv)}function Av(e,t){e*=Jg;var n=em(t*=Jg),x=n*em(e),y=n*am(e),r=am(t),o=$g(sm((o=bv*r-xv*y)*o+(o=xv*x-yv*r)*o+(o=yv*y-bv*x)*o),yv*x+bv*y+xv*r);ov+=o,cv+=o*(yv+(yv=x)),fv+=o*(bv+(bv=y)),dv+=o*(xv+(xv=r)),Ev(yv,bv,xv)}function kv(){_v.point=wv}function Tv(){_v.point=Mv}function Nv(){Cv(mv,vv),_v.point=wv}function Mv(e,t){mv=e,vv=t,e*=Jg,t*=Jg,_v.point=Cv;var n=em(t);yv=n*em(e),bv=n*am(e),xv=am(t),Ev(yv,bv,xv)}function Cv(e,t){e*=Jg;var n=em(t*=Jg),x=n*em(e),y=n*am(e),r=am(t),o=bv*r-xv*y,s=xv*x-yv*r,u=yv*y-bv*x,l=sm(o*o+s*s+u*u),c=cm(l),d=l&&-c/l;hv+=d*o,pv+=d*s,gv+=d*u,ov+=c,cv+=c*(yv+(yv=x)),fv+=c*(bv+(bv=y)),dv+=c*(xv+(xv=r)),Ev(yv,bv,xv)}var Dv=function(a,b){function e(x,y){return x=a(x,y),b(x[0],x[1])}return a.invert&&b.invert&&(e.invert=function(x,y){return(x=b.invert(x,y))&&a.invert(x[0],x[1])}),e};function Rv(e,t){return[e>Wg?e-Yg:e<-Wg?e+Yg:e,t]}function Iv(e,t,n){return(e%=Yg)?t||n?Dv(Lv(e),zv(t,n)):Lv(e):t||n?zv(t,n):Rv}function Pv(e){return function(t,n){return[(t+=e)>Wg?t-Yg:t<-Wg?t+Yg:t,n]}}function Lv(e){var t=Pv(e);return t.invert=Pv(-e),t}function zv(e,t){var n=em(e),r=am(e),o=em(t),s=am(t);function u(e,t){var u=em(t),x=em(e)*u,y=am(e)*u,l=am(t),k=l*n+x*r;return[$g(y*o-k*s,x*n-l*r),cm(k*o+y*s)]}return u.invert=function(e,t){var u=em(t),x=em(e)*u,y=am(e)*u,l=am(t),k=l*o-y*s;return[$g(y*o+l*s,x*n+k*r),cm(k*n-x*r)]},u}Rv.invert=Rv;var jv=function(e){function t(t){return(t=e(t[0]*Jg,t[1]*Jg))[0]*=Kg,t[1]*=Kg,t}return e=Iv(e[0]*Jg,e[1]*Jg,e.length>2?e[2]*Jg:0),t.invert=function(t){return(t=e.invert(t[0]*Jg,t[1]*Jg))[0]*=Kg,t[1]*=Kg,t},t};function Fv(e,t){(t=Cm(t))[0]-=e,Lm(t);var radius=lm(-t[1]);return((-t[2]<0?-radius:radius)+Yg-Gg)%Yg}var Uv=function(){var e,t=[];return{point:function(x,y){e.push([x,y])},lineStart:function(){t.push(e=[])},lineEnd:fm,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}},Bv=function(a,b){return Zg(a[0]-b[0])<Gg&&Zg(a[1]-b[1])<Gg};function Vv(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var qv=function(e,t,n,r,o){var i,s,u=[],l=[];if(e.forEach(function(e){if(!((t=e.length-1)<=0)){var t,x,n=e[0],r=e[t];if(Bv(n,r)){for(o.lineStart(),i=0;i<t;++i)o.point((n=e[i])[0],n[1]);o.lineEnd()}else u.push(x=new Vv(n,e,null,!0)),l.push(x.o=new Vv(n,null,x,!1)),u.push(x=new Vv(r,e,null,!1)),l.push(x.o=new Vv(r,null,x,!0))}}),u.length){for(l.sort(t),Gv(u),Gv(l),i=0,s=l.length;i<s;++i)l[i].e=n=!n;for(var c,d,h=u[0];;){for(var p=h,g=!0;p.v;)if((p=p.n)===h)return;c=p.z,o.lineStart();do{if(p.v=p.o.v=!0,p.e){if(g)for(i=0,s=c.length;i<s;++i)o.point((d=c[i])[0],d[1]);else r(p.x,p.n.x,1,o);p=p.n}else{if(g)for(i=(c=p.p.z).length-1;i>=0;--i)o.point((d=c[i])[0],d[1]);else r(p.x,p.p.x,-1,o);p=p.p}c=(p=p.o).z,g=!g}while(!p.v);o.lineEnd()}}};function Gv(e){if(t=e.length){for(var t,b,i=0,a=e[0];++i<t;)a.n=b=e[i],b.p=a,a=b;a.n=b=e[0],b.p=a}}var Wv=Ug(),Hv=function(e,t,n,r){return function(o){var s,u,l,c=t(o),d=Uv(),h=t(d),p=!1,g={point:m,lineStart:_,lineEnd:w,polygonStart:function(){g.point=E,g.lineStart=O,g.lineEnd=S,u=[],s=[]},polygonEnd:function(){g.point=m,g.lineStart=_,g.lineEnd=w,u=Gr(u);var e=function(e,t){var n=r[0],o=r[1],s=am(o),u=[am(n),-em(n),0],l=0,c=0;Wv.reset(),1===s?o=Hg+Gg:-1===s&&(o=-Hg-Gg);for(var i=0,d=e.length;i<d;++i)if(p=(h=e[i]).length)for(var h,p,g=h[p-1],m=g[0],v=g[1]/2+Xg,_=am(v),w=em(v),j=0;j<p;++j,m=O,_=A,w=T,g=E){var E=h[j],O=E[0],S=E[1]/2+Xg,A=am(S),T=em(S),N=O-m,M=N>=0?1:-1,C=M*N,D=C>Wg,k=_*A;if(Wv.add($g(k*M*am(C),w*T+k*em(C))),l+=D?N+M*Yg:N,D^m>=n^O>=n){var R=Rm(Cm(g),Cm(E));Lm(R);var I=Rm(u,R);Lm(I);var P=(D^N>=0?-1:1)*cm(I[2]);(o>P||o===P&&(R[0]||R[1]))&&(c+=D^N>=0?1:-1)}}return(l<-Gg||l<Gg&&Wv<-Gg)^1&c}(s);u.length?(p||(o.polygonStart(),p=!0),qv(u,Yv,e,n,o)):e&&(p||(o.polygonStart(),p=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),p&&(o.polygonEnd(),p=!1),u=s=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function m(t,n){e(t,n)&&o.point(t,n)}function v(e,t){c.point(e,t)}function _(){g.point=v,c.lineStart()}function w(){g.point=m,c.lineEnd()}function E(e,t){l.push([e,t]),h.point(e,t)}function O(){h.lineStart(),l=[]}function S(){E(l[0][0],l[0][1]),h.lineEnd();var i,e,t,n,r=h.clean(),c=d.result(),g=c.length;if(l.pop(),s.push(l),l=null,g)if(1&r){if((e=(t=c[0]).length-1)>0){for(p||(o.polygonStart(),p=!0),o.lineStart(),i=0;i<e;++i)o.point((n=t[i])[0],n[1]);o.lineEnd()}}else g>1&&2&r&&c.push(c.pop().concat(c.shift())),u.push(c.filter(Xv))}return g}};function Xv(e){return e.length>1}function Yv(a,b){return((a=a.x)[0]<0?a[1]-Hg-Gg:Hg-a[1])-((b=b.x)[0]<0?b[1]-Hg-Gg:Hg-b[1])}var Kv=Hv(function(){return!0},function(e){var t,n=NaN,r=NaN,o=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(s,u){var l=s>0?Wg:-Wg,c=Zg(s-n);Zg(c-Wg)<Gg?(e.point(n,r=(r+u)/2>0?Hg:-Hg),e.point(o,r),e.lineEnd(),e.lineStart(),e.point(l,r),e.point(s,r),t=0):o!==l&&c>=Wg&&(Zg(n-o)<Gg&&(n-=o*Gg),Zg(s-l)<Gg&&(s-=l*Gg),r=function(e,t,n,r){var o,s,u=am(e-n);return Zg(u)>Gg?Qg((am(t)*(s=em(r))*am(n)-am(r)*(o=em(t))*am(e))/(o*s*u)):(t+r)/2}(n,r,s,u),e.point(o,r),e.lineEnd(),e.lineStart(),e.point(l,r),t=0),e.point(n=s,r=u),o=l},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}},function(e,t,n,r){var o;if(null==e)r.point(-Wg,o=n*Hg),r.point(0,o),r.point(Wg,o),r.point(Wg,0),r.point(Wg,-o),r.point(0,-o),r.point(-Wg,-o),r.point(-Wg,0),r.point(-Wg,o);else if(Zg(e[0]-t[0])>Gg){var s=e[0]<t[0]?Wg:-Wg;r.point(-s,o=n*s/2),r.point(0,o),r.point(s,o)}else r.point(t[0],t[1])},[-Wg,-Hg]),Jv=function(radius){var e=em(radius),t=6*Jg,n=e>0,r=Zg(e)>Gg;function o(t,n){return em(t)*em(n)>e}function s(a,b,t){var n=[1,0,0],r=Rm(Cm(a),Cm(b)),o=Dm(r,r),s=r[0],u=o-s*s;if(!u)return!t&&a;var l=e*o/u,c=-e*s/u,d=Rm(n,r),h=Pm(n,l);Im(h,Pm(r,c));var p=d,g=Dm(h,p),m=Dm(p,p),v=g*g-m*(Dm(h,h)-1);if(!(v<0)){var _=sm(v),w=Pm(p,(-g-_)/m);if(Im(w,h),w=Mm(w),!t)return w;var E,O=a[0],S=b[0],A=a[1],T=b[1];S<O&&(E=O,O=S,S=E);var N=S-O,M=Zg(N-Wg)<Gg;if(!M&&T<A&&(E=A,A=T,T=E),M||N<Gg?M?A+T>0^w[1]<(Zg(w[0]-O)<Gg?A:T):A<=w[1]&&w[1]<=T:N>Wg^(O<=w[0]&&w[0]<=S)){var C=Pm(p,(-g+_)/m);return Im(C,h),[w,Mm(C)]}}}function u(e,t){var r=n?radius:Wg-radius,o=0;return e<-r?o|=1:e>r&&(o|=2),t<-r?o|=4:t>r&&(o|=8),o}return Hv(o,function(e){var t,l,c,d,h;return{lineStart:function(){d=c=!1,h=1},point:function(p,g){var m,v=[p,g],_=o(p,g),w=n?_?0:u(p,g):_?u(p+(p<0?Wg:-Wg),g):0;if(!t&&(d=c=_)&&e.lineStart(),_!==c&&(!(m=s(t,v))||Bv(t,m)||Bv(v,m))&&(v[0]+=Gg,v[1]+=Gg,_=o(v[0],v[1])),_!==c)h=0,_?(e.lineStart(),m=s(v,t),e.point(m[0],m[1])):(m=s(t,v),e.point(m[0],m[1]),e.lineEnd()),t=m;else if(r&&t&&n^_){var E;w&l||!(E=s(v,t,!0))||(h=0,n?(e.lineStart(),e.point(E[0][0],E[0][1]),e.point(E[1][0],E[1][1]),e.lineEnd()):(e.point(E[1][0],E[1][1]),e.lineEnd(),e.lineStart(),e.point(E[0][0],E[0][1])))}!_||t&&Bv(t,v)||e.point(v[0],v[1]),t=v,c=_,l=w},lineEnd:function(){c&&e.lineEnd(),t=null},clean:function(){return h|(d&&c)<<1}}},function(e,n,r,o){!function(e,radius,t,n,r,o){if(t){var s=em(radius),u=am(radius),l=n*t;null==r?(r=radius+n*Yg,o=radius-l/2):(r=Fv(s,r),o=Fv(s,o),(n>0?r<o:r>o)&&(r+=n*Yg));for(var c,d=r;n>0?d>o:d<o;d-=l)c=Mm([s,-u*em(d),-u*am(d)]),e.point(c[0],c[1])}}(o,radius,t,r,e,n)},n?[0,-radius]:[-Wg,radius-Wg])},Zv=function(a,b,e,t,n,r){var o,s=a[0],u=a[1],l=0,c=1,d=b[0]-s,h=b[1]-u;if(o=e-s,d||!(o>0)){if(o/=d,d<0){if(o<l)return;o<c&&(c=o)}else if(d>0){if(o>c)return;o>l&&(l=o)}if(o=n-s,d||!(o<0)){if(o/=d,d<0){if(o>c)return;o>l&&(l=o)}else if(d>0){if(o<l)return;o<c&&(c=o)}if(o=t-u,h||!(o>0)){if(o/=h,h<0){if(o<l)return;o<c&&(c=o)}else if(h>0){if(o>c)return;o>l&&(l=o)}if(o=r-u,h||!(o<0)){if(o/=h,h<0){if(o>c)return;o>l&&(l=o)}else if(h>0){if(o<l)return;o<c&&(c=o)}return l>0&&(a[0]=s+l*d,a[1]=u+l*h),c<1&&(b[0]=s+c*d,b[1]=u+c*h),!0}}}}},Qv=1e9,$v=-Qv;function ey(e,t,n){var y=Ir(e,t-Gg,n).concat(t);return function(x){return y.map(function(y){return[x,y]})}}function ty(e,t,n){var x=Ir(e,t-Gg,n).concat(t);return function(y){return x.map(function(x){return[x,y]})}}Ug();var ny,ry,iy,ay,oy=function(x){return x},sy=Ug(),uy=Ug(),ly={point:fm,lineStart:fm,lineEnd:fm,polygonStart:function(){ly.lineStart=cy,ly.lineEnd=hy},polygonEnd:function(){ly.lineStart=ly.lineEnd=ly.point=fm,sy.add(Zg(uy)),uy.reset()},result:function(){var e=sy/2;return sy.reset(),e}};function cy(){ly.point=fy}function fy(x,y){ly.point=dy,ny=iy=x,ry=ay=y}function dy(x,y){uy.add(ay*x-iy*y),iy=x,ay=y}function hy(){dy(ny,ry)}var py,gy,my,vy,yy=ly,by=1/0,xy=by,_y=-by,wy=_y,Ey={point:function(x,y){x<by&&(by=x),x>_y&&(_y=x),y<xy&&(xy=y),y>wy&&(wy=y)},lineStart:fm,lineEnd:fm,polygonStart:fm,polygonEnd:fm,result:function(){var e=[[by,xy],[_y,wy]];return _y=wy=-(xy=by=1/0),e}},Oy=0,Sy=0,Ay=0,ky=0,Ty=0,Ny=0,My=0,Cy=0,Dy=0,Ry={point:Iy,lineStart:Py,lineEnd:jy,polygonStart:function(){Ry.lineStart=Fy,Ry.lineEnd=Uy},polygonEnd:function(){Ry.point=Iy,Ry.lineStart=Py,Ry.lineEnd=jy},result:function(){var e=Dy?[My/Dy,Cy/Dy]:Ny?[ky/Ny,Ty/Ny]:Ay?[Oy/Ay,Sy/Ay]:[NaN,NaN];return Oy=Sy=Ay=ky=Ty=Ny=My=Cy=Dy=0,e}};function Iy(x,y){Oy+=x,Sy+=y,++Ay}function Py(){Ry.point=Ly}function Ly(x,y){Ry.point=zy,Iy(my=x,vy=y)}function zy(x,y){var e=x-my,t=y-vy,n=sm(e*e+t*t);ky+=n*(my+x)/2,Ty+=n*(vy+y)/2,Ny+=n,Iy(my=x,vy=y)}function jy(){Ry.point=Iy}function Fy(){Ry.point=By}function Uy(){Vy(py,gy)}function By(x,y){Ry.point=Vy,Iy(py=my=x,gy=vy=y)}function Vy(x,y){var e=x-my,t=y-vy,n=sm(e*e+t*t);ky+=n*(my+x)/2,Ty+=n*(vy+y)/2,Ny+=n,My+=(n=vy*x-my*y)*(my+x),Cy+=n*(vy+y),Dy+=3*n,Iy(my=x,vy=y)}var qy=Ry;function Gy(e){this._context=e}Gy.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(x,y){switch(this._point){case 0:this._context.moveTo(x,y),this._point=1;break;case 1:this._context.lineTo(x,y);break;default:this._context.moveTo(x+this._radius,y),this._context.arc(x,y,this._radius,0,Yg)}},result:fm};var Wy,Hy,Xy,Yy,Ky,Jy=Ug(),Zy={point:fm,lineStart:function(){Zy.point=Qy},lineEnd:function(){Wy&&$y(Hy,Xy),Zy.point=fm},polygonStart:function(){Wy=!0},polygonEnd:function(){Wy=null},result:function(){var e=+Jy;return Jy.reset(),e}};function Qy(x,y){Zy.point=$y,Hy=Yy=x,Xy=Ky=y}function $y(x,y){Jy.add(sm((Yy-=x)*Yy+(Ky-=y)*Ky)),Yy=x,Ky=y}var eb=Zy;function tb(){this._string=[]}function nb(radius){return"m0,"+radius+"a"+radius+","+radius+" 0 1,1 0,"+-2*radius+"a"+radius+","+radius+" 0 1,1 0,"+2*radius+"z"}tb.prototype={_radius:4.5,_circle:nb(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(x,y){switch(this._point){case 0:this._string.push("M",x,",",y),this._point=1;break;case 1:this._string.push("L",x,",",y);break;default:null==this._circle&&(this._circle=nb(this._radius)),this._string.push("M",x,",",y,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}};var rb=function(e,t){var n,r,o=4.5;function s(e){return e&&("function"==typeof o&&r.pointRadius(+o.apply(this,arguments)),wm(e,n(r))),r.result()}return s.area=function(e){return wm(e,n(yy)),yy.result()},s.measure=function(e){return wm(e,n(eb)),eb.result()},s.bounds=function(e){return wm(e,n(Ey)),Ey.result()},s.centroid=function(e){return wm(e,n(qy)),qy.result()},s.projection=function(t){return arguments.length?(n=null==t?(e=null,oy):(e=t).stream,s):e},s.context=function(e){return arguments.length?(r=null==e?(t=null,new tb):new Gy(t=e),"function"!=typeof o&&r.pointRadius(o),s):t},s.pointRadius=function(e){return arguments.length?(o="function"==typeof e?e:(r.pointRadius(+e),+e),s):o},s.projection(e).context(t)};function ib(e){return function(t){var n=new ab;for(var r in e)n[r]=e[r];return n.stream=t,n}}function ab(){}function ob(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),wm(n,e.stream(Ey)),t(Ey.result()),null!=r&&e.clipExtent(r),e}function sb(e,t,n){return ob(e,function(b){var n=t[1][0]-t[0][0],r=t[1][1]-t[0][1],k=Math.min(n/(b[1][0]-b[0][0]),r/(b[1][1]-b[0][1])),x=+t[0][0]+(n-k*(b[1][0]+b[0][0]))/2,y=+t[0][1]+(r-k*(b[1][1]+b[0][1]))/2;e.scale(150*k).translate([x,y])},n)}function ub(e,t,n){return sb(e,[[0,0],t],n)}function lb(e,t,n){return ob(e,function(b){var n=+t,k=n/(b[1][0]-b[0][0]),x=(n-k*(b[1][0]+b[0][0]))/2,y=-k*b[0][1];e.scale(150*k).translate([x,y])},n)}function cb(e,t,n){return ob(e,function(b){var n=+t,k=n/(b[1][1]-b[0][1]),x=-k*b[0][0],y=(n-k*(b[1][1]+b[0][1]))/2;e.scale(150*k).translate([x,y])},n)}ab.prototype={constructor:ab,point:function(x,y){this.stream.point(x,y)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var fb=16,db=em(30*Jg),hb=function(e,t){return+t?function(e,t){function n(r,o,s,u,l,c,d,h,p,g,m,v,_,w){var E=d-r,O=h-o,S=E*E+O*O;if(S>4*t&&_--){var a=u+g,b=l+m,A=c+v,T=sm(a*a+b*b+A*A),N=cm(A/=T),M=Zg(Zg(A)-1)<Gg||Zg(s-p)<Gg?(s+p)/2:$g(b,a),C=e(M,N),D=C[0],R=C[1],I=D-r,P=R-o,L=O*I-E*P;(L*L/S>t||Zg((E*I+O*P)/S-.5)>.3||u*g+l*m+c*v<db)&&(n(r,o,s,u,l,c,D,R,M,a/=T,b/=T,A,_,w),w.point(D,R),n(D,R,M,a,b,A,d,h,p,g,m,v,_,w))}}return function(t){var r,o,s,u,l,c,d,h,p,g,m,v,_={point:w,lineStart:E,lineEnd:S,polygonStart:function(){t.polygonStart(),_.lineStart=A},polygonEnd:function(){t.polygonEnd(),_.lineStart=E}};function w(x,y){x=e(x,y),t.point(x[0],x[1])}function E(){h=NaN,_.point=O,t.lineStart()}function O(r,o){var s=Cm([r,o]),u=e(r,o);n(h,p,d,g,m,v,h=u[0],p=u[1],d=r,g=s[0],m=s[1],v=s[2],fb,t),t.point(h,p)}function S(){_.point=w,t.lineEnd()}function A(){E(),_.point=T,_.lineEnd=N}function T(e,t){O(r=e,t),o=h,s=p,u=g,l=m,c=v,_.point=O}function N(){n(h,p,d,g,m,v,o,s,r,u,l,c,fb,t),_.lineEnd=S,S()}return _}}(e,t):function(e){return ib({point:function(x,y){x=e(x,y),this.stream.point(x[0],x[1])}})}(e)},pb=ib({point:function(x,y){this.stream.point(x*Jg,y*Jg)}});function gb(k,e,t,n){var r=em(n),o=am(n),a=r*k,b=o*k,s=r/k,u=o/k,l=(o*t-r*e)/k,c=(o*e+r*t)/k;function d(x,y){return[a*x-b*y+e,t-b*x-a*y]}return d.invert=function(x,y){return[s*x-u*y+l,c-u*x-s*y]},d}function mb(e){return vb(function(){return e})()}function vb(e){var t,n,r,o,s,u,l,c,d,h,k=150,x=480,y=250,p=0,g=0,m=0,v=0,_=0,w=0,E=null,O=Kv,S=null,A=oy,T=.5;function N(e){return c(e[0]*Jg,e[1]*Jg)}function M(e){return(e=c.invert(e[0],e[1]))&&[e[0]*Kg,e[1]*Kg]}function C(){var e=gb(k,0,0,w).apply(null,t(p,g)),r=(w?gb:function(k,e,t){function n(x,y){return[e+k*x,t-k*y]}return n.invert=function(x,y){return[(x-e)/k,(t-y)/k]},n})(k,x-e[0],y-e[1],w);return n=Iv(m,v,_),l=Dv(t,r),c=Dv(n,l),u=hb(l,T),D()}function D(){return d=h=null,N}return N.stream=function(e){return d&&h===e?d:d=pb(function(e){return ib({point:function(x,y){var t=e(x,y);return this.stream.point(t[0],t[1])}})}(n)(O(u(A(h=e)))))},N.preclip=function(e){return arguments.length?(O=e,E=void 0,D()):O},N.postclip=function(e){return arguments.length?(A=e,S=r=o=s=null,D()):A},N.clipAngle=function(e){return arguments.length?(O=+e?Jv(E=e*Jg):(E=null,Kv),D()):E*Kg},N.clipExtent=function(e){return arguments.length?(A=null==e?(S=r=o=s=null,oy):function(e,t,n,r){function o(x,y){return e<=x&&x<=n&&t<=y&&y<=r}function s(o,s,l,d){var a=0,h=0;if(null==o||(a=u(o,l))!==(h=u(s,l))||c(o,s)<0^l>0)do{d.point(0===a||3===a?e:n,a>1?r:t)}while((a=(a+l+4)%4)!==h);else d.point(s[0],s[1])}function u(r,o){return Zg(r[0]-e)<Gg?o>0?0:3:Zg(r[0]-n)<Gg?o>0?2:1:Zg(r[1]-t)<Gg?o>0?1:0:o>0?3:2}function l(a,b){return c(a.x,b.x)}function c(a,b){var e=u(a,1),t=u(b,1);return e!==t?e-t:0===e?b[1]-a[1]:1===e?a[0]-b[0]:2===e?a[1]-b[1]:b[0]-a[0]}return function(u){var c,d,h,p,g,m,v,_,w,E,O,S=u,A=Uv(),T={point:N,lineStart:function(){T.point=M,d&&d.push(h=[]),E=!0,w=!1,v=_=NaN},lineEnd:function(){c&&(M(p,g),m&&w&&A.rejoin(),c.push(A.result())),T.point=N,w&&S.lineEnd()},polygonStart:function(){S=A,c=[],d=[],O=!0},polygonEnd:function(){var t=function(){for(var t=0,i=0,n=d.length;i<n;++i)for(var o,s,u=d[i],j=1,l=u.length,c=u[0],h=c[0],p=c[1];j<l;++j)o=h,s=p,h=(c=u[j])[0],p=c[1],s<=r?p>r&&(h-o)*(r-s)>(p-s)*(e-o)&&++t:p<=r&&(h-o)*(r-s)<(p-s)*(e-o)&&--t;return t}(),n=O&&t,o=(c=Gr(c)).length;(n||o)&&(u.polygonStart(),n&&(u.lineStart(),s(null,null,1,u),u.lineEnd()),o&&qv(c,l,t,s,u),u.polygonEnd()),S=u,c=d=h=null}};function N(x,y){o(x,y)&&S.point(x,y)}function M(x,y){var s=o(x,y);if(d&&h.push([x,y]),E)p=x,g=y,m=s,E=!1,s&&(S.lineStart(),S.point(x,y));else if(s&&w)S.point(x,y);else{var a=[v=Math.max($v,Math.min(Qv,v)),_=Math.max($v,Math.min(Qv,_))],b=[x=Math.max($v,Math.min(Qv,x)),y=Math.max($v,Math.min(Qv,y))];Zv(a,b,e,t,n,r)?(w||(S.lineStart(),S.point(a[0],a[1])),S.point(b[0],b[1]),s||S.lineEnd(),O=!1):s&&(S.lineStart(),S.point(x,y),O=!1)}v=x,_=y,w=s}return T}}(S=+e[0][0],r=+e[0][1],o=+e[1][0],s=+e[1][1]),D()):null==S?null:[[S,r],[o,s]]},N.scale=function(e){return arguments.length?(k=+e,C()):k},N.translate=function(e){return arguments.length?(x=+e[0],y=+e[1],C()):[x,y]},N.center=function(e){return arguments.length?(p=e[0]%360*Jg,g=e[1]%360*Jg,C()):[p*Kg,g*Kg]},N.rotate=function(e){return arguments.length?(m=e[0]%360*Jg,v=e[1]%360*Jg,_=e.length>2?e[2]%360*Jg:0,C()):[m*Kg,v*Kg,_*Kg]},N.angle=function(e){return arguments.length?(w=e%360*Jg,C()):w*Kg},N.precision=function(e){return arguments.length?(u=hb(l,T=e*e),D()):sm(T)},N.fitExtent=function(e,t){return sb(N,e,t)},N.fitSize=function(e,t){return ub(N,e,t)},N.fitWidth=function(e,t){return lb(N,e,t)},N.fitHeight=function(e,t){return cb(N,e,t)},function(){return t=e.apply(this,arguments),N.invert=t.invert&&M,C()}}function yb(e){var t=0,n=Wg/3,r=vb(e),o=r(t,n);return o.parallels=function(e){return arguments.length?r(t=e[0]*Jg,n=e[1]*Jg):[t*Kg,n*Kg]},o}function bb(e,t){var n=am(e),r=(n+am(t))/2;if(Zg(r)<Gg)return function(t){var n=em(e);function r(e,t){return[e*n,am(t)/n]}return r.invert=function(x,y){return[x/n,cm(y*n)]},r}();var o=1+n*(2*r-n),s=sm(o)/r;function u(x,y){var e=sm(o-2*r*am(y))/r;return[e*am(x*=r),s-e*em(x)]}return u.invert=function(x,y){var e=s-y;return[$g(x,Zg(e))/r*om(e),cm((o-(x*x+e*e)*r*r)/(2*r))]},u}var xb=function(){return yb(bb).scale(155.424).center([0,33.6442])},_b=function(){return xb().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};function wb(e){return function(x,y){var t=em(x),n=em(y),k=e(t*n);return[k*n*am(x),k*am(y)]}}function Eb(e){return function(x,y){var t=sm(x*x+y*y),n=e(t),r=am(n),o=em(n);return[$g(x*r,t*o),cm(t&&y*r/t)]}}var Ob=wb(function(e){return sm(2/(1+e))});Ob.invert=Eb(function(e){return 2*cm(e/2)});var Sb=wb(function(e){return(e=lm(e))&&e/am(e)});function Ab(e,t){return[e,rm(um((Hg+t)/2))]}function kb(e){var t,n,r,o=mb(e),s=o.center,u=o.scale,l=o.translate,c=o.clipExtent,d=null;function h(){var k=Wg*u(),s=o(jv(o.rotate()).invert([0,0]));return c(null==d?[[s[0]-k,s[1]-k],[s[0]+k,s[1]+k]]:e===Ab?[[Math.max(s[0]-k,d),t],[Math.min(s[0]+k,n),r]]:[[d,Math.max(s[1]-k,t)],[n,Math.min(s[1]+k,r)]])}return o.scale=function(e){return arguments.length?(u(e),h()):u()},o.translate=function(e){return arguments.length?(l(e),h()):l()},o.center=function(e){return arguments.length?(s(e),h()):s()},o.clipExtent=function(e){return arguments.length?(null==e?d=t=n=r=null:(d=+e[0][0],t=+e[0][1],n=+e[1][0],r=+e[1][1]),h()):null==d?null:[[d,t],[n,r]]},h()}function Tb(y){return um((Hg+y)/2)}function Nb(e,t){var n=em(e),r=e===t?am(e):rm(n/em(t))/rm(Tb(t)/Tb(e)),f=n*im(Tb(e),r)/r;if(!r)return Ab;function o(x,y){f>0?y<-Hg+Gg&&(y=-Hg+Gg):y>Hg-Gg&&(y=Hg-Gg);var e=f/im(Tb(y),r);return[e*am(r*x),f-e*em(r*x)]}return o.invert=function(x,y){var e=f-y,t=om(r)*sm(x*x+e*e);return[$g(x,Zg(e))/r*om(e),2*Qg(im(f/t,1/r))-Hg]},o}function Mb(e,t){return[e,t]}function Cb(e,t){var n=em(e),r=e===t?am(e):(n-em(t))/(t-e),o=n/r+e;if(Zg(r)<Gg)return Mb;function s(x,y){var e=o-y,t=r*x;return[e*am(t),o-e*em(t)]}return s.invert=function(x,y){var e=o-y;return[$g(x,Zg(e))/r*om(e),o-om(r)*sm(x*x+e*e)]},s}function Db(x,y){var e=em(y),k=em(x)*e;return[e*am(x)/k,am(y)/k]}function Rb(x,y){return[em(y)*am(x),am(y)]}function Ib(x,y){var e=em(y),k=1+em(x)*e;return[e*am(x)/k,am(y)/k]}function Pb(e,t){return[rm(um((Hg+t)/2)),-e]}Sb.invert=Eb(function(e){return e}),Ab.invert=function(x,y){return[x,2*Qg(nm(y))-Hg]},Mb.invert=Mb,Db.invert=Eb(Qg),Rb.invert=Eb(cm),Ib.invert=Eb(function(e){return 2*Qg(e)}),Pb.invert=function(x,y){return[-y,2*Qg(nm(x))-Hg]};var Lb=rb(),zb=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function jb(e,t){if(!e||"string"!=typeof e)throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(Ub[e]=function(e,t){return function n(){var r=t();return r.type=e,r.path=rb().projection(r),r.copy=r.copy||function(){var e=n();return zb.forEach(function(t){r.hasOwnProperty(t)&&e[t](r[t]())}),e.path.pointRadius(r.path.pointRadius()),e},r}}(e,t),this):Ub.hasOwnProperty(e)?Ub[e]:null}function Fb(e){return e&&e.path||Lb}var Ub={albers:_b,albersusa:function(){var e,t,n,r,o,s,u=_b(),l=xb().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=xb().rotate([157,0]).center([-3,19.9]).parallels([8,18]),d={point:function(x,y){s=[x,y]}};function h(e){var x=e[0],y=e[1];return s=null,n.point(x,y),s||(r.point(x,y),s)||(o.point(x,y),s)}function p(){return e=t=null,h}return h.invert=function(e){var k=u.scale(),t=u.translate(),x=(e[0]-t[0])/k,y=(e[1]-t[1])/k;return(y>=.12&&y<.234&&x>=-.425&&x<-.214?l:y>=.166&&y<.234&&x>=-.214&&x<-.115?c:u).invert(e)},h.stream=function(n){return e&&t===n?e:(r=[u.stream(t=n),l.stream(n),c.stream(n)],o=r.length,e={point:function(x,y){for(var i=-1;++i<o;)r[i].point(x,y)},sphere:function(){for(var i=-1;++i<o;)r[i].sphere()},lineStart:function(){for(var i=-1;++i<o;)r[i].lineStart()},lineEnd:function(){for(var i=-1;++i<o;)r[i].lineEnd()},polygonStart:function(){for(var i=-1;++i<o;)r[i].polygonStart()},polygonEnd:function(){for(var i=-1;++i<o;)r[i].polygonEnd()}});var r,o},h.precision=function(e){return arguments.length?(u.precision(e),l.precision(e),c.precision(e),p()):u.precision()},h.scale=function(e){return arguments.length?(u.scale(e),l.scale(.35*e),c.scale(e),h.translate(u.translate())):u.scale()},h.translate=function(e){if(!arguments.length)return u.translate();var k=u.scale(),x=+e[0],y=+e[1];return n=u.translate(e).clipExtent([[x-.455*k,y-.238*k],[x+.455*k,y+.238*k]]).stream(d),r=l.translate([x-.307*k,y+.201*k]).clipExtent([[x-.425*k+Gg,y+.12*k+Gg],[x-.214*k-Gg,y+.234*k-Gg]]).stream(d),o=c.translate([x-.205*k,y+.212*k]).clipExtent([[x-.214*k+Gg,y+.166*k+Gg],[x-.115*k-Gg,y+.234*k-Gg]]).stream(d),p()},h.fitExtent=function(e,t){return sb(h,e,t)},h.fitSize=function(e,t){return ub(h,e,t)},h.fitWidth=function(e,t){return lb(h,e,t)},h.fitHeight=function(e,t){return cb(h,e,t)},h.scale(1070)},azimuthalequalarea:function(){return mb(Ob).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return mb(Sb).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return yb(Nb).scale(109.5).parallels([30,30])},conicequalarea:xb,conicequidistant:function(){return yb(Cb).scale(131.154).center([0,13.9389])},equirectangular:function(){return mb(Mb).scale(152.63)},gnomonic:function(){return mb(Db).scale(144.049).clipAngle(60)},mercator:function(){return kb(Ab).scale(961/Yg)},orthographic:function(){return mb(Rb).scale(249.5).clipAngle(90+Gg)},stereographic:function(){return mb(Ib).scale(250).clipAngle(142)},transversemercator:function(){var e=kb(Pb),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):[(e=t())[1],-e[0]]},e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):[(e=n())[0],e[1],e[2]-90]},n([0,0,90]).scale(159.155)}};for(var Bb in Ub)jb(Bb,Ub[Bb]);function Vb(e){ur.call(this,null,e)}function qb(e){ur.call(this,null,e)}function Gb(e){ur.call(this,null,e)}function Wb(e){ur.call(this,[],e),this.generator=function(){var e,t,n,r,o,s,u,l,x,y,c,d,h=10,p=h,g=90,m=360,v=2.5;function _(){return{type:"MultiLineString",coordinates:w()}}function w(){return Ir(tm(r/g)*g,n,g).map(c).concat(Ir(tm(l/m)*m,u,m).map(d)).concat(Ir(tm(t/h)*h,e,h).filter(function(x){return Zg(x%g)>Gg}).map(x)).concat(Ir(tm(s/p)*p,o,p).filter(function(y){return Zg(y%m)>Gg}).map(y))}return _.lines=function(){return w().map(function(e){return{type:"LineString",coordinates:e}})},_.outline=function(){return{type:"Polygon",coordinates:[c(r).concat(d(u).slice(1),c(n).reverse().slice(1),d(l).reverse().slice(1))]}},_.extent=function(e){return arguments.length?_.extentMajor(e).extentMinor(e):_.extentMinor()},_.extentMajor=function(e){return arguments.length?(l=+e[0][1],u=+e[1][1],(r=+e[0][0])>(n=+e[1][0])&&(e=r,r=n,n=e),l>u&&(e=l,l=u,u=e),_.precision(v)):[[r,l],[n,u]]},_.extentMinor=function(n){return arguments.length?(s=+n[0][1],o=+n[1][1],(t=+n[0][0])>(e=+n[1][0])&&(n=t,t=e,e=n),s>o&&(n=s,s=o,o=n),_.precision(v)):[[t,s],[e,o]]},_.step=function(e){return arguments.length?_.stepMajor(e).stepMinor(e):_.stepMinor()},_.stepMajor=function(e){return arguments.length?(g=+e[0],m=+e[1],_):[g,m]},_.stepMinor=function(e){return arguments.length?(h=+e[0],p=+e[1],_):[h,p]},_.precision=function(h){return arguments.length?(v=+h,x=ey(s,o,90),y=ty(t,e,v),c=ey(l,u,90),d=ty(r,n,v),_):v},_.extentMajor([[-180,-90+Gg],[180,90-Gg]]).extentMinor([[-180,-80-Gg],[180,80+Gg]])}()}function Hb(e){ur.call(this,null,e),this.modified(!0)}function Xb(e,t,value){Object(v.isFunction)(e[t])&&e[t](value)}Vb.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},Object(v.inherits)(Vb,ur).transform=function(e,t){var n=t.fork(t.ALL),r=this.value,o=e.field||v.identity,s=e.as||"path",u=n.SOURCE;!r||e.modified()?(this.value=r=Fb(e.projection),n.materialize().reflow()):u=o===v.identity||t.modified(o.fields)?n.ADD_MOD:n.ADD;var l=function(e,t){var n=e.pointRadius();return e.context(null),null!=t&&e.pointRadius(t),n}(r,e.pointRadius);return n.visit(u,function(e){e[s]=r(o(e))}),r.pointRadius(l),n.modifies(s)},qb.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},Object(v.inherits)(qb,ur).transform=function(e,t){var n,r=e.projection,o=e.fields[0],s=e.fields[1],u=e.as||["x","y"],x=u[0],y=u[1];function l(e){var t=r([o(e),s(e)]);t?(e[x]=t[0],e[y]=t[1]):(e[x]=void 0,e[y]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(n=t.modified(o.fields)||t.modified(s.fields),t.visit(n?t.ADD_MOD:t.ADD,l)),t.modifies(u)},Gb.Definition={type:"GeoShape",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},Object(v.inherits)(Gb,ur).transform=function(e,t){var n=t.fork(t.ALL),r=this.value,o=e.field||Object(v.field)("datum"),s=e.as||"shape",u=n.ADD_MOD;return r&&!e.modified()||(this.value=r=function(e,t,n){var r=null==n?function(n){return e(t(n))}:function(r){var o=e.pointRadius(),value=e.pointRadius(n)(t(r));return e.pointRadius(o),value};return r.context=function(t){return e.context(t),r},r}(Fb(e.projection),o,e.pointRadius),n.materialize().reflow(),u=n.SOURCE),n.visit(u,function(e){e[s]=r}),n.modifies(s)},Wb.Definition={type:"Graticule",metadata:{source:!0,generates:!0,changes:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},Object(v.inherits)(Wb,ur).transform=function(e,t){var n,r=t.fork(),o=this.value,s=this.generator;if(!o.length||e.modified())for(var u in e)Object(v.isFunction)(s[u])&&s[u](e[u]);return n=s(),o.length?r.mod.push(C(o[0],n)):r.add.push(T(n)),o[0]=n,r.source=o,r},Object(v.inherits)(Hb,ur).transform=function(e,t){var n,r,o=this.value;return!o||e.modified("type")?(this.value=((r=jb(((n=e.type)||"mercator").toLowerCase()))||Object(v.error)("Unrecognized projection type: "+n),o=r()),zb.forEach(function(t){null!=e[t]&&Xb(o,t,e[t])})):zb.forEach(function(t){e.modified(t)&&Xb(o,t,e[t])}),null!=e.pointRadius&&o.path.pointRadius(e.pointRadius),e.fit&&function(e,t){var n,r=(n=t.fit,1===(n=Object(v.array)(n)).length?n[0]:{type:"FeatureCollection",features:n.reduce(function(e,f){return f&&"FeatureCollection"===f.type?e.push.apply(e,f.features):Object(v.isArray)(f)?e.push.apply(e,f):e.push(f),e},[])});t.extent?e.fitExtent(t.extent,r):t.size&&e.fitSize(t.size,r)}(o,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)};var Yb=function(x){return function(){return x}},Kb=function(){return 1e-6*(Math.random()-.5)};function Jb(e,x,y,t){if(isNaN(x)||isNaN(y))return e;var n,r,o,s,u,l,c,i,j,d=e._root,h={data:t},p=e._x0,g=e._y0,m=e._x1,v=e._y1;if(!d)return e._root=h,e;for(;d.length;)if((l=x>=(r=(p+m)/2))?p=r:m=r,(c=y>=(o=(g+v)/2))?g=o:v=o,n=d,!(d=d[i=c<<1|l]))return n[i]=h,e;if(s=+e._x.call(null,d.data),u=+e._y.call(null,d.data),x===s&&y===u)return h.next=d,n?n[i]=h:e._root=h,e;do{n=n?n[i]=new Array(4):e._root=new Array(4),(l=x>=(r=(p+m)/2))?p=r:m=r,(c=y>=(o=(g+v)/2))?g=o:v=o}while((i=c<<1|l)==(j=(u>=o)<<1|s>=r));return n[j]=d,n[i]=h,e}var Zb=function(e,t,n,r,o){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=o};function Qb(e){return e[0]}function $b(e){return e[1]}function ex(e,x,y){var t=new tx(null==x?Qb:x,null==y?$b:y,NaN,NaN,NaN,NaN);return null==e?t:t.addAll(e)}function tx(x,y,e,t,n,r){this._x=x,this._y=y,this._x0=e,this._y0=t,this._x1=n,this._y1=r,this._root=void 0}function nx(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var rx=ex.prototype=tx.prototype;function ix(e){return e.x+e.vx}function ax(e){return e.y+e.vy}function ox(e){return e.index}function sx(e,t){var n=e.get(t);if(!n)throw new Error("missing: "+t);return n}rx.copy=function(){var e,t,n=new tx(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=nx(r),n;for(e=[{source:r,target:n._root=new Array(4)}];r=e.pop();)for(var i=0;i<4;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=new Array(4)}):r.target[i]=nx(t));return n},rx.add=function(e){var x=+this._x.call(null,e),y=+this._y.call(null,e);return Jb(this.cover(x,y),x,y,e)},rx.addAll=function(e){var t,i,x,y,n=e.length,r=new Array(n),o=new Array(n),s=1/0,u=1/0,l=-1/0,c=-1/0;for(i=0;i<n;++i)isNaN(x=+this._x.call(null,t=e[i]))||isNaN(y=+this._y.call(null,t))||(r[i]=x,o[i]=y,x<s&&(s=x),x>l&&(l=x),y<u&&(u=y),y>c&&(c=y));for(l<s&&(s=this._x0,l=this._x1),c<u&&(u=this._y0,c=this._y1),this.cover(s,u).cover(l,c),i=0;i<n;++i)Jb(this,r[i],o[i],e[i]);return this},rx.cover=function(x,y){if(isNaN(x=+x)||isNaN(y=+y))return this;var e=this._x0,t=this._y0,n=this._x1,r=this._y1;if(isNaN(e))n=(e=Math.floor(x))+1,r=(t=Math.floor(y))+1;else{if(!(e>x||x>n||t>y||y>r))return this;var o,i,s=n-e,u=this._root;switch(i=(y<(t+r)/2)<<1|x<(e+n)/2){case 0:do{(o=new Array(4))[i]=u,u=o}while(r=t+(s*=2),x>(n=e+s)||y>r);break;case 1:do{(o=new Array(4))[i]=u,u=o}while(r=t+(s*=2),(e=n-s)>x||y>r);break;case 2:do{(o=new Array(4))[i]=u,u=o}while(t=r-(s*=2),x>(n=e+s)||t>y);break;case 3:do{(o=new Array(4))[i]=u,u=o}while(t=r-(s*=2),(e=n-s)>x||t>y)}this._root&&this._root.length&&(this._root=u)}return this._x0=e,this._y0=t,this._x1=n,this._y1=r,this},rx.data=function(){var e=[];return this.visit(function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)}),e},rx.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},rx.find=function(x,y,radius){var e,t,n,r,o,s,i,u=this._x0,l=this._y0,c=this._x1,d=this._y1,h=[],p=this._root;for(p&&h.push(new Zb(p,u,l,c,d)),null==radius?radius=1/0:(u=x-radius,l=y-radius,c=x+radius,d=y+radius,radius*=radius);s=h.pop();)if(!(!(p=s.node)||(t=s.x0)>c||(n=s.y0)>d||(r=s.x1)<u||(o=s.y1)<l))if(p.length){var g=(t+r)/2,m=(n+o)/2;h.push(new Zb(p[3],g,m,r,o),new Zb(p[2],t,m,g,o),new Zb(p[1],g,n,r,m),new Zb(p[0],t,n,g,m)),(i=(y>=m)<<1|x>=g)&&(s=h[h.length-1],h[h.length-1]=h[h.length-1-i],h[h.length-1-i]=s)}else{var v=x-+this._x.call(null,p.data),_=y-+this._y.call(null,p.data),w=v*v+_*_;if(w<radius){var E=Math.sqrt(radius=w);u=x-E,l=y-E,c=x+E,d=y+E,e=p.data}}return e},rx.remove=function(e){if(isNaN(x=+this._x.call(null,e))||isNaN(y=+this._y.call(null,e)))return this;var t,n,r,o,x,y,s,u,l,c,i,j,d=this._root,h=this._x0,p=this._y0,g=this._x1,m=this._y1;if(!d)return this;if(d.length)for(;;){if((l=x>=(s=(h+g)/2))?h=s:g=s,(c=y>=(u=(p+m)/2))?p=u:m=u,t=d,!(d=d[i=c<<1|l]))return this;if(!d.length)break;(t[i+1&3]||t[i+2&3]||t[i+3&3])&&(n=t,j=i)}for(;d.data!==e;)if(r=d,!(d=d.next))return this;return(o=d.next)&&delete d.next,r?(o?r.next=o:delete r.next,this):t?(o?t[i]=o:delete t[i],(d=t[0]||t[1]||t[2]||t[3])&&d===(t[3]||t[2]||t[1]||t[0])&&!d.length&&(n?n[j]=d:this._root=d),this):(this._root=o,this)},rx.removeAll=function(e){for(var i=0,t=e.length;i<t;++i)this.remove(e[i]);return this},rx.root=function(){return this._root},rx.size=function(){var e=0;return this.visit(function(t){if(!t.length)do{++e}while(t=t.next)}),e},rx.visit=function(e){var t,n,r,o,s,u,l=[],c=this._root;for(c&&l.push(new Zb(c,this._x0,this._y0,this._x1,this._y1));t=l.pop();)if(!e(c=t.node,r=t.x0,o=t.y0,s=t.x1,u=t.y1)&&c.length){var d=(r+s)/2,h=(o+u)/2;(n=c[3])&&l.push(new Zb(n,d,h,s,u)),(n=c[2])&&l.push(new Zb(n,r,h,d,u)),(n=c[1])&&l.push(new Zb(n,d,o,s,h)),(n=c[0])&&l.push(new Zb(n,r,o,d,h))}return this},rx.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new Zb(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var o=t.node;if(o.length){var s,u=t.x0,l=t.y0,c=t.x1,d=t.y1,h=(u+c)/2,p=(l+d)/2;(s=o[0])&&n.push(new Zb(s,u,l,h,p)),(s=o[1])&&n.push(new Zb(s,h,l,c,p)),(s=o[2])&&n.push(new Zb(s,u,p,h,d)),(s=o[3])&&n.push(new Zb(s,h,p,c,d))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},rx.x=function(e){return arguments.length?(this._x=e,this):this._x},rx.y=function(e){return arguments.length?(this._y=e,this):this._y};var ux,lx,cx=0,fx=0,dx=0,hx=1e3,px=0,gx=0,mx=0,vx="object"==typeof performance&&performance.now?performance:Date,yx="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(f){setTimeout(f,17)};function bx(){return gx||(yx(xx),gx=vx.now()+mx)}function xx(){gx=0}function _x(){this._call=this._time=this._next=null}function wx(e,t,n){var r=new _x;return r.restart(e,t,n),r}function Ex(){gx=(px=vx.now())+mx,cx=fx=0;try{!function(){bx(),++cx;for(var e,t=ux;t;)(e=gx-t._time)>=0&&t._call.call(null,e),t=t._next;--cx}()}finally{cx=0,function(){for(var e,t,n=ux,r=1/0;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:ux=t);lx=e,Sx(r)}(),gx=0}}function Ox(){var e=vx.now(),t=e-px;t>hx&&(mx-=t,px=e)}function Sx(e){cx||(fx&&(fx=clearTimeout(fx)),e-gx>24?(e<1/0&&(fx=setTimeout(Ex,e-vx.now()-mx)),dx&&(dx=clearInterval(dx))):(dx||(px=vx.now(),dx=setInterval(Ox,hx)),cx=1,yx(Ex)))}function Ax(e){return e.x}function kx(e){return e.y}_x.prototype=wx.prototype={constructor:_x,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?bx():+n)+(null==t?0:+t),this._next||lx===this||(lx?lx._next=this:ux=this,lx=this),this._call=e,this._time=n,Sx()},stop:function(){this._call&&(this._call=null,this._time=1/0,Sx())}};var Tx=10,Nx=Math.PI*(3-Math.sqrt(5)),Mx={center:function(x,y){var e;function t(){var i,t,n=e.length,r=0,o=0;for(i=0;i<n;++i)r+=(t=e[i]).x,o+=t.y;for(r=r/n-x,o=o/n-y,i=0;i<n;++i)(t=e[i]).x-=r,t.y-=o}return null==x&&(x=0),null==y&&(y=0),t.initialize=function(t){e=t},t.x=function(e){return arguments.length?(x=+e,t):x},t.y=function(e){return arguments.length?(y=+e,t):y},t},collide:function(radius){var e,t,n=1,r=1;function o(){for(var i,o,u,l,c,d,h,p=e.length,k=0;k<r;++k)for(o=ex(e,ix,ax).visitAfter(s),i=0;i<p;++i)h=(d=t[(u=e[i]).index])*d,l=u.x+u.vx,c=u.y+u.vy,o.visit(g);function g(e,t,r,o,s){var p=e.data,g=e.r,m=d+g;if(!p)return t>l+m||o<l-m||r>c+m||s<c-m;if(p.index>u.index){var x=l-p.x-p.vx,y=c-p.y-p.vy,v=x*x+y*y;v<m*m&&(0===x&&(v+=(x=Kb())*x),0===y&&(v+=(y=Kb())*y),v=(m-(v=Math.sqrt(v)))/v*n,u.vx+=(x*=v)*(m=(g*=g)/(h+g)),u.vy+=(y*=v)*m,p.vx-=x*(m=1-m),p.vy-=y*m)}}}function s(e){if(e.data)return e.r=t[e.data.index];for(var i=e.r=0;i<4;++i)e[i]&&e[i].r>e.r&&(e.r=e[i].r)}function u(){if(e){var i,n,r=e.length;for(t=new Array(r),i=0;i<r;++i)t[(n=e[i]).index]=+radius(n,i,e)}}return"function"!=typeof radius&&(radius=Yb(null==radius?1:+radius)),o.initialize=function(t){e=t,u()},o.iterations=function(e){return arguments.length?(r=+e,o):r},o.strength=function(e){return arguments.length?(n=+e,o):n},o.radius=function(e){return arguments.length?(radius="function"==typeof e?e:Yb(+e),u(),o):radius},o},nbody:function(){var e,t,n,r,o=Yb(-30),s=1,u=1/0,l=.81;function c(r){var i,o=e.length,s=ex(e,Ax,kx).visitAfter(h);for(n=r,i=0;i<o;++i)t=e[i],s.visit(p)}function d(){if(e){var i,t,n=e.length;for(r=new Array(n),i=0;i<n;++i)r[(t=e[i]).index]=+o(t,i,e)}}function h(e){var t,n,x,y,i,o=0,s=0;if(e.length){for(x=y=i=0;i<4;++i)(t=e[i])&&(n=Math.abs(t.value))&&(o+=t.value,s+=n,x+=n*t.x,y+=n*t.y);e.x=x/s,e.y=y/s}else{(t=e).x=t.data.x,t.y=t.data.y;do{o+=r[t.data.index]}while(t=t.next)}e.value=o}function p(e,o,c,d){if(!e.value)return!0;var x=e.x-t.x,y=e.y-t.y,h=d-o,p=x*x+y*y;if(h*h/l<p)return p<u&&(0===x&&(p+=(x=Kb())*x),0===y&&(p+=(y=Kb())*y),p<s&&(p=Math.sqrt(s*p)),t.vx+=x*e.value*n/p,t.vy+=y*e.value*n/p),!0;if(!(e.length||p>=u)){(e.data!==t||e.next)&&(0===x&&(p+=(x=Kb())*x),0===y&&(p+=(y=Kb())*y),p<s&&(p=Math.sqrt(s*p)));do{e.data!==t&&(t.vx+=x*(h=r[e.data.index]*n/p),t.vy+=y*h)}while(e=e.next)}}return c.initialize=function(t){e=t,d()},c.strength=function(e){return arguments.length?(o="function"==typeof e?e:Yb(+e),d(),c):o},c.distanceMin=function(e){return arguments.length?(s=e*e,c):Math.sqrt(s)},c.distanceMax=function(e){return arguments.length?(u=e*e,c):Math.sqrt(u)},c.theta=function(e){return arguments.length?(l=e*e,c):Math.sqrt(l)},c},link:function(e){var t,n,r,o,s,u=ox,l=function(e){return 1/Math.min(o[e.source.index],o[e.target.index])},c=Yb(30),d=1;function h(r){for(var k=0,o=e.length;k<d;++k)for(var u,l,c,x,y,h,b,i=0;i<o;++i)x=(c=(u=e[i]).target).x+c.vx-(l=u.source).x-l.vx||Kb(),y=c.y+c.vy-l.y-l.vy||Kb(),y*=h=((h=Math.sqrt(x*x+y*y))-n[i])/h*r*t[i],c.vx-=(x*=h)*(b=s[i]),c.vy-=y*b,l.vx+=x*(b=1-b),l.vy+=y*b}function p(){if(r){var i,l,c=r.length,d=e.length,h=K(r,u);for(i=0,o=new Array(c);i<d;++i)(l=e[i]).index=i,"object"!=typeof l.source&&(l.source=sx(h,l.source)),"object"!=typeof l.target&&(l.target=sx(h,l.target)),o[l.source.index]=(o[l.source.index]||0)+1,o[l.target.index]=(o[l.target.index]||0)+1;for(i=0,s=new Array(d);i<d;++i)s[i]=o[(l=e[i]).source.index]/(o[l.source.index]+o[l.target.index]);t=new Array(d),g(),n=new Array(d),m()}}function g(){if(r)for(var i=0,n=e.length;i<n;++i)t[i]=+l(e[i],i,e)}function m(){if(r)for(var i=0,t=e.length;i<t;++i)n[i]=+c(e[i],i,e)}return null==e&&(e=[]),h.initialize=function(e){r=e,p()},h.links=function(t){return arguments.length?(e=t,p(),h):e},h.id=function(e){return arguments.length?(u=e,h):u},h.iterations=function(e){return arguments.length?(d=+e,h):d},h.strength=function(e){return arguments.length?(l="function"==typeof e?e:Yb(+e),g(),h):l},h.distance=function(e){return arguments.length?(c="function"==typeof e?e:Yb(+e),m(),h):c},h},x:function(x){var e,t,n,r=Yb(.1);function o(r){for(var o,i=0,s=e.length;i<s;++i)(o=e[i]).vx+=(n[i]-o.x)*t[i]*r}function s(){if(e){var i,o=e.length;for(t=new Array(o),n=new Array(o),i=0;i<o;++i)t[i]=isNaN(n[i]=+x(e[i],i,e))?0:+r(e[i],i,e)}}return"function"!=typeof x&&(x=Yb(null==x?0:+x)),o.initialize=function(t){e=t,s()},o.strength=function(e){return arguments.length?(r="function"==typeof e?e:Yb(+e),s(),o):r},o.x=function(e){return arguments.length?(x="function"==typeof e?e:Yb(+e),s(),o):x},o},y:function(y){var e,t,n,r=Yb(.1);function o(r){for(var o,i=0,s=e.length;i<s;++i)(o=e[i]).vy+=(n[i]-o.y)*t[i]*r}function s(){if(e){var i,o=e.length;for(t=new Array(o),n=new Array(o),i=0;i<o;++i)t[i]=isNaN(n[i]=+y(e[i],i,e))?0:+r(e[i],i,e)}}return"function"!=typeof y&&(y=Yb(null==y?0:+y)),o.initialize=function(t){e=t,s()},o.strength=function(e){return arguments.length?(r="function"==typeof e?e:Yb(+e),s(),o):r},o.y=function(e){return arguments.length?(y="function"==typeof e?e:Yb(+e),s(),o):y},o}},Cx="forces",Dx=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],Rx=["static","iterations"],Ix=["x","y","vx","vy"];function Px(e){ur.call(this,null,e)}Px.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:Ix}]};var Lx=Object(v.inherits)(Px,ur);function zx(e,t,n,r){var i,o,s,u,f=Object(v.array)(t.forces);for(i=0,o=Dx.length;i<o;++i)(s=Dx[i])!==Cx&&t.modified(s)&&e[s](t[s]);for(i=0,o=f.length;i<o;++i)u=Cx+i,(s=n||t.modified(Cx,i)?Fx(f[i]):r&&jx(f[i],r)?e.force(u):null)&&e.force(u,s);for(o=e.numForces||0;i<o;++i)e.force(Cx+i,null);return e.numForces=f.length,e}function jx(f,e){var k,t;for(k in f)if(Object(v.isFunction)(t=f[k])&&e.modified(Object(v.accessorFields)(t)))return 1;return 0}function Fx(e){var f,t;for(t in Mx.hasOwnProperty(e.force)||Object(v.error)("Unrecognized force: "+e.force),f=Mx[e.force](),e)Object(v.isFunction)(f[t])&&Ux(f[t],e[t],e);return f}function Ux(f,e,t){f(Object(v.isFunction)(e)?function(n){return e(n,t)}:e)}function Bx(a,b){return a.parent===b.parent?1:2}function Vx(x,e){return x+e.x}function qx(y,e){return Math.max(y,e.y)}function Gx(e){var sum=0,t=e.children,i=t&&t.length;if(i)for(;--i>=0;)sum+=t[i].value;else sum=1;e.value=sum}function Wx(e,t){var n,r,o,i,s,u=new Kx(e),l=+e.value&&(u.value=e.value),c=[u];for(null==t&&(t=Hx);n=c.pop();)if(l&&(n.value=+n.data.value),(o=t(n.data))&&(s=o.length))for(n.children=new Array(s),i=s-1;i>=0;--i)c.push(r=n.children[i]=new Kx(o[i])),r.parent=n,r.depth=n.depth+1;return u.eachBefore(Yx)}function Hx(e){return e.children}function Xx(e){e.data=e.data.data}function Yx(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function Kx(e){this.data=e,this.depth=this.height=0,this.parent=null}Lx.transform=function(e,t){var n,r,o=this.value,s=t.changed(t.ADD_REM),u=e.modified(Dx),l=e.iterations||300;if(o?(s&&(t.modifies("index"),o.nodes(t.source)),(u||t.changed(t.MOD))&&zx(o,e,0,t)):(this.value=o=function(e,n){var r=function(e){var t,n=1,r=.001,o=1-Math.pow(r,1/300),s=0,u=.6,l=K(),c=wx(h),d=se("tick","end");function h(){p(),d.call("tick",t),n<r&&(c.stop(),d.call("end",t))}function p(){var i,t,r=e.length;for(n+=(s-n)*o,l.each(function(e){e(n)}),i=0;i<r;++i)null==(t=e[i]).fx?t.x+=t.vx*=u:(t.x=t.fx,t.vx=0),null==t.fy?t.y+=t.vy*=u:(t.y=t.fy,t.vy=0)}function g(){for(var t,i=0,n=e.length;i<n;++i){if((t=e[i]).index=i,isNaN(t.x)||isNaN(t.y)){var radius=Tx*Math.sqrt(i),r=i*Nx;t.x=radius*Math.cos(r),t.y=radius*Math.sin(r)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function m(t){return t.initialize&&t.initialize(e),t}return null==e&&(e=[]),g(),t={tick:p,restart:function(){return c.restart(h),t},stop:function(){return c.stop(),t},nodes:function(n){return arguments.length?(e=n,g(),l.each(m),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(r=+e,t):r},alphaDecay:function(e){return arguments.length?(o=+e,t):+o},alphaTarget:function(e){return arguments.length?(s=+e,t):s},velocityDecay:function(e){return arguments.length?(u=1-e,t):1-u},force:function(e,n){return arguments.length>1?(null==n?l.remove(e):l.set(e,m(n)),t):l.get(e)},find:function(x,y,radius){var t,n,r,o,s,i=0,u=e.length;for(null==radius?radius=1/0:radius*=radius,i=0;i<u;++i)(r=(t=x-(o=e[i]).x)*t+(n=y-o.y)*n)<radius&&(s=o,radius=r);return s},on:function(e,n){return arguments.length>1?(d.on(e,n),t):d.on(e)}}}(t.source),o=!1,s=r.stop,u=r.restart;return r.stopped=function(){return o},r.restart=function(){return o=!1,u()},r.stop=function(){return o=!0,s()},zx(r,n,!0).on("end",function(){o=!0})}(0,e),o.on("tick",(n=t.dataflow,r=this,function(){n.touch(r).run()})),e.static||(s=!0,o.tick()),t.modifies("index")),u||s||e.modified(Rx)||t.changed()&&e.restart)if(o.alpha(Math.max(o.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(o.alphaMin(),1/l)),e.static)for(o.stop();--l>=0;)o.tick();else if(o.stopped()&&o.restart(),!s)return t.StopPropagation;return this.finish(e,t)},Lx.finish=function(e,t){for(var n,r=t.dataflow,o=this._argops,j=0,s=o.length;j<s;++j)if((n=o[j]).name===Cx&&"link"===n.op._argval.force)for(var u,l=n.op._argops,i=0,c=l.length;i<c;++i)if("links"===l[i].name&&(u=l[i].op.source)){r.pulse(u,r.changeset().reflow());break}return t.reflow(e.modified()).modifies(Ix)},Kx.prototype=Wx.prototype={constructor:Kx,count:function(){return this.eachAfter(Gx)},each:function(e){var t,n,i,r,o=this,s=[o];do{for(t=s.reverse(),s=[];o=t.pop();)if(e(o),n=o.children)for(i=0,r=n.length;i<r;++i)s.push(n[i])}while(s.length);return this},eachAfter:function(e){for(var t,i,n,r=this,o=[r],s=[];r=o.pop();)if(s.push(r),t=r.children)for(i=0,n=t.length;i<n;++i)o.push(t[i]);for(;r=s.pop();)e(r);return this},eachBefore:function(e){for(var t,i,n=this,r=[n];n=r.pop();)if(e(n),t=n.children)for(i=t.length-1;i>=0;--i)r.push(t[i]);return this},sum:function(value){return this.eachAfter(function(e){for(var sum=+value(e.data)||0,t=e.children,i=t&&t.length;--i>=0;)sum+=t[i].value;e.value=sum})},sort:function(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})},path:function(e){for(var t=this,n=function(a,b){if(a===b)return a;var e=a.ancestors(),t=b.ancestors(),n=null;for(a=e.pop(),b=t.pop();a===b;)n=a,a=e.pop(),b=t.pop();return n}(t,e),r=[t];t!==n;)r.push(t=t.parent);for(var k=r.length;e!==n;)r.splice(k,0,e),e=e.parent;return r},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){var e=[];return this.each(function(t){e.push(t)}),e},leaves:function(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e},links:function(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t},copy:function(){return Wx(this).eachBefore(Xx)}};var Jx=Array.prototype.slice,Zx=function(e){for(var t,n,i=0,r=(e=function(e){for(var t,i,n=e.length;n;)i=Math.random()*n--|0,t=e[n],e[n]=e[i],e[i]=t;return e}(Jx.call(e))).length,o=[];i<r;)t=e[i],n&&e_(n,t)?++i:(n=n_(o=Qx(o,t)),i=0);return n};function Qx(e,t){var i,j;if(t_(t,e))return[t];for(i=0;i<e.length;++i)if($x(t,e[i])&&t_(r_(e[i],t),e))return[e[i],t];for(i=0;i<e.length-1;++i)for(j=i+1;j<e.length;++j)if($x(r_(e[i],e[j]),t)&&$x(r_(e[i],t),e[j])&&$x(r_(e[j],t),e[i])&&t_(i_(e[i],e[j],t),e))return[e[i],e[j],t];throw new Error}function $x(a,b){var e=a.r-b.r,t=b.x-a.x,n=b.y-a.y;return e<0||e*e<t*t+n*n}function e_(a,b){var e=a.r-b.r+1e-6,t=b.x-a.x,n=b.y-a.y;return e>0&&e*e>t*t+n*n}function t_(a,e){for(var i=0;i<e.length;++i)if(!e_(a,e[i]))return!1;return!0}function n_(e){switch(e.length){case 1:return{x:(a=e[0]).x,y:a.y,r:a.r};case 2:return r_(e[0],e[1]);case 3:return i_(e[0],e[1],e[2])}var a}function r_(a,b){var e=a.x,t=a.y,n=a.r,r=b.x,o=b.y,s=b.r,u=r-e,l=o-t,c=s-n,d=Math.sqrt(u*u+l*l);return{x:(e+r+u/d*c)/2,y:(t+o+l/d*c)/2,r:(d+n+s)/2}}function i_(a,b,e){var t=a.x,n=a.y,r=a.r,o=b.x,s=b.y,u=b.r,l=e.x,c=e.y,d=e.r,h=t-o,p=t-l,g=n-s,m=n-c,v=u-r,_=d-r,w=t*t+n*n-r*r,E=w-o*o-s*s+u*u,O=w-l*l-c*c+d*d,S=p*g-h*m,A=(g*O-m*E)/(2*S)-t,T=(m*v-g*_)/S,N=(p*E-h*O)/(2*S)-n,M=(h*_-p*v)/S,C=T*T+M*M-1,D=2*(r+A*T+N*M),R=A*A+N*N-r*r,I=-(C?(D+Math.sqrt(D*D-4*C*R))/(2*C):R/D);return{x:t+A+T*I,y:n+N+M*I,r:I}}function a_(a,b,e){var t=a.x,n=a.y,r=b.r+e.r,o=a.r+e.r,s=b.x-t,u=b.y-n,l=s*s+u*u;if(l){var x=.5+((o*=o)-(r*=r))/(2*l),y=Math.sqrt(Math.max(0,2*r*(o+l)-(o-=l)*o-r*r))/(2*l);e.x=t+x*s+y*u,e.y=n+x*u-y*s}else e.x=t+o,e.y=n}function o_(a,b){var e=b.x-a.x,t=b.y-a.y,n=a.r+b.r;return n*n-1e-6>e*e+t*t}function s_(e){var a=e._,b=e.next._,t=a.r+b.r,n=(a.x*b.r+b.x*a.r)/t,r=(a.y*b.r+b.y*a.r)/t;return n*n+r*r}function u_(e){this._=e,this.next=null,this.previous=null}function l_(f){if("function"!=typeof f)throw new Error;return f}function c_(){return 0}var f_=function(x){return function(){return x}};function d_(e){return Math.sqrt(e.value)}function h_(radius){return function(e){e.children||(e.r=Math.max(0,+radius(e)||0))}}function p_(e,k){return function(t){if(n=t.children){var n,i,r,o=n.length,s=e(t)*k||0;if(s)for(i=0;i<o;++i)n[i].r+=s;if(r=function(e){if(!(n=e.length))return 0;var a,b,t,n,r,o,i,j,k,s,u;if((a=e[0]).x=0,a.y=0,!(n>1))return a.r;if(a.x=-(b=e[1]).r,b.x=a.r,b.y=0,!(n>2))return a.r+b.r;a_(b,a,t=e[2]),a=new u_(a),b=new u_(b),t=new u_(t),a.next=t.previous=b,b.next=a.previous=t,t.next=b.previous=a;e:for(i=3;i<n;++i){a_(a._,b._,t=e[i]),t=new u_(t),j=b.next,k=a.previous,s=b._.r,u=a._.r;do{if(s<=u){if(o_(j._,t._)){a.next=b=j,b.previous=a,--i;continue e}s+=j._.r,j=j.next}else{if(o_(k._,t._)){(a=k).next=b,b.previous=a,--i;continue e}u+=k._.r,k=k.previous}}while(j!==k.next);for(t.previous=a,t.next=b,a.next=b.previous=b=t,r=s_(a);(t=t.next)!==b;)(o=s_(t))<r&&(a=t,r=o);b=a.next}for(a=[b._],t=b;(t=t.next)!==b;)a.push(t._);for(t=Zx(a),i=0;i<n;++i)(a=e[i]).x-=t.x,a.y-=t.y;return t.r}(n),s)for(i=0;i<o;++i)n[i].r-=s;t.r=r+s}}}function g_(k){return function(e){var t=e.parent;e.r*=k,t&&(e.x=t.x+k*e.x,e.y=t.y+k*e.y)}}var m_=function(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)},v_=function(e,t,n,r,o){for(var s,u=e.children,i=-1,l=u.length,k=e.value&&(r-t)/e.value;++i<l;)(s=u[i]).y0=n,s.y1=o,s.x0=t,s.x1=t+=s.value*k},y_="$",b_={depth:-1},x_={};function __(e){return e.id}function w_(e){return e.parentId}function E_(a,b){return a.parent===b.parent?1:2}function O_(e){var t=e.children;return t?t[0]:e.t}function S_(e){var t=e.children;return t?t[t.length-1]:e.t}function A_(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function k_(e,t,n){return e.a.parent===t.parent?e.a:n}function T_(e,i){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=i}T_.prototype=Object.create(Kx.prototype);var N_=function(e,t,n,r,o){for(var s,u=e.children,i=-1,l=u.length,k=e.value&&(o-n)/e.value;++i<l;)(s=u[i]).x0=t,s.x1=r,s.y0=n,s.y1=n+=s.value*k},M_=(1+Math.sqrt(5))/2;function C_(e,t,n,r,o,s){for(var u,l,c,d,h,p,g,m,v,_,w,E=[],O=t.children,S=0,A=0,T=O.length,value=t.value;S<T;){c=o-n,d=s-r;do{h=O[A++].value}while(!h&&A<T);for(p=g=h,w=h*h*(_=Math.max(d/c,c/d)/(value*e)),v=Math.max(g/w,w/p);A<T;++A){if(h+=l=O[A].value,l<p&&(p=l),l>g&&(g=l),w=h*h*_,(m=Math.max(g/w,w/p))>v){h-=l;break}v=m}E.push(u={value:h,dice:c<d,children:O.slice(S,A)}),u.dice?v_(u,n,r,o,value?r+=d*h/value:s):N_(u,n,r,value?n+=c*h/value:o,s),value-=h,S=A}return E}var D_=function e(t){function n(e,n,r,o,s){C_(t,e,n,r,o,s)}return n.ratio=function(x){return e((x=+x)>1?x:1)},n}(M_),R_=function e(t){function n(e,n,r,o,s){if((u=e._squarify)&&u.ratio===t)for(var u,l,c,i,d,j=-1,h=u.length,value=e.value;++j<h;){for(c=(l=u[j]).children,i=l.value=0,d=c.length;i<d;++i)l.value+=c[i].value;l.dice?v_(l,n,r,o,r+=(s-r)*l.value/value):N_(l,n,r,n+=(o-n)*l.value/value,s),value-=l.value}else e._squarify=u=C_(t,e,n,r,o,s),u.ratio=t}return n.ratio=function(x){return e((x=+x)>1?x:1)},n}(M_);function I_(e){ur.call(this,null,e)}function P_(e){return e.values}function L_(e){ur.call(this,null,e)}I_.Definition={type:"Nest",metadata:{treesource:!0,generates:!0},params:[{name:"keys",type:"field",array:!0},{name:"key",type:"field"},{name:"generate",type:"boolean"}]},Object(v.inherits)(I_,ur).transform=function(e,t){t.source||Object(v.error)("Nest transform requires an upstream data source.");var n,r,o,s=e.key||S,u=e.generate,l=e.modified(),c=u||l?t.fork(t.ALL):t;return(!this.value||l||t.changed())&&(u&&this.value&&(c.materialize(c.REM),this.value.each(function(e){e.children&&c.rem.push(e)})),n=Object(v.array)(e.keys).reduce(function(e,k){return e.key(k),e},function(){var e,t,n,r=[],o=[];function s(n,o,u,l){if(o>=r.length)return null!=e&&n.sort(e),null!=t?t(n):n;for(var c,value,d,i=-1,h=n.length,p=r[o++],g=K(),m=u();++i<h;)(d=g.get(c=p(value=n[i])+""))?d.push(value):g.set(c,[value]);return g.each(function(e,t){l(m,t,s(e,o,u,l))}),m}return n={object:function(e){return s(e,0,J,Z)},map:function(e){return s(e,0,Q,$)},entries:function(e){return function e(n,s){if(++s>r.length)return n;var u,l=o[s-1];return null!=t&&s>=r.length?u=n.entries():(u=[],n.each(function(t,k){u.push({key:k,values:e(t,s)})})),null!=l?u.sort(function(a,b){return l(a.key,b.key)}):u}(s(e,0,Q,$),0)},key:function(e){return r.push(e),n},sortKeys:function(e){return o[r.length-1]=e,n},sortValues:function(t){return e=t,n},rollup:function(f){return t=f,n}}}()).entries(c.materialize(c.SOURCE).source),this.value=r=Wx({values:n},P_),u&&(c.materialize(c.ADD),c.source=c.source.slice(),r.each(function(e){e.children&&(e=T(e.data),c.add.push(e),c.source.push(e))})),o=r.lookup={},r.each(function(e){null!=S(e.data)&&(o[s(e.data)]=e)})),c.source.root=this.value,c},Object(v.inherits)(L_,ur).transform=function(e,t){t.source&&t.source.root||Object(v.error)(this.constructor.name+" transform requires a backing tree data source.");var n=this.layout(e.method),r=this.fields,o=t.source.root,s=e.as||r;e.field&&o.sum(e.field),e.sort&&o.sort(e.sort),function(e,t,n){for(var r,i=0,o=t.length;i<o;++i)(r=t[i])in n&&e[r](n[r])}(n,this.params,e);try{this.value=n(o)}catch(e){Object(v.error)(e)}return o.each(function(e){!function(e,t,n){for(var r=e.data,i=0,o=t.length-1;i<o;++i)r[n[i]]=e[t[i]];r[n[o]]=e.children?e.children.length:0}(e,r,s)}),t.reflow(e.modified()).modifies(s).modifies("leaf")};var z_=["x","y","r","depth","children"];function j_(e){L_.call(this,e)}j_.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:3,default:z_}]};var F_=Object(v.inherits)(j_,L_);F_.layout=function(){var radius=null,e=1,t=1,n=c_;function r(r){return r.x=e/2,r.y=t/2,radius?r.eachBefore(h_(radius)).eachAfter(p_(n,.5)).eachBefore(g_(1)):r.eachBefore(h_(d_)).eachAfter(p_(c_,1)).eachAfter(p_(n,r.r/Math.min(e,t))).eachBefore(g_(Math.min(e,t)/(2*r.r))),r}return r.radius=function(x){return arguments.length?(radius=null==(f=x)?null:l_(f),r):radius;var f},r.size=function(x){return arguments.length?(e=+x[0],t=+x[1],r):[e,t]},r.padding=function(x){return arguments.length?(n="function"==typeof x?x:f_(+x),r):n},r},F_.params=["size","padding"],F_.fields=z_;var U_=["x0","y0","x1","y1","depth","children"];function B_(e){L_.call(this,e)}B_.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:4,default:U_}]};var V_=Object(v.inherits)(B_,L_);function q_(e){ur.call(this,null,e)}V_.layout=function(){var e=1,t=1,n=0,r=!1;function o(o){var s=o.height+1;return o.x0=o.y0=n,o.x1=e,o.y1=t/s,o.eachBefore(function(e,t){return function(r){r.children&&v_(r,r.x0,e*(r.depth+1)/t,r.x1,e*(r.depth+2)/t);var o=r.x0,s=r.y0,u=r.x1-n,l=r.y1-n;u<o&&(o=u=(o+u)/2),l<s&&(s=l=(s+l)/2),r.x0=o,r.y0=s,r.x1=u,r.y1=l}}(t,s)),r&&o.eachBefore(m_),o}return o.round=function(x){return arguments.length?(r=!!x,o):r},o.size=function(x){return arguments.length?(e=+x[0],t=+x[1],o):[e,t]},o.padding=function(x){return arguments.length?(n=+x,o):n},o},V_.params=["size","round","padding"],V_.fields=U_,q_.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},Object(v.inherits)(q_,ur).transform=function(e,t){t.source||Object(v.error)("Stratify transform requires an upstream data source.");var n,r,o=e.modified();return(!this.value||o||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields))&&(n=function(){var e=__,t=w_;function n(n){var r,i,o,s,u,l,c,d=n.length,h=new Array(d),p={};for(i=0;i<d;++i)u=h[i]=new Kx(r=n[i]),null!=(l=e(r,i,n))&&(l+="")&&(p[c=y_+(u.id=l)]=c in p?x_:u);for(i=0;i<d;++i)if(u=h[i],null!=(l=t(n[i],i,n))&&(l+="")){if(!(s=p[y_+l]))throw new Error("missing: "+l);if(s===x_)throw new Error("ambiguous: "+l);s.children?s.children.push(u):s.children=[u],u.parent=s}else{if(o)throw new Error("multiple roots");o=u}if(!o)throw new Error("no root");if(o.parent=b_,o.eachBefore(function(e){e.depth=e.parent.depth+1,--d}).eachBefore(Yx),o.parent=null,d>0)throw new Error("cycle");return o}return n.id=function(x){return arguments.length?(e=l_(x),n):e},n.parentId=function(x){return arguments.length?(t=l_(x),n):t},n}().id(e.key).parentId(e.parentKey)(t.source),r=n.lookup={},n.each(function(t){r[e.key(t.data)]=t}),this.value=n),t.source.root=this.value,o?t.fork(t.ALL):t};var G_={tidy:function(){var e=E_,t=1,n=1,r=null;function o(o){var c=function(e){for(var t,n,r,i,o,s=new T_(e,0),u=[s];t=u.pop();)if(r=t._.children)for(t.children=new Array(o=r.length),i=o-1;i>=0;--i)u.push(n=t.children[i]=new T_(r[i],i)),n.parent=t;return(s.parent=new T_(null,0)).children=[s],s}(o);if(c.eachAfter(s),c.parent.m=-c.z,c.eachBefore(u),r)o.eachBefore(l);else{var d=o,h=o,p=o;o.eachBefore(function(e){e.x<d.x&&(d=e),e.x>h.x&&(h=e),e.depth>p.depth&&(p=e)});var g=d===h?1:e(d,h)/2,m=g-d.x,v=t/(h.x+g+m),_=n/(p.depth||1);o.eachBefore(function(e){e.x=(e.x+m)*v,e.y=e.depth*_})}return o}function s(t){var n=t.children,r=t.parent.children,o=t.i?r[t.i-1]:null;if(n){!function(e){for(var t,n=0,r=0,o=e.children,i=o.length;--i>=0;)(t=o[i]).z+=n,t.m+=n,n+=t.s+(r+=t.c)}(t);var s=(n[0].z+n[n.length-1].z)/2;o?(t.z=o.z+e(t._,o._),t.m=t.z-s):t.z=s}else o&&(t.z=o.z+e(t._,o._));t.parent.A=function(t,n,r){if(n){for(var o,s=t,u=t,l=n,c=s.parent.children[0],d=s.m,h=u.m,p=l.m,g=c.m;l=S_(l),s=O_(s),l&&s;)c=O_(c),(u=S_(u)).a=t,(o=l.z+p-s.z-d+e(l._,s._))>0&&(A_(k_(l,t,r),t,o),d+=o,h+=o),p+=l.m,d+=s.m,g+=c.m,h+=u.m;l&&!S_(u)&&(u.t=l,u.m+=p-h),s&&!O_(c)&&(c.t=s,c.m+=d-g,r=t)}return r}(t,o,t.parent.A||r[0])}function u(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function l(e){e.x*=t,e.y=e.depth*n}return o.separation=function(x){return arguments.length?(e=x,o):e},o.size=function(x){return arguments.length?(r=!1,t=+x[0],n=+x[1],o):r?null:[t,n]},o.nodeSize=function(x){return arguments.length?(r=!0,t=+x[0],n=+x[1],o):r?[t,n]:null},o},cluster:function(){var e=Bx,t=1,n=1,r=!1;function o(o){var s,x=0;o.eachAfter(function(t){var n=t.children;n?(t.x=function(e){return e.reduce(Vx,0)/e.length}(n),t.y=function(e){return 1+e.reduce(qx,0)}(n)):(t.x=s?x+=e(t,s):0,t.y=0,s=t)});var u=function(e){for(var t;t=e.children;)e=t[0];return e}(o),l=function(e){for(var t;t=e.children;)e=t[t.length-1];return e}(o),c=u.x-e(u,l)/2,d=l.x+e(l,u)/2;return o.eachAfter(r?function(e){e.x=(e.x-o.x)*t,e.y=(o.y-e.y)*n}:function(e){e.x=(e.x-c)/(d-c)*t,e.y=(1-(o.y?e.y/o.y:1))*n})}return o.separation=function(x){return arguments.length?(e=x,o):e},o.size=function(x){return arguments.length?(r=!1,t=+x[0],n=+x[1],o):r?null:[t,n]},o.nodeSize=function(x){return arguments.length?(r=!0,t=+x[0],n=+x[1],o):r?[t,n]:null},o}},W_=["x","y","depth","children"];function H_(e){L_.call(this,e)}H_.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:4,default:W_}]};var X_=Object(v.inherits)(H_,L_);function Y_(e){ur.call(this,{},e)}X_.layout=function(e){var t=e||"tidy";if(G_.hasOwnProperty(t))return G_[t]();Object(v.error)("Unrecognized Tree layout method: "+t)},X_.params=["size","nodeSize","separation"],X_.fields=W_,Y_.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[{name:"key",type:"field"}]},Object(v.inherits)(Y_,ur).transform=function(e,t){t.source&&t.source.root||Object(v.error)("TreeLinks transform requires a backing tree data source.");var n=t.source.root.lookup,r=this.value,o=e.key||S,s={},u=t.fork();function l(e){var t=r[e];t&&(s[e]=1,u.mod.push(t))}return t.visit(t.REM,function(e){var t=o(e),n=r[t];n&&(delete r[t],u.rem.push(n))}),t.visit(t.ADD,function(e){var t,l=o(e);(t=function(e){var t;return e.parent&&(t=e.parent.data)&&null!=S(t)&&t}(n[l]))&&(u.add.push(r[l]=T({source:t,target:e})),s[l]=1)}),t.visit(t.MOD,function(e){var t=o(e),r=n[t].children;if(l(t),r)for(var i=0,u=r.length;i<u;++i)s[t=o(r[i].data)]||l(t)}),u};var K_={binary:function(e,t,n,r,o){var i,sum,s=e.children,u=s.length,l=new Array(u+1);for(l[0]=sum=i=0;i<u;++i)l[i+1]=sum+=s[i].value;!function e(i,j,value,t,n,r,o){if(i>=j-1){var u=s[i];return u.x0=t,u.y0=n,u.x1=r,void(u.y1=o)}for(var c=l[i],d=value/2+c,k=i+1,h=j-1;k<h;){var p=k+h>>>1;l[p]<d?k=p+1:h=p}d-l[k-1]<l[k]-d&&i+1<k&&--k;var g=l[k]-c,m=value-g;if(r-t>o-n){var v=(t*m+r*g)/value;e(i,k,g,t,n,v,o),e(k,j,m,v,n,r,o)}else{var _=(n*m+o*g)/value;e(i,k,g,t,n,r,_),e(k,j,m,t,_,r,o)}}(0,u,e.value,t,n,r,o)},dice:v_,slice:N_,slicedice:function(e,t,n,r,o){(1&e.depth?N_:v_)(e,t,n,r,o)},squarify:D_,resquarify:R_},J_=["x0","y0","x1","y1","depth","children"];function Z_(e){L_.call(this,e)}Z_.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:4,default:J_}]};var Q_=Object(v.inherits)(Z_,L_);Q_.layout=function(){var x=function(){var e=D_,t=!1,n=1,r=1,o=[0],s=c_,u=c_,l=c_,c=c_,d=c_;function h(e){return e.x0=e.y0=0,e.x1=n,e.y1=r,e.eachBefore(p),o=[0],t&&e.eachBefore(m_),e}function p(t){var n=o[t.depth],r=t.x0+n,h=t.y0+n,p=t.x1-n,g=t.y1-n;p<r&&(r=p=(r+p)/2),g<h&&(h=g=(h+g)/2),t.x0=r,t.y0=h,t.x1=p,t.y1=g,t.children&&(n=o[t.depth+1]=s(t)/2,r+=d(t)-n,h+=u(t)-n,p-=l(t)-n,g-=c(t)-n,p<r&&(r=p=(r+p)/2),g<h&&(h=g=(h+g)/2),e(t,r,h,p,g))}return h.round=function(x){return arguments.length?(t=!!x,h):t},h.size=function(x){return arguments.length?(n=+x[0],r=+x[1],h):[n,r]},h.tile=function(x){return arguments.length?(e=l_(x),h):e},h.padding=function(x){return arguments.length?h.paddingInner(x).paddingOuter(x):h.paddingInner()},h.paddingInner=function(x){return arguments.length?(s="function"==typeof x?x:f_(+x),h):s},h.paddingOuter=function(x){return arguments.length?h.paddingTop(x).paddingRight(x).paddingBottom(x).paddingLeft(x):h.paddingTop()},h.paddingTop=function(x){return arguments.length?(u="function"==typeof x?x:f_(+x),h):u},h.paddingRight=function(x){return arguments.length?(l="function"==typeof x?x:f_(+x),h):l},h.paddingBottom=function(x){return arguments.length?(c="function"==typeof x?x:f_(+x),h):c},h.paddingLeft=function(x){return arguments.length?(d="function"==typeof x?x:f_(+x),h):d},h}();return x.ratio=function(e){var t=x.tile();t.ratio&&x.tile(t.ratio(e))},x.method=function(e){K_.hasOwnProperty(e)?x.tile(K_[e]):Object(v.error)("Unrecognized Treemap layout method: "+e)},x},Q_.params=["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],Q_.fields=J_;var $_=function(x){return function(){return x}};function ew(e){return e[0]}function tw(e){return e[1]}function nw(){this._=null}function rw(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function iw(e,t){var n=t,r=t.R,o=n.U;o?o.L===n?o.L=r:o.R=r:e._=r,r.U=o,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function aw(e,t){var n=t,r=t.L,o=n.U;o?o.L===n?o.L=r:o.R=r:e._=r,r.U=o,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function ow(e){for(;e.L;)e=e.L;return e}nw.prototype={constructor:nw,insert:function(e,t){var n,r,o;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=ow(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)n===(r=n.U).L?(o=r.R)&&o.C?(n.C=o.C=!1,r.C=!0,e=r):(e===n.R&&(iw(this,n),n=(e=n).U),n.C=!1,r.C=!0,aw(this,r)):(o=r.L)&&o.C?(n.C=o.C=!1,r.C=!0,e=r):(e===n.L&&(aw(this,n),n=(e=n).U),n.C=!1,r.C=!0,iw(this,r)),n=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t,n,r,o=e.U,s=e.L,u=e.R;if(n=s?u?ow(u):s:u,o?o.L===e?o.L=n:o.R=n:this._=n,s&&u?(r=n.C,n.C=e.C,n.L=s,s.U=n,n!==u?(o=n.U,n.U=e.U,o.L=e=n.R,n.R=u,u.U=n):(n.U=o,o=n,e=n.R)):(r=e.C,e=n),e&&(e.U=o),!r)if(e&&e.C)e.C=!1;else{do{if(e===this._)break;if(e===o.L){if((t=o.R).C&&(t.C=!1,o.C=!0,iw(this,o),t=o.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,aw(this,t),t=o.R),t.C=o.C,o.C=t.R.C=!1,iw(this,o),e=this._;break}}else if((t=o.L).C&&(t.C=!1,o.C=!0,aw(this,o),t=o.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,iw(this,t),t=o.L),t.C=o.C,o.C=t.L.C=!1,aw(this,o),e=this._;break}t.C=!0,e=o,o=o.U}while(!e.C);e&&(e.C=!1)}}};var sw=nw;function uw(e,t,n,r){var o=[null,null],s=Mw.push(o)-1;return o.left=e,o.right=t,n&&cw(o,e,t,n),r&&cw(o,t,e,r),Tw[e.index].halfedges.push(s),Tw[t.index].halfedges.push(s),o}function lw(e,t,n){var r=[t,n];return r.left=e,r}function cw(e,t,n,r){e[0]||e[1]?e.left===n?e[1]=r:e[0]=r:(e[0]=r,e.left=t,e.right=n)}function fw(e,t,n,r,o){var s,a=e[0],b=e[1],u=a[0],l=a[1],c=0,d=1,h=b[0]-u,p=b[1]-l;if(s=t-u,h||!(s>0)){if(s/=h,h<0){if(s<c)return;s<d&&(d=s)}else if(h>0){if(s>d)return;s>c&&(c=s)}if(s=r-u,h||!(s<0)){if(s/=h,h<0){if(s>d)return;s>c&&(c=s)}else if(h>0){if(s<c)return;s<d&&(d=s)}if(s=n-l,p||!(s>0)){if(s/=p,p<0){if(s<c)return;s<d&&(d=s)}else if(p>0){if(s>d)return;s>c&&(c=s)}if(s=o-l,p||!(s<0)){if(s/=p,p<0){if(s>d)return;s>c&&(c=s)}else if(p>0){if(s<c)return;s<d&&(d=s)}return!(c>0||d<1)||(c>0&&(e[0]=[u+c*h,l+c*p]),d<1&&(e[1]=[u+d*h,l+d*p]),!0)}}}}}function dw(e,t,n,r,o){var s=e[1];if(s)return!0;var u,l,c=e[0],d=e.left,h=e.right,p=d[0],g=d[1],m=h[0],v=h[1],_=(p+m)/2,w=(g+v)/2;if(v===g){if(_<t||_>=r)return;if(p>m){if(c){if(c[1]>=o)return}else c=[_,n];s=[_,o]}else{if(c){if(c[1]<n)return}else c=[_,o];s=[_,n]}}else if(l=w-(u=(p-m)/(v-g))*_,u<-1||u>1)if(p>m){if(c){if(c[1]>=o)return}else c=[(n-l)/u,n];s=[(o-l)/u,o]}else{if(c){if(c[1]<n)return}else c=[(o-l)/u,o];s=[(n-l)/u,n]}else if(g<v){if(c){if(c[0]>=r)return}else c=[t,u*t+l];s=[r,u*r+l]}else{if(c){if(c[0]<t)return}else c=[r,u*r+l];s=[t,u*t+l]}return e[0]=c,e[1]=s,!0}function hw(e,t){var n=e.site,r=t.left,o=t.right;return n===o&&(o=r,r=n),o?Math.atan2(o[1]-r[1],o[0]-r[0]):(n===r?(r=t[1],o=t[0]):(r=t[0],o=t[1]),Math.atan2(r[0]-o[0],o[1]-r[1]))}function pw(e,t){return t[+(t.left!==e.site)]}function gw(e,t){return t[+(t.left===e.site)]}var mw,vw=[];function yw(e){var t=e.P,n=e.N;if(t&&n){var r=t.site,o=e.site,s=n.site;if(r!==s){var u=o[0],l=o[1],c=r[0]-u,d=r[1]-l,h=s[0]-u,p=s[1]-l,g=2*(c*p-d*h);if(!(g>=-Dw)){var m=c*c+d*d,v=h*h+p*p,x=(p*m-d*v)/g,y=(c*v-h*m)/g,_=vw.pop()||new function(){rw(this),this.x=this.y=this.arc=this.site=this.cy=null};_.arc=e,_.site=o,_.x=x+u,_.y=(_.cy=y+l)+Math.sqrt(x*x+y*y),e.circle=_;for(var w=null,E=Nw._;E;)if(_.y<E.y||_.y===E.y&&_.x<=E.x){if(!E.L){w=E.P;break}E=E.L}else{if(!E.R){w=E;break}E=E.R}Nw.insert(w,_),w||(mw=_)}}}}function bw(e){var t=e.circle;t&&(t.P||(mw=t.N),Nw.remove(t),vw.push(t),rw(t),e.circle=null)}var xw=[];function _w(e){var t=xw.pop()||new function(){rw(this),this.edge=this.site=this.circle=null};return t.site=e,t}function ww(e){bw(e),kw.remove(e),xw.push(e),rw(e)}function Ew(e){var t=e.circle,x=t.x,y=t.cy,n=[x,y],r=e.P,o=e.N,s=[e];ww(e);for(var u=r;u.circle&&Math.abs(x-u.circle.x)<Cw&&Math.abs(y-u.circle.cy)<Cw;)r=u.P,s.unshift(u),ww(u),u=r;s.unshift(u),bw(u);for(var l=o;l.circle&&Math.abs(x-l.circle.x)<Cw&&Math.abs(y-l.circle.cy)<Cw;)o=l.N,s.push(l),ww(l),l=o;s.push(l),bw(l);var c,d=s.length;for(c=1;c<d;++c)cw((l=s[c]).edge,(u=s[c-1]).site,l.site,n);(l=s[d-1]).edge=uw((u=s[0]).site,l.site,null,n),yw(u),yw(l)}function Ow(e){for(var t,n,r,o,x=e[0],s=e[1],u=kw._;u;)if((r=Sw(u,s)-x)>Cw)u=u.L;else{if(!((o=x-Aw(u,s))>Cw)){r>-Cw?(t=u.P,n=u):o>-Cw?(t=u,n=u.N):t=n=u;break}if(!u.R){t=u;break}u=u.R}!function(e){Tw[e.index]={site:e,halfedges:[]}}(e);var l=_w(e);if(kw.insert(t,l),t||n){if(t===n)return bw(t),n=_w(t.site),kw.insert(l,n),l.edge=n.edge=uw(t.site,l.site),yw(t),void yw(n);if(n){bw(t),bw(n);var c=t.site,d=c[0],h=c[1],p=e[0]-d,g=e[1]-h,m=n.site,v=m[0]-d,_=m[1]-h,w=2*(p*_-g*v),E=p*p+g*g,O=v*v+_*_,S=[(_*E-g*O)/w+d,(p*O-v*E)/w+h];cw(n.edge,c,m,S),l.edge=uw(c,e,null,S),n.edge=uw(e,m,null,S),yw(t),yw(n)}else l.edge=uw(t.site,l.site)}}function Sw(e,t){var n=e.site,r=n[0],o=n[1],s=o-t;if(!s)return r;var u=e.P;if(!u)return-1/0;var l=(n=u.site)[0],c=n[1],d=c-t;if(!d)return l;var h=l-r,p=1/s-1/d,b=h/d;return p?(-b+Math.sqrt(b*b-2*p*(h*h/(-2*d)-c+d/2+o-s/2)))/p+r:(r+l)/2}function Aw(e,t){var n=e.N;if(n)return Sw(n,t);var r=e.site;return r[1]===t?r[0]:1/0}var kw,Tw,Nw,Mw,Cw=1e-6,Dw=1e-12;function Rw(a,b){return b[1]-a[1]||b[0]-a[0]}function Iw(e,t){var x,y,n,r=e.sort(Rw).pop();for(Mw=[],Tw=new Array(e.length),kw=new sw,Nw=new sw;;)if(n=mw,r&&(!n||r[1]<n.y||r[1]===n.y&&r[0]<n.x))r[0]===x&&r[1]===y||(Ow(r),x=r[0],y=r[1]),r=e.pop();else{if(!n)break;Ew(n.arc)}if(function(){for(var e,t,j,n,i=0,r=Tw.length;i<r;++i)if((e=Tw[i])&&(n=(t=e.halfedges).length)){var o=new Array(n),s=new Array(n);for(j=0;j<n;++j)o[j]=j,s[j]=hw(e,Mw[t[j]]);for(o.sort(function(i,j){return s[j]-s[i]}),j=0;j<n;++j)s[j]=t[o[j]];for(j=0;j<n;++j)t[j]=s[j]}}(),t){var o=+t[0][0],s=+t[0][1],u=+t[1][0],l=+t[1][1];!function(e,t,n,r){for(var o,i=Mw.length;i--;)dw(o=Mw[i],e,t,n,r)&&fw(o,e,t,n,r)&&(Math.abs(o[0][0]-o[1][0])>Cw||Math.abs(o[0][1]-o[1][1])>Cw)||delete Mw[i]}(o,s,u,l),function(e,t,n,r){var o,s,u,l,c,d,h,p,g,m,v,_,w=Tw.length,E=!0;for(o=0;o<w;++o)if(s=Tw[o]){for(u=s.site,l=(c=s.halfedges).length;l--;)Mw[c[l]]||c.splice(l,1);for(l=0,d=c.length;l<d;)v=(m=gw(s,Mw[c[l]]))[0],_=m[1],p=(h=pw(s,Mw[c[++l%d]]))[0],g=h[1],(Math.abs(v-p)>Cw||Math.abs(_-g)>Cw)&&(c.splice(l,0,Mw.push(lw(u,m,Math.abs(v-e)<Cw&&r-_>Cw?[e,Math.abs(p-e)<Cw?g:r]:Math.abs(_-r)<Cw&&n-v>Cw?[Math.abs(g-r)<Cw?p:n,r]:Math.abs(v-n)<Cw&&_-t>Cw?[n,Math.abs(p-n)<Cw?g:t]:Math.abs(_-t)<Cw&&v-e>Cw?[Math.abs(g-t)<Cw?p:e,t]:null))-1),++d);d&&(E=!1)}if(E){var O,S,A,T=1/0;for(o=0,E=null;o<w;++o)(s=Tw[o])&&(A=(O=(u=s.site)[0]-e)*O+(S=u[1]-t)*S)<T&&(T=A,E=s);if(E){var N=[e,t],M=[e,r],C=[n,r],D=[n,t];E.halfedges.push(Mw.push(lw(u=E.site,N,M))-1,Mw.push(lw(u,M,C))-1,Mw.push(lw(u,C,D))-1,Mw.push(lw(u,D,N))-1)}}for(o=0;o<w;++o)(s=Tw[o])&&(s.halfedges.length||delete Tw[o])}(o,s,u,l)}this.edges=Mw,this.cells=Tw,kw=Nw=Mw=Tw=null}function Pw(e){ur.call(this,null,e)}Iw.prototype={constructor:Iw,polygons:function(){var e=this.edges;return this.cells.map(function(t){var n=t.halfedges.map(function(i){return pw(t,e[i])});return n.data=t.site.data,n})},triangles:function(){var e=[],t=this.edges;return this.cells.forEach(function(n,i){if(o=(r=n.halfedges).length)for(var r,o,s,a,b,u,l=n.site,j=-1,c=t[r[o-1]],d=c.left===l?c.right:c.left;++j<o;)s=d,d=(c=t[r[j]]).left===l?c.right:c.left,s&&d&&i<s.index&&i<d.index&&((a=l)[0]-(u=d)[0])*((b=s)[1]-a[1])-(a[0]-b[0])*(u[1]-a[1])<0&&e.push([l.data,s.data,d.data])}),e},links:function(){return this.edges.filter(function(e){return e.right}).map(function(e){return{source:e.left.data,target:e.right.data}})},find:function(x,y,radius){for(var e,t,n=this,r=n._found||0,o=n.cells.length;!(t=n.cells[r]);)if(++r>=o)return null;var s=x-t.site[0],u=y-t.site[1],l=s*s+u*u;do{t=n.cells[e=r],r=null,t.halfedges.forEach(function(e){var o=n.edges[e],s=o.left;if(s!==t.site&&s||(s=o.right)){var u=x-s[0],c=y-s[1],d=u*u+c*c;d<l&&(l=d,r=s.index)}})}while(null!==r);return n._found=e,null==radius||l<=radius*radius?t.site:null}},Pw.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};var Lw=[[-1e5,-1e5],[1e5,1e5]];Object(v.inherits)(Pw,ur).transform=function(e,t){var n,r,i,o,s=e.as||"path",u=t.source;for(n=function(){var x=ew,y=tw,e=null;function t(t){return new Iw(t.map(function(e,i){var n=[Math.round(x(e,i,t)/Cw)*Cw,Math.round(y(e,i,t)/Cw)*Cw];return n.index=i,n.data=e,n}),e)}return t.polygons=function(e){return t(e).polygons()},t.links=function(e){return t(e).links()},t.triangles=function(e){return t(e).triangles()},t.x=function(e){return arguments.length?(x="function"==typeof e?e:$_(+e),t):x},t.y=function(e){return arguments.length?(y="function"==typeof e?e:$_(+e),t):y},t.extent=function(n){return arguments.length?(e=null==n?null:[[+n[0][0],+n[0][1]],[+n[1][0],+n[1][1]]],t):e&&[[e[0][0],e[0][1]],[e[1][0],e[1][1]]]},t.size=function(n){return arguments.length?(e=null==n?null:[[0,0],[+n[0],+n[1]]],t):e&&[e[1][0]-e[0][0],e[1][1]-e[0][1]]},t}().x(e.x).y(e.y),e.size?n.size(e.size):n.extent(e.extent||Lw),this.value=n=n(u),r=n.polygons(),i=0,o=u.length;i<o;++i)u[i][s]=r[i]?"M"+r[i].join("L")+"Z":null;return t.reflow(e.modified()).modifies(s)};var zw=Math.PI/180,jw=64,Fw=2048,Uw=function(){var e,t,n,r,o,s,u,l=[256,256],c=Gw,d=[],h=Math.random,p={};function g(e,t,n){for(var r,o,s,a,b,u=t.x,d=t.y,p=Math.sqrt(l[0]*l[0]+l[1]*l[1]),g=c(l),m=h()<.5?1:-1,v=-m;(r=g(v+=m))&&(o=~~r[0],s=~~r[1],!(Math.min(Math.abs(o),Math.abs(s))>=p));)if(t.x=u+o,t.y=d+s,!(t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>l[0]||t.y+t.y1>l[1]||n&&Vw(t,e,l[0])||n&&!((a=t).x+a.x1>(b=n)[0].x&&a.x+a.x0<b[1].x&&a.y+a.y1>b[0].y&&a.y+a.y0<b[1].y))){for(var _,w=t.sprite,E=t.width>>5,O=l[0]>>5,S=t.x-(E<<4),A=127&S,T=32-A,N=t.y1-t.y0,x=(t.y+t.y0)*O+(S>>5),j=0;j<N;j++){_=0;for(var i=0;i<=E;i++)e[x+i]|=_<<T|(i<E?(_=w[j*E+i])>>>A:0);x+=O}return t.sprite=null,!0}return!1}return p.layout=function(){for(var c=function(e){e.width=e.height=1;var t=Math.sqrt(e.getContext("2d").getImageData(0,0,1,1).data.length>>2);e.width=(jw<<5)/t,e.height=Fw/t;var n=e.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:t}}(pa()),p=function(e){for(var a=[],i=-1;++i<e;)a[i]=0;return a}((l[0]>>5)*l[1]),m=null,v=d.length,i=-1,_=[],w=d.map(function(l){return{text:e(l),font:t(l),style:r(l),weight:o(l),rotate:s(l),size:~~n(l),padding:u(l),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:l}}).sort(function(a,b){return b.size-a.size});++i<v;){var E=w[i];E.x=l[0]*(h()+.5)>>1,E.y=l[1]*(h()+.5)>>1,Bw(c,E,w,i),E.hasText&&g(p,E,m)&&(_.push(E),m?qw(m,E):m=[{x:E.x+E.x0,y:E.y+E.y0},{x:E.x+E.x1,y:E.y+E.y1}],E.x-=l[0]>>1,E.y-=l[1]>>1)}return _},p.words=function(e){return arguments.length?(d=e,p):d},p.size=function(e){return arguments.length?(l=[+e[0],+e[1]],p):l},p.font=function(e){return arguments.length?(t=Ww(e),p):t},p.fontStyle=function(e){return arguments.length?(r=Ww(e),p):r},p.fontWeight=function(e){return arguments.length?(o=Ww(e),p):o},p.rotate=function(e){return arguments.length?(s=Ww(e),p):s},p.text=function(t){return arguments.length?(e=Ww(t),p):e},p.spiral=function(e){return arguments.length?(c=Hw[e]||e,p):c},p.fontSize=function(e){return arguments.length?(n=Ww(e),p):n},p.padding=function(e){return arguments.length?(u=Ww(e),p):u},p.random=function(e){return arguments.length?(h=e,p):h},p};function Bw(e,t,n,r){if(!t.sprite){var o=e.context,s=e.ratio;o.clearRect(0,0,(jw<<5)/s,Fw/s);var u,l,c,i,j,x=0,y=0,d=0,h=n.length;for(--r;++r<h;){if(t=n[r],o.save(),o.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font,u=o.measureText(t.text+"m").width*s,c=t.size<<1,t.rotate){var p=Math.sin(t.rotate*zw),g=Math.cos(t.rotate*zw),m=u*g,v=u*p,_=c*g,w=c*p;u=Math.max(Math.abs(m+w),Math.abs(m-w))+31>>5<<5,c=~~Math.max(Math.abs(v+_),Math.abs(v-_))}else u=u+31>>5<<5;if(c>d&&(d=c),x+u>=jw<<5&&(x=0,y+=d,d=0),y+c>=Fw)break;o.translate((x+(u>>1))/s,(y+(c>>1))/s),t.rotate&&o.rotate(t.rotate*zw),o.fillText(t.text,0,0),t.padding&&(o.lineWidth=2*t.padding,o.strokeText(t.text,0,0)),o.restore(),t.width=u,t.height=c,t.xoff=x,t.yoff=y,t.x1=u>>1,t.y1=c>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,x+=u}for(var E=o.getImageData(0,0,(jw<<5)/s,Fw/s).data,O=[];--r>=0;)if((t=n[r]).hasText){for(l=(u=t.width)>>5,c=t.y1-t.y0,i=0;i<c*l;i++)O[i]=0;if(null==(x=t.xoff))return;y=t.yoff;var S=0,A=-1;for(j=0;j<c;j++){for(i=0;i<u;i++){var T=E[(y+j)*(jw<<5)+(x+i)<<2]?1<<31-i%32:0;O[l*j+(i>>5)]|=T,S|=T}S?A=j:(t.y0++,c--,j--,y++)}t.y1=t.y0+A,t.sprite=O.slice(0,(t.y1-t.y0)*l)}}}function Vw(e,t,n){for(var r,o=e.sprite,s=e.width>>5,u=e.x-(s<<4),l=127&u,c=32-l,d=e.y1-e.y0,x=(e.y+e.y0)*(n>>=5)+(u>>5),j=0;j<d;j++){r=0;for(var i=0;i<=s;i++)if((r<<c|(i<s?(r=o[j*s+i])>>>l:0))&t[x+i])return!0;x+=n}return!1}function qw(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function Gw(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function Ww(e){return"function"==typeof e?e:function(){return e}}var Hw={archimedean:Gw,rectangular:function(e){var t=4*e[0]/e[1],x=0,y=0;return function(e){var n=e<0?-1:1;switch(Math.sqrt(1+4*n*e)-n&3){case 0:x+=t;break;case 1:y+=4;break;case 2:x-=t;break;default:y-=4}return[x,y]}}},Xw=["x","y","font","fontSize","fontStyle","fontWeight","angle"],Yw=["text","font","rotate","fontSize","fontStyle","fontWeight"];function Kw(e){ur.call(this,Uw(),e)}function Jw(e){return new Uint32Array(e)}function Zw(e,t,n){var r=(t<257?function(e){return new Uint8Array(e)}:t<65537?function(e){return new Uint16Array(e)}:Jw)(e);return n&&r.set(n),r}Kw.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:Xw}]},Object(v.inherits)(Kw,ur).transform=function(e,t){var n=e.modified();if(n||t.changed(t.ADD_REM)||Yw.some(function(n){var r=e[n];return Object(v.isFunction)(r)&&t.modified(r.fields)})){var r,o=t.materialize(t.SOURCE).source,s=this.value,u=e.as||Xw,l=e.fontSize||14;if(Object(v.isFunction)(l)?r=e.fontSizeRange:l=Object(v.constant)(l),r){var c=l,d=$d("sqrt")().domain(function(e,t){for(var n,r=1/0,o=-1/0,i=0,s=t.length;i<s;++i)(n=e(t[i]))<r&&(r=n),n>o&&(o=n);return[r,o]}(c,o)).range(r);l=function(x){return d(c(x))}}o.forEach(function(e){e[u[0]]=NaN,e[u[1]]=NaN,e[u[3]]=0});for(var h,p,g=s.words(o).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(l).random(Or).layout(),m=s.size(),_=m[0]>>1,w=m[1]>>1,i=0,E=g.length;i<E;++i)(p=(h=g[i]).datum)[u[0]]=h.x+_,p[u[1]]=h.y+w,p[u[2]]=h.font,p[u[3]]=h.size,p[u[4]]=h.style,p[u[5]]=h.weight,p[u[6]]=h.rotate;return t.reflow(n).modifies(u)}};var Qw=function(e,i,t){var n=1<<i;return{one:n,zero:~n,range:t.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd:function(e,t){var i,r=this.bisect(this.range,e.value),o=e.index,s=r[0],u=r[1],l=o.length;for(i=0;i<s;++i)t[o[i]]|=n;for(i=u;i<l;++i)t[o[i]]|=n;return this}}};function $w(){var e=Jw(0),value=[],t=0;return{insert:function(n,r,o){if(!r.length)return[];var s,u,i,l=t,c=r.length,d=Array(c),h=Jw(c);for(i=0;i<c;++i)d[i]=n(r[i]),h[i]=i;if(d=function(e,t){return e.sort.call(t,function(a,b){var x=e[a],y=e[b];return x<y?-1:x>y?1:0}),Wr(e,t)}(d,h),l)s=value,u=e,value=Array(l+c),e=Jw(l+c),function(e,t,n,r,o,s,u,value,l){var i,c=0,d=0;for(i=0;c<r&&d<u;++i)t[c]<o[d]?(value[i]=t[c],l[i]=n[c++]):(value[i]=o[d],l[i]=s[d++]+e);for(;c<r;++c,++i)value[i]=t[c],l[i]=n[c];for(;d<u;++d,++i)value[i]=o[d],l[i]=s[d]+e}(o,s,u,l,d,h,c,value,e);else{if(o>0)for(i=0;i<c;++i)h[i]+=o;value=d,e=h}return t=l+c,{index:h,value:d}},remove:function(n,r){var o,i,j,s=t;for(i=0;!r[e[i]]&&i<s;++i);for(j=i;i<s;++i)r[o=e[i]]||(e[j]=o,value[j]=value[i],++j);t=s-n},bisect:function(e,n){var r;return n?r=n.length:(n=value,r=t),[Mr(n,e[0],0,r),Nr(n,e[1],0,r)]},reindex:function(n){for(var i=0,r=t;i<r;++i)e[i]=n[e[i]]},index:function(){return e},size:function(){return t}}}function eE(e){var t,n,r,o,s;ur.call(this,(t=8,n=[],r=Jw(0),o=Zw(0,t),s=Zw(0,t),{data:function(){return n},seen:function(){return r=(e=r).length>=(t=n.length)?e:((o=o||new e.constructor(t)).set(e),o);var e,t,o},add:function(e){for(var t,i=0,j=n.length,r=e.length;i<r;++i)(t=e[i])._index=j++,n.push(t)},remove:function(e,t){var r,i,j,u=n.length,l=Array(u-e),c=n;for(i=0;!t[i]&&i<u;++i)l[i]=n[i],c[i]=i;for(j=i;i<u;++i)r=n[i],t[i]?c[i]=-1:(c[i]=j,o[j]=o[i],s[j]=s[i],l[j]=r,r._index=j++),o[i]=0;return n=l,c},size:function(){return n.length},curr:function(){return o},prev:function(){return s},reset:function(k){s[k]=o[k]},all:function(){return t<257?255:t<65537?65535:4294967295},set:function(k,e){o[k]|=e},clear:function(k,e){o[k]&=~e},resize:function(e,n){(e>o.length||n>t)&&(t=Math.max(n,t),o=Zw(e,t,o),s=Zw(e,t))}}),e),this._indices=null,this._dims=null}eE.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};var tE=Object(v.inherits)(eE,ur);function nE(e){ur.call(this,null,e)}tE.transform=function(e,t){return this._dims?e.modified("fields")||e.fields.some(function(f){return t.modified(f.fields)})?this.reinit(e,t):this.eval(e,t):this.init(e,t)},tE.init=function(e,t){for(var n,r,o=e.fields,s=e.query,u=this._indices={},l=this._dims=[],c=s.length,i=0;i<c;++i)r=u[n=o[i].fname]||(u[n]=$w()),l.push(Qw(r,i,s[i]));return this.eval(e,t)},tE.reinit=function(e,t){var n,r,o,s,u,l,i,c,f,d=t.materialize().fork(),h=e.fields,p=e.query,g=this._indices,m=this._dims,v=this.value,_=v.curr(),w=v.prev(),E=v.all(),O=d.rem=d.add,S=d.mod,A=p.length,T={};if(w.set(_),t.rem.length&&(u=this.remove(e,t,d)),t.add.length&&v.add(t.add),t.mod.length)for(l={},i=0,c=(s=t.mod).length;i<c;++i)l[s[i]._index]=1;for(i=0;i<A;++i)f=h[i],(!m[i]||e.modified("fields",i)||t.modified(f.fields))&&((n=T[o=f.fname])||(g[o]=r=$w(),T[o]=n=r.insert(f,t.source,0)),m[i]=Qw(r,i,p[i]).onAdd(n,_));for(i=0,c=v.data().length;i<c;++i)u[i]||(w[i]!==_[i]?O.push(i):l[i]&&_[i]!==E&&S.push(i));return v.mask=(1<<A)-1,d},tE.eval=function(e,t){var n=t.materialize().fork(),r=this._dims.length,o=0;return t.rem.length&&(this.remove(e,t,n),o|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(o|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),o|=(1<<r)-1),t.mod.length&&(this.modify(t,n),o|=(1<<r)-1),this.value.mask=o,n},tE.insert=function(e,t,n){var j,r,o,s=t.add,u=this.value,l=this._dims,c=this._indices,d=e.fields,h={},p=n.add,k=u.size(),g=k+s.length,m=l.length;u.resize(g,m),u.add(s);var v=u.curr(),_=u.prev(),w=u.all();for(j=0;j<m;++j)o=h[r=d[j].fname]||(h[r]=c[r].insert(d[j],s,k)),l[j].onAdd(o,v);for(;k<g;++k)_[k]=w,v[k]!==w&&p.push(k)},tE.modify=function(e,t){var i,n,k,r=t.mod,o=this.value,s=o.curr(),u=o.all(),l=e.mod;for(i=0,n=l.length;i<n;++i)s[k=l[i]._index]!==u&&r.push(k)},tE.remove=function(e,t,n){var i,r,k,f,o=this._indices,s=this.value,u=s.curr(),l=s.prev(),c=s.all(),d={},h=n.rem,p=t.rem;for(i=0,r=p.length;i<r;++i)d[k=p[i]._index]=1,l[k]=f=u[k],u[k]=c,f!==c&&h.push(k);for(k in o)o[k].remove(r,d);return this.reindex(t,r,d),d},tE.reindex=function(e,t,n){var r=this._indices,o=this.value;e.runAfter(function(){var e=o.remove(t,n);for(var s in r)r[s].reindex(e)})},tE.update=function(e,t,n){var i,r,o=this._dims,s=e.query,u=t.stamp,l=o.length,c=0;for(n.filters=0,r=0;r<l;++r)e.modified("query",r)&&(i=r,++c);if(1===c)c=o[i].one,this.incrementOne(o[i],s[i],n.add,n.rem);else for(r=0,c=0;r<l;++r)e.modified("query",r)&&(c|=o[r].one,this.incrementAll(o[r],s[r],u,n.add),n.rem=n.add);return c},tE.incrementAll=function(e,t,n,r){var i,j,k,o=this.value,s=o.seen(),u=o.curr(),l=o.prev(),c=e.index(),d=e.bisect(e.range),h=e.bisect(t),p=h[0],g=h[1],m=d[0],v=d[1],_=e.one;if(p<m)for(i=p,j=Math.min(m,g);i<j;++i)s[k=c[i]]!==n&&(l[k]=u[k],s[k]=n,r.push(k)),u[k]^=_;else if(p>m)for(i=m,j=Math.min(p,v);i<j;++i)s[k=c[i]]!==n&&(l[k]=u[k],s[k]=n,r.push(k)),u[k]^=_;if(g>v)for(i=Math.max(p,v),j=g;i<j;++i)s[k=c[i]]!==n&&(l[k]=u[k],s[k]=n,r.push(k)),u[k]^=_;else if(g<v)for(i=Math.max(m,g),j=v;i<j;++i)s[k=c[i]]!==n&&(l[k]=u[k],s[k]=n,r.push(k)),u[k]^=_;e.range=t.slice()},tE.incrementOne=function(e,t,n,r){var i,j,k,o=this.value.curr(),s=e.index(),u=e.bisect(e.range),l=e.bisect(t),c=l[0],d=l[1],h=u[0],p=u[1],g=e.one;if(c<h)for(i=c,j=Math.min(h,d);i<j;++i)o[k=s[i]]^=g,n.push(k);else if(c>h)for(i=h,j=Math.min(c,p);i<j;++i)o[k=s[i]]^=g,r.push(k);if(d>p)for(i=Math.max(c,p),j=d;i<j;++i)o[k=s[i]]^=g,n.push(k);else if(d<p)for(i=Math.max(h,d),j=p;i<j;++i)o[k=s[i]]^=g,r.push(k);e.range=t.slice()},nE.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},Object(v.inherits)(nE,ur).transform=function(e,t){var n=~(e.ignore||0),r=e.filter,o=r.mask;if(0==(o&n))return t.StopPropagation;var s=t.fork(t.ALL),u=r.data(),l=r.curr(),c=r.prev(),d=function(k){return l[k]&n?null:u[k]};return s.filter(s.MOD,d),o&o-1?(s.filter(s.ADD,function(k){var e=l[k]&n;return!e&&e^c[k]&n?u[k]:null}),s.filter(s.REM,function(k){var e=l[k]&n;return!e||e^e^c[k]&n?null:u[k]})):(s.filter(s.ADD,d),s.filter(s.REM,function(k){return(l[k]&n)===o?u[k]:null})),s.filter(s.SOURCE,function(e){return d(e._index)})};var rE=n("SeQP"),iE=function(e){var t=e._signals.cursor;t||(e._signals.cursor=t=e.add({user:"default",item:null})),e.on(e.events("view","mousemove"),t,function(e,n){var value=t.value,r=value?Object(v.isString)(value)?value:value.user:"default",o=n.item&&n.item.cursor||null;return value&&r===value.user&&o==value.item?value:{user:r,item:o}}),e.add(null,function(e){var t=e.cursor,n=this.value;return Object(v.isString)(t)||(n=t.item,t=t.user),"undefined"!=typeof document&&document.body&&(document.body.style.cursor=t&&"default"!==t?t:n||t),n},{cursor:t})};function aE(e,t){var n=e._runtime.data;return n.hasOwnProperty(t)||Object(v.error)("Unrecognized data set: "+t),n[t]}function oE(e,t){D(t)||Object(v.error)("Second argument to changes must be a changeset.");var n=aE(this,e);return n.modified=!0,this.pulse(n.input,t)}function sE(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function uE(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function lE(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function cE(e){return e.item}function fE(e){var t=e.item.mark.source;return t.source||t}function dE(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}var hE=function(e,t,n){var r=document.createElement(e);for(var o in t)r.setAttribute(o,t[o]);return null!=n&&(r.textContent=n),r},pE="vega-bind-radio",gE="vega-option-";function mE(e,t,n,value){var r=hE("input");for(var o in n)"signal"!==o&&"element"!==o&&r.setAttribute("input"===o?"type":o,n[o]);r.setAttribute("name",n.signal),r.value=value,t.appendChild(r),r.addEventListener("input",function(){e.update(r.value)}),e.elements=[r],e.set=function(value){r.value=value}}function vE(e,t,n,value){var r={type:"checkbox",name:n.signal};value&&(r.checked=!0);var o=hE("input",r);t.appendChild(o),o.addEventListener("change",function(){e.update(o.checked)}),e.elements=[o],e.set=function(value){o.checked=!!value||null}}function yE(e,t,n,value){var r=hE("select",{name:n.signal});n.options.forEach(function(e){var t={value:e};_E(e,value)&&(t.selected=!0),r.appendChild(hE("option",t,e+""))}),t.appendChild(r),r.addEventListener("change",function(){e.update(n.options[r.selectedIndex])}),e.elements=[r],e.set=function(value){for(var i=0,e=n.options.length;i<e;++i)if(_E(n.options[i],value))return void(r.selectedIndex=i)}}function bE(e,t,n,value){var r=hE("span",{class:pE});t.appendChild(r),e.elements=n.options.map(function(t){var o=gE+n.signal+"-"+t,s={id:o,type:"radio",name:n.signal,value:t};_E(t,value)&&(s.checked=!0);var u=hE("input",s);return u.addEventListener("change",function(){e.update(t)}),r.appendChild(u),r.appendChild(hE("label",{for:o},t+"")),u}),e.set=function(value){for(var t=e.elements,i=0,n=t.length;i<n;++i)_E(t[i].value,value)&&(t[i].checked=!0)}}function xE(e,t,n,value){value=void 0!==value?value:(+n.max+ +n.min)/2;var r=n.min||Math.min(0,+value)||0,o=n.max||Math.max(100,+value)||100,s=n.step||Ur(r,o,100),u=hE("input",{type:"range",name:n.signal,min:r,max:o,step:s});u.value=value;var l=hE("label",{},+value);function c(){l.textContent=u.value,e.update(+u.value)}t.appendChild(u),t.appendChild(l),u.addEventListener("input",c),u.addEventListener("change",c),e.elements=[u],e.set=function(value){u.value=value,l.textContent=value}}function _E(a,b){return a===b||a+""==b+""}var wE=function(e,t,n,r,o){return(t=t||new r(e.loader())).initialize(n,sE(e),uE(e),lE(e),o).background(e._background)};function EE(e,t){if("string"==typeof t){if("undefined"==typeof document)return e.error("DOM document instance not found."),null;if(!(t=document.querySelector(t)))return e.error("Signal bind element not found: "+t),null}if(t)try{t.innerHTML=""}catch(n){t=null,e.error(n)}return t}var OE=function(e,t,n){var r=Sl(t),o=r&&r.headless;return o?e.runAsync().then(function(){return wE(e,null,null,o,n).renderAsync(e._scenegraph.root)}):Promise.reject("Unrecognized renderer type: "+t)};function SE(e){return+e||0}var AE=["value","update","react","bind"];function kE(e,t){Object(v.error)(e+' for "outer" push: '+Object(v.stringValue)(t))}var TE,NE,ME,CE,DE,RE=function(e,t){var n=e.name;if("outer"===e.push)t.signals[n]||kE("No prior signal definition",n),AE.forEach(function(t){void 0!==e[t]&&kE("Invalid property ",t)});else{var r=t.addSignal(n,e.value);!1===e.react&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}};function IE(e){this.type=e}IE.prototype.visit=function(e){var t,i,n;if(e(this))return 1;for(i=0,n=(t=function(e){switch(e.type){case"ArrayExpression":return e.elements;case"BinaryExpression":case"LogicalExpression":return[e.left,e.right];case"CallExpression":var t=e.arguments.slice();return t.unshift(e.callee),t;case"ConditionalExpression":return[e.test,e.consequent,e.alternate];case"MemberExpression":return[e.object,e.property];case"ObjectExpression":return e.properties;case"Property":return[e.key,e.value];case"UnaryExpression":return[e.argument];case"Identifier":case"Literal":case"RawCode":default:return[]}}(this)).length;i<n;++i)if(t[i].visit(e))return 1};var PE=1,LE=2,zE=3,jE=4,FE=5,UE=6,BE=7,VE=8;(TE={})[PE]="Boolean",TE[LE]="<end>",TE[zE]="Identifier",TE[jE]="Keyword",TE[FE]="Null",TE[UE]="Numeric",TE[BE]="Punctuator",TE[VE]="String",TE[9]="RegularExpression";var qE="ArrayExpression",GE="BinaryExpression",WE="CallExpression",HE="ConditionalExpression",XE="Identifier",YE="Literal",KE="LogicalExpression",JE="MemberExpression",ZE="ObjectExpression",QE="Property",$E="UnaryExpression",eO="Unexpected token %0",tO="Unexpected number",nO="Unexpected string",rO="Unexpected identifier",iO="Unexpected reserved word",aO="Unexpected end of input",oO="Invalid regular expression",sO="Invalid regular expression: missing /",uO="Octal literals are not allowed in strict mode.",lO="Duplicate data property in object literal not allowed in strict mode",cO="ILLEGAL",fO="Disabled.",dO=new RegExp("[\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0-\u08b2\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]"),hO=new RegExp("[\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u0487\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u0669\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07c0-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0-\u08b2\u08e4-\u0963\u0966-\u096f\u0971-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09e6-\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a66-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b66-\u0b6f\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0be6-\u0bef\u0c00-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0ce6-\u0cef\u0cf1\u0cf2\u0d01-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d66-\u0d6f\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e50-\u0e59\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1049\u1050-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191e\u1920-\u192b\u1930-\u193b\u1946-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u19d0-\u19d9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1aa7\u1ab0-\u1abd\u1b00-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1bf3\u1c00-\u1c37\u1c40-\u1c49\u1c4d-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1cf8\u1cf9\u1d00-\u1df5\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200c\u200d\u203f\u2040\u2054\u2071\u207f\u2090-\u209c\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005-\u3007\u3021-\u302f\u3031-\u3035\u3038-\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua62b\ua640-\ua66f\ua674-\ua67d\ua67f-\ua69d\ua69f-\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua827\ua840-\ua873\ua880-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f7\ua8fb\ua900-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf-\ua9d9\ua9e0-\ua9fe\uaa00-\uaa36\uaa40-\uaa4d\uaa50-\uaa59\uaa60-\uaa76\uaa7a-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabea\uabec\uabed\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe2d\ufe33\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]");function pO(e,t){if(!e)throw new Error("ASSERT: "+t)}function gO(e){return e>=48&&e<=57}function mO(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function vO(e){return"01234567".indexOf(e)>=0}function yO(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function bO(e){return 10===e||13===e||8232===e||8233===e}function xO(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&dO.test(String.fromCharCode(e))}function _O(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&hO.test(String.fromCharCode(e))}var wO={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function EO(){for(var e;ME<CE&&(yO(e=NE.charCodeAt(ME))||bO(e));)++ME}function OO(e){var i,t,n,r=0;for(t="u"===e?4:2,i=0;i<t;++i)ME<CE&&mO(NE[ME])?(n=NE[ME++],r=16*r+"0123456789abcdef".indexOf(n.toLowerCase())):jO({},eO,cO);return String.fromCharCode(r)}function SO(){var e,t;for(t=0,"}"===(e=NE[ME])&&jO({},eO,cO);ME<CE&&mO(e=NE[ME++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&jO({},eO,cO),t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}function AO(){var e,t;for(e=NE.charCodeAt(ME++),t=String.fromCharCode(e),92===e&&(117!==NE.charCodeAt(ME)&&jO({},eO,cO),++ME,(e=OO("u"))&&"\\"!==e&&xO(e.charCodeAt(0))||jO({},eO,cO),t=e);ME<CE&&_O(e=NE.charCodeAt(ME));)++ME,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==NE.charCodeAt(ME)&&jO({},eO,cO),++ME,(e=OO("u"))&&"\\"!==e&&_O(e.charCodeAt(0))||jO({},eO,cO),t+=e);return t}function kO(){var e,t,n,r,o=ME,s=NE.charCodeAt(ME),u=NE[ME];switch(s){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++ME,{type:BE,value:String.fromCharCode(s),start:o,end:ME};default:if(61===(e=NE.charCodeAt(ME+1)))switch(s){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return ME+=2,{type:BE,value:String.fromCharCode(s)+String.fromCharCode(e),start:o,end:ME};case 33:case 61:return 61===NE.charCodeAt(ME+=2)&&++ME,{type:BE,value:NE.slice(o,ME),start:o,end:ME}}}return">>>="===(r=NE.substr(ME,4))?{type:BE,value:r,start:o,end:ME+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:BE,value:n,start:o,end:ME+=3}:u===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(u)>=0||"=>"===t?{type:BE,value:t,start:o,end:ME+=2}:"<>=!+-*%&|^/".indexOf(u)>=0?{type:BE,value:u,start:o,end:++ME}:void jO({},eO,cO)}function TO(){var e,t,n;if(pO(gO((n=NE[ME]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=ME,e="","."!==n){if(e=NE[ME++],n=NE[ME],"0"===e){if("x"===n||"X"===n)return++ME,function(e){for(var t="";ME<CE&&mO(NE[ME]);)t+=NE[ME++];return 0===t.length&&jO({},eO,cO),xO(NE.charCodeAt(ME))&&jO({},eO,cO),{type:UE,value:parseInt("0x"+t,16),start:e,end:ME}}(t);if(vO(n))return function(e){for(var t="0"+NE[ME++];ME<CE&&vO(NE[ME]);)t+=NE[ME++];return(xO(NE.charCodeAt(ME))||gO(NE.charCodeAt(ME)))&&jO({},eO,cO),{type:UE,value:parseInt(t,8),octal:!0,start:e,end:ME}}(t);n&&gO(n.charCodeAt(0))&&jO({},eO,cO)}for(;gO(NE.charCodeAt(ME));)e+=NE[ME++];n=NE[ME]}if("."===n){for(e+=NE[ME++];gO(NE.charCodeAt(ME));)e+=NE[ME++];n=NE[ME]}if("e"===n||"E"===n)if(e+=NE[ME++],"+"!==(n=NE[ME])&&"-"!==n||(e+=NE[ME++]),gO(NE.charCodeAt(ME)))for(;gO(NE.charCodeAt(ME));)e+=NE[ME++];else jO({},eO,cO);return xO(NE.charCodeAt(ME))&&jO({},eO,cO),{type:UE,value:parseFloat(e),start:t,end:ME}}function NO(){var e,t,n;return EO(),ME>=CE?{type:LE,start:ME,end:ME}:xO(e=NE.charCodeAt(ME))?(t=ME,{type:1===(n=92===NE.charCodeAt(ME)?AO():function(){var e,t;for(e=ME++;ME<CE;){if(92===(t=NE.charCodeAt(ME)))return ME=e,AO();if(!_O(t))break;++ME}return NE.slice(e,ME)}()).length?zE:wO.hasOwnProperty(n)?jE:"null"===n?FE:"true"===n||"false"===n?PE:zE,value:n,start:t,end:ME}):40===e||41===e||59===e?kO():39===e||34===e?function(){var e,t,n,r,o="",s=!1;for(pO("'"===(e=NE[ME])||'"'===e,"String literal must starts with a quote"),t=ME,++ME;ME<CE;){if((n=NE[ME++])===e){e="";break}if("\\"===n)if((n=NE[ME++])&&bO(n.charCodeAt(0)))"\r"===n&&"\n"===NE[ME]&&++ME;else switch(n){case"u":case"x":"{"===NE[ME]?(++ME,o+=SO()):o+=OO(n);break;case"n":o+="\n";break;case"r":o+="\r";break;case"t":o+="\t";break;case"b":o+="\b";break;case"f":o+="\f";break;case"v":o+="\v";break;default:vO(n)?(0!==(r="01234567".indexOf(n))&&(s=!0),ME<CE&&vO(NE[ME])&&(s=!0,r=8*r+"01234567".indexOf(NE[ME++]),"0123".indexOf(n)>=0&&ME<CE&&vO(NE[ME])&&(r=8*r+"01234567".indexOf(NE[ME++]))),o+=String.fromCharCode(r)):o+=n}else{if(bO(n.charCodeAt(0)))break;o+=n}}return""!==e&&jO({},eO,cO),{type:VE,value:o,octal:s,start:t,end:ME}}():46===e?gO(NE.charCodeAt(ME+1))?TO():kO():gO(e)?TO():kO()}function MO(){var e;return ME=(e=DE).end,DE=NO(),ME=e.end,e}function CO(){var e;e=ME,DE=NO(),ME=e}function DO(e,t,n){var r=new IE("||"===e||"&&"===e?KE:GE);return r.operator=e,r.left=t,r.right=n,r}function RO(e,t){var n=new IE(WE);return n.callee=e,n.arguments=t,n}function IO(e){var t=new IE(XE);return t.name=e,t}function PO(e){var t=new IE(YE);return t.value=e.value,t.raw=NE.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function LO(e,t,n){var r=new IE(JE);return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function zO(e,t,value){var n=new IE(QE);return n.key=t,n.value=value,n.kind=e,n}function jO(e,t){var n,r=Array.prototype.slice.call(arguments,2),o=t.replace(/%(\d)/g,function(e,t){return pO(t<r.length,"Message reference must be in range"),r[t]});throw(n=new Error(o)).index=ME,n.description=o,n}function FO(e){e.type===LE&&jO(e,aO),e.type===UE&&jO(e,tO),e.type===VE&&jO(e,nO),e.type===zE&&jO(e,rO),e.type===jE&&jO(e,iO),jO(e,eO,e.value)}function UO(value){var e=MO();e.type===BE&&e.value===value||FO(e)}function BO(value){return DE.type===BE&&DE.value===value}function VO(e){return DE.type===jE&&DE.value===e}function qO(){var e;return ME=DE.start,(e=MO()).type===VE||e.type===UE?(e.octal&&jO(e,uO),PO(e)):IO(e.value)}function GO(){var e,t,n;return ME=DE.start,(e=DE).type===zE?(n=qO(),UO(":"),zO("init",n,ZO())):e.type!==LE&&e.type!==BE?(t=qO(),UO(":"),zO("init",t,ZO())):void FO(e)}var WO={if:1,this:1};function HO(){var e=[];if(UO("("),!BO(")"))for(;ME<CE&&(e.push(ZO()),!BO(")"));)UO(",");return UO(")"),e}function XO(){var e;return UO("["),e=QO(),UO("]"),e}function YO(){var e=function(){var e,t;for(e=function(){var e,t,n,r,o,s,value;if(BO("("))return function(){var e;return UO("("),e=QO(),UO(")"),e}();if(BO("["))return function(){var e=[];for(ME=DE.start,UO("[");!BO("]");)BO(",")?(MO(),e.push(null)):(e.push(ZO()),BO("]")||UO(","));return MO(),function(e){var t=new IE(qE);return t.elements=e,t}(e)}();if(BO("{"))return function(){var e,t,n=[],r={},o=String;for(ME=DE.start,UO("{");!BO("}");)t="$"+((e=GO()).key.type===XE?e.key.name:o(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?jO({},lO):r[t]=!0,n.push(e),BO("}")||UO(",");return UO("}"),function(e){var t=new IE(ZE);return t.properties=e,t}(n)}();if(ME=DE.start,(e=DE.type)===zE||WO[DE.value])n=IO(MO().value);else if(e===VE||e===UE)DE.octal&&jO(DE,uO),n=PO(MO());else{if(e===jE)throw new Error(fO);e===PE?((t=MO()).value="true"===t.value,n=PO(t)):e===FE?((t=MO()).value=null,n=PO(t)):BO("/")||BO("/=")?(n=PO((DE=null,EO(),r=ME,o=function(){var e,t,n,r;for(pO("/"===(e=NE[ME]),"Regular expression literal must start with a slash"),t=NE[ME++],n=!1,r=!1;ME<CE;)if(t+=e=NE[ME++],"\\"===e)bO((e=NE[ME++]).charCodeAt(0))&&jO({},sO),t+=e;else if(bO(e.charCodeAt(0)))jO({},sO);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||jO({},sO),{value:t.substr(1,t.length-2),literal:t}}(),s=function(){var e,t,n;for(t="",n="";ME<CE&&_O((e=NE[ME]).charCodeAt(0));)++ME,"\\"===e&&ME<CE?jO({},eO,cO):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&jO({},oO,n),{value:n,literal:t}}(),value=function(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(e,t){if(parseInt(t,16)<=1114111)return"x";jO({},oO)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(e){jO({},oO)}try{return new RegExp(e,t)}catch(e){return null}}(o.value,s.value),{literal:o.literal+s.literal,value:value,regex:{pattern:o.value,flags:s.value},start:r,end:ME})),CO()):FO(MO())}return n}();;)if(BO("."))UO("."),e=LO(".",e,(t=void 0,ME=DE.start,function(e){return e.type===zE||e.type===jE||e.type===PE||e.type===FE}(t=MO())||FO(t),IO(t.value)));else if(BO("("))e=RO(e,HO());else{if(!BO("["))break;e=LO("[",e,XO())}return e}();if(DE.type===BE&&(BO("++")||BO("--")))throw new Error(fO);return e}function KO(){var e,t,n,r,o;if(DE.type!==BE&&DE.type!==jE)t=YO();else{if(BO("++")||BO("--"))throw new Error(fO);if(BO("+")||BO("-")||BO("~")||BO("!"))e=MO(),t=KO(),n=e.value,r=t,(o=new IE($E)).operator=n,o.argument=r,o.prefix=!0,t=o;else{if(VO("delete")||VO("void")||VO("typeof"))throw new Error(fO);t=YO()}}return t}function JO(e){var t=0;if(e.type!==BE&&e.type!==jE)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function ZO(){var e,t;return e=function(){var e,t,n,r,o,s,u,l,c,i;if(e=DE,c=KO(),0===(o=JO(r=DE)))return c;for(r.prec=o,MO(),t=[e,DE],s=[c,r,u=KO()];(o=JO(DE))>0;){for(;s.length>2&&o<=s[s.length-2].prec;)u=s.pop(),l=s.pop().value,c=s.pop(),t.pop(),n=DO(l,c,u),s.push(n);(r=MO()).prec=o,s.push(r),t.push(DE),n=KO(),s.push(n)}for(n=s[i=s.length-1],t.pop();i>1;)t.pop(),n=DO(s[i-1].value,s[i-2],n),i-=2;return n}(),BO("?")&&(MO(),t=ZO(),UO(":"),e=function(e,t,n){var r=new IE(HE);return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,ZO())),e}function QO(){var e=ZO();if(BO(","))throw new Error(fO);return e}var $O={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"},eS=function(e){function t(t,n,r){return function(o){return function(t,n,r,o){var s=e(n[0]);return r&&(s=r+"("+s+")",0===r.lastIndexOf("new ",0)&&(s="("+s+")")),s+"."+t+(o<0?"":0===o?"()":"("+n.slice(1).map(e).join(",")+")")}(t,o,n,r)}}var n="new Date";return{isNaN:"isNaN",isFinite:"isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){t.length<3&&Object(v.error)("Missing arguments to clamp function."),t.length>3&&Object(v.error)("Too many arguments to clamp function.");var a=t.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:t("getDate",n,0),day:t("getDay",n,0),year:t("getFullYear",n,0),month:t("getMonth",n,0),hours:t("getHours",n,0),minutes:t("getMinutes",n,0),seconds:t("getSeconds",n,0),milliseconds:t("getMilliseconds",n,0),time:t("getTime",n,0),timezoneoffset:t("getTimezoneOffset",n,0),utcdate:t("getUTCDate",n,0),utcday:t("getUTCDay",n,0),utcyear:t("getUTCFullYear",n,0),utcmonth:t("getUTCMonth",n,0),utchours:t("getUTCHours",n,0),utcminutes:t("getUTCMinutes",n,0),utcseconds:t("getUTCSeconds",n,0),utcmilliseconds:t("getUTCMilliseconds",n,0),length:t("length",null,-1),indexof:t("indexOf",null),lastindexof:t("lastIndexOf",null),slice:t("slice",null),parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase","String",0),lower:t("toLowerCase","String",0),substring:t("substring","String"),replace:t("replace","String"),regexp:"RegExp",test:t("test","RegExp"),if:function(t){t.length<3&&Object(v.error)("Missing arguments to if function."),t.length>3&&Object(v.error)("Too many arguments to if function.");var a=t.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}},tS={};function nS(e,t,n){var k=e+":"+n,r=tS[k];return r&&r[0]===t||(tS[k]=r=[t,t(n)]),r[1]}function rS(e,t){return nS("timeFormat",kt,t)(e)}var iS=new Date(2e3,0,1);function aS(e,t,n){return iS.setMonth(e),iS.setDate(t),rS(iS,n)}function oS(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(t){e.warn(t)}return n[n.length-1]}var sS="undefined"!=typeof window&&window||null,uS="Literal",lS="Identifier",cS="@",fS="%",dS=":";function hS(e,t){var n;return Object(v.isFunction)(e)?e:Object(v.isString)(e)?(n=t.scales[e])&&n.value:void 0}function pS(e,t,n){var r=fS+n;if(!t.hasOwnProperty(r))try{t[r]=e.scaleRef(n)}catch(e){}}function gS(e,t,n,r){if(t[0].type===uS)pS(n,r,t[0].value);else if(t[0].type===lS)for(e in n.scales)pS(n,r,e)}function mS(e,t){return function(n,r,o){if(n){var s=hS(n,(o||this).context);return s&&s.path[e](r)}return t(r)}}var vS=mS("area",function(e){return Om.reset(),wm(e,Sm),2*Om}),yS=mS("bounds",function(e){var i,t,a,b,n,r,o;if(Um=Fm=-(zm=jm=1/0),Wm=[],wm(e,Ym),t=Wm.length){for(Wm.sort(rv),i=1,n=[a=Wm[0]];i<t;++i)iv(a,(b=Wm[i])[0])||iv(a,b[1])?(nv(a[0],b[1])>nv(a[0],a[1])&&(a[1]=b[1]),nv(b[0],a[1])>nv(a[0],a[1])&&(a[0]=b[0])):n.push(a=b);for(r=-1/0,i=0,a=n[t=n.length-1];i<=t;a=b,++i)(o=nv(a[1],(b=n[i])[0]))>r&&(r=o,zm=b[0],Fm=a[1])}return Wm=Hm=null,zm===1/0||jm===1/0?[[NaN,NaN],[NaN,NaN]]:[[zm,jm],[Fm,Um]]}),bS=mS("centroid",function(e){av=ov=sv=uv=lv=cv=fv=dv=hv=pv=gv=0,wm(e,_v);var x=hv,y=pv,t=gv,n=x*x+y*y+t*t;return n<1e-12&&(x=cv,y=fv,t=dv,ov<Gg&&(x=sv,y=uv,t=lv),(n=x*x+y*y+t*t)<1e-12)?[NaN,NaN]:[$g(y,x)*Kg,cm(t/sm(n))*Kg]});function xS(e){var t=this.context.data[e];return t?t.values.value:[]}function _S(e,t,n,r){t[0].type!==uS&&Object(v.error)("First argument to data functions must be a string literal.");var o=t[0].value,s=dS+o;r.hasOwnProperty(s)||(r[s]=n.getData(o).tuplesRef())}var wS={};function ES(e){return e.data}function OS(e,t){var n=xS.call(t,e);return n.root&&n.root.lookup||wS}var SS=function(value,e,t,n){var r,o=e[0],s=e[e.length-1];return o>s&&(r=o,o=s,s=r),t=void 0===t||t,n=void 0===n||n,(t?o<=value:o<value)&&(n?value<=s:value<s)};function AS(a,b){return a===b||a!=a&&b!=b||!(!Object(v.isArray)(a)||!Object(v.isArray)(b)||a.length!==b.length)&&function(a,b){for(var i=0,e=a.length;i<e;++i)if(!AS(a[i],b[i]))return!1;return!0}(a,b)}function kS(e){return function(t){for(var n in e)if(!AS(t[n],e[n]))return!1;return!0}}var TS="bin_",NS="intersect",MS="union",CS="index:unit";function DS(e,t){for(var n,r=t.fields,o=t.values,s=t.getter||(t.getter=[]),u=r.length,i=0;i<u;++i)if(s[i]=s[i]||Object(v.field)(r[i]),n=s[i](e),Object(v.isDate)(n)&&(n=Object(v.toNumber)(n)),Object(v.isDate)(o[i])&&(o[i]=Object(v.toNumber)(o[i])),t[TS+r[i]]){if(Object(v.isDate)(o[i][0])&&(o[i]=o[i].map(v.toNumber)),!SS(n,o[i],!0,!1))return!1}else if(n!==o[i])return!1;return!0}function RS(e,t){for(var n,value,r=t.intervals,o=r.length,i=0;i<o;++i){if(n=r[i].extent,value=(r[i].getter||(r[i].getter=Object(v.field)(r[i].field)))(e),!n||n[0]===n[1])return!1;if(Object(v.isDate)(value)&&(value=Object(v.toNumber)(value)),Object(v.isDate)(n[0])&&(n=r[i].extent=n.map(v.toNumber)),Object(v.isNumber)(n[0])&&!SS(value,n))return!1;if(Object(v.isString)(n[0])&&n.indexOf(value)<0)return!1}return!0}function IS(e,t,n,r){for(var o,s,u,l,b,c=this.context.data[e],d=c?c.values.value:[],h=c?c[CS]&&c[CS].value:void 0,p=n===NS,g=d.length,i=0;i<g;++i)if(o=d[i],h&&p){if(-1===(u=(s=s||{})[l=o.unit]||0))continue;if(b=r(t,o),s[l]=b?-1:++u,b&&1===h.size)return!0;if(!b&&u===h.get(l).count)return!1}else if(p^(b=r(t,o)))return b;return g&&p}function PS(e,t,n){return IS.call(this,e,t,n,DS)}function LS(e,t,n,r){t[0].type!==uS&&Object(v.error)("First argument to indata must be a string literal.");var o=t[0].value,s=cS+"unit";(t.length>=2&&t[t.length-1].value)!==NS||r.hasOwnProperty(s)||(r[s]=n.getData(o).indataRef(n,"unit")),_S(0,t,n,r)}function zS(e,t,n,r){var o,s,u,l,c,d=this.context.data[e],h=d?d.values.value:[],p=d?d[CS]&&d[CS].value:void 0,g=h[0],i=0;if(g){for(o=t?g.encodings.length:g.fields.length;i<o;++i)if(t&&g.encodings[i]===t||n&&g.fields[i]===n){s=i,l=g[TS+g.fields[i]];break}return p&&1===p.size&&(r=MS),p&&r===NS?(c=h.reduce(function(e,t){return(e[t.unit]||(e[t.unit]=[])).push({unit:t.unit,value:t.values[s]}),e},{}),u=Object.keys(c).map(function(e){return{unit:e,value:l?FS(c[e],MS):jS(c[e],MS)}})):u=h.map(function(e){return{unit:e.unit,value:e.values[s]}}),l?FS(u,r):jS(u,r)}}function jS(e,t){for(var n,r,o,s,u={},l=0,c={},d=[],i=0,h=e.length;i<h;++i)s=(n=e[i]).value,u[r=n.unit]||(u[r]=++l),(o=c[s])||(c[s]=o={value:s,units:{},count:0}),o.units[r]||(o.units[r]=++o.count);for(s in c)o=c[s],t===NS&&o.count!==l||d.push(o.value);return d.length?d:void 0}function FS(e,t){for(var n,r,o,s,u=t===NS?BS:US,i=0,l=e.length;i<l;++i)n=e[i].value,Object(v.isDate)(n[0])&&(n=n.map(v.toNumber)),(o=n[0])>(s=n[1])&&(s=n[0],o=n[1]),r=r?u(r,o,s):[o,s];return r&&r.length&&+r[0]!=+r[1]?r:void 0}function US(e,t,n){return e[0]>t&&(e[0]=t),e[1]<n&&(e[1]=n),e}function BS(e,t,n){return n<e[0]||e[1]<t?[]:(e[0]<t&&(e[0]=t),e[1]>n&&(e[1]=n),e)}var VS={random:function(){return Or()},isArray:v.isArray,isBoolean:v.isBoolean,isDate:v.isDate,isNumber:v.isNumber,isObject:v.isObject,isRegExp:v.isRegExp,isString:v.isString,isTuple:O,toBoolean:v.toBoolean,toDate:v.toDate,toNumber:v.toNumber,toString:v.toString,pad:v.pad,peek:v.peek,truncate:v.truncate,rgb:Pc,lab:Zc,hcl:rf,hsl:jc,sequence:Ir,format:function(e,t){return nS("format",_d,t)(e)},utcFormat:function(e,t){return nS("utcFormat",Nt,t)(e)},utcParse:function(e,t){return nS("utcParse",Mt,t)(e)},timeFormat:rS,timeParse:function(e,t){return nS("timeParse",Tt,t)(e)},monthFormat:function(e){return aS(e,1,"%B")},monthAbbrevFormat:function(e){return aS(e,1,"%b")},dayFormat:function(e){return aS(0,2+e,"%A")},dayAbbrevFormat:function(e){return aS(0,2+e,"%a")},quarter:function(e){return 1+~~(new Date(e).getMonth()/3)},utcquarter:function(e){return 1+~~(new Date(e).getUTCMonth()/3)},warn:function(){return oS(this.context.dataflow,"warn",arguments)},info:function(){return oS(this.context.dataflow,"info",arguments)},debug:function(){return oS(this.context.dataflow,"debug",arguments)},inScope:function(e){var t=this.context.group,value=!1;if(t)for(;e;){if(e===t){value=!0;break}e=e.mark.group}return value},clampRange:function(e,t,n){var r,o=e[0],s=e[1];return s<o&&(r=s,s=o,o=r),(r=s-o)>=n-t?[t,n]:[Math.min(Math.max(o,t),n-r),Math.min(Math.max(s,r),n)]},pinchDistance:function(e){var t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)},pinchAngle:function(e){var t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)},screen:function(){return sS?sS.screen:{}},containerSize:function(){var e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]},windowSize:function(){return sS?[sS.innerWidth,sS.innerHeight]:[void 0,void 0]},span:function(e){return e[e.length-1]-e[0]||0},flush:function(e,value,t,n,r,o){var s=Math.abs(value-e[0]),u=Math.abs(Object(v.peek)(e)-value);return s<u&&s<=t?n:u<=t?r:o},bandspace:function(e,t,n){return cc(e||0,t||0,n||0)},inrange:SS,setdata:function(e,t){var n=this.context.dataflow;return n.pulse(this.context.data[e].input,n.changeset().remove(v.truthy).insert(t)),1},pathShape:function(e){var t=null;return function(n){return n?qo(n,t=t||Lo(e)):e}},panLinear:v.panLinear,panLog:v.panLog,panPow:v.panPow,zoomLinear:v.zoomLinear,zoomLog:v.zoomLog,zoomPow:v.zoomPow,encode:function(e,t,n){if(e){var r=this.context.dataflow;r.pulse(e.mark.source,r.changeset().encode(e,t))}return void 0!==n?n:e},modify:function(e,t,n,r,o,s){var u,l,c=this.context.dataflow,d=this.context.data[e],h=d.input,p=d.changes,g=c.stamp();if(!1===c._trigger||!(h.value.length||t||r))return 0;if((!p||p.stamp<g)&&(d.changes=p=c.changeset(),p.stamp=g,c.runAfter(function(){d.modified=!0,c.pulse(h,p).run()},!0,1)),n&&(u=!0===n?v.truthy:Object(v.isArray)(n)||O(n)?n:kS(n),p.remove(u)),t&&p.insert(t),r&&(u=kS(r),h.value.some(u)?p.remove(u):p.insert(r)),o)for(l in s)p.modify(o,l,s[l]);return 1}},qS=["view","item","group","xy","x","y"],GS="this.",WS={};function HS(e,t,n){return 1===arguments.length?VS[e]:(VS[e]=t,n&&(WS[e]=n),YS&&(YS.functions[e]=GS+e),this)}HS("bandwidth",function(e,t){var n=hS(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0},gS),HS("copy",function(e,t){var n=hS(e,(t||this).context);return n?n.copy():void 0},gS),HS("domain",function(e,t){var n=hS(e,(t||this).context);return n?n.domain():[]},gS),HS("range",function(e,t){var n=hS(e,(t||this).context);return n&&n.range?n.range():[]},gS),HS("invert",function(e,t,n){var r=hS(e,(n||this).context);return r?Object(v.isArray)(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0},gS),HS("scale",function(e,value,t){var n=hS(e,(t||this).context);return n?n(value):void 0},gS),HS("gradient",function(e,t,n,r,o){e=hS(e,(o||this).context);var s=fa(t,n),u=e.domain(),l=u[0],c=u[u.length-1],d=Pp(e,l,c);e.ticks&&(l!==(u=e.ticks(+r||15))[0]&&u.unshift(l),c!==u[u.length-1]&&u.push(c));for(var i=0,h=u.length;i<h;++i)s.stop(d(u[i]),e(u[i]));return s},gS),HS("geoArea",vS,gS),HS("geoBounds",yS,gS),HS("geoCentroid",bS,gS),HS("geoShape",function(e,t,n){var r=hS(e,(n||this).context);return function(e){return r?r.path.context(e)(t):""}},gS),HS("indata",function(e,t,value){var n=this.context.data[e]["index:"+t],r=n?n.value.get(value):void 0;return r?r.count:r},function(e,t,n,r){t[0].type!==uS&&Object(v.error)("First argument to indata must be a string literal."),t[1].type!==uS&&Object(v.error)("Second argument to indata must be a string literal.");var o=t[0].value,s=t[1].value,u=cS+s;r.hasOwnProperty(u)||(r[u]=n.getData(o).indataRef(n,s))}),HS("data",xS,_S),HS("vlSingle",PS,_S),HS("vlSingleDomain",zS,_S),HS("vlMulti",PS,LS),HS("vlMultiDomain",zS,LS),HS("vlInterval",function(e,t,n){return IS.call(this,e,t,n,RS)},_S),HS("vlIntervalDomain",function(e,t,n,r){var o,s,u,l,c,d=this.context.data[e],h=d?d.values.value:[],p=h[0],i=0;if(p){for(o=p.intervals.length;i<o;++i)if(s=p.intervals[i],t&&s.encoding===t||n&&s.field===n){if(!s.extent)return;u=i,c=s.extent.length>2;break}return l=h.reduce(function(e,t){var n=t.intervals[u].extent,value=c?n.map(function(e){return{unit:t.unit,value:e}}):{unit:t.unit,value:n};return c?e.push.apply(e,value):e.push(value),e},[]),c?jS(l,r):FS(l,r)}},_S),HS("treePath",function(e,t,n){var r=OS(e,this),o=r[t],s=r[n];return o&&s?o.path(s).map(ES):void 0},_S),HS("treeAncestors",function(e,t){var n=OS(e,this)[t];return n?n.ancestors().map(ES):void 0},_S);var XS={blacklist:["_"],whitelist:["datum","event","item"],fieldvar:"datum",globalvar:function(e){return"_["+Object(v.stringValue)("$"+e)+"]"},functions:function(e){var t=eS(e);for(var n in qS.forEach(function(e){t[e]="event.vega."+e}),VS)t[n]=GS+n;return t},constants:$O,visitors:WS},YS=function(e){var t=(e=e||{}).whitelist?Object(v.toSet)(e.whitelist):{},n=e.blacklist?Object(v.toSet)(e.blacklist):{},r=e.constants||$O,o=(e.functions||eS)(p),s=e.globalvar,u=e.fieldvar,l={},c={},d=0,h=Object(v.isFunction)(s)?s:function(e){return s+'["'+e+'"]'};function p(e){if(Object(v.isString)(e))return e;var t=g[e.type];return null==t&&Object(v.error)("Unsupported type: "+e.type),t(e)}var g={Literal:function(e){return e.raw},Identifier:function(e){var o=e.name;return d>0?o:n.hasOwnProperty(o)?Object(v.error)("Illegal identifier: "+o):r.hasOwnProperty(o)?r[o]:t.hasOwnProperty(o)?o:(l[o]=1,h(o))},MemberExpression:function(e){var t=!e.computed,n=p(e.object);t&&(d+=1);var r=p(e.property);return n===u&&(c[r]=1),t&&(d-=1),n+(t?"."+r:"["+r+"]")},CallExpression:function(e){"Identifier"!==e.callee.type&&Object(v.error)("Illegal callee type: "+e.callee.type);var t=e.callee.name,n=e.arguments,r=o.hasOwnProperty(t)&&o[t];return r||Object(v.error)("Unrecognized function: "+t),Object(v.isFunction)(r)?r(n):r+"("+n.map(p).join(",")+")"},ArrayExpression:function(e){return"["+e.elements.map(p).join(",")+"]"},BinaryExpression:function(e){return"("+p(e.left)+e.operator+p(e.right)+")"},UnaryExpression:function(e){return"("+e.operator+p(e.argument)+")"},ConditionalExpression:function(e){return"("+p(e.test)+"?"+p(e.consequent)+":"+p(e.alternate)+")"},LogicalExpression:function(e){return"("+p(e.left)+e.operator+p(e.right)+")"},ObjectExpression:function(e){return"{"+e.properties.map(p).join(",")+"}"},Property:function(e){d+=1;var k=p(e.key);return d-=1,k+":"+p(e.value)}};function m(e){var t={code:p(e),globals:Object.keys(l),fields:Object.keys(c)};return l={},c={},t}return m.functions=o,m.constants=r,m}(XS),KS=function(e,t,n){var r,o,s={};try{r=function(e){ME=0,CE=(NE=e).length,DE=null,CO();var t=QO();if(DE.type!==LE)throw new Error("Unexpect token after expression.");return t}(e)}catch(t){Object(v.error)("Expression parse error: "+Object(v.stringValue)(e))}return r.visit(function(e){if("CallExpression"===e.type){var n=e.callee.name,r=XS.visitors[n];r&&r(n,e.arguments,t,s)}}),(o=YS(r)).globals.forEach(function(e){var n="$"+e;!s.hasOwnProperty(n)&&t.getSignal(e)&&(s[n]=t.signalRef(e))}),{$expr:n?n+"return("+o.code+");":o.code,$fields:o.fields,$params:s}},JS="view",ZS="scope";function QS(e,t){return(e.merge?function(e,t){var n=$S({merge:e.merge.map(function(e){return QS(e,t)})},e,t);return t.addStream(n).id}:e.stream?function(e,t){var n=$S({stream:QS(e.stream,t)},e,t);return t.addStream(n).id}:e.type?function(e,t){var n,r=t.event((n=e.source)===ZS?JS:n||JS,e.type),o=$S({stream:r},e,t);return 1===Object.keys(o).length?r:t.addStream(o).id}:Object(v.error)("Invalid stream specification: "+Object(v.stringValue)(e)))(e,t)}function $S(e,t,n){var r,o,s,u,l=t.between;return l&&(2!==l.length&&Object(v.error)('Stream "between" parameter must have 2 entries: '+Object(v.stringValue)(t)),e.between=[QS(l[0],n),QS(l[1],n)]),l=t.filter?Object(v.array)(t.filter):[],(t.marktype||t.markname||t.markrole)&&l.push((o=t.markname,s=t.markrole,(u="event.item")+((r=t.marktype)&&"*"!==r?"&&"+u+".mark.marktype==='"+r+"'":"")+(s?"&&"+u+".mark.role==='"+s+"'":"")+(o?"&&"+u+".mark.name==='"+o+"'":""))),t.source===ZS&&l.push("inScope(event.item)"),l.length&&(e.filter=KS("("+l.join(")&&(")+")").$expr),null!=(l=t.throttle)&&(e.throttle=+l),null!=(l=t.debounce)&&(e.debounce=+l),t.consume&&(e.consume=!0),e}var eA=n("XSKZ");function tA(e,value,t,n){this.id=-1,this.type=e,this.value=value,this.params=t,n&&(this.parent=n)}function nA(e,value,t,n){return new tA(e,value,t,n)}function rA(value,e){return nA("operator",value,e)}function iA(e){var t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}var aA={$tupleid:1,toString:function(){return":_tupleid_:"}};function oA(e,t){return t?{$field:e,$name:t}:{$field:e}}var sA=oA("key");function uA(e,t){return{$compare:e,$order:t}}var lA="descending";function cA(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}function fA(e){return e&&e.signal}function hA(e,t){return null!=e?e:t}function pA(e){return function(t,value,n){return nA(e,value,t||void 0,n)}}var gA=pA("aggregate"),mA=pA("axisticks"),vA=pA("bound"),yA=pA("collect"),bA=pA("compare"),xA=pA("datajoin"),_A=pA("encode"),wA=(pA("extent"),pA("facet")),EA=pA("field"),OA=pA("key"),SA=pA("legendentries"),AA=pA("mark"),kA=pA("multiextent"),TA=pA("multivalues"),NA=pA("overlap"),MA=pA("params"),CA=pA("prefacet"),DA=pA("projection"),RA=pA("proxy"),IA=pA("relay"),PA=pA("render"),LA=pA("scale"),zA=pA("sieve"),jA=pA("sortitems"),FA=pA("viewlayout"),UA=pA("values"),BA=0,VA=["identity","ordinal","band","point","bin-linear","bin-ordinal","linear","pow","sqrt","log","sequential","time","utc","quantize","quantile","threshold"],qA=Object(v.toSet)(VA),GA=Object(v.toSet)(VA.slice(1,6));function WA(e){return GA.hasOwnProperty(e)}function HA(e){return"quantile"===e}function XA(e,t){return Object(v.isObject)(e)?e.signal?t.signalRef(e.signal):Object(v.error)("Unsupported object: "+Object(v.stringValue)(e)):e}function YA(e){Object(v.error)("Can not find data set: "+Object(v.stringValue)(e))}function KA(e,t,n){if(e)return e.signal?n.signalRef(e.signal):(Object(v.isArray)(e)?function(e,t,n){return e.map(function(e){return XA(e,n)})}:e.fields?function(e,t,n){var r=e.data,o=e.fields.reduce(function(e,t){return t=Object(v.isString)(t)?{data:r,field:t}:Object(v.isArray)(t)||t.signal?function(e,t){var n="_:vega:_"+BA++,r=yA({});if(Object(v.isArray)(e))r.value={$ingest:e};else if(e.signal){var o="setdata("+Object(v.stringValue)(n)+","+e.signal+")";r.params.input=t.signalRef(o)}return t.addDataPipeline(n,[r,zA({})]),{data:n,field:"data"}}(t,n):t,e.push(t),e},[]);return(WA(t.type)?function(e,t,n){var r,a,o;return r=n.map(function(f){var e=t.getData(f.data);return e||YA(f.data),e.countsRef(t,f.field)}),a=t.add(gA({groupby:sA,ops:["sum"],fields:[t.fieldRef("count")],as:["count"],pulse:r})),o=t.add(yA({pulse:iA(a)})),iA(t.add(UA({field:sA,sort:t.sortRef(JA(e.sort,!0)),pulse:iA(o)})))}:HA(t.type)?function(e,t,n){var r=n.map(function(f){var e=t.getData(f.data);return e||YA(f.data),e.domainRef(t,f.field)});return iA(t.add(TA({values:r})))}:function(e,t,n){var r=n.map(function(f){var e=t.getData(f.data);return e||YA(f.data),e.extentRef(t,f.field)});return iA(t.add(kA({extents:r})))})(e,n,o)}:function(e,t,n){var r=n.getData(e.data);return r||YA(e.data),WA(t.type)?r.valuesRef(n,e.field,JA(e.sort,!1)):HA(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)})(e,t,n);null==t.domainMin&&null==t.domainMax||Object(v.error)("No scale domain defined for domainMin/domainMax to override.")}function JA(e,t){return e&&(e.field||e.op?e.field||"count"===e.op?t&&e.field?Object(v.error)("Multiple domain scales can not sort by field."):t&&e.op&&"count"!==e.op&&Object(v.error)("Multiple domain scales support op count only."):Object(v.error)("No field provided for sort aggregate op: "+e.op):Object(v.isObject)(e)?e.field="key":e={field:"key"}),e}function ZA(e,t,n){return Object(v.isArray)(e)?e.map(function(e){return ZA(e,t,n)}):Object(v.isObject)(e)?e.signal?n.signalRef(e.signal):"fit"===t?e:Object(v.error)("Unsupported parameter object: "+Object(v.stringValue)(e)):e}var QA="value",$A=["shape","size","fill","stroke","strokeDash","opacity"],ek={name:1,interactive:1},tk=Object(v.toSet)(["rule"]),nk=Object(v.toSet)(["group","image","rect"]),rk=function(e,t){var n="";return tk[t]?n:(e.x2&&(e.x?(nk[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(nk[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;"),n)},ik=function(e,t,n,r){var o=KS(e,t);return o.$fields.forEach(function(e){r[e]=1}),Object(v.extend)(n,o.$params),o.$expr},ak=function(e,t,n,r){return function e(t,n,r,o){var s,u,l;if(t.signal)s="datum",l=ik(t.signal,n,r,o);else if(t.group||t.parent){for(u=Math.max(1,t.level||1),s="item";u-- >0;)s+=".mark.group";t.parent?(l=t.parent,s+=".datum"):l=t.group}else t.datum?(s="datum",l=t.datum):Object(v.error)("Invalid field reference: "+Object(v.stringValue)(t));return t.signal||(Object(v.isString)(l)?(o[l]=1,l=Object(v.splitAccessPath)(l).map(v.stringValue).join("][")):l=e(l,n,r,o)),s+"["+l+"]"}(Object(v.isObject)(e)?e:{datum:e},t,n,r)};function ok(e,t,n,r){var o;if(Object(v.isString)(e))n.hasOwnProperty(o=fS+e)||(n[o]=t.scaleRef(e)),o=Object(v.stringValue)(o);else{for(o in t.scales)n[fS+o]=t.scaleRef(o);o=Object(v.stringValue)(fS)+"+"+(e.signal?"("+ik(e.signal,t,n,r)+")":ak(e,t,n,r))}return"_["+o+"]"}var sk=function(e,t,n,r){return Object(v.isObject)(e)?"("+uk(null,e,t,n,r)+")":e},uk=function(e,t,n,r,o){if(null!=t.gradient)return function(e,t,n,r){return"this.gradient("+ok(e.gradient,t,n,r)+","+Object(v.stringValue)(e.start)+","+Object(v.stringValue)(e.stop)+","+Object(v.stringValue)(e.count)+")"}(t,n,r,o);var value=t.signal?ik(t.signal,n,r,o):t.color?function(e,t,n,r){function o(e,x,y,o){return"this."+e+"("+[uk(null,x,t,n,r),uk(null,y,t,n,r),uk(null,o,t,n,r)].join(",")+").toString()"}return e.c?o("hcl",e.h,e.c,e.l):e.h||e.s?o("hsl",e.h,e.s,e.l):e.l||e.a?o("lab",e.l,e.a,e.b):e.r||e.g||e.b?o("rgb",e.r,e.g,e.b):null}(t.color,n,r,o):null!=t.field?ak(t.field,n,r,o):void 0!==t.value?Object(v.stringValue)(t.value):void 0;return null!=t.scale&&(value=function(e,value,t,n,r){var o,s,u,l=ok(e.scale,t,n,r);return null!=e.range?(s=l+".range()",value=0==(o=+e.range)?s+"[0]":"($="+s+","+(1===o?"$[$.length-1]":"$[0]+"+o+"*($[$.length-1]-$[0])")+")"):(void 0!==value&&(value=l+"("+value+")"),e.band&&(u=function(e,t){if(!Object(v.isString)(e))return-1;var n=t.scaleType(e);return"band"===n||"point"===n?1:0}(e.scale,t))&&(o=(s=l+".bandwidth")+"()"+(1==(o=+e.band)?"":"*"+o),u<0&&(o="("+s+"?"+o+":0)"),value=(value?value+"+":"")+o,e.extra&&(value="(datum.extra?"+l+"(datum.extra.value):"+value+")")),null==value&&(value="0")),value}(t,value,n,r,o)),void 0===value&&(value=null),null!=t.exponent&&(value="Math.pow("+value+","+sk(t.exponent,n,r,o)+")"),null!=t.mult&&(value+="*"+sk(t.mult,n,r,o)),null!=t.offset&&(value+="+"+sk(t.offset,n,r,o)),t.round&&(value="Math.round("+value+")"),value},lk=function(e,t,value){return e+"["+Object(v.stringValue)(t)+"]="+value+";"},ck=function(e,t,n,r,o){var s="";return t.forEach(function(t){var value=uk(e,t,n,r,o);s+=t.test?ik(t.test,n,r,o)+"?"+value+":":value}),lk("o",e,s)};function fk(e,t,n,r){var o,s,value,u={},l="var o=item,datum=o.datum,$;";for(o in e)s=e[o],Object(v.isArray)(s)?l+=ck(o,s,r,n,u):(value=uk(o,s,r,n,u),l+=lk("o",o,value));return l+=rk(e,t),{$expr:l+="return 1;",$fields:Object.keys(u),$output:Object.keys(e)}}var dk="mark",hk="frame";function pk(e){return Object(v.isObject)(e)?e:{value:e}}function gk(e,t,value){return null!=value?(e[t]=Object(v.isObject)(value)&&!Object(v.isArray)(value)?value:{value:value},1):0}function mk(e,t,n){for(var r in t)n&&n.hasOwnProperty(r)||(e[r]=Object(v.extend)(e[r]||{},t[r]));return e}function vk(e,t,n,r,o,s){var u,l;for(l in(s=s||{}).encoders={$encode:u={}},e=function(e,t,n,r,o){var s,u,l={};for(s in"legend"!=n&&0!==String(n).indexOf("axis")||(n=null),u=n===hk?o.group:n===dk?Object(v.extend)({},o.mark,o[t]):null)yk(s,e)||("fill"===s||"stroke"===s)&&(yk("fill",e)||yk("stroke",e))||(l[s]={value:u[s]});return Object(v.array)(r).forEach(function(t){var n=o.style&&o.style[t];for(var r in n)yk(r,e)||(l[r]={value:n[r]})}),(e=Object(v.extend)({},e)).enter=Object(v.extend)(l,e.enter),e}(e,t,n,r,o.config))u[l]=fk(e[l],t,s,o);return s}function yk(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}var bk=function(e,t,n,r,o,s,u){return{type:e,name:u?u.name:void 0,role:t,style:u&&u.style||n,key:r,from:o,interactive:!(!u||!u.interactive),encode:mk(s,u,ek)}},xk=function(e,t,n,r,o,s,u){return{type:"group",name:n,role:e,style:t,from:r,interactive:o||!1,encode:s,marks:u}};function _k(value){return Object(v.isObject)(value)&&value.signal?value.signal:Object(v.stringValue)(value)}var wk=function(e){var t=e.role||"";return t.indexOf("axis")&&t.indexOf("legend")?"group"===e.type?"scope":t||dk:t},Ek=function(e,t){var n=fr(e.type);n||Object(v.error)("Unrecognized transform type: "+Object(v.stringValue)(e.type));var r=nA(n.type.toLowerCase(),null,Ok(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r};function Ok(e,t,n){var r,i,o,s={};for(i=0,o=e.params.length;i<o;++i)s[(r=e.params[i]).name]=Sk(r,t,n);return s}function Sk(e,t,n){var r=e.type,value=t[e.name];return"index"===r?function(e,t,n){return Object(v.isString)(t.from)||Object(v.error)('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}(0,t,n):void 0!==value?"param"===r?function(e,t,n){var value=t[e.name];return e.array?(Object(v.isArray)(value)||Object(v.error)("Expected an array of sub-parameters. Instead: "+Object(v.stringValue)(value)),value.map(function(t){return kk(e,t,n)})):kk(e,value,n)}(e,t,n):"projection"===r?n.projectionRef(t[e.name]):e.array&&!fA(value)?value.map(function(t){return Ak(e,t,n)}):Ak(e,value,n):void(e.required&&Object(v.error)("Missing required "+Object(v.stringValue)(t.type)+" parameter: "+Object(v.stringValue)(e.name)))}function Ak(e,value,t){var n=e.type;if(fA(value))return Tk(n)?Object(v.error)("Expression references can not be signals."):Nk(n)?t.fieldRef(value):Mk(n)?t.compareRef(value):t.signalRef(value.signal);var r,o=e.expr||Nk(n);return o&&(r=value)&&r.expr?KS(value.expr,t):o&&value&&value.field?oA(value.field):Tk(n)?KS(value,t):"data"===n?iA(t.getData(value).values):Nk(n)?oA(value):Mk(n)?t.compareRef(value):value}function kk(e,value,t){var n,r,k,i,o;for(i=0,o=e.params.length;i<o;++i){for(k in(r=e.params[i]).key)if(r.key[k]!==value[k]){r=null;break}if(r)break}return r||Object(v.error)("Unsupported parameter: "+Object(v.stringValue)(value)),n=Object(v.extend)(Ok(r,value,t),r.key),iA(t.add(MA(n)))}function Tk(e){return"expr"===e}function Nk(e){return"field"===e}function Mk(e){return"compare"===e}function Ck(e,t,n,r,o){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=o,this.index={}}Ck.fromEntries=function(e,t){var n=t.length,i=1,r=t[0],o=t[n-1],s=t[n-2],u=null;for(e.add(t[0]);i<n;++i)t[i].params.pulse=iA(t[i-1]),e.add(t[i]),"aggregate"===t[i].type&&(u=t[i]);return new Ck(e,r,s,o,u)};var Dk=Ck.prototype;function Rk(e){return Object(v.isString)(e)?e:null}function Ik(e,t,n){var r,o=cA(n.op,n.field);if(t.ops){for(var i=0,s=t.as.length;i<s;++i)if(t.as[i]===o)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(o))}function Pk(e,t,n,r,o,s,u){var l,c,d=t[n]||(t[n]={}),h=function(e){return Object(v.isObject)(e)?(e.order===lA?"-":"+")+cA(e.op,e.field):""}(s),k=Rk(o);if(null!=k&&(e=t.scope,l=d[k+=h?"|"+h:""]),!l){var p=s?{field:sA,pulse:t.countsRef(e,o,s)}:{field:e.fieldRef(o),pulse:iA(t.output)};h&&(p.sort=e.sortRef(s)),c=e.add(nA(r,void 0,p)),u&&(t.index[o]=c),l=iA(c),null!=k&&(d[k]=l)}return l}Dk.countsRef=function(e,t,n){var r,a,o,s=this.counts||(this.counts={}),k=Rk(t);return null!=k&&(e=this.scope,r=s[k]),r?n&&n.field&&Ik(e,r.agg.params,n):(o={groupby:e.fieldRef(t,"key"),pulse:iA(this.output)},n&&n.field&&Ik(e,o,n),r={agg:a=e.add(gA(o)),ref:iA(r=e.add(yA({pulse:iA(a)})))},null!=k&&(s[k]=r)),r.ref},Dk.tuplesRef=function(){return iA(this.values)},Dk.extentRef=function(e,t){return Pk(e,this,"extent","extent",t,!1)},Dk.domainRef=function(e,t){return Pk(e,this,"domain","values",t,!1)},Dk.valuesRef=function(e,t,n){return Pk(e,this,"vals","values",t,n||!0)},Dk.lookupRef=function(e,t){return Pk(e,this,"lookup","tupleindex",t,!1)},Dk.indataRef=function(e,t){return Pk(e,this,"indata","tupleindex",t,!0,!0)};var Lk=function(e,t,n){var r,o,s=e.remove,u=e.insert,l=e.toggle,c=e.modify,d=e.values,h=t.add(rA());r="if("+e.trigger+',modify("'+n+'",'+[u,s,l,c,d].map(function(e){return null==e?"null":e}).join(",")+"),0)",o=KS(r,t),h.update=o.$expr,h.params=o.$params},zk=function(e,t){var n,r,o,s,u,l,c,d,h,p,g,m,_,w=wk(e),E="group"===e.type,O=e.from&&e.from.facet,S=e.layout||"scope"===w||w===hk,A=w===dk||S||O,T=e.overlap;o=function(e,t,n){var r,o,s,u,l;return e?(r=e.facet)&&(t||Object(v.error)("Only group marks can be faceted."),null!=r.field?u=l=iA(n.getData(r.data).output):(e.data?l=iA(n.getData(e.data).aggregate):((s=Ek(Object(v.extend)({type:"aggregate",groupby:Object(v.array)(r.groupby)},r.aggregate),n)).params.key=n.keyRef(r.groupby),s.params.pulse=iA(n.getData(r.data).output),u=l=iA(n.add(s))),o=n.keyRef(r.groupby,!0))):u=iA(n.add(yA(null,[{}]))),u||(u=e.$ref?e:iA(n.getData(e.data).output)),{key:o,pulse:u,parent:l}}(e.from,E,t),h=iA(r=t.add(xA({key:o.key||(e.key?oA(e.key):void 0),pulse:o.pulse,clean:!E}))),r=s=t.add(yA({pulse:h})),p=iA(r=t.add(AA({markdef:function(e){return{marktype:e.type,name:e.name||void 0,role:e.role||wk(e),zindex:+e.zindex||void 0}}(e),interactive:function(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e}(e.interactive,t),clip:function(e,t){var n;return Object(v.isObject)(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+_k(e.path)+")":e.sphere&&(n="geoShape("+_k(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:iA(r)}))),(r=t.add(_A(vk(e.encode,e.type,w,e.style,t,{pulse:p})))).params.parent=t.encode(),e.transform&&e.transform.forEach(function(e){var n=Ek(e,t);(n.metadata.generates||n.metadata.changes)&&Object(v.error)("Mark transforms should not generate new data."),n.params.pulse=iA(r),t.add(r=n)}),e.sort&&(r=t.add(jA({sort:t.compareRef(e.sort,!0),pulse:iA(r)}))),g=iA(r),(O||S)&&(m=iA(S=t.add(FA({layout:t.objectProperty(e.layout),legendMargin:t.config.legendMargin,mark:p,pulse:g})))),_=iA(u=t.add(vA({mark:p,pulse:m||g}))),E&&(A&&((n=t.operators).pop(),S&&n.pop()),t.pushState(g,m||_,h),O?function(e,t,n){var r,o,s,u,l=e.from.facet,c=l.name,d=iA(t.getData(l.data).output);l.name||Object(v.error)("Facet must have a name: "+Object(v.stringValue)(l)),l.data||Object(v.error)("Facet must reference a data set: "+Object(v.stringValue)(l)),l.field?u=t.add(CA({field:t.fieldRef(l.field),pulse:d})):l.groupby?u=t.add(wA({key:t.keyRef(l.groupby),group:iA(t.proxy(n.parent)),pulse:d})):Object(v.error)("Facet must specify groupby or field: "+Object(v.stringValue)(l)),o=(r=t.fork()).add(yA()),s=r.add(zA({pulse:iA(o)})),r.addData(c,new Ck(r,o,o,s)),r.addSignal("parent",null),u.params.subflow={$subflow:Vk(e,r).toRuntime()}}(e,t,o):A?function(e,t,n){var r=t.add(CA({pulse:n.pulse})),o=t.fork();o.add(zA()),o.addSignal("parent",null),r.params.subflow={$subflow:Vk(e,o).toRuntime()}}(e,t,o):Vk(e,t),t.popState(),A&&(S&&n.push(S),n.push(u))),T&&(r={method:!0===T.method?"parity":T.method,pulse:_},T.order&&(r.sort=t.compareRef({field:T.order})),T.bound&&(r.boundScale=t.scaleRef(T.bound.scale),r.boundOrient=T.bound.orient,r.boundTolerance=T.bound.tolerance),_=iA(t.add(NA(r)))),l=t.add(PA({pulse:_})),c=t.add(zA({pulse:iA(l)},void 0,t.parent())),null!=e.name&&(t.addData(d=e.name,new Ck(t,s,l,c)),e.on&&e.on.forEach(function(e){(e.insert||e.remove||e.toggle)&&Object(v.error)("Marks only support modify triggers."),Lk(e,t,d)}))};function jk(e,t,n,r){var o=t&&(t.update&&t.update[n]||t.enter&&t.enter[n]);return+(o?o.value:r&&(o=e.config.style[r])&&o[n])}function Fk(e){var t=yA({},e);return t.metadata={source:!0},t}function Uk(e,t){return{scale:e.scale,range:t}}function Bk(e,t,a,b,n){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+a+","+b+","+n+")"}}var Vk=function(e,t,n){var r=Object(v.array)(e.signals),o=Object(v.array)(e.scales);return n||r.forEach(function(e){RE(e,t)}),Object(v.array)(e.projections).forEach(function(e){!function(e,t){var n={};for(var r in e)"name"!==r&&(n[r]=ZA(e[r],r,t));t.addProjection(e.name,n)}(e,t)}),o.forEach(function(e){!function(e,t){var n=e.type||"linear";qA.hasOwnProperty(n)||Object(v.error)("Unrecognized scale type: "+Object(v.stringValue)(n)),t.addScale(e.name,{type:n,domain:void 0})}(e,t)}),Object(v.array)(e.data).forEach(function(e){!function(e,t){var n=[];e.transform&&e.transform.forEach(function(e){n.push(Ek(e,t))}),e.on&&e.on.forEach(function(n){Lk(n,t,e.name)}),t.addDataPipeline(e.name,function(e,t,n){var r,i,o,s,u,l=[],c=null,d=!1,h=!1;for(e.values?l.push(c=Fk({$ingest:e.values,$format:e.format})):e.url?l.push(c=Fk({$request:e.url,$format:e.format})):e.source&&(c=r=Object(v.array)(e.source).map(function(e){return iA(t.getData(e).output)}),l.push(null)),i=0,o=n.length;i<o;++i)u=(s=n[i]).metadata,c||u.source||l.push(c=Fk()),l.push(s),u.generates&&(h=!0),u.modifies&&!h&&(d=!0),u.source?c=s:u.changes&&(c=null);return r&&(l[0]=IA({derive:d,pulse:(o=r.length-1)?r:r[0]}),(d||o)&&l.splice(1,0,Fk())),c||l.push(Fk()),l.push(zA({})),l}(e,t,n))}(e,t)}),o.forEach(function(e){!function(e,t){var n,r=t.getScale(e.name).params;for(n in r.domain=KA(e.domain,e,t),null!=e.range&&(r.range=function e(t,n,r){var o=t.range,s=n.config.range;if(o.signal)return n.signalRef(o.signal);if(Object(v.isString)(o)){if(s&&s.hasOwnProperty(o))return e(t=Object(v.extend)({},t,{range:s[o]}),n,r);"width"===o?o=[0,{signal:"width"}]:"height"===o?o=WA(t.type)?[0,{signal:"height"}]:[{signal:"height"},0]:Object(v.error)("Unrecognized scale range value: "+Object(v.stringValue)(o))}else{if(o.scheme)return r.scheme=XA(o.scheme,n),o.extent&&(r.schemeExtent=function(e,t){return e.signal?t.signalRef(e.signal):e.map(function(e){return XA(e,t)})}(o.extent,n)),void(o.count&&(r.schemeCount=XA(o.count,n)));if(o.step)return void(r.rangeStep=XA(o.step,n));if(WA(t.type)&&!Object(v.isArray)(o))return KA(o,t,n);Object(v.isArray)(o)||Object(v.error)("Unsupported range type: "+Object(v.stringValue)(o))}return o.map(function(e){return XA(e,n)})}(e,t,r)),null!=e.interpolate&&function(e,t){t.interpolate=XA(e.type||e),null!=e.gamma&&(t.interpolateGamma=XA(e.gamma))}(e.interpolate,r),null!=e.nice&&function(e,t){t.nice=Object(v.isObject)(e)?{interval:XA(e.interval),step:XA(e.step)}:XA(e)}(e.nice,r),e)r.hasOwnProperty(n)||"name"===n||(r[n]=XA(e[n],t))}(e,t)}),r.forEach(function(e){!function(e,t){var n=t.getSignal(e.name);if(e.update){var r=KS(e.update,t);n.update=r.$expr,n.params=r.$params}e.on&&e.on.forEach(function(e){!function(e,t,n){var value,r,o=e.events,s=e.update,u=e.encode,l=[];o||Object(v.error)("Signal update missing events specification."),Object(v.isString)(o)&&(o=Object(eA.selector)(o)),(o=Object(v.array)(o).filter(function(e){return e.signal||e.scale?(l.push(e),0):1})).length&&l.push(o.length>1?{merge:o}:o[0]),null!=u&&(s&&Object(v.error)("Signal encode and update are mutually exclusive."),s="encode(item(),"+Object(v.stringValue)(u)+")"),value=Object(v.isString)(s)?KS(s,t,"var datum=event.item&&event.item.datum;"):null!=s.expr?KS(s.expr,t,"var datum=event.item&&event.item.datum;"):null!=s.value?s.value:null!=s.signal?{$expr:"_.value",$params:{value:t.signalRef(s.signal)}}:Object(v.error)("Invalid signal update specification."),r={target:n,update:value},e.force&&(r.options={force:!0}),l.forEach(function(e){e={source:function(e,t){return e.signal?t.getSignal(e.signal).id:e.scale?t.getScale(e.scale).id:QS(e,t)}(e,t)},t.addUpdate(Object(v.extend)(e,r))})}(e,t,n.id)})}(e,t)}),Object(v.array)(e.axes).forEach(function(e){!function(e,t){var n,r,o,s,u,l,c=function(e,t){var n=t.config,r=e.orient,o="top"===r||"bottom"===r?n.axisX:n.axisY,s=n["axis"+r[0].toUpperCase()+r.slice(1)],u="band"===t.scaleType(e.scale)&&n.axisBand;return o||s||u?Object(v.extend)({},n.axis,o,s,u):n.axis}(e,t),d=e.encode||{},h=d.axis||{},p=h.name||void 0,g=h.interactive,m=h.style;n={orient:e.orient,ticks:!!hA(e.ticks,c.ticks),labels:!!hA(e.labels,c.labels),grid:!!hA(e.grid,c.grid),domain:!!hA(e.domain,c.domain),title:!!hA(e.title,!1)},r=iA(t.add(yA({},[n]))),h=mk({update:{range:{signal:'abs(span(range("'+e.scale+'")))'},offset:pk(hA(e.offset,0)),position:pk(hA(e.position,0)),titlePadding:pk(hA(e.titlePadding,c.titlePadding)),minExtent:pk(hA(e.minExtent,c.minExtent)),maxExtent:pk(hA(e.maxExtent,c.maxExtent))}},d.axis,ek),o=iA(t.add(mA({scale:t.scaleRef(e.scale),extra:c.tickExtra,count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),formatSpecifier:t.property(e.format)}))),l=[],n.grid&&l.push(function(e,t,n,r){var o,s,u,l,c,d,h,p=e.orient,g=e.gridScale,m="left"===p||"top"===p?1:-1,v=m*e.offset||0,_={value:0},w={};return w.enter=o={opacity:_},gk(o,"stroke",t.gridColor),gk(o,"strokeWidth",t.gridWidth),gk(o,"strokeDash",t.gridDash),w.exit=s={opacity:_},w.update=u={},gk(u,"opacity",t.gridOpacity),"top"===p||"bottom"===p?(l="x",c="y",h="height"):(l="y",c="x",h="width"),d=c+"2",u[l]=o[l]=s[l]={scale:e.scale,field:QA,band:t.bandPosition,round:t.tickRound,extra:t.tickExtra,offset:t.tickOffset},g?(o[c]={scale:g,range:0,mult:m,offset:v},u[d]=o[d]={scale:g,range:1,mult:m,offset:v}):(o[c]={value:v},u[d]=o[d]={signal:h,mult:m,offset:v}),bk("rule","axis-grid",null,QA,r,w,n)}(e,c,d.grid,o)),n.ticks&&(s=hA(e.tickSize,c.tickSize),l.push(function(e,t,n,r,o){var s,u,l,c,d,h=e.orient,p="left"===h||"top"===h?-1:1,g={value:0},m={};return m.enter=s={opacity:g},gk(s,"stroke",t.tickColor),gk(s,"strokeWidth",t.tickWidth),m.exit=u={opacity:g},m.update=l={opacity:{value:1}},(c=pk(o)).mult=p,d={scale:e.scale,field:QA,band:t.bandPosition,round:t.tickRound,extra:t.tickExtra,offset:t.tickOffset},"top"===h||"bottom"===h?(l.y=s.y=g,l.y2=s.y2=c,l.x=s.x=u.x=d):(l.x=s.x=g,l.x2=s.x2=c,l.y=s.y=u.y=d),bk("rule","axis-tick",null,QA,r,m,n)}(e,c,d.ticks,o,s))),n.labels&&l.push(function(e,t,n,r,o){var s,u,l,c,d,h=e.orient,p="left"===h||"top"===h?-1:1,g=e.scale,m=hA(e.labelPadding,t.labelPadding),v=hA(e.labelBound,t.labelBound),_=hA(e.labelFlush,t.labelFlush),w=null!=_&&!1!==_&&(_=+_)===_,E=+hA(e.labelFlushOffset,t.labelFlushOffset),O=hA(e.labelOverlap,t.labelOverlap),S={value:0},A={};return A.enter=s={opacity:S},gk(s,"angle",t.labelAngle),gk(s,"fill",t.labelColor),gk(s,"font",t.labelFont),gk(s,"fontSize",t.labelFontSize),gk(s,"fontWeight",t.labelFontWeight),gk(s,"limit",t.labelLimit),A.exit=u={opacity:S},A.update=l={opacity:{value:1},text:{field:"label"}},(c=pk(o)).mult=p,c.offset=pk(m),c.offset.mult=p,d={scale:g,field:QA,band:.5,offset:t.tickOffset},"top"===h||"bottom"===h?(l.y=s.y=c,l.x=s.x=u.x=d,gk(l,"align",w?Bk(g,_,'"left"','"right"','"center"'):"center"),w&&E&&gk(l,"dx",Bk(g,_,-E,E,0)),gk(l,"baseline","top"===h?"bottom":"top")):(l.x=s.x=c,l.y=s.y=u.y=d,gk(l,"align","right"===h?"left":"right"),gk(l,"baseline",w?Bk(g,_,'"bottom"','"top"','"middle"'):"middle"),w&&E&&gk(l,"dy",Bk(g,_,E,-E,0))),e=bk("text","axis-label","guide-label",QA,r,A,n),(O||v)&&(e.overlap={method:O,order:"datum.index",bound:v?{scale:g,orient:h,tolerance:+v}:null}),e}(e,c,d.labels,o,s=n.ticks?s:0)),n.domain&&l.push(function(e,t,n,r){var o,s,u,l,c,d=e.orient,h={value:0},p={};return p.enter=o={opacity:h},gk(o,"stroke",t.domainColor),gk(o,"strokeWidth",t.domainWidth),p.exit={opacity:h},p.update=s={opacity:{value:1}},"top"===d||"bottom"===d?(u="x",c="y"):(u="y",c="x"),l=u+"2",o[c]=h,s[u]=o[u]=Uk(e,0),s[l]=o[l]=Uk(e,1),bk("rule","axis-domain",null,null,r,p,n)}(e,c,d.domain,r)),n.title&&l.push(function(e,t,n,r){var o,s,u,l=e.orient,c=e.title,d="left"===l||"top"===l?-1:1,h="top"===l||"bottom"===l,p={};return p.enter=o={opacity:{value:0}},gk(o,"align",t.titleAlign),gk(o,"fill",t.titleColor),gk(o,"font",t.titleFont),gk(o,"fontSize",t.titleFontSize),gk(o,"fontWeight",t.titleFontWeight),gk(o,"limit",t.titleLimit),p.exit={opacity:{value:0}},p.update=s={opacity:{value:1},text:c&&c.signal?{signal:c.signal}:{value:c+""}},u={scale:e.scale,range:.5},h?(s.x=u,s.angle={value:0},s.baseline={value:"top"===l?"bottom":"top"}):(s.y=u,s.angle={value:90*d},s.baseline={value:"bottom"}),gk(s,"angle",t.titleAngle),gk(s,"baseline",t.titleBaseline),!gk(s,"x",t.titleX)&&h&&!yk("x",n)&&(p.enter.auto={value:!0}),!gk(s,"y",t.titleY)&&!h&&!yk("y",n)&&(p.enter.auto={value:!0}),bk("text","axis-title","guide-title",null,r,p,n)}(e,c,d.title,r)),u=xk("axis",m,p,r,g,h,l),e.zindex&&(u.zindex=e.zindex),zk(u,t)}(e,t)}),Object(v.array)(e.marks).forEach(function(e){zk(e,t)}),Object(v.array)(e.legends).forEach(function(e){!function(e,t){var n,r,o,s,u,l,c,d,h=e.type||"symbol",p=t.config.legend,g=e.encode||{},m=g.legend||{},_=m.name||void 0,w=m.interactive,E=m.style,O=e.size||e.shape||e.fill||e.stroke||e.strokeDash||e.opacity;O||Object(v.error)("Missing valid scale for legend."),n={orient:hA(e.orient,p.orient),title:null!=e.title},r=iA(t.add(yA(null,[n]))),m=mk({enter:function(e){var t={};return gk(t,"fill",e.fillColor)+gk(t,"stroke",e.strokeColor)+gk(t,"strokeWidth",e.strokeWidth)+gk(t,"strokeDash",e.strokeDash)+gk(t,"cornerRadius",e.cornerRadius)?t:void 0}(p),update:{offset:pk(hA(e.offset,p.offset)),padding:pk(hA(e.padding,p.padding)),titlePadding:pk(hA(e.titlePadding,p.titlePadding))}},m,ek),l={update:{x:{field:{group:"padding"}},y:{field:{group:"padding"}},entryPadding:pk(hA(e.entryPadding,p.entryPadding))}},"gradient"===h?(o=iA(t.add(SA({type:"gradient",scale:t.scaleRef(O),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),formatSpecifier:t.property(e.format)}))),d=[function(e,t,n,r){var o,s,u={value:0},l={};return l.enter=o={opacity:u,x:u,y:u},gk(o,"width",n.gradientWidth),gk(o,"height",n.gradientHeight),gk(o,"stroke",n.gradientStrokeColor),gk(o,"strokeWidth",n.gradientStrokeWidth),l.exit={opacity:u},l.update=s={x:u,y:u,fill:{gradient:t},opacity:{value:1}},gk(s,"width",n.gradientWidth),gk(s,"height",n.gradientHeight),bk("rect","legend-gradient",null,void 0,void 0,l,r)}(0,O,p,g.gradient),function(e,t,n,r){var o,s,u={value:0},l={};return l.enter=o={opacity:u},gk(o,"fill",t.labelColor),gk(o,"font",t.labelFont),gk(o,"fontSize",t.labelFontSize),gk(o,"fontWeight",t.labelFontWeight),gk(o,"baseline",t.gradientLabelBaseline),gk(o,"limit",t.gradientLabelLimit),l.exit={opacity:u},l.update=s={opacity:{value:1},text:{field:"label"}},o.x=s.x={field:"perc",mult:t.gradientWidth},o.y=s.y={value:t.gradientHeight,offset:t.gradientLabelOffset},o.align=s.align={signal:'datum.perc<=0?"left":datum.perc>=1?"right":"center"'},bk("text","legend-label","guide-label","perc",r,l,n)}(0,p,g.labels,o)]):(o=iA(t.add(SA(c={scale:t.scaleRef(O),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),formatSpecifier:t.property(e.format)}))),d=[function(e,t,n,r){var o,s,u={value:0},l={};return l.enter=o={opacity:u},gk(o,"shape",t.symbolType),gk(o,"size",t.symbolSize),gk(o,"strokeWidth",t.symbolStrokeWidth),e.fill||(gk(o,"fill",t.symbolFillColor),gk(o,"stroke",t.symbolStrokeColor)),l.exit={opacity:u},l.update=s={opacity:{value:1}},o.x=s.x={field:"offset",mult:.5},o.y=s.y={field:"size",mult:.5,offset:{field:"total",offset:{field:{group:"entryPadding"},mult:{field:"index"}}}},$A.forEach(function(t){e[t]&&(s[t]=o[t]={scale:e[t],field:QA})}),bk("symbol","legend-symbol",null,QA,r,l,n)}(e,p,g.symbols,o),function(e,t,n,r){var o,s,u={value:0},l={};return l.enter=o={opacity:u},gk(o,"align",t.labelAlign),gk(o,"baseline",t.labelBaseline),gk(o,"fill",t.labelColor),gk(o,"font",t.labelFont),gk(o,"fontSize",t.labelFontSize),gk(o,"fontWeight",t.labelFontWeight),gk(o,"limit",t.labelLimit),l.exit={opacity:u},l.update=s={opacity:{value:1},text:{field:"label"}},o.x=s.x={field:"offset",offset:t.labelOffset},o.y=s.y={field:"size",mult:.5,offset:{field:"total",offset:{field:{group:"entryPadding"},mult:{field:"index"}}}},bk("text","legend-label","guide-label",QA,r,l,n)}(0,p,g.labels,o)],c.size=function(e,t,n){var r=jk(t,n[1].encode,"fontSize","guide-label");if(e.size)return{$expr:"Math.max(Math.ceil(Math.sqrt(_.scale(datum))),"+r+")"};var o=jk(t,n[0].encode,"size");return Math.max(Math.ceil(Math.sqrt(o)),r)}(e,t,d)),d=[xk("legend-entry",null,null,r,w,l,d)],n.title&&(u=function(e,t,n,r){var o,s={value:0},u=e.title,l={};return l.enter=o={x:{field:{group:"padding"}},y:{field:{group:"padding"}},opacity:s},gk(o,"align",t.titleAlign),gk(o,"baseline",t.titleBaseline),gk(o,"fill",t.titleColor),gk(o,"font",t.titleFont),gk(o,"fontSize",t.titleFontSize),gk(o,"fontWeight",t.titleFontWeight),gk(o,"limit",t.titleLimit),l.exit={opacity:s},l.update={opacity:{value:1},text:u&&u.signal?{signal:u.signal}:{value:u+""}},bk("text","legend-title","guide-title",null,r,l,n)}(e,p,g.title,r),l.update.y.offset={field:{group:"titlePadding"},offset:jk(t,u.encode,"fontSize","guide-title")},d.push(u)),s=xk("legend",E,_,r,w,m,d),e.zindex&&(s.zindex=e.zindex),zk(s,t)}(e,t)}),e.title&&function(e,t){e=Object(v.isString)(e)?{text:e}:e;var n,r,o=t.config.title,s=Object(v.extend)({},e.encode);n=iA(t.add(yA(null,[{orient:null!=e.orient?e.orient:o.orient}]))),s.name=e.name,s.interactive=e.interactive,r=function(e,t,n,r){var o,s,u,l,c,d,h=e.text,p=e.orient||t.orient,g=e.anchor||t.anchor,m="left"===p||"top"===p?-1:1,_="top"===p||"bottom"===p,w={group:_?"width":"height"},E={};return E.enter=o={opacity:{value:0}},gk(o,"fill",t.color),gk(o,"font",t.font),gk(o,"fontSize",t.fontSize),gk(o,"fontWeight",t.fontWeight),E.exit={opacity:{value:0}},E.update=s={opacity:{value:1},text:Object(v.isObject)(h)?h:{value:h+""},offset:pk((null!=e.offset?e.offset:t.offset)||0)},"start"===g?(c=0,d="left"):"end"===g?(c=1,d="right"):(c=.5,d="center"),u={field:w,mult:c},l=m<0?{value:0}:_?{field:{group:"height"}}:{field:{group:"width"}},_?(s.x=u,s.y=l,s.angle={value:0},s.baseline={value:"top"===p?"bottom":"top"}):(s.x=l,s.y=u,s.angle={value:90*m},s.baseline={value:"bottom"}),s.align={value:d},s.limit={field:w},gk(s,"angle",t.angle),gk(s,"baseline",t.baseline),gk(s,"limit",t.limit),bk("text","title",e.style||"group-title",null,r,E,n)}(e,o,s,n),e.zindex&&(r.zindex=e.zindex),zk(r,t)}(e.title,t),t.parseLambdas(),t},qk=Object(v.toSet)(["width","height","padding","autosize"]);function Gk(e){this.config=e,this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.background=null,this.eventConfig=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function Wk(e){this.config=e.config,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}var Hk=Gk.prototype=Wk.prototype;Hk.fork=function(){return new Wk(this)},Hk.toRuntime=function(){return this.finish(),{background:this.background,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig}},Hk.id=function(){return(this._subid?this._subid+":":0)+this._id++},Hk.add=function(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(function(t){t.$ref=e.id}),e.refs=null),e},Hk.proxy=function(e){var t=e instanceof tA?iA(e):e;return this.add(RA({value:t}))},Hk.addStream=function(e){return this.streams.push(e),e.id=this.id(),e},Hk.addUpdate=function(e){return this.updates.push(e),e},Hk.finish=function(){var e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(e,t,n){var r;e&&((r=e.data||(e.data={}))[t]||(r[t]=[])).push(n)}for(e in this.data)for(var r in n((t=this.data[e]).input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values"),t.index)n(t.index[r],e,"index:"+r);return this},Hk.pushState=function(e,t,n){this._encode.push(iA(this.add(zA({pulse:e})))),this._parent.push(t),this._lookup.push(n?iA(this.proxy(n)):null),this._markpath.push(-1)},Hk.popState=function(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},Hk.parent=function(){return Object(v.peek)(this._parent)},Hk.encode=function(){return Object(v.peek)(this._encode)},Hk.lookup=function(){return Object(v.peek)(this._lookup)},Hk.markpath=function(){var e=this._markpath;return++e[e.length-1]},Hk.fieldRef=function(e,t){if(Object(v.isString)(e))return oA(e,t);e.signal||Object(v.error)("Unsupported field reference: "+Object(v.stringValue)(e));var n,r=e.signal,f=this.field[r];return f||(n={name:this.signalRef(r)},t&&(n.as=t),this.field[r]=f=iA(this.add(EA(n)))),f},Hk.compareRef=function(e,t){function n(e){return fA(e)?(o=!0,iA(r[e.signal])):e}var r=this.signals,o=!1,s=Object(v.array)(e.field).map(n),u=Object(v.array)(e.order).map(n);return t&&s.push(aA),o?iA(this.add(bA({fields:s,orders:u}))):uA(s,u)},Hk.keyRef=function(e,t){var n=this.signals,r=!1;return e=Object(v.array)(e).map(function(e){return fA(e)?(r=!0,iA(n[e.signal])):e}),r?iA(this.add(OA({fields:e,flat:t}))):function(e,t){var n={$key:e};return t&&(n.$flat=!0),n}(e,t)},Hk.sortRef=function(e){if(!e)return e;var a=[cA(e.op,e.field),aA],t=e.order||"ascending";return t.signal?iA(this.add(bA({fields:a,orders:[t=this.signalRef(t.signal),t]}))):uA(a,[t,t])},Hk.event=function(e,t){var n=e+":"+t;if(!this.events[n]){var r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},Hk.addSignal=function(e,value){this.signals.hasOwnProperty(e)&&Object(v.error)("Duplicate signal name: "+Object(v.stringValue)(e));var t=value instanceof tA?value:this.add(rA(value));return this.signals[e]=t},Hk.getSignal=function(e){return this.signals[e]||Object(v.error)("Unrecognized signal name: "+Object(v.stringValue)(e)),this.signals[e]},Hk.signalRef=function(e){return this.signals[e]?iA(this.signals[e]):(this.lambdas.hasOwnProperty(e)||(this.lambdas[e]=this.add(rA(null))),iA(this.lambdas[e]))},Hk.parseLambdas=function(){for(var e=Object.keys(this.lambdas),i=0,t=e.length;i<t;++i){var n=e[i],r=KS(n,this),o=this.lambdas[n];o.params=r.$params,o.update=r.$expr}},Hk.property=function(e){return e&&e.signal?this.signalRef(e.signal):e},Hk.objectProperty=function(e){return e&&Object(v.isObject)(e)?this.signalRef(e.signal||function e(t){return(Object(v.isArray)(t)?function(t){for(var value,n="[",i=0,r=t.length;i<r;++i)value=t[i],n+=(i>0?",":"")+(Object(v.isObject)(value)?value.signal||e(value):Object(v.stringValue)(value));return n+"]"}:function(t){var n,value,r="{",i=0;for(n in t)value=t[n],r+=(++i>1?",":"")+Object(v.stringValue)(n)+":"+(Object(v.isObject)(value)?value.signal||e(value):Object(v.stringValue)(value));return r+"}"})(t)}(e)):e},Hk.addBinding=function(e,t){this.bindings||Object(v.error)("Nested signals do not support binding: "+Object(v.stringValue)(e)),this.bindings.push(Object(v.extend)({signal:e},t))},Hk.addScaleProj=function(e,t){this.scales.hasOwnProperty(e)&&Object(v.error)("Duplicate scale or projection name: "+Object(v.stringValue)(e)),this.scales[e]=this.add(t)},Hk.addScale=function(e,t){this.addScaleProj(e,LA(t))},Hk.addProjection=function(e,t){this.addScaleProj(e,DA(t))},Hk.getScale=function(e){return this.scales[e]||Object(v.error)("Unrecognized scale name: "+Object(v.stringValue)(e)),this.scales[e]},Hk.projectionRef=Hk.scaleRef=function(e){return iA(this.getScale(e))},Hk.projectionType=Hk.scaleType=function(e){return this.getScale(e).params.type},Hk.addData=function(e,t){return this.data.hasOwnProperty(e)&&Object(v.error)("Duplicate data set name: "+Object(v.stringValue)(e)),this.data[e]=t},Hk.getData=function(e){return this.data[e]||Object(v.error)("Undefined data set name: "+Object(v.stringValue)(e)),this.data[e]},Hk.addDataPipeline=function(e,t){return this.data.hasOwnProperty(e)&&Object(v.error)("Duplicate data set name: "+Object(v.stringValue)(e)),this.addData(e,Ck.fromEntries(this,t))};var Xk=function(e,t){return Object(v.isObject)(e)||Object(v.error)("Input Vega specification must be an object."),function(e,t){var n,r,o,s,u,l=t.config;return t.background=e.background||l.background,t.eventConfig=l.events,u=iA(t.root=t.add(rA())),t.addSignal("width",e.width||0),t.addSignal("height",e.height||0),t.addSignal("padding",function(e,t){return e=e||t.padding,Object(v.isObject)(e)?{top:SE(e.top),bottom:SE(e.bottom),left:SE(e.left),right:SE(e.right)}:{top:n=SE(e),bottom:n,left:n,right:n};var n}(e.padding,l)),t.addSignal("autosize",function(e,t){return e=e||t.autosize,Object(v.isObject)(e)?e:{type:e=e||"pad"}}(e.autosize,l)),Object(v.array)(e.signals).forEach(function(e){qk[e.name]||RE(e,t)}),r=t.add(yA()),o=mk({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e.encode),o=t.add(_A(vk(o,"group",hk,e.style,t,{pulse:iA(r)}))),s=t.add(FA({layout:t.objectProperty(e.layout),legendMargin:l.legendMargin,autosize:t.signalRef("autosize"),mark:u,pulse:iA(o)})),t.operators.pop(),t.pushState(iA(o),iA(s),null),Vk(e,t,!0),t.operators.push(s),n=t.add(vA({mark:u,pulse:iA(s)})),n=t.add(PA({pulse:iA(n)})),n=t.add(zA({pulse:iA(n)})),t.addData("root",new Ck(t,r,r,n)),t}(e,new Gk((n=[t,e.config],r={padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:"#4c78a8"},area:{fill:"#4c78a8"},image:null,line:{stroke:"#4c78a8",strokeWidth:2},path:{stroke:"#4c78a8"},rect:{fill:"#4c78a8"},rule:{stroke:"#000"},shape:{stroke:"#4c78a8"},symbol:{fill:"#4c78a8",size:64},text:{fill:"#000",font:"sans-serif",fontSize:11},style:{"guide-label":{fill:"#000",font:"sans-serif",fontSize:10},"guide-title":{fill:"#000",font:"sans-serif",fontSize:11,fontWeight:"bold"},"group-title":{fill:"#000",font:"sans-serif",fontSize:13,fontWeight:"bold"},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:"#ddd"}},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:"#888",grid:!1,gridWidth:1,gridColor:"#ddd",gridOpacity:1,labels:!0,labelAngle:0,labelLimit:180,labelPadding:2,ticks:!0,tickColor:"#888",tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titleAlign:"center",titlePadding:4},axisBand:{tickOffset:-1},legend:{orient:"right",offset:18,padding:0,entryPadding:5,titlePadding:5,gradientWidth:100,gradientHeight:20,gradientStrokeColor:"#ddd",gradientStrokeWidth:0,gradientLabelBaseline:"top",gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelOffset:8,labelLimit:160,symbolType:"circle",symbolSize:100,symbolFillColor:"transparent",symbolStrokeColor:"#888",symbolStrokeWidth:1.5,titleAlign:"left",titleBaseline:"top",titleLimit:180},title:{orient:"top",anchor:"middle",offset:4},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues",extent:[.2,1]},heatmap:{scheme:"viridis"},ramp:{scheme:"blues",extent:[.2,1]},diverging:{scheme:"blueorange"},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}},(n||[]).forEach(function(e){var t,value,n;if(e)for(t in e)if("style"===t)for(t in n=r.style||(r.style={}),e.style)n[t]=Object(v.extend)(n[t]||{},e.style[t]);else value=e[t],r[t]=Object(v.isObject)(value)&&!Object(v.isArray)(value)?Object(v.extend)(Object(v.isObject)(r[t])?r[t]:{},value):value}),r))).toRuntime();var n,r};function Yk(e,t,n){";"!==t[t.length-1]&&(t="return("+t+");");var r=Function.apply(null,e.concat(t));return n&&n.functions?r.bind(n.functions):r}function Kk(e,t){return Yk(["event"],e,t)}function Jk(e,t){return Yk(["item","_"],e,t)}function Zk(e,t,n){var r,value;for(r in n=n||{},e)(value=e[r])&&value.$expr&&value.$params&&Zk(value.$params,t,n),n[r]=Object(v.isArray)(value)?value.map(function(e){return Qk(e,t)}):Qk(value,t);return n}function Qk(e,t){if(!e||!Object(v.isObject)(e))return e;for(var n,i=0,r=$k.length;i<r;++i)if(e.hasOwnProperty((n=$k[i]).key))return n.parse(e,t);return e}var $k=[{key:"$ref",parse:function(e,t){return t.get(e.$ref)||Object(v.error)("Operator not defined: "+e.$ref)}},{key:"$key",parse:function(e,t){var k="k:"+e.$key+"_"+!!e.$flat;return t.fn[k]||(t.fn[k]=Object(v.key)(e.$key,e.$flat))}},{key:"$expr",parse:function(e,t){var k="e:"+e.$expr;return t.fn[k]||(t.fn[k]=Object(v.accessor)(function(t,n){return Yk(["datum","_"],e.$expr,n)}(0,t),e.$fields,e.$name))}},{key:"$field",parse:function(e,t){if(!e.$field)return null;var k="f:"+e.$field+"_"+e.$name;return t.fn[k]||(t.fn[k]=Object(v.field)(e.$field,e.$name))}},{key:"$encode",parse:function(e,t){var n,r,o=e.$encode,s={};for(n in o)r=o[n],s[n]=Object(v.accessor)(Jk(r.$expr,t),r.$fields),s[n].output=r.$output;return s}},{key:"$compare",parse:function(e,t){var k="c:"+e.$compare+"_"+e.$order,n=Object(v.array)(e.$compare).map(function(e){return e&&e.$tupleid?S:e});return t.fn[k]||(t.fn[k]=Object(v.compare)(n,e.$order))}},{key:"$context",parse:function(e,t){return t}},{key:"$subflow",parse:function(e,t){var n=e.$subflow;return function(e,r,o){var s=tT(n,t.fork()),u=s.get(n.operators[0].id),l=s.signals.parent;return l&&l.set(o),u}}},{key:"$tupleid",parse:function(){return S}}];function eT(e){return(e+"").toLowerCase()}var tT=function(e,t){var n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),n.forEach(function(e){!function(e,t){"operator"!==eT(e.type)&&e.type?t.transform(e,e.type):t.operator(e,e.update?function(t,n){return Yk(["_"],e.update,n)}(0,t):null)}(e,t)}),n.forEach(function(e){!function(e,t){var n,r;e.params&&((n=t.get(e.id))||Object(v.error)("Invalid operator id: "+e.id),r=Zk(e.params,t),t.dataflow.connect(n,n.parameters(r)))}(e,t)}),(e.streams||[]).forEach(function(e){!function(e,t){var n,r=null!=e.filter?Kk(e.filter,t):void 0,o=null!=e.stream?t.get(e.stream):void 0;e.source?o=t.events(e.source,e.type,r):e.merge&&(o=(n=e.merge.map(t.get.bind(t)))[0].merge.apply(n[0],n.slice(1))),e.between&&(n=e.between.map(t.get.bind(t)),o=o.between(n[0],n[1])),e.filter&&(o=o.filter(r)),null!=e.throttle&&(o=o.throttle(+e.throttle)),null!=e.debounce&&(o=o.debounce(+e.debounce)),null==o&&Object(v.error)("Invalid stream definition: "+JSON.stringify(e)),e.consume&&o.consume(!0),t.stream(e,o)}(e,t)}),(e.updates||[]).forEach(function(e){!function(e,t){var n,r=t.get(e.source),o=e.update,s=void 0;r||Object(v.error)("Source not defined: "+e.source),n=e.target&&e.target.$expr?Kk(e.target.$expr,t):t.get(e.target),o&&o.$expr&&(o.$params&&(s=Zk(o.$params,t)),o=function(e,t){return Yk(["_","event"],o.$expr,t)}(0,t)),t.update(e,r,n,o,s)}(e,t)}),t.resolve()},nT={skip:!0},rT=function(e,t,n){return new iT(e,t,n)};function iT(e,t,n){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function aT(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.functions=e.functions,this.events=e.events,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}iT.prototype=aT.prototype={fork:function(){var e=new aT(this);return(this.subcontext||(this.subcontext=[])).push(e),e},get:function(e){return this.nodes[e]},set:function(e,t){return this.nodes[e]=t},add:function(e,t){var n,r=this,o=r.dataflow;if(r.set(e.id,t),"collect"===eT(e.type)&&(n=e.value)&&(n.$ingest?o.ingest(t,n.$ingest,n.$format):n.$request?o.request(t,n.$request,n.$format):o.pulse(t,o.changeset().insert(n))),e.root&&(r.root=t),e.parent){var s=r.get(e.parent.$ref);s?(o.connect(s,[t]),t.targets().add(s)):(r.unresolved=r.unresolved||[]).push(function(){s=r.get(e.parent.$ref),o.connect(s,[t]),t.targets().add(s)})}if(e.signal&&(r.signals[e.signal]=t),e.scale&&(r.scales[e.scale]=t),e.data)for(var u in e.data)n=r.data[u]||(r.data[u]={}),e.data[u].forEach(function(e){n[e]=t})},resolve:function(){return(this.unresolved||[]).forEach(function(e){e()}),delete this.unresolved,this},operator:function(e,t,n){this.add(e,this.dataflow.add(e.value,t,n,e.react))},transform:function(e,t,n){this.add(e,this.dataflow.add(this.transforms[eT(t)],n))},stream:function(e,t){this.set(e.id,t)},update:function(e,t,n,r,o){this.dataflow.on(t,n,r,o,e.options)},getState:function(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(function(n){var o=t.signals[n];e.signals(n,o)&&(r[n]=o.value)})}if(e.data){var o=n.data={};Object.keys(t.data).forEach(function(n){var r=t.data[n];e.data(n,r)&&(o[n]=r.input.value)})}return t.subcontext&&!1!==e.recurse&&(n.subcontext=t.subcontext.map(function(t){return t.getState(e)})),n},setState:function(e){var t=this,n=t.dataflow,r=e.data,o=e.signals;Object.keys(o||{}).forEach(function(e){n.update(t.signals[e],o[e],nT)}),Object.keys(r||{}).forEach(function(e){n.pulse(t.data[e].input,n.changeset().remove(v.truthy).insert(r[e]))}),(e.subcontext||[]).forEach(function(e,i){var n=t.subcontext[i];n&&n.setState(e)})}};var oT=function(e,t,n){return tT(t,rT(e,cr,n||VS))},sT="padding";function uT(e,t){var a=e.autosize(),n=e.padding();return t-(a&&a.contains===sT?n.left+n.right:0)}function lT(e,t){var a=e.autosize(),n=e.padding();return t-(a&&a.contains===sT?n.top+n.bottom:0)}function cT(e,t){return t.modified&&Object(v.isArray)(t.input.value)&&e.indexOf("_:vega:_")}function dT(e,t){return!("parent"===e||t instanceof cr.proxy)}function hT(e,t){t=t||{},ar.call(this),this.loader(t.loader||this._loader),this.logLevel(t.logLevel||0),this._el=null,this._renderType=t.renderer||El.Canvas,this._scenegraph=new Nu;var n=this._scenegraph.root;this._renderer=null,this._redraw=!0,this._handler=(new Vu).scene(n),this._preventDefault=!1,this._eventListeners=[],this._resizeListeners=[];var r,o,s=oT(this,e,t.functions);this._runtime=s,this._signals=s.signals,this._bind=(e.bindings||[]).map(function(e){return{state:null,param:Object(v.extend)({},e)}}),s.root&&s.root.set(n),n.source=s.data.root.input,this.pulse(s.data.root.input,this.changeset().insert(n.items)),this._background=s.background||null,this._eventConfig=(r=s.eventConfig,(o=(r=Object(v.extend)({},r)).defaults)&&(Object(v.isArray)(o.prevent)&&(o.prevent=Object(v.toSet)(o.prevent)),Object(v.isArray)(o.allow)&&(o.allow=Object(v.toSet)(o.allow))),r),this._width=this.width(),this._height=this.height(),this._viewWidth=uT(this,this._width),this._viewHeight=lT(this,this._height),this._origin=[0,0],this._resize=0,this._autosize=1,function(e){var t=e._signals,n=t.width,r=t.height,o=t.padding;function s(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,function(t){e._width=t.size,e._viewWidth=uT(e,t.size),s()},{size:n}),e._resizeHeight=e.add(null,function(t){e._height=t.size,e._viewHeight=lT(e,t.size),s()},{size:r});var u=e.add(null,s,{pad:o});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,u.rank=o.rank+1}(this),iE(this)}var pT=Object(v.inherits)(hT,ar);function gT(e,t){return e._signals.hasOwnProperty(t)?e._signals[t]:Object(v.error)("Unrecognized signal name: "+Object(v.stringValue)(t))}function mT(e,t){var n=(e._targets||[]).filter(function(e){var n=e._update;return n&&n.handler===t});return n.length?n[0]:null}pT.run=function(e){if(ar.prototype.run.call(this,e),this._redraw||this._resize)try{this.render()}catch(e){this.error(e)}return this},pT.render=function(){var e,t,n,r;return this._renderer&&(this._resize&&(this._resize=0,t=lE(e=this),n=sE(e),r=uE(e),e._renderer.background(e._background),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(function(e){e(n,r)})),this._renderer.render(this._scenegraph.root)),this._redraw=!1,this},pT.dirty=function(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},pT.container=function(){return this._el},pT.scenegraph=function(){return this._scenegraph},pT.signal=function(e,value,t){var n=gT(this,e);return 1===arguments.length?n.value:this.update(n,value,t)},pT.background=function(e){return arguments.length?(this._background=e,this._resize=1,this):this._background},pT.width=function(e){return arguments.length?this.signal("width",e):this.signal("width")},pT.height=function(e){return arguments.length?this.signal("height",e):this.signal("height")},pT.padding=function(e){return arguments.length?this.signal("padding",e):this.signal("padding")},pT.autosize=function(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},pT.renderer=function(e){return arguments.length?(Sl(e)||Object(v.error)("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._renderer&&(this._renderer=null,this.initialize(this._el))),this):this._renderType},pT.loader=function(e){return arguments.length?(e!==this._loader&&(ar.prototype.loader.call(this,e),this._renderer&&(this._renderer=null,this.initialize(this._el))),this):this._loader},pT.resize=function(){return this._autosize=1,this},pT._resizeView=function(e,t,n,r,o,s){this.runAfter(function(u){var l=0;u._autosize=0,u.width()!==n&&(l=1,u.width(n),u._resizeWidth.skip(!0)),u.height()!==r&&(l=1,u.height(r),u._resizeHeight.skip(!0)),u._viewWidth!==e&&(u._resize=1,u._viewWidth=e),u._viewHeight!==t&&(u._resize=1,u._viewHeight=t),u._origin[0]===o[0]&&u._origin[1]===o[1]||(u._resize=1,u._origin=o),l&&u.run("enter"),s&&u.runAfter(function(){u.resize()})},!1,1)},pT.addEventListener=function(e,t){return this._handler.on(e,t),this},pT.removeEventListener=function(e,t){return this._handler.off(e,t),this},pT.addResizeListener=function(e){var t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},pT.removeResizeListener=function(e){var t=this._resizeListeners,i=t.indexOf(e);return i>=0&&t.splice(i,1),this},pT.addSignalListener=function(e,t){var n=gT(this,e),r=mT(n,t);return r||((r=function(){t(e,n.value)}).handler=t,this.on(n,null,r)),this},pT.removeSignalListener=function(e,t){var n=gT(this,e),r=mT(n,t);return r&&n._targets.remove(r),this},pT.preventDefault=function(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},pT.tooltipHandler=function(e){var t=this._handler;return arguments.length?(t.handleTooltip=e||zu.prototype.handleTooltip,this):t.handleTooltip},pT.events=function(e,t,n){var r,o=this,s=new G(n),u=function(n,r){"view"===e&&function(e,t){var n=e._eventConfig.defaults,r=n&&n.prevent,o=n&&n.allow;return!1!==r&&!0!==o&&(!0===r||!1===o||(r?r[t]:o?!o[t]:e.preventDefault()))}(o,t)&&n.preventDefault();try{s.receive(function(e,t,n){var r,o,s=e._renderer.scene();return s&&(o=lE(e),(r=Bu(t.changedTouches?t.changedTouches[0]:t,s))[0]-=o[0],r[1]-=o[1]),t.dataflow=e,t.vega=function(e,t,n){var r=t?"group"===t.mark.marktype?t:t.mark.group:null;function o(e){var i,n=r;if(e)for(i=t;i;i=i.mark.group)if(i.mark.name===e){n=i;break}return n&&n.mark&&n.mark.interactive?n:{}}function s(e){if(!e)return n;Object(v.isString)(e)&&(e=o(e));for(var t=n.slice();e;)t[0]-=e.x||0,t[1]-=e.y||0,e=e.mark&&e.mark.group;return t}return{view:Object(v.constant)(e),item:Object(v.constant)(t||{}),group:o,xy:s,x:function(e){return s(e)[0]},y:function(e){return s(e)[1]}}}(e,n,r),t.item=n,t}(o,n,r))}catch(e){o.error(e)}finally{o.run()}};if("view"===e)return o.addEventListener(t,u),s;if("window"===e?"undefined"!=typeof window&&(r=[window]):"undefined"!=typeof document&&(r=document.querySelectorAll(e)),!r)return o.warn("Can not resolve event source: "+e),s;for(var i=0,l=r.length;i<l;++i)r[i].addEventListener(t,u);return o._eventListeners.push({type:t,sources:r,handler:u}),s},pT.finalize=function(){for(var e,t,n=this._eventListeners,r=n.length;--r>=0;)for(e=(t=n[r]).sources.length;--e>=0;)t.sources[e].removeEventListener(t.type,t.handler)},pT.hover=function(e,t){return e=[e||"hover"],t=[t||"update",e],this.on(this.events("view","mouseover",cE),fE,dE(e)),this.on(this.events("view","mouseout",cE),fE,dE(t)),this},pT.data=function(e){return aE(this,e).values.value},pT.change=oE,pT.insert=function(e,t){return oE.call(this,e,R().insert(t))},pT.remove=function(e,t){return oE.call(this,e,R().remove(t))},pT.initialize=function(e,t){var n,r,o=this,s=o._renderType,u=Sl(s);return e=o._el=e?EE(o,e):null,u||o.error("Unrecognized renderer type: "+s),n=u.handler||Vu,o._renderer=(r=e?u.renderer:u.headless)?wE(o,o._renderer,e,r):null,o._handler=function(e,t,r,o){var s=new n(e.loader()).scene(e.scenegraph().root).initialize(r,lE(e),e);return t&&(s.handleTooltip=t.handleTooltip,t.handlers().forEach(function(e){s.on(e.type,e.handler)})),s}(o,o._handler,e),o._redraw=!0,e&&(t=t?EE(o,t):e.appendChild(hE("div",{class:"vega-bindings"})),o._bind.forEach(function(e){e.param.element&&(e.element=EE(o,e.param.element))}),o._bind.forEach(function(e){!function(t,n,r){if(n){var o=e.param,s=e.state;s||(s=e.state={elements:null,active:!1,set:null,update:function(value){s.source=!0,t.signal(o.signal,value).run()}},o.debounce&&(s.update=Object(v.debounce)(o.debounce,s.update))),function(e,t,n,value){var r=hE("div",{class:"vega-bind"});r.appendChild(hE("span",{class:"vega-bind-name"},n.name||n.signal)),t.appendChild(r);var o=mE;switch(n.input){case"checkbox":o=vE;break;case"select":o=yE;break;case"radio":o=bE;break;case"range":o=xE}o(e,r,n,value)}(s,n,o,t.signal(o.signal)),s.active||(t.on(t._signals[o.signal],null,function(){s.source?s.source=!1:s.set(t.signal(o.signal))}),s.active=!0)}}(o,e.element||t)})),o},pT.toImageURL=function(e,t){return e!==El.Canvas&&e!==El.SVG&&e!==El.PNG?Promise.reject("Unrecognized image type: "+e):OE(this,e,t).then(function(t){return e===El.SVG?(n=t.svg(),r=new Blob([n],{type:"image/svg+xml"}),window.URL.createObjectURL(r)):t.canvas().toDataURL("image/png");var n,r})},pT.toCanvas=function(e){return OE(this,El.Canvas,e).then(function(e){return e.canvas()})},pT.toSVG=function(e){return OE(this,El.SVG,e).then(function(e){return e.svg()})},pT.getState=function(e){return this._runtime.getState(e||{data:cT,signals:dT,recurse:!0})},pT.setState=function(e){var t=this;return t.runAfter(function(){t._trigger=!1,t._runtime.setState(e),t.run().runAfter(function(){t._trigger=!0})}),this},n.d(t,"version",function(){return rE.version}),n.d(t,"bin",function(){return _r}),n.d(t,"bootstrapCI",function(){return Hr}),n.d(t,"quartiles",function(){return Xr}),n.d(t,"random",function(){return Or}),n.d(t,"setRandom",function(){return Sr}),n.d(t,"randomInteger",function(){return Yr}),n.d(t,"randomKDE",function(){return Jr}),n.d(t,"randomMixture",function(){return Zr}),n.d(t,"randomNormal",function(){return Kr}),n.d(t,"randomUniform",function(){return Qr}),n.d(t,"accessor",function(){return v.accessor}),n.d(t,"accessorName",function(){return v.accessorName}),n.d(t,"accessorFields",function(){return v.accessorFields}),n.d(t,"id",function(){return v.id}),n.d(t,"identity",function(){return v.identity}),n.d(t,"zero",function(){return v.zero}),n.d(t,"one",function(){return v.one}),n.d(t,"truthy",function(){return v.truthy}),n.d(t,"falsy",function(){return v.falsy}),n.d(t,"logger",function(){return v.logger}),n.d(t,"None",function(){return v.None}),n.d(t,"Error",function(){return v.Error}),n.d(t,"Warn",function(){return v.Warn}),n.d(t,"Info",function(){return v.Info}),n.d(t,"Debug",function(){return v.Debug}),n.d(t,"panLinear",function(){return v.panLinear}),n.d(t,"panLog",function(){return v.panLog}),n.d(t,"panPow",function(){return v.panPow}),n.d(t,"zoomLinear",function(){return v.zoomLinear}),n.d(t,"zoomLog",function(){return v.zoomLog}),n.d(t,"zoomPow",function(){return v.zoomPow}),n.d(t,"array",function(){return v.array}),n.d(t,"compare",function(){return v.compare}),n.d(t,"constant",function(){return v.constant}),n.d(t,"debounce",function(){return v.debounce}),n.d(t,"error",function(){return v.error}),n.d(t,"extend",function(){return v.extend}),n.d(t,"extentIndex",function(){return v.extentIndex}),n.d(t,"fastmap",function(){return v.fastmap}),n.d(t,"field",function(){return v.field}),n.d(t,"inherits",function(){return v.inherits}),n.d(t,"isArray",function(){return v.isArray}),n.d(t,"isBoolean",function(){return v.isBoolean}),n.d(t,"isDate",function(){return v.isDate}),n.d(t,"isFunction",function(){return v.isFunction}),n.d(t,"isNumber",function(){return v.isNumber}),n.d(t,"isObject",function(){return v.isObject}),n.d(t,"isRegExp",function(){return v.isRegExp}),n.d(t,"isString",function(){return v.isString}),n.d(t,"key",function(){return v.key}),n.d(t,"merge",function(){return v.merge}),n.d(t,"pad",function(){return v.pad}),n.d(t,"peek",function(){return v.peek}),n.d(t,"repeat",function(){return v.repeat}),n.d(t,"splitAccessPath",function(){return v.splitAccessPath}),n.d(t,"stringValue",function(){return v.stringValue}),n.d(t,"toBoolean",function(){return v.toBoolean}),n.d(t,"toDate",function(){return v.toDate}),n.d(t,"toNumber",function(){return v.toNumber}),n.d(t,"toString",function(){return v.toString}),n.d(t,"toSet",function(){return v.toSet}),n.d(t,"truncate",function(){return v.truncate}),n.d(t,"visitArray",function(){return v.visitArray}),n.d(t,"loader",function(){return Ee}),n.d(t,"read",function(){return qn}),n.d(t,"inferType",function(){return Ie}),n.d(t,"inferTypes",function(){return Pe}),n.d(t,"typeParsers",function(){return Ce}),n.d(t,"formats",function(){return Ye}),n.d(t,"Bounds",function(){return sa}),n.d(t,"Gradient",function(){return fa}),n.d(t,"GroupItem",function(){return ha}),n.d(t,"ResourceLoader",function(){return ma}),n.d(t,"Item",function(){return da}),n.d(t,"Scenegraph",function(){return Nu}),n.d(t,"Handler",function(){return zu}),n.d(t,"Renderer",function(){return Fu}),n.d(t,"CanvasHandler",function(){return Vu}),n.d(t,"CanvasRenderer",function(){return Xu}),n.d(t,"SVGHandler",function(){return Zu}),n.d(t,"SVGRenderer",function(){return ol}),n.d(t,"SVGStringRenderer",function(){return vl}),n.d(t,"RenderType",function(){return El}),n.d(t,"renderModule",function(){return Sl}),n.d(t,"Marks",function(){return wu}),n.d(t,"boundClip",function(){return kl}),n.d(t,"boundContext",function(){return _s}),n.d(t,"boundStroke",function(){return vs}),n.d(t,"boundItem",function(){return Eu}),n.d(t,"boundMark",function(){return Su}),n.d(t,"pathCurves",function(){return Ro}),n.d(t,"pathSymbols",function(){return Yo}),n.d(t,"pathRectangle",function(){return ts}),n.d(t,"pathTrail",function(){return rs}),n.d(t,"pathParse",function(){return Lo}),n.d(t,"pathRender",function(){return qo}),n.d(t,"point",function(){return Bu}),n.d(t,"domCreate",function(){return Du}),n.d(t,"domFind",function(){return Ru}),n.d(t,"domChild",function(){return Iu}),n.d(t,"domClear",function(){return Pu}),n.d(t,"openTag",function(){return el}),n.d(t,"closeTag",function(){return tl}),n.d(t,"font",function(){return vu}),n.d(t,"textMetrics",function(){return lu}),n.d(t,"resetSVGClipId",function(){return Ws}),n.d(t,"sceneEqual",function(){return Nl}),n.d(t,"pathEqual",function(){return Ml}),n.d(t,"sceneToJSON",function(){return ku}),n.d(t,"sceneFromJSON",function(){return Tu}),n.d(t,"sceneZOrder",function(){return Ns}),n.d(t,"sceneVisit",function(){return Ms}),n.d(t,"scenePickVisit",function(){return Cs}),n.d(t,"Dataflow",function(){return ar}),n.d(t,"EventStream",function(){return G}),n.d(t,"Parameters",function(){return P}),n.d(t,"Pulse",function(){return Hn}),n.d(t,"MultiPulse",function(){return Zn}),n.d(t,"Operator",function(){return U}),n.d(t,"Transform",function(){return ur}),n.d(t,"changeset",function(){return R}),n.d(t,"ingest",function(){return T}),n.d(t,"isTuple",function(){return O}),n.d(t,"definition",function(){return fr}),n.d(t,"transform",function(){return dr}),n.d(t,"transforms",function(){return cr}),n.d(t,"tupleid",function(){return S}),n.d(t,"scale",function(){return $d}),n.d(t,"scheme",function(){return Rp}),n.d(t,"interpolate",function(){return zp}),n.d(t,"interpolateRange",function(){return Ip}),n.d(t,"timeInterval",function(){return Up}),n.d(t,"utcInterval",function(){return Bp}),n.d(t,"projection",function(){return jb}),n.d(t,"View",function(){return hT}),n.d(t,"parse",function(){return Xk}),n.d(t,"expressionFunction",function(){return HS}),n.d(t,"formatLocale",function(){return Ad}),n.d(t,"timeFormatLocale",function(){return Vn}),n.d(t,"runtime",function(){return tT}),n.d(t,"runtimeContext",function(){return rT}),Object(v.extend)(cr,r,o,l,c,d,h,p,g,m)},YsHz:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SELECTION_ID="_vgsid_",t.defaultConfig={single:{on:"click",fields:[t.SELECTION_ID],resolve:"global",empty:"all"},multi:{on:"click",fields:[t.SELECTION_ID],toggle:"event.shiftKey",resolve:"global",empty:"all"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global"}}},Yt8P:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PARALLELIZE_THRESHOLD=30,t.computeOptimalWindowSize=function(e){return e<=t.PARALLELIZE_THRESHOLD?e:function(t,n){for(var i=Math.floor(Math.sqrt(e));i<t;++i)if(t%i==0)return i;return t}(e)}},YuVP:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Bsgt"),o=n("Xq4m"),s=n("kglw"),u=n("6SkM");t.default={predicate:"vlMulti",scaleDomain:"vlMultiDomain",signals:function(e,t){var n=t.project,l=u.default.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum",c=[],d=n.map(function(e){return r.stringValue(e.channel)}).filter(function(e){return e}).join(", "),h=n.map(function(e){return r.stringValue(e.field)}).join(", "),p=n.map(function(t){var n=t.channel,r=e.fieldDef(n);return r&&r.bin?(c.push(t.field),"["+l+o.accessPath(e.vgField(n,{}))+", "+l+o.accessPath(e.vgField(n,{binSuffix:"end"}))+"]"):""+l+o.accessPath(t.field)}).join(", ");return[{name:t.name+s.TUPLE,value:{},on:[{events:t.events,update:"datum && item().mark.marktype !== 'group' ? {unit: "+s.unitName(e)+", encodings: ["+d+"], fields: ["+h+"], values: ["+p+"]"+(c.length?", "+c.map(function(b){return r.stringValue("bin_"+b)+": 1"}).join(", "):"")+"} : null",force:!0}]}]},modifyExpr:function(e,t){return t.name+s.TUPLE+", "+("global"===t.resolve?"null":"{unit: "+s.unitName(e)+"}")}}},ZD6k:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("v/P2"),o=n("A3i/"),s=n("A6gD"),u=n("XPNO"),l=n("XFvI");function c(e,n,r){if(void 0===r&&(r=t.TEST_EPSILON),e instanceof u.Tensor||n instanceof u.Tensor){if(e instanceof u.Tensor&&n instanceof u.Tensor){if(e.dtype!==n.dtype)throw new Error("Arrays are of different type actual: "+e.dtype+" vs expected: "+n.dtype+".");if(!l.arraysEqual(e.shape,n.shape))throw new Error("Arrays are of different shape actual: "+e.shape+" vs expected: "+n.shape+".")}}else{var o=e.constructor.name,s=n.constructor.name;if(o!==s)throw new Error("Arrays are of different type actual: "+o+" vs expected: "+s)}var c,h;if(c=e instanceof u.Tensor?e.dataSync():e,h=n instanceof u.Tensor?n.dataSync():n,c.length!==h.length)throw new Error("Arrays have different lengths actual: "+c.length+" vs expected: "+h.length+".\nActual:   "+c+".\nExpected: "+h+".");for(var i=0;i<h.length;++i){var a=c[i],p=h[i];if(!d(a,Number(p),r))throw new Error("Arrays differ: actual["+i+"] = "+a+", expected["+i+"] = "+p+".\nActual:   "+c+".\nExpected: "+h+".")}}function d(a,e,t){return!(!isNaN(a)||!isNaN(e))||!(isNaN(a)||isNaN(e)||Math.abs(a-e)>t)}t.WEBGL_ENVS=[{BACKEND:"webgl",WEBGL_FLOAT_TEXTURE_ENABLED:!0,WEBGL_VERSION:1},{BACKEND:"webgl",WEBGL_FLOAT_TEXTURE_ENABLED:!0,WEBGL_VERSION:2}],t.CPU_ENVS=[{BACKEND:"cpu"}],t.ALL_ENVS=t.WEBGL_ENVS.concat(t.CPU_ENVS),t.TEST_EPSILON=.001,t.expectArraysClose=c,t.expectArraysEqual=function(e,t){return c(e,t,0)},t.expectNumbersClose=function(a,e,n){if(void 0===n&&(n=t.TEST_EPSILON),!d(a,e,n))throw new Error("Numbers differ: actual === "+a+", expected === "+e)},t.expectValuesInRange=function(e,t,n){var r;r=e instanceof u.Tensor?e.dataSync():e;for(var i=0;i<r.length;i++)if(r[i]<t||r[i]>n)throw new Error("Value out of range:"+r[i]+" low: "+t+", high: "+n)},t.describeWithFlags=function(e,t,n){t.forEach(function(t){!function(e,t,n){describe(e,function(){beforeAll(function(){r.ENV.setFeatures(n||{}),r.ENV.addCustomBackend("webgl",function(){return new s.MathBackendWebGL}),r.ENV.addCustomBackend("cpu",function(){return new o.MathBackendCPU})}),beforeEach(function(){n&&null!=n.BACKEND&&r.Environment.setBackend(n.BACKEND),r.ENV.engine.startScope()}),afterEach(function(){r.ENV.engine.endScope(null)}),afterAll(function(){r.ENV.reset()}),t()})}(e+" "+JSON.stringify(t),n,t)})},t.assertIsNan=function(e,t){if(!l.isValNaN(e,t))throw new Error("Value "+e+" does not represent NaN for dtype "+t)}},ZQPO:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("qmZh"),s=n("lbmW"),u=n("yJL4"),l=n("TPCB"),c=n("Q1Fz"),d=n("2EGJ"),h=n("np2E"),p=n("np2E"),g=function(e){function t(t){var n=e.call(this,t)||this;return n.depthwiseKernel=null,n.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,n.depthwiseInitializer=l.getInitializer(t.depthwiseInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.depthwiseConstraint=s.getConstraint(t.depthwiseConstraint),n.depthwiseRegularizer=c.getRegularizer(t.depthwiseRegularizer),n}return r(t,e),t.prototype.build=function(e){if((e=p.getExactlyOneShape(e)).length<4)throw new u.ValueError("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(e)+".");var t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new u.ValueError("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+e[t]+").");var n=e[t];this.depthwiseKernel=this.addWeight("depthwise_kernel",[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier],null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0},t.prototype.call=function(e,t){e=p.getExactlyOneTensor(e);var n=o.depthwiseConv2d(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(n=o.biasAdd(n,this.bias.read(),this.dataFormat)),null!=this.activation&&(n=this.activation(n)),n},t.prototype.computeOutputShape=function(e){e=p.getExactlyOneShape(e);var t="channelsFirst"===this.dataFormat?e[3]:e[2],n="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,r=d.convOutputLength("channelsFirst"===this.dataFormat?e[2]:e[1],this.kernelSize[0],this.padding,this.strides[0]),o=d.convOutputLength(t,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],n,r,o]:[e[0],r,o,n]},t}(n("bcxt").Conv2D);t.DepthwiseConv2D=g,h.ClassNameMap.register("DepthwiseConv2D",g)},Zjkm:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("0N5v"),s=n("dMOq"),u=n("KIOn");t.tick={vgMark:"rect",encodeEntry:function(e){var t,n=e.config,l=e.width,c=e.height,d=e.markDef.orient,h="horizontal"===d?"width":"height",p="horizontal"===d?"height":"width";return r({},s.baseEncodeEntry(e,{size:"ignore",orient:"ignore"}),s.pointPosition("x",e,u.mid(l),"xc"),s.pointPosition("y",e,u.mid(c),"yc"),s.nonPosition("size",e,{defaultValue:function(e){var t=e.config,n=e.markDef,r=e.getScaleComponent("horizontal"===n.orient?"x":"y");if(void 0!==n.size)return n.size;if(void 0!==t.tick.bandSize)return t.tick.bandSize;var s=r?r.get("range"):void 0,u=s&&o.isVgRangeStep(s)?s.step:t.scale.rangeStep;if("number"!=typeof u)throw new Error("Function does not handle non-numeric rangeStep");return u/1.5}(e),vgChannel:h}),((t={})[p]={value:n.tick.thickness},t))}}},ZyY3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version="0.3.0"},"a/7e":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Bsgt"),o=n("xdLA"),s=n("KMAE"),u=n("rxHH"),l=n("rxHH"),c=n("Xq4m"),d=n("0N5v"),h=n("OMxB"),p=n("aIXu"),g=n("dFdk");function m(e,n,r,o,l,c,d,h,g,m){for(var w=h||null===o.rangeStep,E=0,O=t.RANGE_PROPERTIES;E<O.length;E++){var S=O[E];if(void 0!==o[S]){var A=u.scaleTypeSupportProperty(n,S),T=u.channelScalePropertyIncompatability(e,S);if(A)if(T)s.warn(T);else switch(S){case"range":return p.makeExplicit(o[S]);case"scheme":return p.makeExplicit(v(o[S]));case"rangeStep":var N=o[S];if(null!==N){if(!h)return p.makeExplicit({step:N});s.warn(s.message.rangeStepDropped(e))}}else s.warn(s.message.scalePropertyNotWorkWithScaleType(n,S,e))}}return p.makeImplicit(_(e,n,r,l,c,d,g,m,w))}function v(e){if(u.isExtendedScheme(e)){var t={scheme:e.name};return e.count&&(t.count=e.count),e.extent&&(t.extent=e.extent),t}return{scheme:e}}function _(e,t,n,r,u,d,h,p,g){switch(e){case o.X:case o.Y:if(c.contains(["point","band"],t)&&!g)if(e===o.X&&"text"===d){if(r.scale.textXRangeStep)return{step:r.scale.textXRangeStep}}else if(r.scale.rangeStep)return{step:r.scale.rangeStep};return e===o.Y&&l.hasContinuousDomain(t)?[{signal:h},0]:[0,{signal:h}];case o.SIZE:return[function(e,t,n){if(t)return 0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(s.message.incompatibleChannel("size",e))}(d,u,r),function(e,t,n){var r=n.scale;switch(e){case"bar":case"tick":return void 0!==n.scale.maxBandSize?n.scale.maxBandSize:w(t,n.scale)-1;case"line":case"rule":return n.scale.maxStrokeWidth;case"text":return n.scale.maxFontSize;case"point":case"square":case"circle":if(n.scale.maxSize)return n.scale.maxSize;var o=w(t,r);return(o-2)*(o-2)}throw new Error(s.message.incompatibleChannel("size",e))}(d,p,r)];case o.SHAPE:return"symbol";case o.COLOR:case o.FILL:case o.STROKE:return"ordinal"===t?"nominal"===n?"category":"ordinal":"rect"===d||"geoshape"===d?"heatmap":"ramp";case o.OPACITY:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error("Scale range undefined for channel "+e)}function w(e,t){return e.length>0?Math.min.apply(null,e):t.rangeStep?t.rangeStep:21}t.RANGE_PROPERTIES=["range","rangeStep","scheme"],t.parseScaleRange=function(e){h.isUnitModel(e)?function(e){var t=e.component.scales;o.SCALE_CHANNELS.forEach(function(n){var o=t[n];if(o){var u=e.getScaleComponent(n),l=e.specifiedScales[n],h=e.fieldDef(n),p="x"===n?"width":"y"===n?"height":void 0,g=p?!!e.component.layoutSize.get(p):void 0,v=u.get("type"),_=c.contains(["point","band"],v)||!!l.rangeStep;p&&e.fit&&!g&&_&&(s.warn(s.message.CANNOT_FIX_RANGE_STEP_WITH_FIT),g=!0);var w=function(e){var t=[],n=e.getScaleComponent("x"),o=n&&n.get("range");o&&d.isVgRangeStep(o)&&r.isNumber(o.step)&&t.push(o.step);var s=e.getScaleComponent("y"),u=s&&s.get("range");return u&&d.isVgRangeStep(u)&&r.isNumber(u.step)&&t.push(u.step),t}(e),E=m(n,v,h.type,l,e.config,o.get("zero"),e.mark(),g,e.getName(p),w);o.setWithExplicit("range",E)}})}(e):g.parseNonUnitScaleProperty(e,"range")},t.parseRangeForChannel=m,t.defaultRange=_},aIXu:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("KMAE"),s=n("Xq4m");function u(e,t,n,r){return e.explicit&&t.explicit&&o.warn(o.message.mergeConflictingProperty(n,r,e.value,t.value)),e}t.Split=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={}),this.explicit=e,this.implicit=t}return e.prototype.clone=function(){return new e(s.duplicate(this.explicit),s.duplicate(this.implicit))},e.prototype.combine=function(){return r({},this.explicit,this.implicit)},e.prototype.get=function(e){return void 0!==this.explicit[e]?this.explicit[e]:this.implicit[e]},e.prototype.getWithExplicit=function(e){return void 0!==this.explicit[e]?{explicit:!0,value:this.explicit[e]}:void 0!==this.implicit[e]?{explicit:!1,value:this.implicit[e]}:{explicit:!1,value:void 0}},e.prototype.setWithExplicit=function(e,value){void 0!==value.value&&this.set(e,value.value,value.explicit)},e.prototype.set=function(e,value,t){return delete this[t?"implicit":"explicit"][e],this[t?"explicit":"implicit"][e]=value,this},e.prototype.copyKeyFromSplit=function(e,t){void 0!==t.explicit[e]?this.set(e,t.explicit[e],!0):void 0!==t.implicit[e]&&this.set(e,t.implicit[e],!1)},e.prototype.copyKeyFromObject=function(e,t){void 0!==t[e]&&this.set(e,t[e],!0)},e}(),t.makeExplicit=function(value){return{explicit:!0,value:value}},t.makeImplicit=function(value){return{explicit:!1,value:value}},t.tieBreakByComparing=function(e){return function(t,n,r,o){var s=e(t.value,n.value);return s>0?t:s<0?n:u(t,n,r,o)}},t.defaultTieBreaker=u,t.mergeValuesWithExplicit=function(e,t,n,r,o){return void 0===o&&(o=u),void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:s.stringify(e.value)===s.stringify(t.value)?e:o(e,t,n,r)}},aXiv:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LRNProgram=function(e,radius,t,n,r,o){this.variableNames=["x"],this.outputShape=[];var s,u=radius,l=e[1]-1,c=e[2]-1,d=e[3]-1;this.outputShape=e;var h="float("+t+") + float("+n+") * sum";s=.5===r?"inversesqrt("+h+")":1===r?"1.0/("+h+")":"exp(log("+h+") * float(-"+r+"));",this.userCode="withinChannel"===o?"\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int b = coords[0];\n          int r = coords[1];\n          int c = coords[2];\n          int d = coords[3];\n          float x = getX(b, r, c, d);\n          float sum = 0.0;\n          for (int u = -"+u+"; u <= "+u+"; u++) {\n            for (int v = -"+u+"; v <= "+u+"; v++) {\n              int idx = r + u;\n              int idy = c + v;\n              if (idx >= 0 && idx <= "+l+" && idy >= 0 && idy <= "+c+") {\n                float z = getX(b, idx, idy, d);\n                sum += z * z;\n              }\n            }\n          }\n          float val = x * "+s+";\n          setOutput(val);\n        }\n      ":"\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int b = coords[0];\n          int r = coords[1];\n          int c = coords[2];\n          int d = coords[3];\n          float x = getX(b, r, c, d);\n          float sum = 0.0;\n          for (int j = -"+u+"; j <= "+u+"; j++) {\n            int idx = d + j;\n            if (idx >= 0 && idx <=  "+d+") {\n              float z = getX(b, r, c, idx);\n              sum += z * z;\n            }\n          }\n          float val = x * "+s+";\n          setOutput(val);\n        }\n      "}},ajEb:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("35G1");t.LSTMOps=function(){function e(){}return e.multiRNNCell=function(e,t,n,r){for(var o=t,s=[],i=0;i<e.length;i++){var u=e[i](o,n[i],r[i]);s.push(u[0]),s.push(u[1]),o=u[1]}var l=[],c=[];for(i=0;i<s.length;i+=2)l.push(s[i]),c.push(s[i+1]);return[l,c]},e.basicLSTMCell=function(e,t,n,r,o,s){var u=r.concat(s,1).matMul(t).add(n),l=u.shape[1]/4,c=[u.shape[0],l],i=u.slice([0,0],c),j=u.slice([0,l],c),f=u.slice([0,2*l],c),d=u.slice([0,3*l],c),h=i.sigmoid().mulStrict(j.tanh()).addStrict(o.mulStrict(e.add(f).sigmoid()));return[h,h.tanh().mulStrict(d.sigmoid())]},r([o.doc({heading:"Operations",subheading:"RNN"}),s.operation],e,"multiRNNCell",null),r([o.doc({heading:"Operations",subheading:"RNN"}),s.operation],e,"basicLSTMCell",null),e}()},"as/7":function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("v/P2"),s=n("V6aD"),u=n("m3RX"),l=n("dFrR");t.SGDOptimizer=function(e){function t(t){var n=e.call(this)||this;return n.learningRate=t,n.setLearningRate(t),n}return r(t,e),t.prototype.applyGradients=function(e){var t=this;Object.keys(e).forEach(function(n){var r=e[n],value=o.ENV.engine.registeredVariables[n];s.tidy(function(){var e=t.c.mul(r).add(value);value.assign(e)})})},t.prototype.setLearningRate=function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=s.keep(u.scalar(-e))},t.prototype.dispose=function(){this.c.dispose()},t}(l.Optimizer)},bDWH:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBroadcastDims=function(e,t){for(var n=e.length,r=[],i=0;i<n;i++){var o=n-1-i;(t[t.length-1-i]||1)>1&&1===(e[o]||1)&&r.unshift(o)}return r},t.getReductionAxes=function(e,t){for(var n=[],i=0;i<t.length;i++){var r=e[e.length-i-1],o=t.length-i-1;(null==r||1===r&&t[o]>1)&&n.unshift(o)}return n},t.broadcastDimsAreOuter=function(e){for(var i=0;i<e.length;i++)if(e[i]!==i)return!1;return!0},t.assertAndGetBroadcastShape=function(e,t){for(var n=[],r="Operands could not be broadcast together with shapes "+e+" and "+t+".",o=Math.max(e.length,t.length),i=0;i<o;i++){var a=e[e.length-i-1]||1,b=t[t.length-i-1]||1;if(a>1&&b>1&&a!==b)throw Error(r);n.unshift(Math.max(a,b))}return n}},bMJS:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("utsZ"),s=n("gqjM"),u=n("KMAE"),l=n("D6ZG"),c=n("zEzE"),d=n("Xq4m"),h=n("efV4");t.normalizeMarkDef=function(e,t,n){var p=l.isMarkDef(e)?r({},e):{type:e},g=p.orient||h.getMarkConfig("orient",p,n);return p.orient=function(e,t,n){switch(e){case l.POINT:case l.CIRCLE:case l.SQUARE:case l.TEXT:case l.RECT:return}var r=t.y2,o=t.x2;switch(e){case l.RULE:if(o&&r)return;case l.BAR:case l.AREA:if(r)return"vertical";if(o)return"horizontal";if(e===l.RULE){if(t.x&&!t.y)return"vertical";if(t.y&&!t.x)return"horizontal"}case l.LINE:case l.TICK:var d=s.isFieldDef(t.x)&&s.isContinuous(t.x),h=s.isFieldDef(t.y)&&s.isContinuous(t.y);if(d&&!h)return"tick"!==e?"horizontal":"vertical";if(!d&&h)return"tick"!==e?"vertical":"horizontal";if(d&&h){var p=t.x,g=t.y,m=p.type===c.TEMPORAL,v=g.type===c.TEMPORAL;return m&&!v?"tick"!==e?"vertical":"horizontal":!m&&v?"tick"!==e?"horizontal":"vertical":!p.aggregate&&g.aggregate?"tick"!==e?"vertical":"horizontal":p.aggregate&&!g.aggregate?"tick"!==e?"horizontal":"vertical":n||(e===l.LINE&&t.order||u.warn(u.message.unclearOrientContinuous(e)),"vertical")}return void u.warn(u.message.unclearOrientDiscreteOrEmpty(e))}return"vertical"}(p.type,t,g),void 0!==g&&g!==p.orient&&u.warn(u.message.orientOverridden(p.orient,g)),void 0===(p.opacity||h.getMarkConfig("opacity",p,n))&&(p.opacity=function(e,t){if(d.contains([l.POINT,l.TICK,l.CIRCLE,l.SQUARE],p.type)&&!o.isAggregate(t))return.7}(0,t)),void 0===p.filled&&(p.filled=function(e,t){var n=h.getMarkConfig("filled",e,t),r=e.type;return void 0!==n?n:r!==l.POINT&&r!==l.LINE&&r!==l.RULE}(p,n)),p}},bcxt:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("JV7f"),s=n("5WUj"),u=n("jRWw"),l=n("qmZh"),c=n("e/LB"),d=n("lbmW"),h=n("DjcB"),p=n("yJL4"),g=n("TPCB"),m=n("Q1Fz"),v=n("mFTl"),_=n("2EGJ"),w=n("np2E"),E=function(e){function t(t,n){var r=e.call(this,n)||this;if(r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.rank=t,1!==r.rank&&2!==r.rank)throw new p.NotImplementedError("Convolution layer for rank other than 1 or 2 ("+r.rank+") is not implemented yet.");if(r.filters=n.filters,r.kernelSize=_.normalizeArray(n.kernelSize,t,"kernelSize"),r.strides=_.normalizeArray(null==n.strides?1:n.strides,t,"strides"),r.padding=null==n.padding?"valid":n.padding,c.checkPaddingMode(r.padding),r.dataFormat=null==n.dataFormat?"channelsLast":n.dataFormat,c.checkDataFormat(r.dataFormat),r.dilationRate=null==n.dilationRate?1:n.dilationRate,!(1===r.dilationRate||Array.isArray(r.dilationRate)&&s.isEqual(s.uniq(r.dilationRate),[1])))throw new p.NotImplementedError("Non-default dilation is not implemented for convolution layers yet.");return r.activation=u.getActivation(n.activation),r.useBias=null==n.useBias||n.useBias,r.kernelInitializer=g.getInitializer(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=g.getInitializer(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=d.getConstraint(n.kernelConstraint),r.biasConstraint=d.getConstraint(n.biasConstraint),r.kernelRegularizer=m.getRegularizer(n.kernelRegularizer),r.biasRegularizer=m.getRegularizer(n.biasRegularizer),r.activityRegularizer=m.getRegularizer(n.activityRegularizer),r}return r(t,e),t.prototype.build=function(e){e=w.getExactlyOneShape(e);var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new p.ValueError("The channel dimension of the input should be defined. Found "+e[t]);var n,r=e[t],o=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(n={},n[t]=r,n)}],this.built=!0},t.prototype.call=function(e,t){var n;e=w.getExactlyOneTensor(e);var r=null==this.bias?null:this.bias.read();if(1===this.rank)n=l.conv1dWithBias(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat);else if(2===this.rank)n=l.conv2dWithBias(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat);else if(3===this.rank)throw new p.NotImplementedError("3D convolution is not implemented yet.");return null!=this.activation&&(n=this.activation(n)),n},t.prototype.computeOutputShape=function(e){e=w.getExactlyOneShape(e);for(var t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2),i=0;i<n.length;++i){var r=_.convOutputLength(n[i],this.kernelSize[i],this.padding,this.strides[i],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[i]);t.push(r)}var o=[e[0]];return"channelsLast"===this.dataFormat?(o=o.concat(t)).push(this.filters):(o.push(this.filters),o=o.concat(t)),o},t.prototype.getConfig=function(){var t={rank:this.rank,filters:this.filters,kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:u.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:g.serializeInitializer(this.kernelInitializer),biasInitializer:g.serializeInitializer(this.biasInitializer),kernelRegularizer:m.serializeRegularizer(this.kernelRegularizer),biasRegularizer:m.serializeRegularizer(this.biasRegularizer),activityRegularizer:m.serializeRegularizer(this.activityRegularizer),kernelConstraint:d.serializeConstraint(this.kernelConstraint),biasConstraint:d.serializeConstraint(this.biasConstraint)},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(h.Layer);t.Conv=E;var O=function(e){function t(t){return e.call(this,2,t)||this}return r(t,e),t.prototype.getConfig=function(){var t=e.prototype.getConfig.call(this);return delete t.rank,t},t}(E);t.Conv2D=O,w.ClassNameMap.register("Conv2D",O);var S=function(e){function t(t){var n=e.call(this,t)||this;if(n.inputSpec=[new h.InputSpec({ndim:4})],"same"!==n.padding&&"valid"!==n.padding)throw new p.ValueError("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+n.padding);return n}return r(t,e),t.prototype.build=function(e){if(4!==(e=w.getExactlyOneShape(e)).length)throw new p.ValueError("Input should have rank 4; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new p.ValueError("The channel dimension of the inputs should be defined. Found `None`.");var n,r=e[t],o=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",o,v.DType.float32,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],v.DType.float32,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new h.InputSpec({ndim:4,axes:(n={},n[t]=r,n)})],this.built=!0},t.prototype.call=function(e,t){var n=this;return o.tidy(function(){var t=w.getExactlyOneTensor(e);if(4!==t.shape.length)throw new p.ValueError("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+t.shape.length);var r,s,u=t.shape;"channelsFirst"===n.dataFormat?(r=2,s=3):(r=1,s=2);var c=u[s],d=n.kernelSize[1],h=n.strides[1],g=[u[0],_.deconvLength(u[r],n.strides[0],n.kernelSize[0],n.padding),_.deconvLength(c,h,d,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=l.transpose(t,[0,2,3,1]));var m=o.conv2dTranspose(t,n.kernel.read(),g,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(m=l.transpose(m,[0,3,1,2])),null!=n.bias&&(m=l.biasAdd(m,n.bias.read(),n.dataFormat)),null!=n.activation&&(m=n.activation(m)),m})},t.prototype.computeOutputShape=function(e){var t,n,r,o=(e=w.getExactlyOneShape(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3):(t=3,n=1,r=2);var s=this.kernelSize[0],u=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return o[t]=this.filters,o[n]=_.deconvLength(o[n],l,s,this.padding),o[r]=_.deconvLength(o[r],c,u,this.padding),o},t.prototype.getConfig=function(){var t=e.prototype.getConfig.call(this);return delete t.dilationRate,t},t}(O);t.Conv2DTranspose=S,w.ClassNameMap.register("Conv2DTranspose",S);var A=function(e){function t(t){var n=e.call(this,1,t)||this;return n.inputSpec=[{ndim:3}],n}return r(t,e),t.prototype.getConfig=function(){var t=e.prototype.getConfig.call(this);return delete t.rank,delete t.dataFormat,t},t}(E);t.Conv1D=A,w.ClassNameMap.register("Conv1D",A)},bpG5:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("XFvI");t.getFilteredNodesXToY=function(e,t,y){for(var n={},r={},i=0;i<t.length;i++)n[t[i].id]=!0;for(i=0;i<e.length;i++){var o=(g=e[i]).inputs;for(var s in o){for(var u=o[s],l=!1,j=0;j<t.length;j++)if(n[u.id]){n[g.output.id]=!0,l=!0,r[g.id]=!0;break}if(l)break}}var c={};c[y.id]=!0;var d={};for(i=e.length-1;i>=0;i--){o=(g=e[i]).inputs;var h=[];for(h.push(g.output),j=0;j<h.length;j++)if(c[h[j].id]){for(var s in o)c[o[s].id]=!0,d[g.id]=!0;break}}var p=[];for(i=0;i<e.length;i++){var g;if(r[(g=e[i]).id]&&d[g.id]){var m={};for(var s in g.inputs){var v=g.inputs[s];n[v.id]&&(m[s]=v)}var _=Object.assign({},g);_.inputs=m,_.output=g.output,p.push(_)}}return p},t.backpropagateGradients=function(e,t){for(var i=t.length-1;i>=0;i--){var n=t[i],o=e[n.output.id];if(null==n.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+n.name+".");var s=n.gradient(o);for(var u in n.inputs){if(!(u in s))throw new Error("Cannot backprop through input "+u+". Available gradients found: "+Object.keys(s)+".");var l=s[u](),x=n.inputs[u];if(!r.arraysEqual(l.shape,x.shape))throw new Error("Error in gradient for op "+n.name+". The gradient of input '"+u+"' has shape '"+l.shape+"', which does not match the shape of the input '"+x.shape+"'");if(null==e[x.id])e[x.id]=l;else{var c=e[x.id];e[x.id]=c.add(l),c.dispose()}}}}},ccAg:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("bDWH"),o="\n  if (isNaN(a)) return a;\n  if (isNaN(b)) return b;\n";t.ADD="return a + b;",t.SUB="return a - b;",t.MUL="return a * b;",t.DIV="return a / b;",t.POW="\n  return (round(mod(b, 2.0)) == 0 || round(mod(b, 2.0)) == 2) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",t.SQUARED_DIFFERENCE="return (a - b) * (a - b);",t.EQUAL=o+"\n  return float(a == b);\n",t.NOT_EQUAL=o+"\n  return float(a != b);\n",t.LESS=o+"\n  return float(a < b);\n",t.LESS_EQUAL=o+"\n  return float(a <= b);\n",t.GREATER=o+"\n  return float(a > b);\n",t.GREATER_EQUAL=o+"\n  return float(a >= b);\n",t.LOGICAL_AND=o+"\n  return float(a >= 1.0 && b >= 1.0);\n",t.LOGICAL_OR=o+"\n  return float(a >= 1.0 || b >= 1.0);\n",t.LOGICAL_XOR=o+"\n  return float(a >= 1.0 ^^ b >= 1.0);\n",t.PRELU="\n  return (a >= 0.0) ? a : b * a;\n",t.PRELU_DER="\n  return (a > 0.0) ? 1.0 : ((a < 0.0) ? b : a);\n",t.MAX=o+"\n  return max(a, b);\n",t.MIN=o+"\n  return min(a, b);\n",t.ATAN2=o+"\n  return atan(a, b);\n",t.BinaryOpProgram=function(){return function(e,t,n){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.outputShape=r.assertAndGetBroadcastShape(t,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+e+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "}}()},cgBu:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("XFvI");t.assertParamsValid=function(e,t,n){r.assert(e.rank===t.length,"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."),r.assert(e.rank===n.length,"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+").");for(var i=0;i<e.rank;++i)r.assert(t[i]+n[i]<=e.shape[i],"Error in slice"+e.rank+"D: begin["+i+"] + size["+i+"] ("+(t[i]+n[i])+") would overflow input.shape["+i+"] ("+e.shape[i]+")")}},d7qV:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("v/P2"),u=n("XFvI"),l=n("35G1"),c=n("cgBu");t.SliceOps=function(){function e(){}return e.slice1d=function(x,t,n){return u.assert(1===x.rank,"slice1d expects a rank-1 tensor, but got a rank-"+x.rank+" tensor"),e.slice(x,[t],[n])},e.slice2d=function(x,t,n){return u.assert(2===x.rank,"slice1d expects a rank-2 tensor, but got a rank-"+x.rank+" tensor"),e.slice(x,t,n)},e.slice3d=function(x,t,n){return u.assert(3===x.rank,"slice1d expects a rank-3 tensor, but got a rank-"+x.rank+" tensor"),e.slice(x,t,n)},e.slice4d=function(x,t,n){return u.assert(4===x.rank,"slice1d expects a rank-4 tensor, but got a rank-"+x.rank+" tensor"),e.slice(x,t,n)},e.slice=function(x,e,t){if(c.assertParamsValid(x,e,t),0===x.rank)throw new Error("Slicing scalar is not possible");var n=x.shape;return s.ENV.engine.runKernel(function(n){return n.slice(x,e,t)},{x:x},function(r){for(var o=[],i=0;i<r.rank;i++)o.push([e[i],n[i]-e[i]-t[i]]);return{x:function(){return r.pad(o)}}})},r([o.doc({heading:"Tensors",subheading:"Slicing and Joining"}),l.operation],e,"slice",null),e}()},dFdk:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("xdLA"),o=n("KMAE"),s=n("rxHH"),u=n("Xq4m"),l=n("Xq4m"),c=n("OMxB"),d=n("aIXu"),h=n("a/7e");function p(e,t){c.isUnitModel(e)?function(e,t){var n=e.component.scales;u.keys(n).forEach(function(r){var u=e.specifiedScales[r],l=n[r],c=e.getScaleComponent(r),d=e.fieldDef(r),h=e.sort(r),p=e.config,m=u[t],v=c.get("type"),_=s.scaleTypeSupportProperty(v,t),w=s.channelScalePropertyIncompatability(r,t);if(void 0!==m&&(_?w&&o.warn(w):o.warn(o.message.scalePropertyNotWorkWithScaleType(v,t,r))),_&&void 0===w)if(void 0!==m)l.copyKeyFromObject(t,u);else{var value=g(t,r,d,h,c.get("type"),c.get("padding"),c.get("paddingInner"),u.domain,e.markDef,p);void 0!==value&&l.set(t,value,!1)}})}(e,t):m(e,t)}function g(e,t,n,r,o,s,u,l,c,d){var h=d.scale;switch(e){case"nice":return v(o,t,n);case"padding":return _(t,o,h,n,c,d.bar);case"paddingInner":return w(s,t,h);case"paddingOuter":return E(s,t,o,u,h);case"reverse":return O(o,r);case"zero":return S(t,n,l)}return h[e]}function m(e,t){for(var n=e.component.scales,r=0,o=e.children;r<o.length;r++){var s=o[r];"range"===t?h.parseScaleRange(s):p(s,t)}u.keys(n).forEach(function(r){for(var o,s=0,u=e.children;s<u.length;s++){var l=u[s].component.scales[r];if(l){var c=l.getWithExplicit(t);o=d.mergeValuesWithExplicit(o,c,t,"scale",d.tieBreakByComparing(function(e,n){switch(t){case"range":return e.step&&n.step?e.step-n.step:0}return 0}))}}n[r].setWithExplicit(t,o)})}function v(e,t,n){if(!n.bin&&!l.contains([s.ScaleType.TIME,s.ScaleType.UTC],e))return l.contains([r.X,r.Y],t)}function _(e,t,n,o,u,c){if(l.contains([r.X,r.Y],e)){if(s.isContinuousToContinuous(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;var d=u.orient;if("bar"===u.type&&!o.bin&&("vertical"===d&&"x"===e||"horizontal"===d&&"y"===e))return c.continuousBandSize}if(t===s.ScaleType.POINT)return n.pointPadding}}function w(e,t,n){if(void 0===e)return l.contains([r.X,r.Y],t)?n.bandPaddingInner:void 0}function E(e,t,n,o,u){if(void 0===e)return l.contains([r.X,r.Y],t)&&n===s.ScaleType.BAND?void 0!==u.bandPaddingOuter?u.bandPaddingOuter:o/2:void 0}function O(e,t){if(s.hasContinuousDomain(e)&&"descending"===t)return!0}function S(e,t,n){return"size"===e&&"quantitative"===t.type||!(n&&"unaggregated"!==n||t.bin||!l.contains([r.X,r.Y],e))}t.parseScaleProperty=p,t.getDefaultValue=g,t.parseNonUnitScaleProperty=m,t.nice=v,t.padding=_,t.paddingInner=w,t.paddingOuter=E,t.reverse=O,t.zero=S},dFrR:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("V6aD");t.Optimizer=function(){function e(){}return e.prototype.minimize=function(f,e,t){void 0===e&&(e=!1);var n=this.computeGradients(f,t),value=n.value,r=n.grads;return this.applyGradients(r),Object.keys(r).forEach(function(e){return r[e].dispose()}),e?value:(value.dispose(),null)},e.prototype.computeGradients=function(f,e){return s.variableGrads(f,e)},r([o.doc({heading:"Training",subheading:"Optimizers"})],e.prototype,"minimize",null),r([o.doc({heading:"Training",subheading:"Classes",namespace:"train"})],e)}()},dMOq:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("Bsgt"),s=n("gqjM"),u=n("KMAE"),l=n("0Ooj"),c=n("Xq4m"),d=n("0N5v"),h=n("efV4"),p=n("kglw"),g=n("KIOn");function m(e){var t=e.config,n=e.markDef,o=n.filled?"fill":"stroke";return r({},c.contains(["bar","point","circle","square","geoshape"],n.type)?{fill:{value:"transparent"}}:{},v("color",e,{vgChannel:o,defaultValue:e.markDef[o]||e.markDef.color||h.getMarkConfig(o,e.markDef,t)||h.getMarkConfig("color",e.markDef,t)}),v("fill",e),v("stroke",e))}function v(e,t,n){void 0===n&&(n={});var r=n.defaultValue,o=n.defaultRef||(void 0!==r?{value:r}:void 0);return _(t,t.encoding[e],n.vgChannel||e,function(n){return g.midPoint(e,n,t.scaleName(e),t.getScaleComponent(e),null,o)})}function _(e,t,n,u){var c,d,h=t&&t.condition,g=u(t);if(h){var m=(o.isArray(h)?h:[h]).map(function(t){var n=u(t),o=s.isConditionalSelection(t)?p.selectionPredicate(e,t.selection):l.expression(e,t.test);return r({test:o},n)});return(c={})[n]=m.concat(void 0!==g?[g]:[]),c}return void 0!==g?((d={})[n]=g,d):{}}function w(e,t){return void 0===t&&(t="text"),_(e,e.encoding[t],t,function(t){return g.text(t,e.config)})}function E(e,t,n,r){var o,s=t.encoding,u=t.stack,l=s[e]||!s.latitude&&!s.longitude?g.stackable(e,s[e],t.scaleName(e),t.getScaleComponent(e),u,n):{field:t.getName(e)};return(o={})[r||e]=l,o}t.color=m,t.baseEncodeEntry=function(e,t){return r({},function(e,t){return d.VG_MARK_CONFIGS.reduce(function(n,r){return void 0!==e[r]&&"ignore"!==t[r]&&(n[r]={value:e[r]}),n},{})}(e.markDef,t),m(e),v("opacity",e),w(e,"tooltip"),w(e,"href"))},t.valueIfDefined=function(e,value){if(void 0!==value)return(t={})[e]={value:value},t;var t},t.nonPosition=v,t.text=w,t.bandPosition=function(e,t,n){var o,l,c,d=n.scaleName(t),h="x"===t?"width":"height";if(n.encoding.size||void 0!==n.markDef.size)if(n.markDef.orient){var p=((o={})[t+"c"]=g.fieldRef(e,d,{},{band:.5}),o);if(s.getFieldDef(n.encoding.size))u.warn(u.message.cannotUseSizeFieldWithBandSize(t));else{if(s.isValueDef(n.encoding.size))return r({},p,v("size",n,{vgChannel:h}));if(void 0!==n.markDef.size)return r({},p,((l={})[h]={value:n.markDef.size},l))}}else u.warn(u.message.cannotApplySizeToNonOrientedMark(n.markDef.type));return(c={})[t]=g.fieldRef(e,d,{binSuffix:"range"}),c[h]=g.bandRef(d),c},t.centeredBandPosition=function(e,t,n,o){var s="x"===e?"width":"height";return r({},E(e,t,n,"x"===e?"xc":"yc"),v("size",t,{defaultRef:o,vgChannel:s}))},t.binnedPosition=function(e,t,n,r,o){return"x"===t?{x2:g.bin(e,n,"start",o?0:r),x:g.bin(e,n,"end",o?r:0)}:{y2:g.bin(e,n,"start",o?r:0),y:g.bin(e,n,"end",o?0:r)}},t.pointPosition=E,t.pointPosition2=function(e,t,n){var r,o=e.encoding,s=e.stack,u="x2"===(n=n||("horizontal"===e.markDef.orient?"x2":"y2"))?"x":"y",l=o[u],c=l||!o.latitude&&!o.longitude?g.stackable2(n,l,o[n],e.scaleName(u),e.getScaleComponent(u),s,t):{field:e.getName(n)};return(r={})[n]=c,r}},dQN6:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Bsgt"),o=n("Xq4m"),s={argmax:1,argmin:1,average:1,count:1,distinct:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1};t.AGGREGATE_OPS=o.flagKeys(s),t.isAggregateOp=function(a){return!!s[a]},t.COUNTING_OPS=["count","valid","missing","distinct"],t.isCountingAggregateOp=function(e){return e&&o.contains(t.COUNTING_OPS,e)},t.SUM_OPS=["count","sum","distinct","valid","missing"],t.SHARED_DOMAIN_OPS=["mean","average","median","q1","q3","min","max"],t.SHARED_DOMAIN_OP_INDEX=r.toSet(t.SHARED_DOMAIN_OPS)},deCJ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAxisConfig=function(e,t,n,r,o){void 0===r&&(r="");for(var s=0,u=("band"===o?["axisBand"]:[]).concat(["x"===n?"axisX":"axisY","axis"+r.substr(0,1).toUpperCase()+r.substr(1),"axis"]);s<u.length;s++){var l=u[s];if(t[l]&&void 0!==t[l][e])return t[l][e]}}},"di0+":function(e,t,n){(function(e){var r;!function(e,o,s){function u(f,e){return e.x=f.x,e.y=f.y,e.z=f.z,e.w=f.w,e}function l(e,t){var n=new function(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var k=0;k<n.length+64;k++)t.x^=0|n.charCodeAt(k),t.next()}(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&("object"==typeof r&&u(r,n),o.state=function(){return u(n,{})}),o}o&&o.exports?o.exports=l:n("LGuY")&&n("nErl")?void 0===(r=(function(){return l}).call(t,n,t,o))||(o.exports=r):this.xor128=l}(0,"object"==typeof e&&e,n("LGuY"))}).call(t,n("3IRH")(e))},doZ3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SELU_SCALEALPHA=1.7580993408473768,t.SELU_SCALE=1.0507009873554805},"e/LB":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("yJL4"),o=n("np2E"),s=new Map;o.SerializableEnumRegistry.register("data_format",{channels_first:"channelsFirst",channels_last:"channelsLast"}),t.VALID_DATA_FORMAT_VALUES=["channelsFirst","channelsLast",void 0,null],t.checkDataFormat=function(value){if(null!=value&&t.VALID_DATA_FORMAT_VALUES.indexOf(value)<0)throw new r.ValueError(value+" is not a valid DataFormat.  Valid values as "+t.VALID_DATA_FORMAT_VALUES)},o.SerializableEnumRegistry.register("padding",{valid:"valid",same:"same",casual:"casual"}),t.VALID_PADDING_MODE_VALUES=["valid","same","casual",void 0,null],t.checkPaddingMode=function(value){if(null!=value&&t.VALID_PADDING_MODE_VALUES.indexOf(value)<0)throw new r.ValueError(value+" is not a valid PaddingMode.  Valid values as "+t.VALID_PADDING_MODE_VALUES)},t.VALID_POOL_MODE_VALUES=["max","avg",void 0,null],t.checkPoolMode=function(value){if(null!=value&&t.VALID_POOL_MODE_VALUES.indexOf(value)<0)throw new r.ValueError(value+" is not a valid PoolMode.  Valid values as "+t.VALID_POOL_MODE_VALUES)};var u=[];t.nameScope=function(e,t){u.push(e);try{var n=t();return u.pop(),n}catch(e){throw u.pop(),e}},t.getUniqueTensorName=function(e){if(!c(e))throw new Error("Not a valid tensor name: '"+e+"'");e=(0===u.length?"":u.join("/")+"/")+e,s.has(e)||s.set(e,0);var t=s.get(e);return s.set(e,s.get(e)+1),t>0?e+"_"+t:e};var l=new RegExp(/^[A-Za-z][A-Za-z0-9\._\/]*$/);function c(e){return!!e.match(l)}t.isValidTensorName=c},efV4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Bsgt"),o=n("xdLA"),s=n("gqjM"),u=n("rxHH"),l=n("jfp2"),c=n("zEzE"),d=n("Xq4m");function h(e){return[].concat(e.type,e.style||[])}function p(e,t,n){var value=n.mark[e],r=n[t.type];void 0!==r[e]&&(value=r[e]);for(var o=0,s=h(t);o<s.length;o++){var u=n.style[s[o]];u&&void 0!==u[e]&&(value=u[e])}return value}function g(e,t,n){if(e.type===c.QUANTITATIVE)return t||n.numberFormat}function m(e,t){return"format("+e+', "'+(t||"")+'")'}function v(e,t,n){return m(e,t||n.numberFormat)}function _(e,t,n,r){return e+" === null || isNaN("+e+') ? "null" : '+v(e,n,r)+' + " - " + '+v(t,n,r)}function w(e,t,n,r,o,s){if(!t||n){var u=n||o;return s?"utcFormat("+e+", '"+u+"')":"timeFormat("+e+", '"+u+"')"}return l.formatExpression(t,e,r,s)}function E(e,t){var n=e.slice();return t.forEach(function(e){for(var t=0,r=n;t<r.length;t++)if(d.stringify(r[t])===d.stringify(e))return;n.push(e)}),n}t.applyConfig=function(e,t,n){for(var r=0,o=n;r<o.length;r++){var s=o[r],value=t[s];void 0!==value&&(e[s]={value:value})}return e},t.applyMarkConfig=function(e,t,n){for(var r=0,o=n;r<o.length;r++){var s=o[r],value=p(s,t.markDef,t.config);void 0!==value&&(e[s]={value:value})}return e},t.getStyles=h,t.getMarkConfig=p,t.formatSignalRef=function(e,t,n,r){var o=g(e,t,r);if(e.bin)return{signal:_(s.vgField(e,{expr:n}),s.vgField(e,{expr:n,binSuffix:"end"}),o,r)};if("quantitative"===e.type)return{signal:""+m(s.vgField(e,{expr:n}),o)};if(s.isTimeFieldDef(e)){var l=s.isScaleFieldDef(e)&&e.scale&&e.scale.type===u.ScaleType.UTC;return{signal:w(s.vgField(e,{expr:n}),e.timeUnit,t,r.text.shortTimeLabels,r.timeFormat,l)}}return{signal:"''+"+s.vgField(e,{expr:n})}},t.getSpecifiedOrDefaultValue=function(e,t){return void 0!==e?e:t},t.numberFormat=g,t.numberFormatExpr=v,t.binFormatExpression=_,t.timeFormatExpression=w,t.sortParams=function(e,t){return(r.isArray(e)?e:[e]).reduce(function(e,n){return e.field.push(s.vgField(n,t)),e.order.push(n.sort||"ascending"),e},{field:[],order:[]})},t.mergeTitleFieldDefs=E,t.titleMerger=function(e,t){if(r.isArray(e.value)&&r.isArray(t.value))return{explicit:e.explicit,value:E(e.value,t.value)};if(!r.isArray(e.value)&&!r.isArray(t.value))return{explicit:e.explicit,value:e.value===t.value?e.value:e.value+", "+t.value};throw new Error("It should never reach here")},t.binRequiresRange=function(e,t){return e.bin?o.isScaleChannel(t)&&d.contains(["ordinal","nominal"],e.type):(console.warn("Only use this method with binned field defs"),!1)}},emb8:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("v/P2"),u=n("XFvI"),l=n("DqkE"),c=n("35G1");t.ReverseOps=function(){function e(){}return e.reverse1d=function(x){return u.assert(1===x.rank,"Error in reverse1D: x must be rank 1 but got\n             rank "+x.rank+"."),e.reverse(x,0)},e.reverse2d=function(x,t){return u.assert(2===x.rank,"Error in reverse2D: x must be rank 2 but got\n             rank "+x.rank+"."),e.reverse(x,t)},e.reverse3d=function(x,t){return u.assert(3===x.rank,"Error in reverse3D: x must be rank 3 but got\n             rank "+x.rank+"."),e.reverse(x,t)},e.reverse4d=function(x,t){return u.assert(4===x.rank,"Error in reverse4D: x must be rank 4 but got\n             rank "+x.rank+"."),e.reverse(x,t)},e.reverse=function(x,e){if(0===x.rank)return x.clone();var t=l.parseAxisParam(e,x.shape);return s.ENV.engine.runKernel(function(e){return e.reverse(x,t)},{x:x},function(e){return{x:function(){return e.reverse(t)}}}).reshapeAs(x)},r([o.doc({heading:"Tensors",subheading:"Slicing and Joining"}),c.operation],e,"reverse",null),e}()},fC4T:function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},fzqA:function(e,t,n){(function(e){var r;!function(e,o,s){function u(f,e){return e.x=f.x.slice(),e.i=f.i,e}function l(e,t){null==e&&(e=+new Date);var n=new function(e){var t=this;t.next=function(){var e,n,r=t.x,i=t.i;return e=r[i],n=(e^=e>>>7)^e<<24,n^=(e=r[i+1&7])^e>>>10,n^=(e=r[i+3&7])^e>>>3,n^=(e=r[i+4&7])^e<<7,e=r[i+7&7],r[i]=n^=(e^=e<<13)^e<<9,t.i=i+1&7,n},function(e,t){var j,n=[];if(t===(0|t))n[0]=t;else for(t=""+t,j=0;j<t.length;++j)n[7&j]=n[7&j]<<15^t.charCodeAt(j)+n[j+1&7]<<13;for(;n.length<8;)n.push(0);for(j=0;j<8&&0===n[j];++j);for(8==j&&(n[7]=-1),e.x=n,e.i=0,j=256;j>0;--j)e.next()}(t,e)}(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&(r.x&&u(r,n),o.state=function(){return u(n,{})}),o}o&&o.exports?o.exports=l:n("LGuY")&&n("nErl")?void 0===(r=(function(){return l}).call(t,n,t,o))||(o.exports=r):this.xorshift7=l}(0,"object"==typeof e&&e,n("LGuY"))}).call(t,n("3IRH")(e))},g4zD:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("yJL4"),o=n("np2E");function s(e,t,value){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"==typeof value}t.convertPythonicToTs=function e(t,n){if(null===t)return null;if("string"==typeof t)return o.toCamelCase(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){for(var u=[],l=t.length,i=0;i<l;++i){var c=t[i];s(n,i,c)?u.push(c):u.push(e(c,n))}return u}for(var d={},h=0,p=Object.keys(t);h<p.length;h++){var g=p[h],m=t[g];if("name"===g&&"string"==typeof m)d[g]=m;else{var v=o.toCamelCase(g);if(!o.SerializableEnumRegistry.contains(g)||"string"!=typeof m&&null!=m)d[v]=e(m,v);else{var _=o.SerializableEnumRegistry.lookup(g,m);if(null==_)throw new r.ValueError("Unkown value "+m+" for "+g+" Enum");d[v]=_}}}return d},t.convertTsToPythonic=function e(t,n){if(null===t||void 0===t)return null;if("string"==typeof t)return o.toSnakeCase(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){for(var r=[],u=t.length,i=0;i<u;++i){var l=t[i];s(n,i,l)?r.push(l):r.push(e(l,n))}return r}for(var c={},d=0,h=Object.keys(t);d<h.length;d++){var p=h[d],g=t[p],m=o.toSnakeCase(p);if("name"!==p&&"className"!==p||"string"!=typeof g)if(!o.SerializableEnumRegistry.contains(m)||"string"!=typeof g&&null!=g)c[m]=e(g,p);else{var v=o.SerializableEnumRegistry.reverseLookup(m,g);c[m]=v}else c[m]=g}return c}},gkZw:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("v/P2"),u=n("XFvI"),l=n("DqkE"),c=n("35G1");t.TransposeOps=function(){function e(){}return e.transpose=function(x,e){return null==e&&(e=x.shape.map(function(e,i){return i}).reverse()),u.assert(x.rank===e.length,"Error in transpose: rank of input "+x.rank+" must match length of perm "+e+"."),s.ENV.engine.runKernel(function(t){return t.transpose(x,e)},{x:x},function(t){var n=l.getUndoAxesPermutation(e);return{x:function(){return t.transpose(n)}}})},r([o.doc({heading:"Operations",subheading:"Matrices"}),c.operation],e,"transpose",null),e}()},gqjM:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var s=n("Bsgt"),u=n("dQN6"),l=n("NDl6"),c=n("xdLA"),d=n("KMAE"),h=n("jfp2"),p=n("zEzE"),g=n("Xq4m");function m(e){return!!e&&!!e.condition&&!s.isArray(e.condition)&&v(e.condition)}function v(e){return!(!e||!e.field&&"count"!==e.aggregate)}function _(e){return e&&"value"in e&&void 0!==e.value}function w(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return!!e.bin;case"latitude":case"longitude":case"temporal":return!1}throw new Error(d.message.invalidFieldType(e.type))}function E(e){return!w(e)}function O(e){return"count"===e.aggregate}function S(e,t){var n=e.field,r=e.timeUnit,o=e.aggregate;return"count"===o?t.countTitle:e.bin?n+" (binned)":r?n+" ("+h.getTimeUnitParts(r).join("-")+")":o?g.titlecase(o)+" of "+n:n}function A(e,t){var n=e.aggregate||e.timeUnit||e.bin&&"bin";return n?n.toUpperCase()+"("+e.field+")":e.field}t.isConditionalSelection=function(e){return e.selection},t.isRepeatRef=function(e){return e&&!s.isString(e)&&"repeat"in e},t.toFieldDefBase=function(e){var t=e.timeUnit,n=e.bin,o=e.aggregate;return r({},t?{timeUnit:t}:{},n?{bin:n}:{},o?{aggregate:o}:{},{field:e.field})},t.isConditionalDef=function(e){return!!e&&!!e.condition},t.hasConditionalFieldDef=m,t.hasConditionalValueDef=function(e){return!!e&&!!e.condition&&(s.isArray(e.condition)||_(e.condition))},t.isFieldDef=v,t.isStringFieldDef=function(e){return v(e)&&s.isString(e.field)},t.isValueDef=_,t.isScaleFieldDef=function(e){return!(!e||!e.scale&&!e.sort)},t.vgField=function(e,t){void 0===t&&(t={});var n=e.field,r=t.prefix,o=t.suffix;if(O(e))n="count_*";else{var s=void 0;t.nofn||(e.bin?(s=l.binToString(e.bin),o=t.binSuffix||""):e.aggregate?s=String(t.aggregate||e.aggregate):e.timeUnit&&(s=String(e.timeUnit))),s&&(n=s+"_"+n)}return o&&(n=n+"_"+o),r&&(n=r+"_"+n),t.expr&&(n=""+t.expr+g.accessPath(n)),n},t.isDiscrete=w,t.isContinuous=E,t.isCount=O,t.verbalTitleFormatter=S,t.functionalTitleFormatter=A,t.defaultTitleFormatter=function(e,t){switch(t.fieldTitle){case"plain":return e.field;case"functional":return A(e);default:return S(e,t)}};var T=t.defaultTitleFormatter;function N(e){T=e}function M(e,t){if(e.timeUnit)return"temporal";if(e.bin)return"quantitative";switch(c.rangeType(t)){case"continuous":return"quantitative";case"discrete":case"flexible":return"nominal";default:return"quantitative"}}function C(e,t){if(e.aggregate&&!u.isAggregateOp(e.aggregate)){var n=o(e,["aggregate"]);d.warn(d.message.invalidAggregate(e.aggregate)),e=n}if(e.timeUnit&&(e=r({},e,{timeUnit:h.normalizeTimeUnit(e.timeUnit)})),e.bin&&(e=r({},e,{bin:D(e.bin,t)})),e.type){var s=p.getFullName(e.type);e.type!==s&&(e=r({},e,{type:s})),"quantitative"!==e.type&&u.isCountingAggregateOp(e.aggregate)&&(d.warn(d.message.invalidFieldTypeForCountAggregate(e.type,e.aggregate)),e=r({},e,{type:"quantitative"}))}else{var l=M(e,t);d.warn(d.message.emptyOrInvalidFieldType(e.type,t,l)),e=r({},e,{type:l})}var c=I(e,t);return c.compatible||d.warn(c.warning),e}function D(e,t){return s.isBoolean(e)?{maxbins:l.autoMaxBins(t)}:e.maxbins||e.step?e:r({},e,{maxbins:l.autoMaxBins(t)})}t.setTitleFormatter=N,t.resetTitleFormatter=function(){N(t.defaultTitleFormatter)},t.title=function(e,t){return T(e,t)},t.defaultType=M,t.getFieldDef=function(e){return v(e)?e:m(e)?e.condition:void 0},t.normalize=function(e,t){if(s.isString(e)||s.isNumber(e)||s.isBoolean(e)){var n=s.isString(e)?"string":s.isNumber(e)?"number":"boolean";return d.warn(d.message.primitiveChannelDef(t,n,e)),{value:e}}return v(e)?C(e,t):m(e)?r({},e,{condition:C(e.condition,t)}):e},t.normalizeFieldDef=C,t.normalizeBin=D;var R={compatible:!0};function I(e,t){switch(t){case"row":case"column":return E(e)&&!e.timeUnit?{compatible:!1,warning:d.message.facetChannelShouldBeDiscrete(t)}:R;case"x":case"y":case"color":case"fill":case"stroke":case"text":case"detail":case"key":case"tooltip":case"href":return R;case"longitude":case"longitude2":case"latitude":case"latitude2":return e.type!==p.QUANTITATIVE?{compatible:!1,warning:"Channel "+t+" should not be used with "+e.type+" field."}:R;case"opacity":case"size":case"x2":case"y2":return w(e)&&!e.bin?{compatible:!1,warning:"Channel "+t+" should not be used with discrete field."}:R;case"shape":return"nominal"!==e.type&&"geojson"!==e.type?{compatible:!1,warning:"Shape channel should be used with nominal data or geojson only"}:R;case"order":return"nominal"===e.type?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:R}throw new Error("channelCompatability not implemented for channel "+t)}t.channelCompatibility=I,t.isNumberFieldDef=function(e){return"quantitative"===e.type||!!e.bin},t.isTimeFieldDef=function(e){return"temporal"===e.type||!!e.timeUnit}},gr0I:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("/u4k");t.TileProgram=function(){return function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),i=0;i<n.length;i++)n[i]=e[i]*t[i];this.outputShape=n,this.rank=n.length;var o=r.getCoordsDataType(this.rank),s=function(e){var t=e.length;if(t>4)throw Error("Tile for rank "+t+" is not yet supported");if(1===t)return"imod(resRC, "+e[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],i=0;i<e.length;i++)r.push("imod("+n[i]+", "+e[i]+")");return r.join()}(e);this.userCode="\n      void main() {\n        "+o+" resRC = getOutputCoords();\n        setOutput(getA("+s+"));\n      }\n    "}}()},gt9F:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=/\/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t[0],version:t[1]}}},h5Qj:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("JV7f"),s=n("jRWw"),u=n("qmZh"),l=n("qmZh"),c=n("DjcB"),d=n("yJL4"),h=n("mFTl"),p=n("np2E"),g=function(e){function t(t){var n=e.call(this,null==t?{}:t)||this;return n.DEFAULT_ALPHA=.3,null==t&&(t={}),n.alpha=null==t.alpha?n.DEFAULT_ALPHA:t.alpha,n}return r(t,e),t.prototype.call=function(e,t){var x=p.getExactlyOneTensor(e);return o.leakyRelu(x,this.alpha)},t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var t={alpha:this.alpha},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(c.Layer);t.LeakyReLU=g,p.ClassNameMap.register("LeakyReLU",g);var m=function(e){function t(t){var n=e.call(this,null==t?{}:t)||this;if(n.DEFAULT_ALPHA=1,null==t&&(t={}),null!=t.alpha&&t.alpha!==n.DEFAULT_ALPHA)throw new d.NotImplementedError("Non-default alpha value ("+t.alpha+") is not supported by the ELU layer yet.");return n.alpha=null==t.alpha?n.DEFAULT_ALPHA:t.alpha,n}return r(t,e),t.prototype.call=function(e,t){var x=p.getExactlyOneTensor(e);return o.elu(x)},t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var t={alpha:this.alpha},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(c.Layer);t.ELU=m,p.ClassNameMap.register("ELU",m);var v=function(e){function t(t){var n=e.call(this,null==t?{}:t)||this;return n.DEFAULT_THETA=1,null==t&&(t={}),n.theta=null==t.theta?n.DEFAULT_THETA:t.theta,n.thetaTensor=l.getScalar(n.theta),n}return r(t,e),t.prototype.call=function(e,t){var x=p.getExactlyOneTensor(e);return x.mul(u.cast(x.greater(this.thetaTensor),h.DType.float32))},t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var t={theta:this.theta},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(c.Layer);t.ThresholdedReLU=v,p.ClassNameMap.register("ThresholdedReLU",v);var _=function(e){function t(t){var n=e.call(this,null==t?{}:t)||this;return n.DEFAULT_AXIS=1,null==t&&(t={}),n.axis=null==t.theta?n.DEFAULT_AXIS:t.theta,n}return r(t,e),t.prototype.call=function(e,t){var x=p.getExactlyOneTensor(e);return s.softmax(x,this.axis)},t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var t={axis:this.axis},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(c.Layer);t.Softmax=_,p.ClassNameMap.register("Softmax",_)},h6VP:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("qmZh"),s=n("e/LB"),u=n("DjcB"),l=n("DjcB"),c=n("yJL4"),d=n("2EGJ"),h=n("np2E"),p=function(e){function t(t){var n=this;return null==t.poolSize&&(t.poolSize=2),(n=e.call(this,t)||this).poolSize=[t.poolSize],n.strides=null==t.strides?n.poolSize:[t.strides],n.padding=null==t.padding?"valid":t.padding,s.checkPaddingMode(n.padding),n.inputSpec=[new u.InputSpec({ndim:3})],n}return r(t,e),t.prototype.computeOutputShape=function(e){return e=h.getExactlyOneShape(e),length=d.convOutputLength(e[1],this.poolSize[0],this.padding,this.strides[0]),[e[0],length,e[2]]},t.prototype.call=function(e,t){this.invokeCallHook(e,t),e=o.expandDims(h.getExactlyOneTensor(e),2);var n=this.poolingFunction(h.getExactlyOneTensor(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return o.squeeze(n,2)},t.prototype.getConfig=function(){var t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(l.Layer);t.Pooling1D=p;var g=function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.prototype.poolingFunction=function(e,t,n,r,u){return s.checkDataFormat(u),s.checkPaddingMode(r),o.pool2d(e,t,n,r,u,"max")},t}(p);t.MaxPooling1D=g,h.ClassNameMap.register("MaxPooling1D",g);var m=function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.prototype.poolingFunction=function(e,t,n,r,u){return s.checkDataFormat(u),s.checkPaddingMode(r),o.pool2d(e,t,n,r,u,"avg")},t}(p);t.AvgPooling1D=m,h.ClassNameMap.register("AvgPooling1D",m);var v=function(e){function t(t){var n=this;return null==t.poolSize&&(t.poolSize=[2,2]),(n=e.call(this,t)||this).poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],n.strides=null==t.strides?n.poolSize:t.strides,n.padding=null==t.padding?"valid":t.padding,n.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,s.checkDataFormat(n.dataFormat),s.checkPaddingMode(n.padding),n.inputSpec=[new u.InputSpec({ndim:4})],n}return r(t,e),t.prototype.computeOutputShape=function(e){e=h.getExactlyOneShape(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=d.convOutputLength(t,this.poolSize[0],this.padding,this.strides[0]),n=d.convOutputLength(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]},t.prototype.call=function(e,t){return this.invokeCallHook(e,t),this.poolingFunction(h.getExactlyOneTensor(e),this.poolSize,this.strides,this.padding,this.dataFormat)},t.prototype.getConfig=function(){var t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(l.Layer);t.Pooling2D=v;var _=function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.prototype.poolingFunction=function(e,t,n,r,u){return s.checkDataFormat(u),s.checkPaddingMode(r),o.pool2d(e,t,n,r,u,"max")},t}(v);t.MaxPooling2D=_,h.ClassNameMap.register("MaxPooling2D",_);var w=function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.prototype.poolingFunction=function(e,t,n,r,u){return s.checkDataFormat(u),s.checkPaddingMode(r),o.pool2d(e,t,n,r,u,"avg")},t}(v);t.AvgPooling2D=w,h.ClassNameMap.register("AvgPooling2D",w);var E=function(e){function t(t){var n=e.call(this,t)||this;return n.inputSpec=[new u.InputSpec({ndim:3})],n}return r(t,e),t.prototype.computeOutputShape=function(e){return[e[0],e[2]]},t.prototype.call=function(e,t){throw new c.NotImplementedError},t}(l.Layer);t.GlobalPooling1D=E;var O=function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.prototype.call=function(e,t){var n=h.getExactlyOneTensor(e);return o.mean(n,1)},t}(E);t.GlobalAveragePooling1D=O,h.ClassNameMap.register("GlobalAveragePooling1D",O);var S=function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.prototype.call=function(e,t){var n=h.getExactlyOneTensor(e);return o.max(n,1)},t}(E);t.GlobalMaxPooling1D=S,h.ClassNameMap.register("GlobalMaxPooling1D",S);var A=function(e){function t(t){var n=e.call(this,t)||this;return n.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,s.checkDataFormat(n.dataFormat),n.inputSpec=[new u.InputSpec({ndim:4})],n}return r(t,e),t.prototype.computeOutputShape=function(e){return e=e,"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]},t.prototype.call=function(e,t){throw new c.NotImplementedError},t.prototype.getConfig=function(){var t={dataFormat:this.dataFormat},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(l.Layer);t.GlobalPooling2D=A;var T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.call=function(e,t){var n=h.getExactlyOneTensor(e);return o.mean(n,"channelsLast"===this.dataFormat?[1,2]:[2,3])},t}(A);t.GlobalAveragePooling2D=T,h.ClassNameMap.register("GlobalAveragePooling2D",T);var N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.call=function(e,t){var n=h.getExactlyOneTensor(e);return o.max(n,"channelsLast"===this.dataFormat?[1,2]:[2,3])},t}(A);t.GlobalMaxPooling2D=N,h.ClassNameMap.register("GlobalMaxPooling2D",N)},"i+52":function(e,t,n){(function(e){var r;!function(e,o,s){function u(f,e){return e.x=f.x,e.y=f.y,e.z=f.z,e.w=f.w,e.v=f.v,e.d=f.d,e}function l(e,t){var n=new function(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var k=0;k<n.length+64;k++)t.x^=0|n.charCodeAt(k),k==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&("object"==typeof r&&u(r,n),o.state=function(){return u(n,{})}),o}o&&o.exports?o.exports=l:n("LGuY")&&n("nErl")?void 0===(r=(function(){return l}).call(t,n,t,o))||(o.exports=r):this.xorwow=l}(0,"object"==typeof e&&e,n("LGuY"))}).call(t,n("3IRH")(e))},ivZP:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var s=n("OMJi"),u=n("2CTY"),l=n("gqjM"),c=n("Xq4m");function d(e,t,n,d){void 0===d&&(d={header:!1});var h=e.combine(),p=h.orient,g=h.scale,m=h.title,v=o(h,["orient","scale","title"]);if(c.keys(v).forEach(function(e){var n=u.AXIS_PROPERTY_TYPE[e];n&&n!==t&&"both"!==n&&delete v[e]}),"grid"===t){if(!v.grid)return;if(v.encode){var grid=v.encode.grid;v.encode=r({},grid?{grid:grid}:{}),0===c.keys(v.encode).length&&delete v.encode}return r({scale:g,orient:p},v,{domain:!1,labels:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:0})}if(d.header||!e.mainExtracted){if(v.encode){for(var _=0,w=u.AXIS_PARTS;_<w.length;_++){var E=w[_];e.hasAxisPart(E)||delete v.encode[E]}0===c.keys(v.encode).length&&delete v.encode}var O=function(e,t){return s.isArray(e)?e.map(function(e){return l.title(e,t)}).join(", "):e}(m,n);return r({scale:g,orient:p},O?{title:O}:{},v,{zindex:1})}}t.assembleAxis=d,t.assembleAxes=function(e,t){var n=e.x,x=void 0===n?[]:n,r=e.y,y=void 0===r?[]:r;return x.map(function(a){return d(a,"main",t)}).concat(x.map(function(a){return d(a,"grid",t)}),y.map(function(a){return d(a,"main",t)}),y.map(function(a){return d(a,"grid",t)})).filter(function(a){return a})}},j7RO:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Bsgt"),o=n("NDl6"),s=n("xdLA"),u=n("1dKF"),l=n("gqjM"),c=n("KMAE"),d=n("rxHH"),h=n("zEzE"),p=n("Xq4m");t.grid=function(e,t){return!d.hasDiscreteDomain(e)&&!t.bin},t.gridScale=function(e,t){var n="x"===t?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)},t.labelFlush=function(e,t,n){return void 0!==n.labelFlush?n.labelFlush:!("x"!==t||!p.contains(["quantitative","temporal"],e.type))||void 0},t.labelOverlap=function(e,t,n,r){return void 0!==t.labelOverlap?t.labelOverlap:"nominal"!==e.type?"log"!==r||"greedy":void 0},t.orient=function(e){switch(e){case s.X:return"bottom";case s.Y:return"left"}throw new Error(c.message.INVALID_CHANNEL_FOR_AXIS)},t.tickCount=function(e,t,n,r){if(!d.hasDiscreteDomain(n)&&"log"!==n&&!p.contains(["month","hours","day","quarter"],t.timeUnit))return t.bin?{signal:"ceil("+r.signal+"/20)"}:{signal:"ceil("+r.signal+"/40)"}},t.title=function(e,t,n){var o=l.title(t,n);return e?r.truncate(o,e):o},t.values=function(e,t,n){var r=e.values;if(e.values&&u.isDateTime(r[0]))return r.map(function(e){return{signal:u.dateTimeExpr(e,!0)}});if(!r&&n.bin&&n.type===h.QUANTITATIVE){var s=t.getName(o.binToString(n.bin)+"_"+n.field+"_bins");return{signal:"sequence("+s+".start, "+s+".stop + "+s+".step, "+s+".step)"}}return r}},jRWw:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("JV7f"),o=n("qmZh"),s=n("yJL4");function u(x,e){return void 0===e&&(e=1),o.elu(x,e)}function l(x){return o.selu(x)}function c(x){return o.relu(x)}function d(x){return o.minimum(r.scalar(6),o.relu(x))}function h(x){return x}function p(x){return o.sigmoid(x)}function g(x){return o.hardSigmoid(x)}function m(x){return o.softplus(x)}function v(x){return o.softsign(x)}function _(x){return o.tanh(x)}function w(x,e){return void 0===e&&(e=-1),o.softmax(x,e)}t.getActivation=function(e){if(null==e)return h;if("elu"===e.toLowerCase())return u;if("hardsigmoid"===e.toLowerCase())return g;if("linear"===e.toLowerCase())return h;if("relu"===e.toLowerCase())return c;if("relu6"===e.toLowerCase())return d;if("selu"===e.toLowerCase())return l;if("sigmoid"===e.toLowerCase())return p;if("softmax"===e.toLowerCase())return w;if("softplus"===e.toLowerCase())return m;if("softsign"===e.toLowerCase())return v;if("tanh"===e.toLowerCase())return _;throw new s.ValueError("Unsupported activation function "+e)},t.elu=u,t.selu=l,t.relu=c,t.relu6=d,t.linear=h,t.sigmoid=p,t.hardSigmoid=g,t.softplus=m,t.softsign=v,t.tanh=_,t.softmax=w,t.serializeActivation=function(e){return e.name}},jb1O:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("XFvI"),o=7;function s(e,t){return r.rightPad(parseFloat(e.toFixed(o)).toString(),t)}t.tensorToString=function(e,t){var n=e.dataSync(),r=function(e){var t=e.dataSync(),n=e.size,r=e.strides[e.strides.length-1],o=new Array(r).fill(0);if(e.rank>1)for(var u=0;u<n/r;u++)for(var l=u*r,j=0;j<r;j++)o[j]=Math.max(o[j],s(t[l+j],0).length);return o}(e),o=function e(t,n,r,o,u){void 0===u&&(u=!0);var l=n[0],c=n.length;if(0===c)return[t[0].toString()];if(1===c){if(l>20){var d=Array.from(t.subarray(0,3)),h=Array.from(t.subarray(l-3,l));return["["+d.map(function(x,i){return s(x,o[i])}).join(", ")+", ..., "+h.map(function(x,i){return s(x,o[l-3+i])}).join(", ")+"]"]}return["["+Array.from(t).map(function(x,i){return s(x,o[i])}).join(", ")+"]"]}var p=n.slice(1),g=r.slice(1),m=r[0],v=[];if(l>20){for(var i=0;i<3;i++)v.push.apply(v,e(t.subarray(_=i*m,_+m),p,g,o,!1));for(v.push("..."),i=l-3;i<l;i++)v.push.apply(v,e(t.subarray(_=i*m,_+m),p,g,o,i===l-1))}else for(i=0;i<l;i++){var _;v.push.apply(v,e(t.subarray(_=i*m,_+m),p,g,o,i===l-1))}var w=2===c?",":"";for(v[0]="["+v[0]+w,i=1;i<v.length-1;i++)v[i]=" "+v[i]+w;var E=",\n";for(i=2;i<c;i++)E+="\n";return v[v.length-1]=" "+v[v.length-1]+"]"+(u?"":E),v}(n,e.shape,e.strides,r),u=["Tensor"];return t&&(u.push("  dtype: "+e.dtype),u.push("  rank: "+e.rank),u.push("  shape: ["+e.shape+"]"),u.push("  values:")),u.push(o.map(function(e){return"    "+e}).join("\n")),u.join("\n")}},jfp2:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o,s=n("1dKF"),u=n("KMAE"),l=n("Xq4m");!function(e){e.YEAR="year",e.MONTH="month",e.DAY="day",e.DATE="date",e.HOURS="hours",e.MINUTES="minutes",e.SECONDS="seconds",e.MILLISECONDS="milliseconds",e.YEARMONTH="yearmonth",e.YEARMONTHDATE="yearmonthdate",e.YEARMONTHDATEHOURS="yearmonthdatehours",e.YEARMONTHDATEHOURSMINUTES="yearmonthdatehoursminutes",e.YEARMONTHDATEHOURSMINUTESSECONDS="yearmonthdatehoursminutesseconds",e.MONTHDATE="monthdate",e.HOURSMINUTES="hoursminutes",e.HOURSMINUTESSECONDS="hoursminutesseconds",e.MINUTESSECONDS="minutesseconds",e.SECONDSMILLISECONDS="secondsmilliseconds",e.QUARTER="quarter",e.YEARQUARTER="yearquarter",e.QUARTERMONTH="quartermonth",e.YEARQUARTERMONTH="yearquartermonth",e.UTCYEAR="utcyear",e.UTCMONTH="utcmonth",e.UTCDAY="utcday",e.UTCDATE="utcdate",e.UTCHOURS="utchours",e.UTCMINUTES="utcminutes",e.UTCSECONDS="utcseconds",e.UTCMILLISECONDS="utcmilliseconds",e.UTCYEARMONTH="utcyearmonth",e.UTCYEARMONTHDATE="utcyearmonthdate",e.UTCYEARMONTHDATEHOURS="utcyearmonthdatehours",e.UTCYEARMONTHDATEHOURSMINUTES="utcyearmonthdatehoursminutes",e.UTCYEARMONTHDATEHOURSMINUTESSECONDS="utcyearmonthdatehoursminutesseconds",e.UTCMONTHDATE="utcmonthdate",e.UTCHOURSMINUTES="utchoursminutes",e.UTCHOURSMINUTESSECONDS="utchoursminutesseconds",e.UTCMINUTESSECONDS="utcminutesseconds",e.UTCSECONDSMILLISECONDS="utcsecondsmilliseconds",e.UTCQUARTER="utcquarter",e.UTCYEARQUARTER="utcyearquarter",e.UTCQUARTERMONTH="utcquartermonth",e.UTCYEARQUARTERMONTH="utcyearquartermonth"}(o=t.TimeUnit||(t.TimeUnit={}));var c={year:1,quarter:1,month:1,day:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};t.TIMEUNIT_PARTS=l.flagKeys(c),t.isLocalSingleTimeUnit=function(e){return!!c[e]};var d={utcyear:1,utcquarter:1,utcmonth:1,utcday:1,utcdate:1,utchours:1,utcminutes:1,utcseconds:1,utcmilliseconds:1};t.isUtcSingleTimeUnit=function(e){return!!d[e]};var h={utcyearquarter:1,utcyearquartermonth:1,utcyearmonth:1,utcyearmonthdate:1,utcyearmonthdatehours:1,utcyearmonthdatehoursminutes:1,utcyearmonthdatehoursminutesseconds:1,utcquartermonth:1,utcmonthdate:1,utchoursminutes:1,utchoursminutesseconds:1,utcminutesseconds:1,utcsecondsmilliseconds:1},p=r({},d,h);function g(e){return!!p[e]}t.isUTCTimeUnit=g,t.getLocalTimeUnit=function(e){return e.substr(3)};var m=r({},c,d,{yearquarter:1,yearquartermonth:1,yearmonth:1,yearmonthdate:1,yearmonthdatehours:1,yearmonthdatehoursminutes:1,yearmonthdatehoursminutesseconds:1,quartermonth:1,monthdate:1,hoursminutes:1,hoursminutesseconds:1,minutesseconds:1,secondsmilliseconds:1},h);t.TIMEUNITS=l.flagKeys(m),t.isTimeUnit=function(e){return!!m[e]};var v={year:"setFullYear",month:"setMonth",date:"setDate",hours:"setHours",minutes:"setMinutes",seconds:"setSeconds",milliseconds:"setMilliseconds",quarter:null,day:null};function _(e,t){var n=v[e];return{setDateMethod:t?"setUTC"+n.substr(3):n,getDateMethod:"get"+(t?"UTC":"")+n.substr(3)}}function w(e,t){var n=e.indexOf(t);return n>-1&&(t!==o.SECONDS||0===n||"i"!==e.charAt(n-1))}t.convert=function(e,n){for(var r=g(e),s=r?new Date(Date.UTC(0,0,1,0,0,0,0)):new Date(0,0,1,0,0,0,0),u=0,l=t.TIMEUNIT_PARTS;u<l.length;u++){var c=l[u];if(w(e,c))switch(c){case o.DAY:throw new Error("Cannot convert to TimeUnits containing 'day'");case o.QUARTER:var d=_("month",r);s[d.setDateMethod](3*Math.floor(n[d.getDateMethod]()/3));break;default:var h=_(c,r);s[h.setDateMethod](n[h.getDateMethod]())}}return s},t.getTimeUnitParts=function(e){return t.TIMEUNIT_PARTS.reduce(function(t,n){return w(e,n)?t.concat(n):t},[])},t.containsTimeUnit=w,t.fieldExpr=function(e,n){var r="datum"+l.accessPath(n),u=g(e)?"utc":"",c=t.TIMEUNIT_PARTS.reduce(function(t,n){var s;return w(e,n)&&(t[n]=(s=n)===o.QUARTER?"("+u+"quarter("+r+")-1)":""+u+s+"("+r+")"),t},{});return s.dateTimeExpr(c)},t.formatExpression=function(e,t,n,r){if(e){var s=[],u="",l=w(e,o.YEAR);w(e,o.QUARTER)&&(u="'Q' + quarter("+t+")"),w(e,o.MONTH)&&s.push(!1!==n?"%b":"%B"),w(e,o.DAY)?s.push(n?"%a":"%A"):w(e,o.DATE)&&s.push("%d"+(l?",":"")),l&&s.push(n?"%y":"%Y");var c=[];w(e,o.HOURS)&&c.push("%H"),w(e,o.MINUTES)&&c.push("%M"),w(e,o.SECONDS)&&c.push("%S"),w(e,o.MILLISECONDS)&&c.push("%L");var d=[];return s.length>0&&d.push(s.join(" ")),c.length>0&&d.push(c.join(":")),d.length>0&&(u&&(u+=" + ' ' + "),u+=r?"utcFormat("+t+", '"+d.join(" ")+"')":"timeFormat("+t+", '"+d.join(" ")+"')"),u||void 0}},t.normalizeTimeUnit=function(e){return"day"!==e&&e.indexOf("day")>=0?(u.warn(u.message.dayReplacedWithDate(e)),e.replace("day","date")):e}},kESI:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isMobile=function(){var a=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))}},kglw:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("XSKZ"),s=n("Bsgt"),u=n("xdLA"),l=n("KMAE"),c=n("YsHz"),d=n("Xq4m"),h=n("OMxB"),p=n("3A6A"),g=n("YuVP"),m=n("T4GW"),v=n("8na5");function _(e,t){return w(e,function(n,r){t=r.marks?r.marks(e,n,t):t,v.forEachTransform(n,function(r){r.marks&&(t=r.marks(e,n,t))})}),t}function w(e,t){var n=e.component.selection;for(var r in n)if(n.hasOwnProperty(r)){var o=n[r];t(o,E(o.type))}}function E(e){switch(e){case"single":return m.default;case"multi":return g.default;case"interval":return p.default}return null}function O(e){for(var t=e.parent;t&&!h.isFacetModel(t);)t=t.parent;return t}t.STORE="_store",t.TUPLE="_tuple",t.MODIFY="_modify",t.SELECTION_DOMAIN="_selection_domain_",t.parseUnitSelection=function(e,t){var n={},u=e.config.selection,l=function(l){if(!t.hasOwnProperty(l))return"continue";var c=t[l],h=u[c.type];for(var p in h)"encodings"===p&&c.fields||"fields"===p&&c.encodings||("mark"===p&&(c[p]=r({},h[p],c[p])),void 0!==c[p]&&!0!==c[p]||(c[p]=h[p]||c[p]));l=d.varName(l);var g=n[l]=r({},c,{name:l,events:s.isString(c.on)?o.selector(c.on,"scope"):c.on});v.forEachTransform(g,function(t){t.parse&&t.parse(e,c,g)})};for(var c in t)l(c);return n},t.assembleUnitSelectionSignals=function(e,n){w(e,function(r,o){var u=r.name,l=o.modifyExpr(e,r);n.push.apply(n,o.signals(e,r)),v.forEachTransform(r,function(t){t.signals&&(n=t.signals(e,r,n)),t.modifyExpr&&(l=t.modifyExpr(e,r,l))}),n.push({name:u+t.MODIFY,on:[{events:{signal:u+t.TUPLE},update:"modify("+s.stringValue(r.name+t.STORE)+", "+l+")"}]})});var r=O(e);if(n.length&&r){var u=s.stringValue(r.getName("cell"));n.unshift({name:"facet",value:{},on:[{events:o.selector("mousemove","scope"),update:"isTuple(facet) ? facet : group("+u+").datum"}]})}return n},t.assembleTopLevelSignals=function(e,t){var n=!1;return w(e,function(r,o){o.topLevelSignals&&(t=o.topLevelSignals(e,r,t)),v.forEachTransform(r,function(n){n.topLevelSignals&&(t=n.topLevelSignals(e,r,t))}),n=!0}),n&&(t.filter(function(e){return"unit"===e.name}).length||t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]})),t},t.assembleUnitSelectionData=function(e,n){return w(e,function(e){n.filter(function(n){return n.name===e.name+t.STORE}).length||n.push({name:e.name+t.STORE})}),n},t.assembleUnitSelectionMarks=_,t.assembleLayerSelectionMarks=function(e,t){return e.children.forEach(function(e){h.isUnitModel(e)&&(t=_(e,t))}),t},t.selectionPredicate=function(e,n,r){var o=[],u=d.logicalExpr(n,function(n){var u=d.varName(n),l=e.getSelectionComponent(u,n),c=s.stringValue(u+t.STORE);if(l.timeUnit){var h=r||e.component.data.raw,p=l.timeUnit.clone();h.parent?p.insertAsParentOf(h):h.parent=p}return"none"!==l.empty&&o.push(c),E(l.type).predicate+"("+c+", datum"+("global"===l.resolve?")":", "+s.stringValue(l.resolve)+")")});return(o.length?"!("+o.map(function(e){return"length(data("+e+"))"}).join(" || ")+") || ":"")+"("+u+")"},t.isRawSelectionDomain=function(e){return e.signal.indexOf(t.SELECTION_DOMAIN)>=0},t.selectionScaleDomain=function(e,n){var r=JSON.parse(n.signal.replace(t.SELECTION_DOMAIN,"")),o=d.varName(r.selection),u=e.component.selection&&e.component.selection[o];return u?(l.warn('Use "bind": "scales" to setup a binding for scales and selections within the same view.'),{signal:"null"}):(u=e.getSelectionComponent(o,r.selection),r.encoding||r.field||(r.field=u.project[0].field,u.project.length>1&&l.warn('A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": '+s.stringValue(r.field)+".")),{signal:E(u.type).scaleDomain+"("+s.stringValue(o+t.STORE)+", "+s.stringValue(r.encoding||null)+", "+s.stringValue(r.field||null)+("global"===u.resolve?")":", "+s.stringValue(u.resolve)+")")})},t.unitName=function(e){var t=s.stringValue(e.name),n=O(e);return n&&(t+=(n.facet.row?" + '_' + facet"+d.accessPath(n.vgField("row")):"")+(n.facet.column?" + '_' + facet"+d.accessPath(n.vgField("column")):"")),t},t.requiresSelectionId=function(e){var t=!1;return w(e,function(e){t=t||e.project.some(function(e){return e.field===c.SELECTION_ID})}),t},t.channelSignalName=function(e,t,n){return d.varName(e.name+"_"+("visual"===n?t:e.fields[t]))},t.positionalProjections=function(e){var x=null,t=null,y=null,n=null;return e.project.forEach(function(e,i){e.channel===u.X?(x=e,t=i):e.channel===u.Y&&(y=e,n=i)}),{x:x,xi:t,y:y,yi:n}}},kmR0:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("v/P2"),u=n("XFvI"),l=n("bDWH"),c=n("35G1");t.CompareOps=function(){function e(){}return e.notEqual=function(a,b){return u.assertTypesMatch(a,b),l.assertAndGetBroadcastShape(a.shape,b.shape),s.ENV.engine.runKernel(function(e){return e.notEqual(a,b)},{a:a,b:b})},e.notEqualStrict=function(a,b){return u.assertShapesMatch(a.shape,b.shape,"Error in notEqualStrict: "),a.notEqual(b)},e.less=function(a,b){return u.assertTypesMatch(a,b),l.assertAndGetBroadcastShape(a.shape,b.shape),s.ENV.engine.runKernel(function(e){return e.less(a,b)},{a:a,b:b})},e.lessStrict=function(a,b){return u.assertShapesMatch(a.shape,b.shape,"Error in lessStrict: "),a.less(b)},e.equal=function(a,b){return u.assertTypesMatch(a,b),l.assertAndGetBroadcastShape(a.shape,b.shape),s.ENV.engine.runKernel(function(e){return e.equal(a,b)},{a:a,b:b})},e.equalStrict=function(a,b){return u.assertShapesMatch(a.shape,b.shape,"Error in equalStrict: "),a.equal(b)},e.lessEqual=function(a,b){return u.assertTypesMatch(a,b),l.assertAndGetBroadcastShape(a.shape,b.shape),s.ENV.engine.runKernel(function(e){return e.lessEqual(a,b)},{a:a,b:b})},e.lessEqualStrict=function(a,b){return u.assertShapesMatch(a.shape,b.shape,"Error in lessEqualStrict: "),a.lessEqual(b)},e.greater=function(a,b){return u.assertTypesMatch(a,b),l.assertAndGetBroadcastShape(a.shape,b.shape),s.ENV.engine.runKernel(function(e){return e.greater(a,b)},{a:a,b:b})},e.greaterStrict=function(a,b){return u.assertShapesMatch(a.shape,b.shape,"Error in greaterStrict: "),a.greater(b)},e.greaterEqual=function(a,b){return u.assertTypesMatch(a,b),l.assertAndGetBroadcastShape(a.shape,b.shape),s.ENV.engine.runKernel(function(e){return e.greaterEqual(a,b)},{a:a,b:b})},e.greaterEqualStrict=function(a,b){return u.assertShapesMatch(a.shape,b.shape,"Error in greaterEqualStrict: "),a.greaterEqual(b)},r([o.doc({heading:"Operations",subheading:"Logical"}),c.operation],e,"notEqual",null),r([c.operation],e,"notEqualStrict",null),r([o.doc({heading:"Operations",subheading:"Logical"}),c.operation],e,"less",null),r([c.operation],e,"lessStrict",null),r([o.doc({heading:"Operations",subheading:"Logical"}),c.operation],e,"equal",null),r([c.operation],e,"equalStrict",null),r([o.doc({heading:"Operations",subheading:"Logical"}),c.operation],e,"lessEqual",null),r([c.operation],e,"lessEqualStrict",null),r([o.doc({heading:"Operations",subheading:"Logical"}),c.operation],e,"greater",null),r([c.operation],e,"greaterStrict",null),r([o.doc({heading:"Operations",subheading:"Logical"}),c.operation],e,"greaterEqual",null),r([c.operation],e,"greaterEqualStrict",null),e}()},"kpg/":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResizeBilinearProgram=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[1],s=e[2];this.outputShape=[e[0],t,n,e[3]];var u=r?[o-1,s-1]:[o,s],l=r?[t-1,n-1]:[t,n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/l[0]+",\n          "+u[1]/l[1]+");\n      const vec2 inputShapeRC = vec2("+o+".0, "+s+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "}},lBAX:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultinomialProgram=function(){function e(e,t,n){this.variableNames=["probs"],this.outputShape=[e,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(t-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(t-1)+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}},e}()},lbmW:function(e,t,n){"use strict";var r=n("TToO").__extends,o=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var s=n("JV7f"),u=n("qmZh"),l=n("np2E");function c(e,t){return u.sqrt(u.sum(u.square(e),t,!0))}var d=function(){function e(){}return e.prototype.getConfig=function(){return{}},o([s.doc({heading:"Constraints",subheading:"Classes",namespace:"constraints"})],e)}();t.Constraint=d;var h=function(e){function t(t){var n=e.call(this)||this;return n.defaultMaxValue=2,n.defaultAxis=0,n.maxValue=null!=t.maxValue?t.maxValue:n.defaultMaxValue,n.axis=null!=t.axis?t.axis:n.defaultAxis,n}return r(t,e),t.prototype.apply=function(e){var t=c(e,this.axis),n=u.clip(t,0,this.maxValue);return u.multiply(e,u.divide(n,u.scalarPlusArray(u.getScalar(u.epsilon()),t)))},t.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},t}(d);t.MaxNorm=h,l.ClassNameMap.register("MaxNorm",h);var p=function(e){function t(t){var n=e.call(this)||this;return n.defaultAxis=0,n.axis=null!=t.axis?t.axis:n.defaultAxis,n}return r(t,e),t.prototype.apply=function(e){return u.divide(e,u.scalarPlusArray(u.getScalar(u.epsilon()),c(e,this.axis)))},t.prototype.getConfig=function(){return{axis:this.axis}},t}(d);t.UnitNorm=p,l.ClassNameMap.register("UnitNorm",p);var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.apply=function(e){return u.relu(e)},t}(d);t.NonNeg=g,l.ClassNameMap.register("NonNeg",g);var m=function(e){function t(t){var n=e.call(this)||this;return n.defaultMinValue=0,n.defaultMaxValue=1,n.defaultRate=1,n.defaultAxis=0,n.minValue=null!=t.minValue?t.minValue:n.defaultMinValue,n.maxValue=null!=t.maxValue?t.maxValue:n.defaultMaxValue,n.rate=null!=t.rate?t.rate:n.defaultRate,n.axis=null!=t.axis?t.axis:n.defaultAxis,n}return r(t,e),t.prototype.apply=function(e){var t=c(e,this.axis),n=u.add(u.scalarTimesArray(u.getScalar(this.rate),u.clip(t,this.minValue,this.maxValue)),u.scalarTimesArray(u.getScalar(1-this.rate),t));return u.multiply(e,u.divide(n,u.scalarPlusArray(u.getScalar(u.epsilon()),t)))},t.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},t}(d);function v(e,t){return void 0===t&&(t={}),l.deserializeKerasObject(e,l.ClassNameMap.getMap().pythonClassNameMap,t,"constraint")}t.MinMaxNorm=m,l.ClassNameMap.register("MinMaxNorm",m),t.CONSTRAINT_IDENTIFIER_REGISTRY_SYMBOL_MAP={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"},t.serializeConstraint=function(e){return l.serializeKerasObject(e)},t.deserializeConstraint=v,t.getConstraint=function(e){return null==e?null:"string"==typeof e?v({className:e in t.CONSTRAINT_IDENTIFIER_REGISTRY_SYMBOL_MAP?t.CONSTRAINT_IDENTIFIER_REGISTRY_SYMBOL_MAP[e]:e,config:{}}):e instanceof d?e:v(e)}},m3RX:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("z2hB"),o=n("xHKr"),s=n("G57i"),u=n("kmR0"),l=n("SPTo"),c=n("TZ+F"),d=n("DCGi"),h=n("wjyt"),p=n("/KFK"),g=n("ajEb"),m=n("zhZS"),v=n("JdMc"),_=n("pohi"),w=n("UPUT"),E=n("emb8"),O=n("d7qV"),S=n("DxGv"),A=n("gkZw"),T=n("oDDY");t.batchNormalization=o.BatchNormOps.batchNormalization,t.batchNormalization2d=o.BatchNormOps.batchNormalization2d,t.batchNormalization3d=o.BatchNormOps.batchNormalization3d,t.batchNormalization4d=o.BatchNormOps.batchNormalization4d,t.concat=l.ConcatOps.concat,t.concat1d=l.ConcatOps.concat1d,t.concat2d=l.ConcatOps.concat2d,t.concat3d=l.ConcatOps.concat3d,t.concat4d=l.ConcatOps.concat4d,t.conv1d=c.ConvOps.conv1d,t.conv2d=c.ConvOps.conv2d,t.conv2dTranspose=c.ConvOps.conv2dTranspose,t.depthwiseConv2d=c.ConvOps.depthwiseConv2d,t.matMul=m.MatmulOps.matMul,t.matrixTimesVector=m.MatmulOps.matrixTimesVector,t.outerProduct=m.MatmulOps.outerProduct,t.vectorTimesMatrix=m.MatmulOps.vectorTimesMatrix,t.avgPool=_.PoolOps.avgPool,t.maxPool=_.PoolOps.maxPool,t.minPool=_.PoolOps.minPool,t.transpose=A.TransposeOps.transpose,t.reverse=E.ReverseOps.reverse,t.reverse1d=E.ReverseOps.reverse1d,t.reverse2d=E.ReverseOps.reverse2d,t.reverse3d=E.ReverseOps.reverse3d,t.reverse4d=E.ReverseOps.reverse4d,t.slice=O.SliceOps.slice,t.slice1d=O.SliceOps.slice1d,t.slice2d=O.SliceOps.slice2d,t.slice3d=O.SliceOps.slice3d,t.slice4d=O.SliceOps.slice4d,t.argMax=w.ReductionOps.argMax,t.argMin=w.ReductionOps.argMin,t.logSumExp=w.ReductionOps.logSumExp,t.max=w.ReductionOps.max,t.mean=w.ReductionOps.mean,t.min=w.ReductionOps.min,t.moments=w.ReductionOps.moments,t.sum=w.ReductionOps.sum,t.equal=u.CompareOps.equal,t.equalStrict=u.CompareOps.equalStrict,t.greater=u.CompareOps.greater,t.greaterStrict=u.CompareOps.greaterStrict,t.greaterEqual=u.CompareOps.greaterEqual,t.greaterEqualStrict=u.CompareOps.greaterEqualStrict,t.less=u.CompareOps.less,t.lessStrict=u.CompareOps.lessStrict,t.lessEqual=u.CompareOps.lessEqual,t.lessEqualStrict=u.CompareOps.lessEqualStrict,t.notEqual=u.CompareOps.notEqual,t.notEqualStrict=u.CompareOps.notEqualStrict,t.logicalNot=h.LogicalOps.logicalNot,t.logicalAnd=h.LogicalOps.logicalAnd,t.logicalOr=h.LogicalOps.logicalOr,t.logicalXor=h.LogicalOps.logicalXor,t.where=h.LogicalOps.where,t.abs=T.UnaryOps.abs,t.acos=T.UnaryOps.acos,t.asin=T.UnaryOps.asin,t.atan=T.UnaryOps.atan,t.ceil=T.UnaryOps.ceil,t.clipByValue=T.UnaryOps.clipByValue,t.cos=T.UnaryOps.cos,t.cosh=T.UnaryOps.cosh,t.elu=T.UnaryOps.elu,t.exp=T.UnaryOps.exp,t.expm1=T.UnaryOps.expm1,t.floor=T.UnaryOps.floor,t.leakyRelu=T.UnaryOps.leakyRelu,t.log=T.UnaryOps.log,t.log1p=T.UnaryOps.log1p,t.neg=T.UnaryOps.neg,t.prelu=T.UnaryOps.prelu,t.relu=T.UnaryOps.relu,t.selu=T.UnaryOps.selu,t.sigmoid=T.UnaryOps.sigmoid,t.sin=T.UnaryOps.sin,t.sinh=T.UnaryOps.sinh,t.sqrt=T.UnaryOps.sqrt,t.square=T.UnaryOps.square,t.step=T.UnaryOps.step,t.tan=T.UnaryOps.tan,t.tanh=T.UnaryOps.tanh,t.add=s.BinaryOps.add,t.atan2=s.BinaryOps.atan2,t.addStrict=s.BinaryOps.addStrict,t.div=s.BinaryOps.div,t.divStrict=s.BinaryOps.divStrict,t.maximum=s.BinaryOps.maximum,t.maximumStrict=s.BinaryOps.maximumStrict,t.minimum=s.BinaryOps.minimum,t.minimumStrict=s.BinaryOps.minimumStrict,t.mul=s.BinaryOps.mul,t.mulStrict=s.BinaryOps.mulStrict,t.pow=s.BinaryOps.pow,t.powStrict=s.BinaryOps.powStrict,t.sub=s.BinaryOps.sub,t.subStrict=s.BinaryOps.subStrict,t.squaredDifference=s.BinaryOps.squaredDifference,t.squaredDifferenceStrict=s.BinaryOps.squaredDifferenceStrict,t.norm=v.NormOps.norm,t.cast=r.ArrayOps.cast,t.clone=r.ArrayOps.clone,t.fromPixels=r.ArrayOps.fromPixels,t.ones=r.ArrayOps.ones,t.onesLike=r.ArrayOps.onesLike,t.zeros=r.ArrayOps.zeros,t.zerosLike=r.ArrayOps.zerosLike,t.rand=r.ArrayOps.rand,t.randomNormal=r.ArrayOps.randomNormal,t.truncatedNormal=r.ArrayOps.truncatedNormal,t.randomUniform=r.ArrayOps.randomUniform,t.multinomial=r.ArrayOps.multinomial,t.reshape=r.ArrayOps.reshape,t.squeeze=r.ArrayOps.squeeze,t.tile=r.ArrayOps.tile,t.gather=r.ArrayOps.gather,t.oneHot=r.ArrayOps.oneHot,t.linspace=r.ArrayOps.linspace,t.range=r.ArrayOps.range,t.buffer=r.ArrayOps.buffer,t.fill=r.ArrayOps.fill,t.tensor=r.ArrayOps.tensor,t.scalar=r.ArrayOps.scalar,t.tensor1d=r.ArrayOps.tensor1d,t.tensor2d=r.ArrayOps.tensor2d,t.tensor3d=r.ArrayOps.tensor3d,t.tensor4d=r.ArrayOps.tensor4d,t.print=r.ArrayOps.print,t.expandDims=r.ArrayOps.expandDims,t.stack=r.ArrayOps.stack,t.pad=r.ArrayOps.pad,t.pad1d=r.ArrayOps.pad1d,t.pad2d=r.ArrayOps.pad2d,t.pad3d=r.ArrayOps.pad3d,t.pad4d=r.ArrayOps.pad4d,t.basicLSTMCell=g.LSTMOps.basicLSTMCell,t.multiRNNCell=g.LSTMOps.multiRNNCell,t.softmax=S.SoftmaxOps.softmax,t.localResponseNormalization=p.LRNOps.localResponseNormalization,n("XPNO"),n("3goy"),t.losses={softmaxCrossEntropy:S.SoftmaxOps.softmaxCrossEntropy},t.image={resizeBilinear:d.ImageOps.resizeBilinear}},m48y:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("Xq4m"),s=n("aIXu");t.AxisComponent=function(e){function t(t,n,r){void 0===t&&(t={}),void 0===n&&(n={}),void 0===r&&(r=!1);var o=e.call(this)||this;return o.explicit=t,o.implicit=n,o.mainExtracted=r,o}return r(t,e),t.prototype.clone=function(){return new t(o.duplicate(this.explicit),o.duplicate(this.implicit),this.mainExtracted)},t.prototype.hasAxisPart=function(e){return!("axis"!==e&&("grid"===e||"title"===e?!this.get(e):!1===(t=this.get(e))||null===t));var t},t}(s.Split)},mFTl:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o,s=n("JV7f"),u=n("e/LB");!function(e){e.float32="float32",e.int32="int32",e.bool="bool"}(o=t.DType||(t.DType={}));var l=0;t.SymbolicTensor=function(){return r([s.doc({heading:"Models",subheading:"Classes"})],function(e,t,n,r,o,s,c){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=o,this.outputTensorIndex=c,this.id=l++,null!=s&&(this.name=u.getUniqueTensorName(s))})}();var c=function(){function e(e,t){this.dtype=o.float32,this.shape=e.shape,this.val=e,this.id=l++,null!=t&&(this.name=u.getUniqueTensorName(t))}return e.prototype.value=function(){return this.val},e}();function d(e){return e instanceof c?e.value():e}t.ConcreteTensor=c;var h="Variable";t.LayerVariable=function(){function e(e,t,n,r,c){void 0===t&&(t=o.float32),void 0===n&&(n=h),void 0===r&&(r=!0),void 0===c&&(c=null),this.dtype=null==t?o.float32:t,this.shape=e.shape,this.id=l++,this.name=u.getUniqueTensorName(null==n?h:n),this.trainable=r,this.constraint=c,this.val=s.variable(d(e),this.trainable,this.name,this.dtype)}return e.prototype.read=function(){return this.val},e.prototype.write=function(e){return function(x,y){if(x.shape.toString()!==y.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(x.shape)+" vs. "+JSON.stringify(y.shape))}(this.val,e),this.val.assign(d(e)),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val)),this},e}()},mPLz:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("/u4k");t.WhereProgram=function(){return function(e,t,n){var o,s;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)s="resRC",o="resRC";else{for(var u=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[],i=0;i<t.length;i++)c.push(""+u[i]),i<e&&l.push(""+u[i]);o=l.join(),s=c.join()}var d=r.getCoordsDataType(n);this.userCode="\n      void main() {\n        "+d+" resRC = getOutputCoords();\n        float cVal = getC("+o+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+s+"));\n        } else {\n          setOutput(getB("+s+"));\n        }\n      }\n    "}}()},msRB:function(e,t,n){"use strict";var r=n("TToO").__extends,o=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var s=n("JV7f"),u=n("5WUj"),l=n("jRWw"),c=n("qmZh"),d=n("lbmW"),h=n("DjcB"),p=n("DjcB"),g=n("yJL4"),m=n("TPCB"),v=n("Q1Fz"),_=n("mFTl"),w=n("np2E"),E=n("KB5b"),O=n("AQHg"),S=function(e){function t(t){var n,r=e.call(this,t)||this;if(null==t.cell)throw new g.ValueError("cell property is missing for the constructor of RNN.");if(null==(n=Array.isArray(t.cell)?new I({cells:t.cell}):t.cell).stateSize)throw new g.ValueError("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=n,r.returnSequences=null!=t.returnSequences&&t.returnSequences,r.returnState=null!=t.returnState&&t.returnState,r.goBackwards=null!=t.goBackwards&&t.goBackwards,r._stateful=null!=t.stateful&&t.stateful,r.unroll=null!=t.unroll&&t.unroll,r.supportsMasking=!0,r.inputSpec=[new h.InputSpec({ndim:3})],r.stateSpec=null,r.states=null,r.numConstants=null,r}return r(t,e),t.prototype.getStates=function(){if(null==this.states){var e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return u.range(e).map(function(x){return null})}return this.states},t.prototype.setStates=function(e){this.states=e},t.prototype.computeOutputShape=function(e){w.isArrayOfShapes(e)&&(e=e[0]),e=e;var t=this.cell.stateSize;Array.isArray(t)||(t=[t]);var n,r=t[0];if(n=this.returnSequences?[e[0],e[1],r]:[e[0],r],this.returnState){for(var o=[],s=0,u=t;s<u.length;s++)o.push([e[0],u[s]]);return[n].concat(o)}return n},t.prototype.computeMask=function(e,t){throw new g.NotImplementedError("computeMask has not been implemented for RNN yet")},t.prototype.build=function(e){if(null!=this.numConstants)throw new g.NotImplementedError("Constants support is not implemented in RNN yet.");w.isArrayOfShapes(e)&&(e=e[0]),e=e,this.inputSpec[0]=new h.InputSpec({shape:[this.stateful?e[0]:null,null,e[e.length-1]]});var t,n=[e[0]].concat(e.slice(2));if(this.cell.build(n),t=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!u.isEqual(this.stateSpec.map(function(e){return e.shape[e.shape.length-1]}),t))throw new g.ValueError("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=t.map(function(e){return new h.InputSpec({shape:[null,e]})});if(this.stateful)throw new g.NotImplementedError("stateful RNN layer is not implemented yet")},t.prototype.resetStates=function(e){if(!this.stateful)throw new g.AttributeError("Cannot call resetState() on an RNN Layer that is not stateful.");var t=this.inputSpec[0].shape[0];if(null==t)throw new g.ValueError("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states)this.states=Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(function(e){return c.zeros([t,e])}):[c.zeros([t,this.cell.stateSize])];else if(null==e)Array.isArray(this.cell.stateSize)?this.states=this.cell.stateSize.map(function(e){return c.zeros([t,e])}):this.states[0]=c.zeros([t,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states.length)throw new g.ValueError("Layer "+this.name+" expects "+this.states.length+" state(s), but it received "+e.length+" state value(s). Input received: "+e);for(var n=0;n<this.states.length;++n){var value=e[n],r=Array.isArray(this.cell.stateSize)?this.cell.stateSize[n]:this.cell.stateSize,o=[t,r];if(!u.isEqual(value.shape,o))throw new g.ValueError("State "+n+" is incompatible with layer "+this.name+": expected shape="+o+", received shape="+value.shape);this.states[n]=value}}},t.prototype.standardizeArgs=function(e,t,n){if(Array.isArray(e)){if(null!=t||null!=n)throw new g.ValueError("When inputs is an array, neither initialState or constants should be provided");null!=this.numConstants&&(n=e.slice(e.length-this.numConstants,e.length),e=e.slice(0,e.length-this.numConstants)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function r(x){return null==x||Array.isArray(x)?x:[x]}return{inputs:e,initialState:t=r(t),constants:n=r(n)}},t.prototype.apply=function(t,n){var r=null==n?null:n.initialState,o=null==n?null:n.constants;null==n&&(n={});var s=this.standardizeArgs(t,r,o);t=s.inputs,o=s.constants;var u=[],l=[];if(null!=(r=s.initialState)){n.initialState=r,u=u.concat(r),this.stateSpec=[];for(var c=0,d=r;c<d.length;c++)this.stateSpec.push(new h.InputSpec({shape:d[c].shape}));l=l.concat(this.stateSpec)}if(null!=o&&(n.constants=o,u=u.concat(o),this.numConstants=o.length),u[0]instanceof _.SymbolicTensor){var p=[t].concat(u),g=this.inputSpec.concat(l),m=this.inputSpec;this.inputSpec=g;var v=e.prototype.apply.call(this,p,n);return this.inputSpec=m,v}return e.prototype.apply.call(this,t,n)},t.prototype.call=function(e,t){var n=this,r=null==t?null:t.mask,o=null==t?null:t.training,s=null==t?null:t.initialState;if(e=w.getExactlyOneTensor(e),null==s){if(this.stateful)throw new g.NotImplementedError("stateful RNN layer is not implemented yet.");s=this.getInitialState(e)}if(null!=r)throw new g.NotImplementedError("Masking is not implemented for RNN yet");var u=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(s.length!==u)throw new g.ValueError("RNN Layer has "+u+" state(s) but was passed "+s.length+" initial state(s).");var l=e.shape[1];this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var d={training:o},h=c.rnn(function(e,t){var r=n.cell.call([e].concat(t),d);return[r[0],r.slice(1)]},e,s,this.goBackwards,null,null,this.unroll,l),p=h[0],m=h[1],v=h[2];if(this.stateful)throw new g.NotImplementedError("stateful RNN layer is not implemented yet");var _=this.returnSequences?m:p;return this.returnState?[_].concat(v):_},t.prototype.getInitialState=function(e){var t=c.zeros(e.shape);return t=c.sum(t,[1,2]),t=c.expandDims(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(function(e){return e>1?c.tile(t,[1,e]):t}):this.cell.stateSize>1?[c.tile(t,[1,this.cell.stateSize])]:[t]},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);var n=this.cell.getConfig();t.cell={className:this.cell.constructor.name,config:n};var r=e.prototype.getConfig.call(this);return Object.assign(t,r),t},t}(p.Layer);t.RNN=S,w.ClassNameMap.register("RNN",S);var A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),o([s.doc({heading:"Layers",subheading:"Classes"})],t)}(p.Layer);t.RNNCell=A;var T=function(e){function t(t){var n=e.call(this,t)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=t.units,n.activation=l.getActivation(null==t.activation?n.DEFAULT_ACTIVATION:t.activation),n.useBias=null==t.useBias||t.useBias,n.kernelInitializer=m.getInitializer(t.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=m.getInitializer(t.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=m.getInitializer(t.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=v.getRegularizer(t.kernelRegularizer),n.recurrentRegularizer=v.getRegularizer(t.recurrentRegularizer),n.biasRegularizer=v.getRegularizer(t.biasRegularizer),n.kernelConstraint=d.getConstraint(t.kernelConstraint),n.recurrentConstraint=d.getConstraint(t.recurrentConstraint),n.biasConstraint=d.getConstraint(t.biasConstraint),n.dropout=E.min([1,E.max([0,null==t.dropout?0:t.dropout])]),n.recurrentDropout=E.min([1,E.max([0,null==t.recurrentDropout?0:t.recurrentDropout])]),n.stateSize=n.units,n}return r(t,e),t.prototype.build=function(e){e=w.getExactlyOneShape(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0},t.prototype.call=function(e,t){if(2!==(e=e).length)throw new g.ValueError("SimpleRNNCell expects 2 input Tensors, got "+e.length+".");var n=e[1];if(e=e[0],0!==this.dropout||0!==this.recurrentDropout)throw new g.NotImplementedError("Dropout is not implemented for SimpleRNNCell yet");var r=c.dot(e,this.kernel.read());null!=this.bias&&(r=c.biasAdd(r,this.bias.read()));var o=c.add(r,c.dot(n,this.recurrentKernel.read()));return null!=this.activation&&(o=this.activation(o)),[o,o]},t.prototype.getConfig=function(){var t={units:this.units,activation:l.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:m.serializeInitializer(this.kernelInitializer),recurrentInitializer:m.serializeInitializer(this.recurrentInitializer),biasInitializer:m.serializeInitializer(this.biasInitializer),kernelRegularizer:v.serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:v.serializeRegularizer(this.recurrentRegularizer),biasRegularizer:v.serializeRegularizer(this.biasRegularizer),activityRegularizer:v.serializeRegularizer(this.activityRegularizer),kernelConstraint:d.serializeConstraint(this.kernelConstraint),recurrentConstraint:d.serializeConstraint(this.recurrentConstraint),biasConstraint:d.serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(A);t.SimpleRNNCell=T,w.ClassNameMap.register("SimpleRNNCell",T);var N=function(e){function t(t){return t.cell=new T(t),e.call(this,t)||this}return r(t,e),t.prototype.call=function(t,n){return e.prototype.call.call(this,t,{mask:null==n?null:n.mask,training:null==n?null:n.training,initialState:null==n?null:n.initialState})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var t={units:this.units,activation:l.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:m.serializeInitializer(this.kernelInitializer),recurrentInitializer:m.serializeInitializer(this.recurrentInitializer),biasInitializer:m.serializeInitializer(this.biasInitializer),kernelRegularizer:v.serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:v.serializeRegularizer(this.recurrentRegularizer),biasRegularizer:v.serializeRegularizer(this.biasRegularizer),activityRegularizer:v.serializeRegularizer(this.activityRegularizer),kernelConstraint:d.serializeConstraint(this.kernelConstraint),recurrentConstraint:d.serializeConstraint(this.recurrentConstraint),biasConstraint:d.serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(S);t.SimpleRNN=N,w.ClassNameMap.register("SimpleRNN",N);var M=function(e){function t(t){var n=e.call(this,t)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=t.units,n.activation=l.getActivation(void 0===t.activation?n.DEFAULT_ACTIVATION:t.activation),n.recurrentActivation=l.getActivation(void 0===t.activation?n.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),n.useBias=null==t.useBias||t.useBias,n.kernelInitializer=m.getInitializer(t.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=m.getInitializer(t.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=m.getInitializer(t.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=v.getRegularizer(t.kernelRegularizer),n.recurrentRegularizer=v.getRegularizer(t.recurrentRegularizer),n.biasRegularizer=v.getRegularizer(t.biasRegularizer),n.kernelConstraint=d.getConstraint(t.kernelConstraint),n.recurrentConstraint=d.getConstraint(t.recurrentConstraint),n.biasConstraint=d.getConstraint(t.biasConstraint),n.dropout=E.min([1,E.max([0,null==t.dropout?0:t.dropout])]),n.recurrentDropout=E.min([1,E.max([0,null==t.recurrentDropout?0:t.recurrentDropout])]),n.implementation=t.implementation,n.stateSize=n.units,n}return r(t,e),t.prototype.build=function(e){e=w.getExactlyOneShape(e),this.kernel=this.addWeight("kernel",[e[e.length-1],3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0},t.prototype.call=function(e,t){if(0!==this.dropout||0!==this.recurrentDropout)throw new g.NotImplementedError("Dropout is not implemented for GRUCell yet");if(2!==(e=e).length)throw new g.ValueError("GRUCell expects 2 input Tensors (inputs, h, c), got "+e.length+".");var n,r,o,s=e[1];if(e=e[0],1===this.implementation){var u=c.sliceAlongLastAxis(this.kernel.read(),0,this.units),l=c.sliceAlongLastAxis(this.kernel.read(),this.units,this.units),d=c.sliceAlongLastAxis(this.kernel.read(),2*this.units,this.units),h=c.sliceAlongLastAxis(this.recurrentKernel.read(),0,this.units),p=c.sliceAlongLastAxis(this.recurrentKernel.read(),this.units,this.units),m=c.sliceAlongLastAxis(this.recurrentKernel.read(),2*this.units,this.units),v=e,_=e,w=c.dot(e,u),E=c.dot(v,l),O=c.dot(_,d);if(this.useBias){var S=c.sliceAlongFirstAxis(this.bias.read(),0,this.units),A=c.sliceAlongFirstAxis(this.bias.read(),this.units,this.units),T=c.sliceAlongFirstAxis(this.bias.read(),2*this.units,this.units);w=c.biasAdd(w,S),E=c.biasAdd(E,A),O=c.biasAdd(O,T)}var N=s,M=s;n=this.recurrentActivation(c.add(w,c.dot(s,h))),r=this.recurrentActivation(c.add(E,c.dot(N,p))),o=this.activation(c.add(O,c.dot(c.multiply(r,M),m)))}else{var C=c.dot(e,this.kernel.read());this.useBias&&(C=c.biasAdd(C,this.bias.read()));var D=c.dot(s,c.sliceAlongLastAxis(this.recurrentKernel.read(),0,2*this.units)),R=(w=c.sliceAlongLastAxis(C,0,this.units),E=c.sliceAlongLastAxis(C,this.units,this.units),c.sliceAlongLastAxis(D,0,this.units)),I=c.sliceAlongLastAxis(D,this.units,this.units);n=this.recurrentActivation(c.add(w,R)),r=this.recurrentActivation(c.add(E,I)),O=c.sliceAlongLastAxis(C,2*this.units,this.units);var P=c.dot(c.multiply(r,s),c.sliceAlongLastAxis(this.recurrentKernel.read(),2*this.units,this.units));o=this.activation(c.add(O,P))}var L=c.add(c.multiply(n,s),c.multiply(c.scalarPlusArray(c.getScalar(1),c.neg(n)),o));return[L,L]},t.prototype.getConfig=function(){var t={units:this.units,activation:l.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:m.serializeInitializer(this.kernelInitializer),recurrentInitializer:m.serializeInitializer(this.recurrentInitializer),biasInitializer:m.serializeInitializer(this.biasInitializer),kernelRegularizer:v.serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:v.serializeRegularizer(this.recurrentRegularizer),biasRegularizer:v.serializeRegularizer(this.biasRegularizer),activityRegularizer:v.serializeRegularizer(this.activityRegularizer),kernelConstraint:d.serializeConstraint(this.kernelConstraint),recurrentConstraint:d.serializeConstraint(this.recurrentConstraint),biasConstraint:d.serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(A);t.GRUCell=M,w.ClassNameMap.register("GRUCell",M);var C=function(e){function t(t){return 0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new M(t),e.call(this,t)||this}return r(t,e),t.prototype.call=function(t,n){return e.prototype.call.call(this,t,{mask:null==n?null:n.mask,training:null==n?null:n.training,initialState:null==n?null:n.initialState})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var t={units:this.units,activation:l.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:m.serializeInitializer(this.kernelInitializer),recurrentInitializer:m.serializeInitializer(this.recurrentInitializer),biasInitializer:m.serializeInitializer(this.biasInitializer),kernelRegularizer:v.serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:v.serializeRegularizer(this.recurrentRegularizer),biasRegularizer:v.serializeRegularizer(this.biasRegularizer),activityRegularizer:v.serializeRegularizer(this.activityRegularizer),kernelConstraint:d.serializeConstraint(this.kernelConstraint),recurrentConstraint:d.serializeConstraint(this.recurrentConstraint),biasConstraint:d.serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.fromConfig=function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)},t}(S);t.GRU=C,w.ClassNameMap.register("GRU",C);var D=function(e){function t(t){var n=e.call(this,t)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=t.units,n.activation=l.getActivation(void 0===t.activation?n.DEFAULT_ACTIVATION:t.activation),n.recurrentActivation=l.getActivation(void 0===t.activation?n.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),n.useBias=null==t.useBias||t.useBias,n.kernelInitializer=m.getInitializer(t.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=m.getInitializer(t.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=m.getInitializer(t.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.unitForgetBias=t.unitForgetBias,n.kernelRegularizer=v.getRegularizer(t.kernelRegularizer),n.recurrentRegularizer=v.getRegularizer(t.recurrentRegularizer),n.biasRegularizer=v.getRegularizer(t.biasRegularizer),n.kernelConstraint=d.getConstraint(t.kernelConstraint),n.recurrentConstraint=d.getConstraint(t.recurrentConstraint),n.biasConstraint=d.getConstraint(t.biasConstraint),n.dropout=E.min([1,E.max([0,null==t.dropout?0:t.dropout])]),n.recurrentDropout=E.min([1,E.max([0,null==t.recurrentDropout?0:t.recurrentDropout])]),n.implementation=t.implementation,n.stateSize=[n.units,n.units],n}return r(t,e),t.prototype.build=function(e){var t;if(e=w.getExactlyOneShape(e),this.kernel=this.addWeight("kernel",[e[e.length-1],4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var n=this.biasInitializer,o=this.units;t=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.apply=function(e,t){var r=n.apply([o]),s=(new m.Ones).apply([o]),u=n.apply([2*o]);return c.concatAlongFirstAxis(c.concatAlongFirstAxis(r,s),u)},t}(m.Initializer))}else t=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,t,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},t.prototype.call=function(e,t){if(0!==this.dropout||0!==this.recurrentDropout)throw new g.NotImplementedError("Dropout is not implemented for LSTMCell yet");if(3!==(e=e).length)throw new g.ValueError("LSTMCell expects 3 input Tensors (inputs, h, c), got "+e.length+".");var i,f,n,r,o=e[1],s=e[2];if(e=e[0],1===this.implementation){var u=c.sliceAlongLastAxis(this.kernel.read(),0,this.units),l=c.sliceAlongLastAxis(this.kernel.read(),this.units,this.units),d=c.sliceAlongLastAxis(this.kernel.read(),2*this.units,this.units),h=c.sliceAlongLastAxis(this.kernel.read(),3*this.units,this.units),p=c.sliceAlongLastAxis(this.recurrentKernel.read(),0,this.units),m=c.sliceAlongLastAxis(this.recurrentKernel.read(),this.units,this.units),v=c.sliceAlongLastAxis(this.recurrentKernel.read(),2*this.units,this.units),_=c.sliceAlongLastAxis(this.recurrentKernel.read(),3*this.units,this.units),w=e,E=e,O=e,S=c.dot(e,u),A=c.dot(w,l),T=c.dot(E,d),N=c.dot(O,h);if(this.useBias){var M=c.sliceAlongFirstAxis(this.bias.read(),0,this.units),C=c.sliceAlongFirstAxis(this.bias.read(),this.units,this.units),D=c.sliceAlongFirstAxis(this.bias.read(),2*this.units,this.units),R=c.sliceAlongFirstAxis(this.bias.read(),3*this.units,this.units);S=c.biasAdd(S,M),A=c.biasAdd(A,C),T=c.biasAdd(T,D),N=c.biasAdd(N,R)}var I=o,P=o,L=o;i=this.recurrentActivation(c.add(S,c.dot(o,p))),f=this.recurrentActivation(c.add(A,c.dot(I,m))),n=c.add(c.multiply(f,s),c.multiply(i,this.activation(c.add(T,c.dot(P,v))))),r=this.recurrentActivation(c.add(N,c.dot(L,_)))}else{var z=c.dot(e,this.kernel.read());z=c.add(z,c.dot(o,this.recurrentKernel.read())),this.useBias&&(z=c.biasAdd(z,this.bias.read()));var F=c.sliceAlongLastAxis(z,0,this.units),U=c.sliceAlongLastAxis(z,this.units,this.units),B=c.sliceAlongLastAxis(z,2*this.units,this.units),V=c.sliceAlongLastAxis(z,3*this.units,this.units);i=this.recurrentActivation(F),f=this.recurrentActivation(U),n=c.add(c.multiply(f,s),c.multiply(i,this.activation(B))),r=this.recurrentActivation(V)}var q=c.multiply(r,this.activation(n));return[q,q,n]},t.prototype.getConfig=function(){var t={units:this.units,activation:l.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:m.serializeInitializer(this.kernelInitializer),recurrentInitializer:m.serializeInitializer(this.recurrentInitializer),biasInitializer:m.serializeInitializer(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:v.serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:v.serializeRegularizer(this.recurrentRegularizer),biasRegularizer:v.serializeRegularizer(this.biasRegularizer),activityRegularizer:v.serializeRegularizer(this.activityRegularizer),kernelConstraint:d.serializeConstraint(this.kernelConstraint),recurrentConstraint:d.serializeConstraint(this.recurrentConstraint),biasConstraint:d.serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(A);t.LSTMCell=D,w.ClassNameMap.register("LSTMCell",D);var R=function(e){function t(t){return 0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new D(t),e.call(this,t)||this}return r(t,e),t.prototype.call=function(t,n){return e.prototype.call.call(this,t,{mask:null==n?null:n.mask,training:null==n?null:n.training,initialState:null==n?null:n.initialState})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var t={units:this.units,activation:l.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:m.serializeInitializer(this.kernelInitializer),recurrentInitializer:m.serializeInitializer(this.recurrentInitializer),biasInitializer:m.serializeInitializer(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:v.serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:v.serializeRegularizer(this.recurrentRegularizer),biasRegularizer:v.serializeRegularizer(this.biasRegularizer),activityRegularizer:v.serializeRegularizer(this.activityRegularizer),kernelConstraint:d.serializeConstraint(this.kernelConstraint),recurrentConstraint:d.serializeConstraint(this.recurrentConstraint),biasConstraint:d.serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.fromConfig=function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)},t}(S);t.LSTM=R,w.ClassNameMap.register("LSTM",R);var I=function(e){function t(t){var n=e.call(this,t)||this;return n.cells=t.cells,n}return r(t,e),Object.defineProperty(t.prototype,"stateSize",{get:function(){for(var e=[],t=0,n=this.cells.slice().reverse();t<n.length;t++){var r=n[t];Array.isArray(r.stateSize)?e.push.apply(e,r.stateSize):e.push(r.stateSize)}return e},enumerable:!0,configurable:!0}),t.prototype.call=function(e,t){for(var n=(e=e).slice(1),r=[],o=0,s=this.cells.slice().reverse();o<s.length;o++){var u=s[o];Array.isArray(u.stateSize)?r.push(n.splice(0,u.stateSize.length)):r.push(n.splice(0,1))}r.reverse();for(var l,c=[],i=0;i<this.cells.length;++i)u=this.cells[i],n=r[i],l=0===i?[e[0]].concat(n):[l[0]].concat(n),l=u.call(l,t),c.push(l.slice(1));n=[];for(var d=0,h=c.slice().reverse();d<h.length;d++)n.push.apply(n,h[d]);return[l[0]].concat(n)},t.prototype.build=function(e){var t;w.isArrayOfShapes(e)&&(e=e[0]),e=e;for(var n=0,r=this.cells;n<r.length;n++){var o=r[n];o.build(e),t=Array.isArray(o.stateSize)?o.stateSize[0]:o.stateSize,e=[e[0],t]}this.built=!0},t.prototype.getConfig=function(){for(var t=[],n=0,r=this.cells;n<r.length;n++)t.push({className:this.constructor.name,config:r[n].getConfig()});var o={cells:t},s=e.prototype.getConfig.call(this);return Object.assign(o,s),o},t.fromConfig=function(e,t,n){void 0===n&&(n={});for(var r=[],o=0,s=t.cells;o<s.length;o++)r.push(O.deserialize(s[o],n));return new e({cells:r})},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){if(!this.trainable)return[];for(var weights=[],e=0,t=this.cells;e<t.length;e++)weights.push.apply(weights,t[e].trainableWeights);return weights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){for(var weights=[],e=0,t=this.cells;e<t.length;e++)weights.push.apply(weights,t[e].nonTrainableWeights);if(!this.trainable){for(var n=[],r=0,o=this.cells;r<o.length;r++)n.push.apply(n,o[r].trainableWeights);return n.concat(weights)}return weights},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){for(var weights=[],e=0,t=this.cells;e<t.length;e++)weights.push.apply(weights,t[e].weights);return c.batchGetValue(weights)},t.prototype.setWeights=function(weights){for(var e=[],t=0,n=this.cells;t<n.length;t++)for(var r=n[t],o=weights.splice(r.weights.length),i=0;i<r.weights.length;++i)e.push([r.weights[i],o[i]]);c.batchSetValue(e)},t}(A);t.StackedRNNCells=I,w.ClassNameMap.register("StackedRNNCells",I)},"mz/+":function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("Bsgt"),s=n("gqjM"),u=n("Xq4m"),l=n("efV4"),c=n("FgHA");t.StackNode=function(e){function t(t,n){var r=e.call(this,t)||this;return r._stack=n,r}return r(t,e),t.prototype.clone=function(){return new t(null,u.duplicate(this._stack))},t.make=function(e,n){var r,o=n.stack;if(!o)return null;o.groupbyChannel&&(r=n.fieldDef(o.groupbyChannel));var u,c=function(e){return e.stack.stackBy.reduce(function(e,t){var n=s.vgField(t.fieldDef);return n&&e.push(n),e},[])}(n),d=n.encoding.order;return u=d?l.sortParams(d):c.reduce(function(e,t){return e.field.push(t),e.order.push("descending"),e},{field:[],order:[]}),new t(e,{dimensionFieldDef:r,field:n.vgField(o.fieldChannel),facetby:[],stackby:c,sort:u,offset:o.offset,impute:o.impute})},Object.defineProperty(t.prototype,"stack",{get:function(){return this._stack},enumerable:!0,configurable:!0}),t.prototype.addDimensions=function(e){this._stack.facetby=this._stack.facetby.concat(e)},t.prototype.dependentFields=function(){var e={};e[this._stack.field]=!0,this.getGroupbyFields().forEach(function(f){return e[f]=!0}),this._stack.facetby.forEach(function(f){return e[f]=!0});var t=this._stack.sort.field;return o.isArray(t)?t.forEach(function(f){return e[f]=!0}):e[t]=!0,e},t.prototype.producedFields=function(){var e={};return e[this._stack.field+"_start"]=!0,e[this._stack.field+"_end"]=!0,e},t.prototype.getGroupbyFields=function(){var e=this._stack,t=e.dimensionFieldDef;return t?t.bin?e.impute?[s.vgField(t,{binSuffix:"mid"})]:[s.vgField(t,{}),s.vgField(t,{binSuffix:"end"})]:[s.vgField(t)]:[]},t.prototype.assemble=function(){var e=[],t=this._stack,n=t.facetby,r=t.field,o=t.dimensionFieldDef,u=t.offset,l=t.sort,c=t.stackby;if(t.impute&&o){var d=o?s.vgField(o,{binSuffix:"mid"}):void 0;o.bin&&e.push({type:"formula",expr:"("+s.vgField(o,{expr:"datum"})+"+"+s.vgField(o,{expr:"datum",binSuffix:"end"})+")/2",as:d}),e.push({type:"impute",field:r,groupby:c,key:d,method:"value",value:0})}return e.push({type:"stack",groupby:this.getGroupbyFields().concat(n),field:r,sort:l,as:[r+"_start",r+"_end"],offset:u}),e},t}(c.DataFlowNode)},nErl:function(e,t){(function(t){e.exports=t}).call(t,{})},nHpP:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n("JhAJ"),n("IJmD"),n("qVfm"),n("FhLH"),n("JE6x");var r=n("QhdG");n("xJJ0"),n("as/7"),t.train={sgd:r.OptimizerConstructors.sgd,momentum:r.OptimizerConstructors.momentum,adadelta:r.OptimizerConstructors.adadelta,adagrad:r.OptimizerConstructors.adagrad,rmsprop:r.OptimizerConstructors.rmsprop,adamax:r.OptimizerConstructors.adamax,adam:r.OptimizerConstructors.adam}},ndgZ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("KMAE"),o=n("ooBR"),s=n("CSN5"),u=n("+M68"),l=n("sHGH"),c=n("4DJb"),d=n("2+Ke");t.buildModel=function(e,t,n,h,p,g,m){if(o.isFacetSpec(e))return new u.FacetModel(e,t,n,p,g);if(o.isLayerSpec(e))return new l.LayerModel(e,t,n,h,p,g,m);if(o.isUnitSpec(e))return new d.UnitModel(e,t,n,h,p,g,m);if(o.isRepeatSpec(e))return new c.RepeatModel(e,t,n,p,g);if(o.isConcatSpec(e))return new s.ConcatModel(e,t,n,p,g);throw new Error(r.message.INVALID_SPEC)}},nkjP:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Bsgt"),o=n("D6ZG"),s=n("D6ZG");t.DEFAULT_REQUIRED_CHANNEL_MAP={text:["text"],line:["x","y"],area:["x","y"]},t.DEFAULT_SUPPORTED_CHANNEL_TYPE={bar:r.toSet(["row","column","x","y","size","color","fill","stroke","detail"]),line:r.toSet(["row","column","x","y","color","fill","stroke","color","detail"]),area:r.toSet(["row","column","x","y","color","fill","stroke","detail"]),tick:r.toSet(["row","column","x","y","color","fill","stroke","detail"]),circle:r.toSet(["row","column","x","y","color","fill","stroke","size","detail"]),square:r.toSet(["row","column","x","y","color","fill","stroke","size","detail"]),point:r.toSet(["row","column","x","y","color","fill","stroke","size","detail","shape"]),geoshape:r.toSet(["row","column","color","fill","stroke","detail","shape"]),text:r.toSet(["row","column","size","color","fill","stroke","text"])},t.getEncodingMappingError=function(e,n,r){void 0===n&&(n=t.DEFAULT_REQUIRED_CHANNEL_MAP),void 0===r&&(r=t.DEFAULT_SUPPORTED_CHANNEL_TYPE);var u=o.isMarkDef(e.mark)?e.mark.type:e.mark,l=e.encoding,c=n[u],d=r[u];for(var i in c)if(!(c[i]in l))return'Missing encoding channel "'+c[i]+'" for mark "'+u+'"';for(var h in l)if(!d[h])return'Encoding channel "'+h+'" is not supported by mark type "'+u+'"';return u!==s.BAR||l.x||l.y?null:"Missing both x and y for bar"}},np2E:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("5WUj"),s=n("yJL4"),u=n("mFTl");function l(x){return Array.isArray(x)?x:[x]}t.pyListRepeat=function(value,e){if(Array.isArray(value)){for(var t=[],i=0;i<e;i++)t=t.concat(value);return t}return(t=new Array(e)).fill(value),t},t.pyGetAttr=function(e,t,n){if(t in e)return e[t];if(o.isUndefined(n))throw new s.AttributeError("pyGetAttr: Attempting to get attribute "+t+"with no default value defined");return n},t.pyNormalizeArrayIndex=function(x,e){if(null==x||null==e)throw new s.ValueError("Must provide a valid array and index for pyNormalizeArrayIndex(). Got array "+x+" and index "+e+".");var t="Index "+e+" out of range for array of length "+x.length;if(e<0){if(e<-x.length)throw new s.IndexError(t);return x.length+e}if(e>=x.length)throw new s.IndexError(t);return e},t.assert=function(e,t){if(!e)throw new s.AssertionError(t)},t.count=function(e,t){for(var n=0,r=0,o=e;r<o.length;r++)o[r]===t&&n++;return n},t.ClassNameMap=function(){function e(){this.pythonClassNameMap={}}return e.getMap=function(){return null==e.instance&&(e.instance=new e),e.instance},e.register=function(e,t){this.getMap().pythonClassNameMap[e]=[t,t.fromConfig]},e}(),t.SerializableEnumRegistry=function(){function e(){this.enumRegistry={}}return e.getMap=function(){return null==e.instance&&(e.instance=new e),e.instance},e.register=function(t,n){if(e.contains(t))throw new s.ValueError("Attempting to register a repeated enum: "+t);this.getMap().enumRegistry[t]=n},e.contains=function(e){return e in this.getMap().enumRegistry},e.lookup=function(e,value){return this.getMap().enumRegistry[e][value]},e.reverseLookup=function(e,value){var t=this.getMap().enumRegistry[e];for(var n in t)if(t[n]===value)return n;throw new s.ValueError("Could not find serialization string for "+value)},e}(),t.singletonOrArray=function(e){return 1===e.length?e[0]:e},t.toList=l,t.objectListUid=function(e){for(var t="",n=0,r=l(e);n<r.length;n++){var o=r[n];if(null==o.id)throw new s.ValueError("Object "+o+" passed to objectListUid without an id");""!==t&&(t+=", "),t+=Math.abs(o.id)}return t},t.isArrayOfShapes=function(x){return Array.isArray(x)&&Array.isArray(x[0])},t.normalizeShapeList=function(x){return 0===x.length?[]:Array.isArray(x[0])?x:[x]},t.isAllNullOrUndefined=function(e){return o.every(l(e),function(x){return o.isNull(x)||o.isUndefined(x)})},t.toSnakeCase=function(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t},t.toCamelCase=function(e){return e.length<=1?e:-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,function(e,t){return t.toUpperCase()})};var c={};function d(a,b){return a<b?-1:a>b?1:0}t.serializeKerasObject=function(e){if(null===e||void 0===e)return null;if(null!=e.getConfig)return{className:e.constructor.name,config:e.getConfig()};if(null!=e.name)return e.name;throw new s.ValueError("Cannot serialize "+e)},t.deserializeKerasObject=function(e,t,n,u){if(void 0===t&&(t={}),void 0===n&&(n={}),void 0===u&&(u="object"),"string"==typeof e){var l=void 0;if(e in n)l=n[e];else if(e in c)l=c[e];else if(null==(l=t[e]))throw new s.ValueError("Unknown "+u+": "+e);return l}var d=e;if(null==d.className||null==d.config)throw new s.ValueError(u+": Improper config format: "+JSON.stringify(d)+".\n'className' and 'config' must set.");var h,p,g,m=d.className,v=void 0,_=void 0;if(o.has(n,m)?(v=(h=n.get(m))[0],_=h[1]):o.has(c,m)?(v=(p=c.className)[0],_=p[1]):o.has(t,m)&&(v=(g=t[m])[0],_=g[1]),null==v)throw new s.ValueError("Unknown "+u+": "+m);if(null!=_){for(var w={},E=0,O=Object.keys(c);E<O.length;E++)w[I=O[E]]=c[I];for(var S=0,A=Object.keys(n);S<A.length;S++)w[I=A[S]]=n[I];d.config.customObjects=w;for(var T=r({},c),N=0,M=Object.keys(n);N<M.length;N++)c[I=M[N]]=n[I];var C=_(v,d.config);return c=r({},T),C}T=r({},c);for(var D=0,R=Object.keys(n);D<R.length;D++){var I;c[I=R[D]]=n[I]}return C=new v(d.config),c=r({},T),C},t.getExactlyOneTensor=function(e){var x;if(Array.isArray(e)){if(1!==e.length)throw new s.ValueError("Expected Tensor length to be 1; got "+e.length);x=e[0]}else x=e;return x},t.getExactlyOneShape=function(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return(e=e)[0];throw new s.ValueError("Expected exactly 1 Shape; got "+e.length)}return e},t.numberCompare=d,t.reverseNumberCompare=function(a,b){return-1*d(a,b)},t.stringToDType=function(e){switch(e){case"float32":return u.DType.float32;default:throw new s.ValueError("Invalid dtype: "+e)}}},oDDY:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("v/P2"),u=n("XFvI"),l=n("35G1"),c=n("m3RX"),d=n("m3RX"),h=n("doZ3");t.UnaryOps=function(){function e(){}return e.neg=function(x){return s.ENV.engine.runKernel(function(e){return e.neg(x)},{x:x},function(e){return{x:function(){return e.neg()}}})},e.ceil=function(x){return s.ENV.engine.runKernel(function(e){return e.ceil(x)},{x:x},function(e){return{x:function(){return c.zerosLike(e)}}})},e.floor=function(x){return s.ENV.engine.runKernel(function(e){return e.floor(x)},{x:x},function(e){return{x:function(){return c.zerosLike(e)}}})},e.exp=function(x){return s.ENV.engine.runKernel(function(e,t){return t(e.exp(x))},{x:x},function(e,t){var y=t[0];return{x:function(){return e.mulStrict(y)}}})},e.expm1=function(x){return s.ENV.engine.runKernel(function(e){return e.expm1(x)},{x:x},function(e){return{x:function(){return e.mulStrict(x.exp())}}})},e.log=function(x){return s.ENV.engine.runKernel(function(e){return e.log(x)},{x:x},function(e){return{x:function(){return e.divStrict(x.toFloat())}}})},e.log1p=function(x){return s.ENV.engine.runKernel(function(e){return e.log1p(x)},{x:x},function(e){return{x:function(){return e.divStrict(x.add(c.scalar(1)))}}})},e.sqrt=function(x){return s.ENV.engine.runKernel(function(e){return e.sqrt(x)},{x:x},function(e){return{x:function(){return e.divStrict(x.toFloat().sqrt().mul(c.scalar(2)))}}})},e.square=function(x){return s.ENV.engine.runKernel(function(e){return e.square(x)},{x:x},function(e){return{x:function(){return e.mulStrict(x.toFloat().mul(c.scalar(2)))}}})},e.abs=function(x){return s.ENV.engine.runKernel(function(e){return e.abs(x)},{x:x},function(e){return{x:function(){return e.mulStrict(x.toFloat().step(-1))}}})},e.clipByValue=function(x,e,t){return u.assert(e<=t,"Error in clip: min ("+e+") must beless than or equal to max ("+t+")."),s.ENV.engine.runKernel(function(n){return n.clip(x,e,t)},{x:x},function(n){return{x:function(){return n.where(x.greater(c.scalar(e)).logicalAnd(x.less(c.scalar(t))),d.zerosLike(n))}}})},e.relu=function(x){return s.ENV.engine.runKernel(function(e){return e.relu(x)},{x:x},function(e){var t=x.step();return{x:function(){return e.mulStrict(t.toFloat())}}})},e.elu=function(x){return s.ENV.engine.runKernel(function(e){return e.elu(x)},{x:x},function(e){return{x:function(){return e.mulStrict(function(x){return s.ENV.engine.runKernel(function(e){return e.eluDer(x)},{x:x})}(x))}}})},e.selu=function(x){return s.ENV.engine.runKernel(function(e){return e.selu(x)},{x:x},function(e){return{x:function(){var t=x.greater(c.scalar(0)),n=c.scalar(h.SELU_SCALEALPHA),r=c.scalar(h.SELU_SCALE),o=e.mul(r),s=e.mul(n).mul(x.toFloat().exp());return c.where(t,o,s)}}})},e.leakyRelu=function(x,e){return void 0===e&&(e=.2),s.ENV.engine.runKernel(function(t){return t.leakyRelu(x,e)},{x:x},function(t){return{x:function(){return t.mulStrict(x.step(e))}}})},e.prelu=function(x,e){return s.ENV.engine.runKernel(function(t){return t.prelu(x,e)},{x:x},function(t){return{x:function(){return t.mulStrict(function(x,e){return s.ENV.engine.runKernel(function(t){return t.preluDer(x,e)},{x:x,alpha:e})}(x,e))}}})},e.sigmoid=function(x){return s.ENV.engine.runKernel(function(e,t){return t(e.sigmoid(x))},{x:x},function(e,t){var y=t[0];return{x:function(){return e.mulStrict(y.mul(c.scalar(1).sub(y)))}}})},e.sin=function(x){return s.ENV.engine.runKernel(function(e){return e.sin(x)},{x:x},function(e){return{x:function(){return x.toFloat().cos().mulStrict(e)}}})},e.cos=function(x){return s.ENV.engine.runKernel(function(e){return e.cos(x)},{x:x},function(e){return{x:function(){return x.toFloat().sin().neg().mulStrict(e)}}})},e.tan=function(x){return s.ENV.engine.runKernel(function(e){return e.tan(x)},{x:x},function(e){return{x:function(){return e.divStrict(x.cos().square())}}})},e.asin=function(x){return s.ENV.engine.runKernel(function(e){return e.asin(x)},{x:x},function(t){return{x:function(){return t.divStrict(e.sqrt(c.scalar(1).sub(x.toFloat().square())))}}})},e.acos=function(x){return s.ENV.engine.runKernel(function(e){return e.acos(x)},{x:x},function(t){return{x:function(){return t.divStrict(e.sqrt(c.scalar(1).sub(x.toFloat().square()))).neg()}}})},e.atan=function(x){return s.ENV.engine.runKernel(function(e){return e.atan(x)},{x:x},function(e){return{x:function(){return e.divStrict(c.scalar(1).add(x.toFloat().square()))}}})},e.sinh=function(x){return s.ENV.engine.runKernel(function(e){return e.sinh(x)},{x:x},function(e){return{x:function(){return x.toFloat().cosh().mulStrict(e)}}})},e.cosh=function(x){return s.ENV.engine.runKernel(function(e){return e.cosh(x)},{x:x},function(e){return{x:function(){return x.toFloat().sinh().mulStrict(e)}}})},e.tanh=function(x){return s.ENV.engine.runKernel(function(e,t){return t(e.tanh(x))},{x:x},function(e,t){var y=t[0];return{x:function(){return c.scalar(1).sub(y.square()).mulStrict(e)}}})},e.step=function(x,e){return void 0===e&&(e=0),s.ENV.engine.runKernel(function(t){return t.step(x,e)},{x:x},function(e){return{x:function(){return c.zerosLike(e)}}})},r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"neg",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"ceil",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"floor",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"exp",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"expm1",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"log",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"log1p",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"sqrt",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"square",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"abs",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"clipByValue",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"relu",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"elu",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"selu",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"leakyRelu",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"prelu",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"sigmoid",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"sin",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"cos",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"tan",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"asin",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"acos",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"atan",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"sinh",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"cosh",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"tanh",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),l.operation],e,"step",null),e}()},oTxn:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("77UE"),s=n("gqjM"),u=n("KMAE"),l=n("ooBR"),c=n("6MX6"),d=n("Xq4m"),h=n("ndgZ"),p=n("6Tiz"),g=n("9QYT");t.compile=function(e,t){void 0===t&&(t={}),t.logger&&u.set(t.logger),t.fieldTitle&&s.setTitleFormatter(t.fieldTitle);try{var n=o.initConfig(d.mergeDeep({},t.config,e.config)),m=l.normalize(e,n),v=c.normalizeAutoSize(e.autosize,n.autosize,l.isLayerSpec(m)||l.isUnitSpec(m)),_=h.buildModel(m,null,"",void 0,void 0,n,"fit"===v.type);return _.parse(),g.optimizeDataflow(_.component.data),function(e,t){var n=e.config?o.stripAndRedirectConfig(e.config):void 0,s=[].concat(e.assembleSelectionData([]),p.assembleRootData(e.component.data,t.datasets||{}));delete t.datasets;var u=e.assembleProjections(),l=e.assembleTitle(),c=e.assembleGroupStyle(),d=e.assembleLayoutSignals();return d=d.filter(function(e){return"width"!==e.name&&"height"!==e.name||void 0===e.value||(t[e.name]=+e.value,!1)}),{spec:r({$schema:"https://vega.github.io/schema/vega/v3.0.json"},e.description?{description:e.description}:{},t,l?{title:l}:{},c?{style:c}:{},{data:s},u.length>0?{projections:u}:{},e.assembleGroup(d.concat(e.assembleSelectionTopLevelSignals([]))),n?{config:n}:{})}}(_,function(e,t,n){return r({autosize:1===d.keys(n).length&&n.type?n.type:n},c.extractTopLevelProperties(t),c.extractTopLevelProperties(e))}(e,n,v))}finally{t.logger&&u.reset(),t.fieldTitle&&s.resetTitleFormatter()}}},objH:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function u(value){try{c(r.next(value))}catch(e){s(e)}}function l(value){try{c(r.throw(value))}catch(e){s(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,l)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var f,y,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(f)throw new TypeError("Generator is already executing.");for(;o;)try{if(f=1,y&&(n=y[2&r[0]?"return":r[0]?"throw":"next"])&&!(n=n.call(y,r[1])).done)return n;switch(y=0,n&&(r=[0,n.value]),r[0]){case 0:case 1:n=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,y=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){o.label=r[1];break}if(6===r[0]&&o.label<n[1]){o.label=n[1],n=r;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(r);break}n[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],y=0}finally{f=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=n("m3RX"),u=n("XFvI"),l={float32:4,int32:4};t.loadWeights=function(e,t,n,c){return void 0===t&&(t=""),r(this,void 0,void 0,function(){var r,d,h,p,g,m,v,_,w,E,O;return o(this,function(o){switch(o.label){case 0:if(r=e.map(function(){return!1}),d={},h=null!=n?n.map(function(){return!1}):[],p=[],e.forEach(function(e,t){var o=0;e.weights.forEach(function(e){var s=l[e.dtype]*u.sizeFromShape(e.shape),c=function(){r[t]=!0,null==d[t]&&(d[t]=[]),d[t].push({manifestEntry:e,groupOffset:o,sizeBytes:s})};null!=n?n.forEach(function(t,n){t===e.name&&(c(),h[n]=!0)}):c(),p.push(e.name),o+=s})}),!h.every(function(e){return e}))throw g=n.filter(function(e,i){return!h[i]}),new Error("Could not find weights in manifest with names: "+g.join(", ")+". \nManifest JSON has weights with names: "+p.join(", ")+".");return m=r.reduce(function(e,t,i){return t&&e.push(i),e},[]),v=[],m.forEach(function(i){e[i].paths.forEach(function(e){var n=t+(t.endsWith("/")?"":"/")+e;v.push(fetch(n,c))})}),[4,Promise.all(v)];case 1:return _=o.sent(),[4,Promise.all(_.map(function(e){return e.arrayBuffer()}))];case 2:return w=o.sent(),E={},O=0,m.forEach(function(i){for(var t=e[i].paths.length,n=0,r=0;r<t;r++)n+=w[O+r].byteLength;for(var o=new ArrayBuffer(n),u=new Uint8Array(o),l=0,c=0;c<t;c++){var h=new Uint8Array(w[O+c]);u.set(h,l),l+=h.byteLength}d[i].forEach(function(e){var t,n=o.slice(e.groupOffset,e.groupOffset+e.sizeBytes);if("float32"===e.manifestEntry.dtype)t=new Float32Array(n);else{if("int32"!==e.manifestEntry.dtype)throw new Error("Weight "+e.manifestEntry.name+" has unknown dtype "+e.manifestEntry.dtype+".");t=new Int32Array(n)}var r=e.manifestEntry.name;if(null!=E[r])throw new Error("Duplicate weight with name "+r+". Please make sure weights names are unique in the manifest JSON.");E[r]=s.tensor(t,e.manifestEntry.shape,e.manifestEntry.dtype)}),O+=t}),[2,E]}})})}},ooBR:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var s=n("xdLA"),u=n("Td0G"),l=n("utsZ"),c=n("utsZ"),d=n("KMAE"),h=n("D6ZG"),p=n("6xrs"),g=n("Xq4m");function m(e){return void 0!==e.facet}function v(e){return!!e.mark}function _(e){return void 0!==e.layer}function w(e){return void 0!==e.repeat}function E(e){return O(e)||S(e)}function O(e){return void 0!==e.vconcat}function S(e){return void 0!==e.hconcat}function A(e){var t=e.parentEncoding,n=e.encoding;if(t&&n){var o=g.keys(t).reduce(function(e,t){return n[t]&&e.push(t),e},[]);o.length>0&&d.warn(d.message.encodingOverridden(o))}var s=r({},t||{},n||{});return g.keys(s).length>0?s:void 0}function T(e){var t=e.parentProjection,n=e.projection;return t&&n&&d.warn(d.message.projectionOverridden({parentProjection:t,projection:n})),n||t}function N(e,t,n,c){var d=e.encoding;if(n||c){var m=T({parentProjection:c,projection:e.projection}),v=A({parentEncoding:n,encoding:d});return N(r({},e,m?{projection:m}:{},v?{encoding:v}:{}),t)}if(function(e){return h.isPrimitiveMark(e.mark)}(e)){if(l.isRanged(d))return function(e){var t=l.channelHasField(e.encoding,s.X),n=l.channelHasField(e.encoding,s.Y),r=l.channelHasField(e.encoding,s.X2),o=l.channelHasField(e.encoding,s.Y2);if(r&&!t||o&&!n){var u=g.duplicate(e);return r&&!t&&(u.encoding.x=u.encoding.x2,delete u.encoding.x2),o&&!n&&(u.encoding.y=u.encoding.y2,delete u.encoding.y2),u}return e}(e);var _=t&&t.overlay,w=_&&e.mark===h.AREA&&g.contains(["linepoint","line"],_.area),E=_&&(_.line&&e.mark===h.LINE||"linepoint"===_.area&&e.mark===h.AREA);return E||w?function(e,t,n,s){var u,l=e.mark,c=e.selection,d=e.projection,h=e.encoding,g=o(e,["mark","selection","projection","encoding"]),m=[{mark:l,encoding:h}],v=p.stack(l,h,s?s.stack:void 0),_=h;if(v){var w=v.fieldChannel,E=v.offset;_=r({},h,((u={})[w]=r({},h[w],E?{stack:E}:{}),u))}return n&&m.push(r({},d?{projection:d}:{},{mark:{type:"line",style:"lineOverlay"}},c?{selection:c}:{},{encoding:_})),t&&m.push(r({},d?{projection:d}:{},{mark:{type:"point",filled:!0,style:"pointOverlay"}},c?{selection:c}:{},{encoding:_})),r({},g,{layer:m})}(e,E,w,t):e}return u.normalize(e,t)}function M(e,t){return t.forEach(function(t){var n=["field","type","value","timeUnit","bin","aggregate"].reduce(function(f,e){return void 0!==t[e]&&(f[e]=t[e]),f},{}),r=g.hash(n);e[r]=e[r]||t}),e}t.isFacetSpec=m,t.isUnitSpec=v,t.isLayerSpec=_,t.isRepeatSpec=w,t.isConcatSpec=E,t.isVConcatSpec=O,t.isHConcatSpec=S,t.normalize=function e(t,n){if(m(t))return function(t,n){var s=t.spec,u=o(t,["spec"]);return r({},u,{spec:e(s,n)})}(t,n);if(_(t))return function e(t,n,s,u){var l=t.layer,c=t.encoding,d=t.projection,h=o(t,["layer","encoding","projection"]),p=A({parentEncoding:s,encoding:c}),g=T({parentProjection:u,projection:d});return r({},h,{layer:l.map(function(t){return _(t)?e(t,n,p,g):N(t,n,p,g)})})}(t,n);if(w(t))return function(t,n){var s=t.spec,u=o(t,["spec"]);return r({},u,{spec:e(s,n)})}(t,n);if(O(t))return function(t,n){var s=t.vconcat,u=o(t,["vconcat"]);return r({},u,{vconcat:s.map(function(t){return e(t,n)})})}(t,n);if(S(t))return function(t,n){var s=t.hconcat,u=o(t,["hconcat"]);return r({},u,{hconcat:s.map(function(t){return e(t,n)})})}(t,n);if(v(t)){var u=l.channelHasField(t.encoding,s.ROW),c=l.channelHasField(t.encoding,s.COLUMN);return u||c?function(e,t){var n=e.encoding,s=n.row,u=n.column,l=o(n,["row","column"]),c=e.mark,d=e.width,h=e.projection,p=e.height,g=e.selection,m=o(e,["mark","width","projection","height","selection","encoding"]);return r({},m,{facet:r({},s?{row:s}:{},u?{column:u}:{}),spec:N(r({},h?{projection:h}:{},{mark:c},d?{width:d}:{},p?{height:p}:{},{encoding:l},g?{selection:g}:{}),t)})}(t,n):N(t,n)}throw new Error(d.message.INVALID_SPEC)},t.fieldDefs=function(e){return g.vals(function e(t,n){return void 0===n&&(n={}),_(t)?t.layer.forEach(function(t){v(t)?M(n,c.fieldDefs(t.encoding)):e(t,n)}):m(t)?(M(n,c.fieldDefs(t.facet)),e(t.spec,n)):w(t)?e(t.spec,n):E(t)?(O(t)?t.vconcat:t.hconcat).forEach(function(t){return e(t,n)}):M(n,c.fieldDefs(t.encoding)),n}(e))},t.isStacked=function(e,t){return t=t||e.config,!!h.isPrimitiveMark(e.mark)&&null!==p.stack(e.mark,e.encoding,t?t.stack:void 0)}},"p//t":function(e,t,n){var r;!function(o,s){var u,l=this,c=256,d=6,h="random",p=s.pow(c,d),g=s.pow(2,52),m=2*g,v=c-1;function _(e,t,n){var r=[],_=E(function e(t,n){var r,o=[],s=typeof t;if(n&&"object"==s)for(r in t)try{o.push(e(t[r],n-1))}catch(e){}return o.length?o:"string"==s?t:t+"\0"}((t=1==t?{entropy:!0}:t||{}).entropy?[e,O(o)]:null==e?function(){try{var e;return u&&(e=u.randomBytes)?e=e(c):(e=new Uint8Array(c),(l.crypto||l.msCrypto).getRandomValues(e)),O(e)}catch(e){var t=l.navigator,n=t&&t.plugins;return[+new Date,l,n,l.screen,O(o)]}}():e,3),r),S=new function(e){var t,n=e.length,r=this,i=0,j=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);i<c;)o[i]=i++;for(i=0;i<c;i++)o[i]=o[j=v&j+e[i%n]+(t=o[i])],o[j]=t;(r.g=function(e){for(var t,n=0,i=r.i,j=r.j,o=r.S;e--;)t=o[i=v&i+1],n=n*c+o[v&(o[i]=o[j=v&j+t])+(o[j]=t)];return r.i=i,r.j=j,n})(c)}(r),A=function(){for(var e=S.g(d),t=p,x=0;e<g;)e=(e+x)*c,t*=c,x=S.g(1);for(;e>=m;)e/=2,t/=2,x>>>=1;return(e+x)/t};return A.int32=function(){return 0|S.g(4)},A.quick=function(){return S.g(4)/4294967296},A.double=A,E(O(S.S),o),(t.pass||n||function(e,t,n,r){return r&&(r.S&&w(r,S),e.state=function(){return w(S,{})}),n?(s[h]=e,t):e})(A,_,"global"in t?t.global:this==s,t.state)}function w(f,e){return e.i=f.i,e.j=f.j,e.S=f.S.slice(),e}function E(e,t){for(var n,r=e+"",j=0;j<r.length;)t[v&j]=v&(n^=19*t[v&j])+r.charCodeAt(j++);return O(t)}function O(a){return String.fromCharCode.apply(0,a)}if(s["seed"+h]=_,E(s.random(),o),"object"==typeof e&&e.exports){e.exports=_;try{u=n(6)}catch(e){}}else void 0===(r=(function(){return _}).call(t,n,t,e))||(e.exports=r)}([],Math)},"p/aw":function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("dMOq"),s=n("KIOn");t.line={vgMark:"line",encodeEntry:function(e){var t=e.width,n=e.height;return r({},o.baseEncodeEntry(e,{size:"ignore",orient:"ignore"}),o.pointPosition("x",e,s.mid(t)),o.pointPosition("y",e,s.mid(n)),o.nonPosition("size",e,{vgChannel:"strokeWidth"}))}}},pIoe:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("v/P2"),o=n("XFvI"),s=n("/u4k");function u(){return!r.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")}function l(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(e,i){var n=e.logicalShape,r=e.texShape,s=t[i].tensor.shape,u=t[i].texData.texShape;if(!o.arraysEqual(n,s))throw Error("Binary was compiled with different shapes than the current args. Shapes "+n+" and "+s+" must match");if(!o.arraysEqual(r,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+r+" and "+u+" must match")})}t.compileProgram=function(e,t,n,r){for(var o=t.userCode,l=n.map(function(e,i){return{name:t.variableNames[i],shapeInfo:{logicalShape:e.tensor.shape,texShape:e.texData.texShape}}}),c=l.map(function(x){return x.shapeInfo}),d={logicalShape:r.tensor.shape,texShape:r.texData.texShape},h=s.makeShader(l,d,o,!0===t.supportsBroadcasting),p=e.createProgram(h),g={},i=0;i<t.variableNames.length;i++){var m=t.variableNames[i];g[m]=e.getUniformLocation(p,m)}return u()&&(g.NaN=e.getUniformLocation(p,"NaN",!1)),{program:t,source:h,webGLProgram:p,uniformLocations:g,gpgpu:e,inShapeInfos:c,outShapeInfo:d}},t.runProgram=function(e,t,n,r){l(e.inShapeInfos,t),l([e.outShapeInfo],[n]);var o=n.texData.texShape,s=e.gpgpu;s.setOutputMatrixTexture(n.texData.texture,o[0],o[1]),s.setProgram(e.webGLProgram),t.forEach(function(t,i){s.setInputMatrixTexture(t.texData.texture,e.uniformLocations[e.program.variableNames[i]],i)}),u()&&s.gl.uniform1f(e.uniformLocations.NaN,NaN),null!=r&&r(s,e.webGLProgram),s.executeProgram()},t.makeShaderKey=function(e,t,n){var r="";t.concat(n).forEach(function(x){r+=x.tensor.shape+"_"+x.texData.texShape});var o=e.userCode,s=(!0===e.supportsBroadcasting).toString();return e.constructor.name+"_"+s+"_"+r+"_"+o}},paLv:function(e,t,n){"use strict";var r=n("TToO").__extends,o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n("NDl6"),u=n("gqjM"),l=n("Xq4m"),c=n("efV4"),d=n("OMxB"),h=n("FgHA");function p(e,t){var n;n=function(e){return"as"in e}(e)?[e.as,e.as+"_end"]:[u.vgField(e,{}),u.vgField(e,{binSuffix:"end"})];var r=u.normalizeBin(e.bin,void 0)||{},l=function(e,t){return s.binToString(e)+"_"+t}(r,e.field),c=function(e,t){return{signal:e.getName(t+"_bins"),extentSignal:e.getName(t+"_extent")}}(t,l),d=c.signal,h=c.extentSignal;return{key:l,binComponent:o({bin:r,field:e.field,as:n},d?{signal:d}:{},h?{extentSignal:h}:{})}}t.BinNode=function(e){function t(t,n){var r=e.call(this,t)||this;return r.bins=n,r}return r(t,e),t.prototype.clone=function(){return new t(null,l.duplicate(this.bins))},t.makeFromEncoding=function(e,n){var r=n.reduceFieldDef(function(e,t,r){if(t.bin){var s=p(t,n),l=s.key;e[l]=o({},s.binComponent,e[l],function(e,t,n,r){if(c.binRequiresRange(t,n)){var o=d.isUnitModel(e)&&(e.axis(n)||e.legend(n))||{},s=u.vgField(t,{expr:"datum"}),l=u.vgField(t,{expr:"datum",binSuffix:"end"});return{formulaAs:u.vgField(t,{binSuffix:"range"}),formula:c.binFormatExpression(s,l,o.format,r)}}return{}}(n,t,r,n.config))}return e},{});return 0===l.keys(r).length?null:new t(e,r)},t.makeFromTransform=function(e,n,r){var o,s=p(n,r);return new t(e,((o={})[s.key]=s.binComponent,o))},t.prototype.merge=function(e){this.bins=o({},this.bins,e.bins),e.remove()},t.prototype.producedFields=function(){var e={};return l.vals(this.bins).forEach(function(t){t.as.forEach(function(f){return e[f]=!0})}),e},t.prototype.dependentFields=function(){var e={};return l.vals(this.bins).forEach(function(t){e[t.field]=!0}),e},t.prototype.assemble=function(){return l.flatten(l.vals(this.bins).map(function(e){var t=[],n=o({type:"bin",field:e.field,as:e.as,signal:e.signal},e.bin);return!e.bin.extent&&e.extentSignal&&(t.push({type:"extent",field:e.field,signal:e.extentSignal}),n.extent={signal:e.extentSignal}),t.push(n),e.formula&&t.push({type:"formula",expr:e.formula,as:e.formulaAs}),t}))},t}(h.DataFlowNode)},pohi:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("v/P2"),u=n("XFvI"),l=n("Hjly"),c=n("35G1");t.PoolOps=function(){function e(){}return e.maxPool=function(x,t,n,r,o){var c=x,d=!1;3===x.rank&&(d=!0,c=x.as4D(1,x.shape[0],x.shape[1],x.shape[2])),u.assert(4===c.rank,"Error in maxPool: input must be rank 4 but got rank "+c.rank+"."),null!=o&&u.assert(u.isInt(r),"Error in maxPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+".");var h=l.computePool2DInfo(c.shape,t,n,r,o),p=s.ENV.engine.runKernel(function(e){return e.maxPool(c,h)},{x:c},function(o){return{x:function(){return e.maxPoolBackprop(o,c,t,n,r)}}});return d?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p},e.maxPoolBackprop=function(e,t,n,r,o,c){u.assert(t.rank===e.rank,"Rank of input ("+t.rank+") does not match rank of dy ("+e.rank+")");var d=t,h=e,p=!1;3===t.rank&&(p=!0,d=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),h=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),u.assert(4===h.rank,"Error in maxPoolBackprop: dy must be rank 4 but got rank "+h.rank+"."),u.assert(4===d.rank,"Error in maxPoolBackprop: input must be rank 4 but got rank "+d.rank+"."),null!=c&&u.assert(u.isInt(o),"Error in maxPoolBackprop: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+o+".");var g=l.computePool2DInfo(d.shape,n,r,o,c),m=s.ENV.engine.runKernel(function(e){return e.maxPoolBackprop(h,d,g)},{dy4D:h,input4D:d});return p?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m},e.minPool=function(e,t,n,r,o){var c=e,d=!1;3===e.rank&&(d=!0,c=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),u.assert(4===c.rank,"Error in minPool: x must be rank 4 but got rank "+c.rank+"."),null!=o&&u.assert(u.isInt(r),"Error in minPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+".");var h=l.computePool2DInfo(c.shape,t,n,r,o),p=s.ENV.engine.runKernel(function(e){return e.minPool(c,h)},{input4D:c});return d?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p},e.avgPool=function(x,t,n,r,o){var c=x,d=!1;3===x.rank&&(d=!0,c=x.as4D(1,x.shape[0],x.shape[1],x.shape[2])),u.assert(4===c.rank,"Error in avgPool: x must be rank 4 but got rank "+c.rank+"."),null!=o&&u.assert(u.isInt(r),"Error in avgPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+".");var h=l.computePool2DInfo(c.shape,t,n,r),p=s.ENV.engine.runKernel(function(e){return e.avgPool(c,h)},{x:c},function(o){return{x:function(){return e.avgPoolBackprop(o,c,t,n,r)}}});return d?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p},e.avgPoolBackprop=function(e,t,n,r,o){u.assert(t.rank===e.rank,"Rank of input ("+t.rank+") does not match rank of dy ("+e.rank+")");var c=t,d=e,h=!1;3===t.rank&&(h=!0,c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),d=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),u.assert(4===d.rank,"Error in avgPoolBackprop: dy must be rank 4 but got rank "+d.rank+"."),u.assert(4===c.rank,"Error in avgPoolBackprop: input must be rank 4 but got rank "+c.rank+".");var p=l.computePool2DInfo(c.shape,n,r,o),g=s.ENV.engine.runKernel(function(e){return e.avgPoolBackprop(d,c,p)},{dy4D:d,input4D:c});return h?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g},r([o.doc({heading:"Operations",subheading:"Convolution"}),c.operation],e,"maxPool",null),r([c.operation],e,"maxPoolBackprop",null),r([o.doc({heading:"Operations",subheading:"Convolution"}),c.operation],e,"minPool",null),r([o.doc({heading:"Operations",subheading:"Convolution"}),c.operation],e,"avgPool",null),r([c.operation],e,"avgPoolBackprop",null),e}()},q049:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArgMinMaxProgram=function(){return function(e,t,n){this.variableNames=["A"];var r=e.windowSize,o=e.batchSize,s=Math.ceil(e.inSize/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,s],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = 0;\n        float bestValue = getA(batch, inOffset);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+(n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));")+";\n          float candidate = getA(batch, inIdx);\n          if (isNaN(candidate)) {\n            setOutput(candidate);\n            return;\n          }\n          if (candidate "+("max"===t?">":"<")+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "}}()},qVfm:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("v/P2"),s=n("V6aD"),u=n("m3RX"),l=n("dFrR");t.AdamOptimizer=function(e){function t(t,n,r,o){void 0===o&&(o=1e-8);var l=e.call(this)||this;return l.learningRate=t,l.accumulatedFirstMoment={},l.accumulatedSecondMoment={},l.c=s.keep(u.scalar(-t)),l.eps=s.keep(u.scalar(o)),l.beta1=s.keep(u.scalar(n)),l.beta2=s.keep(u.scalar(r)),s.tidy(function(){l.accBeta1=u.scalar(n).variable(),l.accBeta2=u.scalar(r).variable()}),l.oneMinusBeta1=s.keep(u.scalar(1-n)),l.oneMinusBeta2=s.keep(u.scalar(1-r)),l.one=s.keep(u.scalar(1)),l}return r(t,e),t.prototype.applyGradients=function(e){var t=this;s.tidy(function(){var n=t.one.sub(t.accBeta1),r=t.one.sub(t.accBeta2);for(var s in e){var value=o.ENV.engine.registeredVariables[s];if(null==t.accumulatedFirstMoment[s]){var l=!1;t.accumulatedFirstMoment[s]=u.zerosLike(value).variable(l)}null==t.accumulatedSecondMoment[s]&&(l=!1,t.accumulatedSecondMoment[s]=u.zerosLike(value).variable(l));var c=e[s],d=t.accumulatedSecondMoment[s],h=t.beta1.mul(t.accumulatedFirstMoment[s]).add(t.oneMinusBeta1.mul(c)),p=t.beta2.mul(d).add(t.oneMinusBeta2.mul(c.square())),g=h.div(n),m=p.div(r);t.accumulatedFirstMoment[s].assign(h),t.accumulatedSecondMoment[s].assign(p);var v=t.c.mul(g.div(t.eps.add(m.sqrt()))).add(value);value.assign(v)}t.accBeta1.assign(t.accBeta1.mul(t.beta1)),t.accBeta2.assign(t.accBeta2.mul(t.beta2))})},t.prototype.dispose=function(){var e=this;this.c.dispose(),this.eps.dispose(),this.beta1.dispose(),this.beta2.dispose(),this.accBeta1.dispose(),this.accBeta2.dispose(),this.oneMinusBeta1.dispose(),this.oneMinusBeta2.dispose(),this.one.dispose(),null!=this.accumulatedFirstMoment&&Object.keys(this.accumulatedFirstMoment).forEach(function(t){return e.accumulatedFirstMoment[t].dispose()}),null!=this.accumulatedSecondMoment&&Object.keys(this.accumulatedSecondMoment).forEach(function(t){return e.accumulatedSecondMoment[t].dispose()})},t}(l.Optimizer)},qZoT:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("xdLA"),o=n("gqjM"),s=n("JFC7"),u=n("zEzE"),l=n("Xq4m"),c=n("efV4"),d=n("OMxB"),h=n("8YQ1"),p=n("aIXu"),g=n("aIXu"),m=n("z89S"),v=n("S/bZ"),_=n("4FW+");function w(e,t){var n=e.fieldDef(t),u=e.legend(t),d=new m.LegendComponent({},function(e,t){switch(t){case r.COLOR:var n=e.scaleName(r.COLOR);return e.markDef.filled?{fill:n}:{stroke:n};case r.FILL:case r.STROKE:case r.SIZE:case r.SHAPE:case r.OPACITY:return(o={})[t]=e.scaleName(t),o}var o}(e,t));s.LEGEND_PROPERTIES.forEach(function(n){var value=function(e,t,n,r){var s=r.fieldDef(n);switch(e){case"format":return c.numberFormat(s,t.format,r.config);case"title":return c.getSpecifiedOrDefaultValue(t.title||(void 0===t.title?void 0:null),o.title(s,r.config))||void 0;case"values":return _.values(t);case"type":return c.getSpecifiedOrDefaultValue(t.type,_.type(s.type,n,r.getScaleComponent(n).get("type")))}return t[e]}(n,u,t,e);if(void 0!==value){var r="values"===n?!!u.values:value===u[n];(r||void 0===e.config.legend[n])&&d.set(n,value,r)}});var h=u.encoding||{},p=["labels","legend","title","symbols","gradient"].reduce(function(r,o){var value=v[o]?v[o](n,h[o],e,t,d.get("type")):h[o];return void 0!==value&&l.keys(value).length>0&&(r[o]={update:value}),r},{});return l.keys(p).length>0&&d.set("encode",p,!!u.encoding),d}function E(e,t){if(!e)return t.clone();var n=e.getWithExplicit("orient"),r=t.getWithExplicit("orient");if(!n.explicit||!r.explicit||n.value===r.value){for(var o=!1,u=function(n){var r=g.mergeValuesWithExplicit(e.getWithExplicit(n),t.getWithExplicit(n),n,"legend",function(e,t){switch(n){case"title":return c.titleMerger(e,t);case"type":return o=!0,p.makeImplicit("symbol")}return g.defaultTieBreaker(e,t,n,"legend")});e.setWithExplicit(n,r)},d=0,h=s.VG_LEGEND_PROPERTIES;d<h.length;d++)u(h[d]);return o&&(((e.implicit||{}).encode||{}).gradient&&l.deleteNestedProperty(e.implicit,["encode","gradient"]),((e.explicit||{}).encode||{}).gradient&&l.deleteNestedProperty(e.explicit,["encode","gradient"])),e}}t.parseLegend=function e(t){t.component.legends=d.isUnitModel(t)?function(e){var t=e.encoding;return[r.COLOR,r.FILL,r.STROKE,r.SIZE,r.SHAPE,r.OPACITY].reduce(function(n,s){var l=t[s];return!e.legend(s)||!e.getScaleComponent(s)||o.isFieldDef(l)&&s===r.SHAPE&&l.type===u.GEOJSON||(n[s]=w(e,s)),n},{})}(t):function(t){for(var n=t.component,r=n.legends,o=n.resolve,s=function(n){e(n),l.keys(n.component.legends).forEach(function(e){o.legend[e]=h.parseGuideResolve(t.component.resolve,e),"shared"===o.legend[e]&&(r[e]=E(r[e],n.component.legends[e]),r[e]||(o.legend[e]="independent",delete r[e]))})},u=0,c=t.children;u<c.length;u++)s(c[u]);return l.keys(r).forEach(function(e){for(var n=0,r=t.children;n<r.length;n++){var s=r[n];s.component.legends[e]&&"shared"===o.legend[e]&&delete s.component.legends[e]}}),r}(t)},t.parseLegendForChannel=w,t.mergeLegendComponent=E},qmZh:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("JV7f"),o=n("JV7f"),s=n("5WUj"),u=n("e/LB"),l=n("yJL4"),c=n("mFTl"),d=n("np2E"),h=n("KB5b"),p=n("vurQ"),g=n("vurQ"),m="webgl",v=c.DType.float32;t.setBackend=function(e){r.setBackend(e),m=e,function(){for(var e in _)for(var t in _[e])_[e][t].dispose(),delete _[e][t]}()},t.getBackend=function(){return m},t.keep=function(x){return r.keep(x)};var _={float32:{},int32:{}};function w(value,e){return void 0===e&&(e=v),null==_[e][value]&&(_[e][value]=o.scalar(value,e),r.keep(_[e][value])),_[e][value]}function E(x){return x.shape}function O(x){return x.shape.length}function S(x,e){if(null==e)return e;var t=E(x);return Array.isArray(e)?e.map(function(e){return d.pyNormalizeArrayIndex(t,e)}):d.pyNormalizeArrayIndex(t,e)}function A(x,e){return x.reshape(e)}function T(x,e){return r.transpose(x,e)}function N(x,e){return r.reverse(x,e)}function M(x,e){void 0===e&&(e=-1);var t=E(x).slice();return e<0&&(e=t.length+e+1),t.splice(e,0,1),A(x,t)}function C(x){return A(x,[h.arrayProd(x.shape)])}function D(e,t,n){switch(e.rank){case 1:return r.slice1d(e,t,n);case 2:return r.slice2d(e,[t,0],[n,e.shape[1]]);case 3:return r.slice3d(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return r.slice4d(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);default:throw new l.ValueError("sliceAlongFirstAxis() received an unsupported subtype of Tensor: "+e.constructor.name)}}function R(a,b){switch(a.rank){case 1:return r.concat1d([a,b]);case 2:return r.concat2d([a,b],0);case 3:return r.concat3d([a,b],0);case 4:return r.concat4d([a,b],0);default:throw new l.ValueError("concatAlongFirstAxis() received an unsupported subtype of Tensor: "+a.constructor.name)}}function I(x,e){if(Array.isArray(e)||(e=[e]),O(x)!==e.length)throw new l.ValueError("The length of input n ("+e.length+") does not match the number of dimensions in input x ("+O(x)+")");return r.tile(x,e)}function P(e,t){return r.zeros(e)}function L(e,t,n){for(var r=[],i=0;i<e;++i)for(var j=0;j<e;++j)r.push(i===j?1:0);return o.tensor2d(r,[e,e])}function z(x){return r.neg(x)}function F(x,y){return r.add(x,y)}function U(x,y){return r.sub(x,y)}function B(x,y){return r.mul(x,y)}function V(x,y){return r.div(x,y)}function q(e,x){return r.mul(e,x)}function G(e,x){return r.add(e,x)}function W(e,t,n,o,s){return r.randomUniform(e,t,n)}function H(e,t,n,o,s){return void 0===t&&(t=0),void 0===n&&(n=1),r.truncatedNormal(e,t,n)}function X(e,t,n,o,s){if(void 0===t&&(t=0),void 0===n&&(n=1),o===c.DType.bool)throw new l.NotImplementedError("randomNormal does not support dType bool.");return r.randomNormal(e,t,n,o===c.DType.float32?"float32":"int32",s)}function Y(x){var e=o.zerosLike(x),t=o.onesLike(x);return o.where($(x,e),e,o.where(greater(x,o.zerosLike(x)),t,q(w(-1),t)))}function sum(x,e,t){return r.sum(x,e,t)}function K(x){return r.mulStrict(x,x)}function J(x){return r.sqrt(x)}function Z(x){return r.log(x)}function Q(x,e,t){return r.clipByValue(x,e,t)}function $(x,y){return r.equal(x,y)}function greater(x,y){return r.greater(x,y)}function ee(x,y){return r.maximum(x,y)}function te(x,e,t){if(null==t&&(t=g.imageDataFormat()),u.checkDataFormat(t),1!==O(e)&&O(e)!==O(x))throw new l.ValueError("Unexpected bias dimensions: "+O(e)+"; expected it to be 1 or "+O(x));var y,n=e.shape;if(5===O(x))"channelsFirst"===t?y=x.add(e.reshape(1===n.length?[1,n[0],1,1,1]:[1,n[3],n[0],n[1],n[2]])):"channelsLast"===t&&(y=x.add(e.reshape(1===n.length?[1,1,1,1,n[0]]:[1].concat(n))));else if(4===O(x))"channelsFirst"===t?y=x.add(e.reshape(1===n.length?[1,n[0],1,1]:[1,n[2],n[0],n[1]])):"channelsLast"===t&&(y=x.add(e.reshape(1===n.length?[1,1,1,n[0]]:[1].concat(n))));else if(3===O(x))"channelsFirst"===t?y=x.add(e.reshape(1===n.length?[1,n[0],1]:[1,n[1],n[0]])):"channelsLast"===t&&(y=x.add(e.reshape(1===n.length?[1,1,n[0]]:[1].concat(n))));else{if(!(O(x)<3))throw new l.ValueError("Unsupported input rank by biasAdd: "+O(x));y=x.add(e)}return y}function ne(x,e){return u.checkDataFormat(e),"channelsFirst"===e?r.transpose(x,[0,2,3,1]):x}function re(x,e,t,n,o,s,c){if(void 0===n&&(n=1),void 0===o&&(o="valid"),void 0===c&&(c=1),null==s&&(s=g.imageDataFormat()),u.checkDataFormat(s),1!==c)throw new l.NotImplementedError("dilationRate = "+c+" is not implemented for 1D convolution yet.");if(3!==x.shape.length)throw new l.ValueError("The input of a conv1dWithBias operation should be 3, but is "+x.shape.length+" instead.");if(3!==e.shape.length)throw new l.ValueError("The kernel for a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead");if(null!=t&&1!==t.shape.length)throw new l.ValueError("The bias for a conv1dWithBias operation should be 1, but is "+e.shape.length+" instead");if("channelsFirst"===s&&(x=T(x,[0,2,1])),"casual"===o)throw new l.NotImplementedError("The support for CASUAL padding mode in conv1dWithBias is not implemented yet.");var y=r.conv1d(x,e,n,"same"===o?"same":"valid");return null!=t&&(y=te(y,t)),y}function ie(x,e,t,n,o,s,c){if(void 0===n&&(n=[1,1]),void 0===o&&(o="valid"),null==s&&(s=g.imageDataFormat()),u.checkDataFormat(s),null!=c)throw new l.NotImplementedError("Support for non-default dilation rate is not implemented yet.");if(3!==O(x)&&4!==O(x))throw new l.ValueError("conv2dWithBias expects input to be of rank 3 or 4, but received "+O(x)+".");if(3!==O(e)&&4!==O(e))throw new l.ValueError("conv2dWithBias expects kernel to be of rank 3 or 4, but received "+O(x)+".");var y=ne(x,s);if("casual"===o)throw new l.NotImplementedError("The support for CASUAL padding mode in conv1dWithBias is not implemented yet.");return y=r.conv2d(y,e,n,"same"===o?"same":"valid"),null!=t&&(y=te(y,t)),"channelsFirst"===s&&(y=r.transpose(y,[0,3,1,2])),y}t.getScalar=w,t.epsilon=p.epsilon,t.isBackendSymbolic=function(){return!1},t.shape=E,t.intShape=function(x){return x.shape},t.ndim=O,t.dtype=function(x){return x instanceof o.Tensor?v:x.dtype},t.normalizeAxis=S,t.countParams=function(x){var e=x.shape;return e.length>0?e.reduce(function(a,b){return a*b}):1},t.cast=function(x,e){return x.asType(e)},t.reshape=A,t.transpose=T,t.permuteDimensions=T,t.reverse=N,t.expandDims=M,t.squeeze=function(x,e){return r.squeeze(x,[e])},t.temporalPadding=function(x,e){if(3!==O(x))throw new l.ValueError("temporalPadding expects input tensor to be 3-D, but received a "+O(x)+"-D tensor.");if(null==e&&(e=[1,1]),2!==e.length)throw new l.ValueError("temporalPadding expects input padding pattern to be a length-2 array, but received a length-"+e.length+" array.");return r.pad(x,[[0,0],e,[0,0]])},t.spatial2dPadding=function(x,e,t){if(4!==O(x))throw new l.ValueError("temporalPadding expects input tensor to be 4-D, but received a "+O(x)+"-D tensor.");if(null==e&&(e=[[1,1],[1,1]]),2!==e.length||2!==e[0].length||2!==e[1].length)throw new l.ValueError("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==t&&(t=g.imageDataFormat()),"channelsLast"!==t&&"channelsFirst"!==t)throw new l.ValueError("Unknown data format: "+t+". Supported data formats are 'channelsLast' and 'channelsFirst.");return r.pad(x,"channelsFirst"===t?[[0,0],[0,0],e[0],e[1]]:[[0,0],e[0],e[1],[0,0]])},t.repeat=function(x,e){if(2!==x.shape.length)throw new l.ValueError("repeat() expects a rank-2 tensor, but received a rank-"+x.shape.length+" tensor.");return I(M(x,1),[1,e,1])},t.flatten=C,t.batchFlatten=function(x){if(O(x)<=1)throw new l.ValueError("batchFlatten requires a minimum rank of 2. Got rank: "+O(x)+".");return A(x,[x.shape[0],h.arrayProd(x.shape,1)])},t.sliceAlongFirstAxis=D,t.sliceAlongLastAxis=function(e,t,n){switch(e.rank){case 1:return r.slice1d(e,t,n);case 2:return r.slice2d(e,[0,t],[e.shape[0],n]);case 3:return r.slice3d(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return r.slice4d(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new l.ValueError("sliceAlongLastAxis() received an unsupported subtype of Tensor: "+e.constructor.name)}},t.concatenate=function(e,t){var n;return void 0===t&&(t=-1),t<0&&(t=0!==(n=O(e[0]))?n:0),t===O(e[0])&&(t=-1),r.concat(e,t)},t.concatAlongFirstAxis=R,t.tile=I,t.variable=function(x,e,t,n){return new c.LayerVariable(x,e,t,!0,n)},t.batchGetValue=function(e){return e.map(function(x){return x.read()})},t.batchSetValue=function(e){e.map(function(e){e[0].write(e[1])})},t.zeros=P,t.zerosVariable=function(e,t,n){return new c.LayerVariable(P(e),t,n)},t.zerosLike=function(x,e,t){return new c.LayerVariable(r.zerosLike(x),e,t)},t.ones=function(e,t){return r.ones(e)},t.onesVariable=function(e,t,n){var o=r.ones(e);return new c.LayerVariable(o,t,n)},t.onesLike=function(x,e,t){var n=r.onesLike(x);return new c.LayerVariable(n,e,t)},t.identity=function(x){return x.clone()},t.eye=L,t.eyeVariable=function(e,t,n){return new c.LayerVariable(L(e),t,n)},t.neg=z,t.add=F,t.subtract=U,t.multiply=B,t.divide=V,t.scalarTimesArray=q,t.scalarPlusArray=G,t.randomUniform=W,t.randomUniformVariable=function(e,t,n,r,o,s){return void 0===s&&(s="randomUniform"),new c.LayerVariable(W(e,t,n),r,s)},t.truncatedNormal=H,t.truncatedNormalVariable=function(e,t,n,r,o,s){return void 0===t&&(t=0),void 0===n&&(n=1),void 0===s&&(s="truncatedNormal"),new c.LayerVariable(H(e,t,n),r,s)},t.randomNormal=X,t.randomNormalVariable=function(e,t,n,r,o,s){return void 0===t&&(t=0),void 0===n&&(n=1),void 0===s&&(s="randomNormal"),new c.LayerVariable(X(e,t,n,r,o),r,s)},t.update=function(x,e){return x.write(e)},t.updateAdd=function(x,e){return x.write(r.add(x.read(),e))},t.updateSub=function(x,e){return x.write(r.sub(x.read(),e))},t.dot=function(x,y){if(2!==O(y))throw new l.NotImplementedError("dot support for y other than rank 2 is not yet implemented: y shape = "+E);if(2===O(x))return r.matMul(x,y);if(3===O(x)){var e=x.shape[0],t=x.shape[1];return x=x.reshape([e*t,x.shape[2]]),r.matMul(x,y).reshape([e,t,y.shape[1]])}throw new l.NotImplementedError("dot support for x of rank "+O(x)+" is not yet implemented: x shape = "+E)},t.sign=Y,t.qr=function(x){if(2!==x.shape.length)throw new l.ValueError("qr() requires a 2D Tensor, but got a "+x.shape.length+"D Tensor.");if(x.shape[0]<x.shape[1])throw new l.ValueError("qr() requires x.shape[0] >= x.shape[1], but got shape: ["+x.shape+"]");for(var e=x.shape[0],t=x.shape[1],n=L(e),s=x,u=o.tensor2d([[1]],[1,1]),j=0;j<t;++j){var c=s.slice([j,j],[e-j,1]),d=r.norm(c),h=s.slice([j,j],[1,1]),p=r.neg(Y(h)),g=h.sub(B(p,d)),m=V(c,g),v=void 0;v=1===m.shape[0]?u:u.concat(m.slice([1,0],[m.shape[0]-1,m.shape[1]]),0);var _=r.neg(V(r.matMul(p,g),d)),w=s.slice([j,0],[e-j,t]),E=_.mul(v);s=0===j?w.sub(E.matMul(v.transpose().matMul(w))):s.slice([0,0],[j,t]).concat(w.sub(E.matMul(v.transpose().matMul(w))),0);var O=n.slice([0,j],[e,n.shape[1]-j]);n=0===j?O.sub(O.matMul(v).matMul(E.transpose())):n.slice([0,0],[e,j]).concat(O.sub(O.matMul(v).matMul(E.transpose())),1)}return[n,s]},t.oneHot=function(e,t){if(1!==O(e))throw new Error("Only 1D one-hot tensors are supported in the deeplearn backend, at present.");return r.oneHot(e,t)},t.mean=function(x,e,t){return e=S(x,e),r.mean(x,e,t)},t.argmax=function(x,e){return void 0===e&&(e=-1),r.argMax(x,e)},t.gather=function(e,t,n){return Array.isArray(t)&&(t=o.tensor1d(t)),r.gather(e,t,n)},t.max=function(x,e,t){return r.max(x,e,t)},t.min=function(x,e,t){return r.min(x,e,t)},t.minimum=function(x,y){return r.minimum(x,y)},t.sum=sum,t.abs=function(x){return r.abs(x)},t.square=K,t.sqrt=J,t.exp=function(x){return r.exp(x)},t.log=Z,t.pow=function(x,a){if("number"==typeof a&&(a=o.scalar(Math.round(a),"int32")),"int32"!==a.dtype)throw new l.NotImplementedError("Non-int32 dtype ("+a.dtype+") is not supported by pow() yet");return r.pow(x,a)},t.clip=Q,t.equal=$,t.greater=greater,t.greaterEqual=function(x,y){return r.greaterEqual(x,y)},t.maximum=ee,t.sin=function(x){return r.sin(x.value())},t.cos=function(x){return r.cos(x.value())},t.batchNormalization=function(x,e,t,n,o,s){var u;if(void 0===s&&(s=.001),2===O(x))u=r.batchNormalization2d(x,e,t,s);else if(3===O(x))u=r.batchNormalization3d(x,e,t,s);else{if(4!==O(x))throw new l.NotImplementedError("batchNormalization is not implememnted for array of rank "+O(x)+" yet");u=r.batchNormalization4d(x,e,t,s)}return null!=o&&(u=B(u,o)),null!=n&&(u=F(u,n)),u},t.biasAdd=te,t.elu=function(x,e){if(void 0===e&&(e=1),1!==e)throw new l.NotImplementedError("Support for alpha values other than 1 ("+e+") is not implemented yet.");return r.elu(x)},t.selu=function(x){return r.selu(x)},t.relu=function(x){return r.relu(x)},t.softplus=function(x){return r.log(r.add(w(1),r.exp(x)))},t.softsign=function(x){return r.div(x,r.add(w(1),r.abs(x)))},t.tanh=function(x){return r.tanh(x)},t.dropout=function(x,e,t,n){if(null!=t&&!s.isEqual(x.shape,t))throw new l.NotImplementedError("Non-default noise shape is not implemented yet: "+JSON.stringify(t));if(null!=n)throw new l.NotImplementedError("seed is not implemented for dropout yet.");var o=r.step(r.add(z(e),W(x.shape,0,1)));return o=r.mul(V(w(1),U(w(1),e)),o),r.mul(x,o)},t.l2Normalize=function(x,e){return V(x,J(ee(sum(K(x),e,!0),q(o.scalar(t.epsilon()),r.onesLike(x)))))},t.conv1dWithBias=re,t.conv1d=function(x,e,t,n,r,o){return void 0===t&&(t=1),void 0===n&&(n="valid"),void 0===o&&(o=1),u.checkDataFormat(r),re(x,e,null,t,n,r,o)},t.conv2d=function(x,e,t,n,r,o){return void 0===t&&(t=[1,1]),void 0===n&&(n="valid"),u.checkDataFormat(r),ie(x,e,null,t,n,r,o)},t.conv2dWithBias=ie,t.depthwiseConv2d=function(x,e,t,n,o,s){void 0===t&&(t=[1,1]),void 0===n&&(n="valid"),null==o&&(o=g.imageDataFormat()),u.checkDataFormat(o);var y=ne(x,o);if(4!==O(x))throw new l.ValueError("Input for depthwiseConv2d is required to be 4-D, but is instead "+O(x)+"-D");if(4!==O(e))throw new l.ValueError("depthwiseKernel is required to be 4-D, but is instead "+O(e)+"-D");return y=r.depthwiseConv2d(y,e,t,"same"===n?"same":"valid","NHWC",s),"channelsFirst"===o&&(y=r.transpose(y,[0,3,1,2])),y},t.pool2d=function(x,e,t,n,o,s){var y;u.checkDataFormat(o),u.checkPoolMode(s),u.checkPaddingMode(n),null==t&&(t=[1,1]),null==n&&(n="valid"),null==o&&(o=g.imageDataFormat()),null==s&&(s="max"),x=ne(x,o);var l="same"===n?"same":"valid";return y="max"===s?r.maxPool(x,e,t,l):r.avgPool(x,e,t,l),"channelsFirst"===o&&(y=r.transpose(y,[0,3,1,2])),y},t.nameScope=function(e,t){return u.nameScope(e,t)},t.floatx=function(){return c.DType.float32};var ae={};function oe(x,e){return void 0===e&&(e=-1),r.softmax(x,e)}function se(e,n,o){return void 0===o&&(o=!1),n=Q(n=o?oe(n):V(n,sum(n,E(n).length-1,!0)),t.epsilon(),1-t.epsilon()),r.neg(r.sum(r.mul(e,r.log(n)),E(n).length-1))}function ue(e,t){var n=r.maximum(t,r.zerosLike(t)),o=r.mul(t,e),s=r.log(r.add(w(1),r.exp(r.neg(r.abs(t)))));return r.add(r.sub(n,o),s)}t.getUid=function(e){return void 0===e&&(e=""),e in ae||(ae[e]=0),ae[e]+=1,e+ae[e].toString()},t.softmax=oe,t.categoricalCrossentropy=se,t.sparseCategoricalCrossentropy=function(e,t,n){void 0===n&&(n=!1);var o=r.floor(C(e)),s=E(t);return se(A(r.oneHot(o,s[s.length-1]),s),t,n)},t.binaryCrossentropy=function(e,n,o){var y;return void 0===o&&(o=!1),ue(e,y=o?n:Z(V(y=Q(n,t.epsilon(),1-t.epsilon()),U(r.onesLike(y),y))))},t.sigmoidCrossEntropyWithLogits=ue,t.sigmoid=function(x){return r.sigmoid(x)},t.hardSigmoid=function(x){return Q(G(o.scalar(.5),q(o.scalar(.2),x)),0,1)},t.inTrainPhase=function(x,e,t){return void 0===t&&(t=!1),t?x():e()},t.rnn=function(e,t,n,r,o,u,c,d){void 0===r&&(r=!1),void 0===c&&(c=!1);var h,p,g=t.shape.length;if(g<3)throw new l.ValueError("Input should be at least 3D, but is "+g+"D.");if(t=T(t,[1,0].concat(s.range(2,g))),null!=o)throw new l.NotImplementedError("The rnn() function of the deeplearn.js backend does not support masking yet.");if(null!=u)throw new l.NotImplementedError("The rnn() functoin of the deeplearn.js backend does not support constants yet.");c&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r&&(t=N(t,0));for(var m=n,v=t.shape[0],_=0;_<v;++_){var w=D(t,_,1),E=e(w=A(w,w.shape.slice(1)),m);p=E[0],h=0===_?p.reshape([1].concat(p.shape)):R(h,p.reshape([1].concat(p.shape))),m=E[1]}return[p,T(h,[1,0].concat(s.range(2,h.shape.length))),m]},t.gradients=function(e,t){var n=t.map(function(e){return e.read()}),r=o.variableGrads(e,n);return t.map(function(e){return r.grads[e.name]})}},r4me:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var s=n("Bsgt"),u=n("gqjM"),l=n("KMAE"),c=n("7AlL");function d(e,t){return u.isRepeatRef(e.field)?e.field.repeat in t?r({},e,{field:t[e.field.repeat]}):void l.warn(l.message.noSuchRepeatedValue(e.field.repeat)):e}function h(e,t){if(void 0!==(e=d(e,t))){if(e.sort&&c.isSortField(e.sort)){var n=d(e.sort,t);e=r({},e,n?{sort:n}:{})}return e}}function p(e,t){return u.isFieldDef(e)?(n=h(e,t))?n:u.isConditionalDef(e)?{condition:e.condition}:void 0:u.hasConditionalFieldDef(e)?(n=h(e.condition,t))?r({},e,{condition:n}):o(e,["condition"]):e;var n}function g(e,t){var n={};for(var r in e)if(e.hasOwnProperty(r)){var o=e[r];if(s.isArray(o))n[r]=o.map(function(e){return p(e,t)}).filter(function(e){return e});else{var u=p(o,t);u&&(n[r]=u)}}return n}t.replaceRepeaterInFacet=function(e,t){return g(e,t)},t.replaceRepeaterInEncoding=function(e,t){return g(e,t)}},rPAV:function(e,t,n){"use strict";var r=n("TToO").__extends,o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n("aIXu");t.ProjectionComponent=function(e){function t(t,n,r,s){var u=e.call(this,o({},n),{name:t})||this;return u.specifiedProjection=n,u.size=r,u.data=s,u.merged=!1,u}return r(t,e),t}(s.Split)},rd7I:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("/u4k");t.SliceProgram=function(){function e(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var t=r.getCoordsDataType(this.rank),n=function(e){if(1===e)return"sourceLoc";if(2===e)return"sourceLoc.x, sourceLoc.y";if(3===e)return"sourceLoc.x, sourceLoc.y, sourceLoc.z";if(4===e)return"sourceLoc.x, sourceLoc.y, sourceLoc.z, sourceLoc.w";throw Error("Slicing for rank "+e+" is not yet supported")}(this.rank);this.userCode="\n      uniform "+t+" start;\n\n      void main() {\n        "+t+" sourceLoc = start + getOutputCoords();\n        setOutput(getSource("+n+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){if(null!=t.startLoc||(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null!=t.startLoc))if(1===t.rank)n.gl.uniform1i(t.startLoc,e[0]);else if(2===t.rank)n.gl.uniform2i(t.startLoc,e[0],e[1]);else if(3===t.rank)n.gl.uniform3i(t.startLoc,e[0],e[1],e[2]);else{if(4!==t.rank)throw Error("Slicing for rank "+t.rank+" is not yet supported");n.gl.uniform4i(t.startLoc,e[0],e[1],e[2],e[3])}}},e}()},rxHH:function(e,t,n){"use strict";var r=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var o=n("Bsgt"),s=n("xdLA"),u=n("KMAE"),l=n("Xq4m");!function(e){e.LINEAR="linear",e.BIN_LINEAR="bin-linear",e.LOG="log",e.POW="pow",e.SQRT="sqrt",e.TIME="time",e.UTC="utc",e.SEQUENTIAL="sequential",e.QUANTILE="quantile",e.QUANTIZE="quantize",e.THRESHOLD="threshold",e.ORDINAL="ordinal",e.BIN_ORDINAL="bin-ordinal",e.POINT="point",e.BAND="band"}(t.ScaleType||(t.ScaleType={}));var c={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric","bin-linear":"bin-linear",time:"time",utc:"time",sequential:"sequential",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position"};t.SCALE_TYPES=l.keys(c),t.scaleCompatible=function(e,t){var n=c[e],r=c[t];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n};var d={linear:0,log:1,pow:1,sqrt:1,time:0,utc:0,point:10,band:11,"bin-linear":0,sequential:0,ordinal:0,"bin-ordinal":0};t.scaleTypePrecedence=function(e){return d[e]},t.CONTINUOUS_TO_CONTINUOUS_SCALES=["linear","bin-linear","log","pow","sqrt","time","utc"];var h=o.toSet(t.CONTINUOUS_TO_CONTINUOUS_SCALES);t.CONTINUOUS_DOMAIN_SCALES=t.CONTINUOUS_TO_CONTINUOUS_SCALES.concat(["sequential"]);var p=o.toSet(t.CONTINUOUS_DOMAIN_SCALES);t.DISCRETE_DOMAIN_SCALES=["ordinal","bin-ordinal","point","band"];var g=o.toSet(t.DISCRETE_DOMAIN_SCALES),m=o.toSet(["bin-linear","bin-ordinal"]);function v(e){return e in p}function _(e){return e in h}t.TIME_SCALE_TYPES=["time","utc"],t.hasDiscreteDomain=function(e){return e in g},t.isBinScale=function(e){return e in m},t.hasContinuousDomain=v,t.isContinuousToContinuous=_,t.defaultScaleConfig={textXRangeStep:90,rangeStep:21,pointPadding:.5,bandPaddingInner:.1,facetSpacing:16,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4},t.isExtendedScheme=function(e){return e&&!!e.name},t.isSelectionDomain=function(e){return e&&e.selection};var w={type:1,domain:1,range:1,rangeStep:1,scheme:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1};t.SCALE_PROPERTIES=l.flagKeys(w);var E=r(w,["type","domain","range","rangeStep","scheme"]);t.NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES=l.flagKeys(E),t.scaleTypeSupportProperty=function(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":return l.contains(["sequential","ordinal","bin-ordinal","quantile","quantize"],e);case"interpolate":return l.contains(["linear","bin-linear","pow","log","sqrt","utc","time"],e);case"round":return _(e)||"band"===e||"point"===e;case"padding":return _(e)||l.contains(["point","band"],e);case"paddingOuter":case"rangeStep":return l.contains(["point","band"],e);case"paddingInner":return"band"===e;case"clamp":return _(e)||"sequential"===e;case"nice":return _(e)||"sequential"===e||"quantize"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"zero":return v(e)&&!l.contains(["log","time","utc","bin-linear","threshold","quantile"],e)}throw new Error("Invalid scale property "+t+".")},t.channelScalePropertyIncompatability=function(e,t){switch(t){case"interpolate":case"scheme":return s.isColorChannel(e)?void 0:u.message.cannotUseScalePropertyWithNonColor(e);case"type":case"domain":case"range":case"base":case"exponent":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeStep":case"reverse":case"round":case"clamp":case"zero":return}throw new Error('Invalid scale property "'+t+'".')},t.channelSupportScaleType=function(e,t){switch(e){case s.Channel.X:case s.Channel.Y:case s.Channel.SIZE:case s.Channel.OPACITY:return _(t)||l.contains(["band","point"],t);case s.Channel.COLOR:case s.Channel.FILL:case s.Channel.STROKE:return"band"!==t;case s.Channel.SHAPE:return"ordinal"===t}return!1}},sHGH:function(e,t,n){"use strict";var r=n("TToO").__extends,o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n("KMAE"),u=n("ooBR"),l=n("Xq4m"),c=n("vprv"),d=n("4TaE"),h=n("9d0T"),p=n("ADrU"),g=n("3kMs"),m=n("OMxB"),v=n("kglw"),_=n("2+Ke");t.LayerModel=function(e){function t(n,r,l,c,d,h,p){var g=e.call(this,n,r,l,h,n.resolve)||this;g.type="layer";var m=o({},c,n.width?{width:n.width}:{},n.height?{height:n.height}:{});return g.initSize(m),g.children=n.layer.map(function(e,i){if(u.isLayerSpec(e))return new t(e,g,g.getName("layer_"+i),m,d,h,p);if(u.isUnitSpec(e))return new _.UnitModel(e,g,g.getName("layer_"+i),m,d,h,p);throw new Error(s.message.INVALID_SPEC)}),g}return r(t,e),t.prototype.parseData=function(){this.component.data=d.parseData(this);for(var e=0,t=this.children;e<t.length;e++)t[e].parseData()},t.prototype.parseLayoutSize=function(){p.parseLayerLayoutSize(this)},t.prototype.parseSelection=function(){var e=this;this.component.selection={};for(var t=function(t){t.parseSelection(),l.keys(t.component.selection).forEach(function(n){e.component.selection[n]=t.component.selection[n]})},n=0,r=this.children;n<r.length;n++)t(r[n])},t.prototype.parseMarkGroup=function(){for(var e=0,t=this.children;e<t.length;e++)t[e].parseMarkGroup()},t.prototype.parseAxisAndHeader=function(){c.parseLayerAxis(this)},t.prototype.assembleSelectionTopLevelSignals=function(e){return this.children.reduce(function(e,t){return t.assembleSelectionTopLevelSignals(e)},e)},t.prototype.assembleSelectionSignals=function(){return this.children.reduce(function(e,t){return e.concat(t.assembleSelectionSignals())},[])},t.prototype.assembleLayoutSignals=function(){return this.children.reduce(function(e,t){return e.concat(t.assembleLayoutSignals())},h.assembleLayoutSignals(this))},t.prototype.assembleSelectionData=function(e){return this.children.reduce(function(e,t){return t.assembleSelectionData(e)},e)},t.prototype.assembleTitle=function(){var t=e.prototype.assembleTitle.call(this);if(t)return t;for(var n=0,r=this.children;n<r.length;n++)if(t=r[n].assembleTitle())return t},t.prototype.assembleLayout=function(){return null},t.prototype.assembleMarks=function(){return v.assembleLayerSelectionMarks(this,l.flatten(this.children.map(function(e){return e.assembleMarks()})))},t.prototype.assembleLegends=function(){return this.children.reduce(function(e,t){return e.concat(t.assembleLegends())},g.assembleLegends(this))},t}(m.Model)},sOR5:function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},sruv:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("efV4"),s=n("dMOq"),u=n("KIOn");function l(e,t){var n=e.config,o=e.width,l=e.height;return r({},s.baseEncodeEntry(e,{size:"include",orient:"ignore"}),s.pointPosition("x",e,u.mid(o)),s.pointPosition("y",e,u.mid(l)),s.nonPosition("size",e),c(e,n,t))}function c(e,t,n){return n?{shape:{value:n}}:s.nonPosition("shape",e,{defaultValue:o.getMarkConfig("shape",e.markDef,t)})}t.shapeMixins=c,t.point={vgMark:"symbol",encodeEntry:function(e){return l(e)}},t.circle={vgMark:"symbol",encodeEntry:function(e){return l(e,"circle")}},t.square={vgMark:"symbol",encodeEntry:function(e){return l(e,"square")}}},t41L:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("v/P2"),u=n("XFvI");t.Tracking=function(){function e(){}return e.tidy=function(e,t,n){void 0===n&&(n=!1);var r=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}s.ENV.engine.startScope(r,n);var o=t();return o instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s.ENV.engine.endScope(o,n),o},e.dispose=function(e){u.extractTensorsFromAny(e).forEach(function(e){return e.dispose()})},e.keep=function(e){return s.ENV.engine.keep(e)},e.time=function(f){return s.ENV.engine.time(f)},r([o.doc({heading:"Performance",subheading:"Memory"})],e,"tidy",null),r([o.doc({heading:"Performance",subheading:"Memory"})],e,"keep",null),r([o.doc({heading:"Performance",subheading:"Timing"})],e,"time",null),e}()},tDz0:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("xdLA"),o=n("gqjM"),s=n("D6ZG"),u=n("rxHH"),l=n("zEzE"),c=n("Xq4m"),d=n("OMxB"),h=n("8YQ1"),p=n("aIXu"),g=n("3zuq"),m=n("GH2X"),v=n("dFdk"),_=n("a/7e"),w=n("wE+S");function E(e){e.component.scales=d.isUnitModel(e)?function(e){var t=e.encoding,n=e.config,u=e.mark();return r.SCALE_CHANNELS.reduce(function(c,d){var h,p=void 0,m=t[d];if(o.isFieldDef(m)&&u===s.GEOSHAPE&&d===r.SHAPE&&m.type===l.GEOJSON)return c;if(o.isFieldDef(m)?(h=m,p=m.scale):o.hasConditionalFieldDef(m)?(h=m.condition,p=m.condition.scale):d===r.X?h=o.getFieldDef(t.x2):d===r.Y&&(h=o.getFieldDef(t.y2)),h&&null!==p&&!1!==p){var v=(p=p||{}).type,_=w.scaleType(p.type,d,h,u,n.scale);c[d]=new g.ScaleComponent(e.scaleName(d+"",!0),{value:_,explicit:v===_})}return c},{})}(e):function(e){for(var t=e.component.scales={},n={},r=e.component.resolve,o=function(t){E(t),c.keys(t.component.scales).forEach(function(o){if(r.scale[o]=r.scale[o]||h.defaultScaleResolve(o,e),"shared"===r.scale[o]){var s=n[o],l=t.component.scales[o].getWithExplicit("type");s?u.scaleCompatible(s.value,l.value)?n[o]=p.mergeValuesWithExplicit(s,l,"type","scale",O):(r.scale[o]="independent",delete n[o]):n[o]=l}})},s=0,l=e.children;s<l.length;s++)o(l[s]);return c.keys(n).forEach(function(r){var o=e.scaleName(r,!0);t[r]=new g.ScaleComponent(o,n[r]);for(var s=0,u=e.children;s<u.length;s++){var l=u[s],c=l.component.scales[r];c&&(l.renameScale(c.get("name"),o),c.merged=!0)}}),t}(e)}t.parseScale=function(e){E(e),m.parseScaleDomain(e);for(var t=0,n=u.NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES;t<n.length;t++)v.parseScaleProperty(e,n[t]);_.parseScaleRange(e)},t.parseScaleCore=E;var O=p.tieBreakByComparing(function(e,t){return u.scaleTypePrecedence(e)-u.scaleTypePrecedence(t)})},tn2z:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("Bsgt"),s=n("8Wnz"),u=n("utsZ"),l=n("gqjM"),c=n("D6ZG"),d=n("7AlL"),h=n("Xq4m"),p=n("efV4"),g=n("VUgH"),m=n("+zlj"),v=n("G/mX"),_=n("p/aw"),w=n("sruv"),E=n("y72d"),O=n("TBqz"),S=n("VYUM"),A=n("Zjkm"),T={area:g.area,bar:m.bar,line:_.line,point:w.point,text:S.text,tick:A.tick,rect:E.rect,rule:O.rule,circle:w.circle,square:w.square,geoshape:v.geoshape};t.parseMarkGroup=function(e){return h.contains([c.LINE,c.AREA],e.mark())?function(e){var t=D(e.encoding),n=C(e,{fromPrefix:t.length>0?N:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:N+e.requestDataName(s.MAIN),data:e.requestDataName(s.MAIN),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}(e):C(e)};var N="faceted_path_";function M(e){if(e.channelHasField("order")&&!e.stack)return p.sortParams(e.encoding.order,{expr:"datum"});if(h.contains(["line","area"],e.mark())){var t="horizontal"===e.markDef.orient?"y":"x",n=e.sort(t),r=d.isSortField(n)?l.vgField({aggregate:u.isAggregate(e.encoding)?n.op:void 0,field:n.field},{expr:"datum"}):e.vgField(t,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"});return r?{field:r,order:"descending"}:void 0}}function C(e,t){void 0===t&&(t={fromPrefix:""});var n=e.mark(),o=void 0!==e.markDef.clip?!!e.markDef.clip:function(e){var t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return!!(t&&t.get("domainRaw")||n&&n.get("domainRaw"))}(e),u=p.getStyles(e.markDef),l=e.encoding.key,c=M(e),d=T[n].postEncodingTransform?T[n].postEncodingTransform(e):null;return[r({name:e.getName("marks"),type:T[n].vgMark},o?{clip:!0}:{},u?{style:u}:{},l?{key:{field:l.field}}:{},c?{sort:c}:{},{from:{data:t.fromPrefix+e.requestDataName(s.MAIN)},encode:{update:T[n].encodeEntry(e)}},d?{transform:d}:{})]}function D(e){return h.keys(e).reduce(function(t,n){switch(n){case"x":case"y":case"order":case"tooltip":case"href":case"x2":case"y2":case"latitude":case"longitude":case"latitude2":case"longitude2":case"text":case"shape":return t;case"detail":case"key":var r=e[n];return r&&(o.isArray(r)?r:[r]).forEach(function(e){e.aggregate||t.push(l.vgField(e,{}))}),t;case"color":case"fill":case"stroke":case"size":case"opacity":var s=l.getFieldDef(e[n]);return s&&!s.aggregate&&t.push(l.vgField(s,{})),t;default:throw new Error("Bug: Channel "+n+" unimplemented for line mark")}},[])}t.getSort=M,t.pathGroupingFields=D},u9Pu:function(e,t,n){var r,o;void 0===(o="function"==typeof(r=function(){var e=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,t=/-([0-9A-Za-z-.]+)/;function n(e){var t=e.replace(/^v/,"").split("."),n=t.splice(0,2);return n.push(t.join(".")),n}function r(e){return isNaN(Number(e))?e:Number(e)}function o(t){if("string"!=typeof t)throw new TypeError("Invalid argument expected string");if(!e.test(t))throw new Error("Invalid argument not valid semver")}return function(e,s){[e,s].forEach(o);for(var u=n(e),l=n(s),i=0;i<3;i++){var c=parseInt(u[i]||0,10),d=parseInt(l[i]||0,10);if(c>d)return 1;if(d>c)return-1}if([u[2],l[2]].every(t.test.bind(t))){var h=t.exec(u[2])[1].split(".").map(r),p=t.exec(l[2])[1].split(".").map(r);for(i=0;i<Math.max(h.length,p.length);i++){if(void 0===h[i]||"string"==typeof p[i]&&"number"==typeof h[i])return-1;if(void 0===p[i]||"string"==typeof h[i]&&"number"==typeof p[i])return 1;if(h[i]>p[i])return 1;if(p[i]>h[i])return-1}}else if([u[2],l[2]].some(t.test.bind(t)))return t.test(u[2])?-1:1;return 0}})?r.apply(t,[]):r)||(e.exports=o)},ujcs:function(e,t){t.read=function(e,t,n,r,o){var s,u,l=8*o-r-1,c=(1<<l)-1,d=c>>1,h=-7,i=n?o-1:0,p=n?-1:1,g=e[t+i];for(i+=p,s=g&(1<<-h)-1,g>>=-h,h+=l;h>0;s=256*s+e[t+i],i+=p,h-=8);for(u=s&(1<<-h)-1,s>>=-h,h+=r;h>0;u=256*u+e[t+i],i+=p,h-=8);if(0===s)s=1-d;else{if(s===c)return u?NaN:1/0*(g?-1:1);u+=Math.pow(2,r),s-=d}return(g?-1:1)*u*Math.pow(2,s-r)},t.write=function(e,value,t,n,r,o){var s,u,l,c=8*o-r-1,d=(1<<c)-1,h=d>>1,p=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,i=n?0:o-1,g=n?1:-1,m=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(u=isNaN(value)?1:0,s=d):(s=Math.floor(Math.log(value)/Math.LN2),value*(l=Math.pow(2,-s))<1&&(s--,l*=2),(value+=s+h>=1?p/l:p*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=d?(u=0,s=d):s+h>=1?(u=(value*l-1)*Math.pow(2,r),s+=h):(u=value*Math.pow(2,h-1)*Math.pow(2,r),s=0));r>=8;e[t+i]=255&u,i+=g,u/=256,r-=8);for(s=s<<r|u,c+=r;c>0;e[t+i]=255&s,i+=g,s/=256,c-=8);e[t+i-g]|=128*m}},utsZ:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var s=n("Bsgt"),u=n("xdLA"),l=n("gqjM"),c=n("KMAE"),d=n("zEzE"),h=n("Xq4m");function p(e,t){var n=e&&e[t];return!!n&&(s.isArray(n)?h.some(n,function(e){return!!e.field}):l.isFieldDef(n)||l.hasConditionalFieldDef(n))}t.channelHasField=p,t.isAggregate=function(e){return h.some(u.CHANNELS,function(t){if(p(e,t)){var n=e[t];if(s.isArray(n))return h.some(n,function(e){return!!e.aggregate});var r=l.getFieldDef(n);return r&&!!r.aggregate}return!1})},t.normalizeEncoding=function(e,t){return h.keys(e).reduce(function(n,p){if(!u.isChannel(p))return c.warn(c.message.invalidEncodingChannel(p)),n;if(!u.supportMark(p,t))return c.warn(c.message.incompatibleChannel(p,t)),n;var g;if("size"===p&&"line"===t&&(m=l.getFieldDef(e[p]))&&m.aggregate)return c.warn(c.message.incompatibleChannel(p,t,"when the field is aggregated.")),n;if("detail"===p||"order"===p)(v=e[p])&&(n[p]=(s.isArray(v)?v:[v]).reduce(function(e,t){return l.isFieldDef(t)?e.push(l.normalizeFieldDef(t,p)):c.warn(c.message.emptyFieldDef(t,p)),e},[]));else{var m,v=e[p];if((m=l.getFieldDef(e[p]))&&h.contains([d.Type.LATITUDE,d.Type.LONGITUDE],m.type)){var _=o(n,["symbol"==typeof p?p:p+""]),w="x"===p?"longitude":"y"===p?"latitude":"x2"===p?"longitude2":"y2"===p?"latitude2":void 0;return c.warn(c.message.latLongDeprecated(p,m.type,w)),r({},_,((g={})[w]=r({},l.normalize(m,p),{type:"quantitative"}),g))}if(!l.isFieldDef(v)&&!l.isValueDef(v)&&!l.isConditionalDef(v))return c.warn(c.message.emptyFieldDef(v,p)),n;n[p]=l.normalize(v,p)}return n},{})},t.isRanged=function(e){return e&&(!!e.x&&!!e.x2||!!e.y&&!!e.y2)},t.fieldDefs=function(e){var t=[];return u.CHANNELS.forEach(function(n){if(p(e,n)){var r=e[n];(s.isArray(r)?r:[r]).forEach(function(e){l.isFieldDef(e)?t.push(e):l.hasConditionalFieldDef(e)&&t.push(e.condition)})}}),t},t.forEach=function(e,f,t){if(e)for(var n=function(n){s.isArray(e[n])?e[n].forEach(function(e){f.call(t,e,n)}):f.call(t,e[n],n)},r=0,o=h.keys(e);r<o.length;r++)n(o[r])},t.reduce=function(e,f,t,n){return e?h.keys(e).reduce(function(t,r){var o=e[r];return s.isArray(o)?o.reduce(function(e,t){return f.call(n,e,t,r)},t):f.call(n,t,o,r)},t):t}},"v/P2":function(e,t,n){"use strict";(function(e){var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o,s=n("kESI"),u=n("w3wY"),l=n("Kkag"),c=n("XFvI");function d(e,t){return null!=e.getExtension(t)}function h(e){if(0===e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=document.createElement("canvas");return 1===e?t.getContext("webgl")||t.getContext("experimental-webgl"):t.getContext("webgl2")}function p(e){if(null!=e){var t=e.getExtension("WEBGL_lose_context");if(null==t)throw new Error("Extension WEBGL_lose_context not supported on this browser.");t.loseContext()}}function g(e){var t=h(e);return null!=t&&(p(t),!0)}!function(e){e[e.NUMBER=0]="NUMBER",e[e.BOOLEAN=1]="BOOLEAN",e[e.STRING=2]="STRING"}(o=t.Type||(t.Type={})),t.URL_PROPERTIES=[{name:"DEBUG",type:o.BOOLEAN},{name:"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",type:o.NUMBER},{name:"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",type:o.BOOLEAN},{name:"WEBGL_VERSION",type:o.NUMBER},{name:"WEBGL_FLOAT_TEXTURE_ENABLED",type:o.BOOLEAN},{name:"WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED",type:o.BOOLEAN},{name:"BACKEND",type:o.STRING}];var m=["webgl","cpu"],v=function(){function e(e){this.features={},this.BACKEND_REGISTRY={},this.backends=this.BACKEND_REGISTRY,null!=e&&(this.features=e),this.get("DEBUG")&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}return e.setBackend=function(e,n){if(void 0===n&&(n=!1),!(e in t.ENV.backends))throw new Error("Backend type '"+e+"' not found in registry");t.ENV.initBackend(e,n)},e.getBackend=function(){return t.ENV.initDefaultBackend(),t.ENV.currentBackendType},e.memory=function(){return t.ENV.engine.memory()},e.prototype.get=function(e){return e in this.features?this.features[e]:(this.features[e]=this.evaluateFeature(e),this.features[e])},e.prototype.set=function(e,value){this.features[e]=value},e.prototype.getBestBackendType=function(){for(var i=0;i<m.length;++i){var e=m[i];if(e in this.backends)return e}throw new Error("No backend found in registry.")},e.prototype.evaluateFeature=function(e){if("DEBUG"===e)return!1;if("BACKEND"===e)return this.getBestBackendType();if("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"===e){var t=this.get("WEBGL_VERSION");return 0===t?0:function(e){if(0===e)return 0;var t,n=h(e);return t=d(n,"EXT_disjoint_timer_query_webgl2")&&2===e?2:d(n,"EXT_disjoint_timer_query")?1:0,null!=n&&p(n),t}(t)}if("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE"===e)return this.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!s.isMobile();if("WEBGL_VERSION"===e)return g(2)?2:g(1)?1:0;if("WEBGL_FLOAT_TEXTURE_ENABLED"===e)return function(e){if(0===e)return!1;var t=h(e);if(1===e){if(!d(t,"OES_texture_float"))return!1}else if(!d(t,"EXT_color_buffer_float"))return!1;var n=t.createFramebuffer(),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,2===e?t.RGBA32F:t.RGBA,1,1,0,t.RGBA,t.FLOAT,null),t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;t.readPixels(0,0,1,1,t.RGBA,t.FLOAT,new Float32Array(4));var s=t.getError()===t.NO_ERROR;return p(t),o&&s}(this.get("WEBGL_VERSION"));if("WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED"===e)return function(e){if(e>0)return!1;if(2!==e)return!1;var t=h(e),n=d(t,"WEBGL_get_buffer_sub_data_async");return p(t),n}(this.get("WEBGL_VERSION"));throw new Error("Unknown feature "+e+".")},e.prototype.setFeatures=function(e){this.reset(),this.features=e,this.backends={}},e.prototype.reset=function(){if(this.features=E(),null!=this.globalEngine&&(this.globalEngine.dispose(),this.globalEngine=null),this.backends!==this.BACKEND_REGISTRY){for(var e in this.backends)this.backends[e].dispose();this.backends=this.BACKEND_REGISTRY}},e.prototype.initBackend=function(e,n){void 0===n&&(n=!1);var r=!1;"string"==typeof e?(this.currentBackendType=e,e=t.ENV.findBackend(e)):(r=!0,this.currentBackendType="custom"),this.globalEngine=new l.Engine(e,r,n)},e.prototype.findBackend=function(e){return this.backends[e]},e.prototype.addCustomBackend=function(e,t){if(e in this.backends)throw new Error(e+" backend was already registered");try{var n=t();return this.backends[e]=n,!0}catch(e){return!1}},e.prototype.registerBackend=function(e,t){if(e in this.BACKEND_REGISTRY)throw new Error(e+" backend was already registered as global");try{var n=t();return this.BACKEND_REGISTRY[e]=n,!0}catch(e){return!1}},Object.defineProperty(e.prototype,"engine",{get:function(){return this.initDefaultBackend(),this.globalEngine},enumerable:!0,configurable:!0}),e.prototype.initDefaultBackend=function(){null==this.globalEngine&&this.initBackend(t.ENV.get("BACKEND"),!1)},r([u.doc({heading:"Environment"})],e,"setBackend",null),r([u.doc({heading:"Environment"})],e,"getBackend",null),r([u.doc({heading:"Performance",subheading:"Memory"})],e,"memory",null),e}();t.Environment=v;var _,w="dljsflags";function E(){var e={};if("undefined"==typeof window)return e;var n=c.getQueryParams(window.location.search);if(w in n){var r={};n[w].split(",").forEach(function(e){var t=e.split(":");r[t[0]]=t[1]}),t.URL_PROPERTIES.forEach(function(t){t.name in r&&(console.log("Setting feature override from URL "+t.name+": "+r[t.name]),t.type===o.NUMBER?e[t.name]=+r[t.name]:t.type===o.BOOLEAN?e[t.name]="true"===r[t.name]:t.type===o.STRING?e[t.name]=r[t.name]:console.warn("Unknown URL param: "+t.name+"."))})}return e}t.ENV=((_=function(){var t;if("undefined"!=typeof window)t=window;else{if("undefined"==typeof e)throw new Error("Could not find a global object");t=e}return t}()).ENV=_.ENV||new v(E()),_.ENV)}).call(t,n("DuR2"))},vmeP:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FromPixelsProgram=function(e){this.variableNames=["A"];var t=e[0],n=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+n+".0, "+t+".0);\n\n        vec4 values = texture2D(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "}},vprv:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("2CTY"),o=n("xdLA"),s=n("gqjM"),u=n("Xq4m"),l=n("efV4"),c=n("8YQ1"),d=n("aIXu"),h=n("m48y"),p=n("deCJ"),g=n("BP3J"),m=n("j7RO");t.parseUnitAxis=function(e){return o.POSITION_SCALE_CHANNELS.reduce(function(t,n){return e.component.scales[n]&&e.axis(n)&&(t[n]=[function(e,t){var n=t.axis(e),o=new h.AxisComponent;r.VG_AXIS_PROPERTIES.forEach(function(u){var value=function(e,t,n,o){var u=o.fieldDef(n);switch(e){case"scale":return o.scaleName(n);case"gridScale":return m.gridScale(o,n);case"format":return l.numberFormat(u,t.format,o.config);case"grid":var c=o.getScaleComponent(n).get("type");return l.getSpecifiedOrDefaultValue(t.grid,m.grid(c,u));case"labelFlush":return m.labelFlush(u,n,t);case"labelOverlap":return c=o.getScaleComponent(n).get("type"),m.labelOverlap(u,t,n,c);case"orient":return l.getSpecifiedOrDefaultValue(t.orient,m.orient(n));case"tickCount":c=o.getScaleComponent(n).get("type");var d="x"===n?"width":"y"===n?"height":void 0,h=d?o.getSizeSignalRef(d):void 0;return l.getSpecifiedOrDefaultValue(t.tickCount,m.tickCount(n,u,c,h));case"title":var p=o.fieldDef("x"===n?"x2":"y2");return l.getSpecifiedOrDefaultValue(void 0===t.title?void 0:t.title,l.mergeTitleFieldDefs([s.toFieldDefBase(u)],p?[s.toFieldDefBase(p)]:[]));case"values":return m.values(t,o,u)}return r.isAxisProperty(e)?t[e]:void 0}(u,n,e,t);if(void 0!==value){var c="values"===u?!!n.values:"encode"===u?!!n.encoding||!!n.labelAngle:value===n[u],d=p.getAxisConfig(u,t.config,e,o.get("orient"),t.getScaleComponent(e).get("type"));(c||void 0===d)&&o.set(u,value,c)}});var c=n.encoding||{},d=r.AXIS_PARTS.reduce(function(n,r){if(!o.hasAxisPart(r))return n;var value="labels"===r?g.labels(t,e,c.labels||{},o.get("orient")):c[r]||{};return void 0!==value&&u.keys(value).length>0&&(n[r]={update:value}),n},{});return u.keys(d).length>0&&o.set("encode",d,!!n.encoding||!!n.labelAngle),o}(n,e)]),t},{})};var v={bottom:"top",top:"bottom",left:"right",right:"left"};function _(e,t){if(!e)return t.map(function(e){return e.clone()});if(e.length===t.length){for(var n=e.length,i=0;i<n;i++){var r=e[i],o=t[i];if(!!r!=!!o)return;if(r&&o){var s=r.getWithExplicit("orient"),u=o.getWithExplicit("orient");if(s.explicit&&u.explicit&&s.value!==u.value)return;e[i]=w(r,o)}}return e}}function w(e,t){for(var n=function(n){var r=d.mergeValuesWithExplicit(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",function(e,t){switch(n){case"title":return l.titleMerger(e,t);case"gridScale":return{explicit:e.explicit,value:e.value||t.value}}return d.defaultTieBreaker(e,t,n,"axis")});e.setWithExplicit(n,r)},o=0,s=r.VG_AXIS_PROPERTIES;o<s.length;o++)n(s[o]);return e}t.parseLayerAxis=function(e){for(var t=e.component,n=t.axes,r=t.resolve,s={top:0,bottom:0,right:0,left:0},l=0,d=e.children;l<d.length;l++){(S=d[l]).parseAxisAndHeader();for(var h=0,p=u.keys(S.component.axes);h<p.length;h++)r.axis[w=p[h]]=c.parseGuideResolve(e.component.resolve,w),"shared"===r.axis[w]&&(n[w]=_(n[w],S.component.axes[w]),n[w]||(r.axis[w]="independent",delete n[w]))}for(var g=0,m=[o.X,o.Y];g<m.length;g++)for(var w=m[g],E=0,O=e.children;E<O.length;E++){var S;if((S=O[E]).component.axes[w]){if("independent"===r.axis[w]){n[w]=(n[w]||[]).concat(S.component.axes[w]);for(var A=0,T=S.component.axes[w];A<T.length;A++){var N=T[A],M=N.getWithExplicit("orient"),C=M.value;if(s[C]>0&&!M.explicit){var D=v[C];s[C]>s[D]&&N.set("orient",D,!1)}s[C]++}}delete S.component.axes[w]}}}},vurQ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=1e-7;t.epsilon=function(){return r},t.setEpsilon=function(e){r=e},t.imageDataFormat=function(){return"channelsLast"}},vyDb:function(e,t,n){"use strict";var r=n("TToO").__extends,o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n("xdLA"),u=n("gqjM"),l=n("KMAE"),c=n("Xq4m"),d=n("efV4"),h=n("FgHA");t.AggregateNode=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.dimensions=n,o.measures=r,o}return r(t,e),t.prototype.clone=function(){return new t(null,o({},this.dimensions),c.duplicate(this.measures))},t.makeFromEncoding=function(e,n){var r=!1;n.forEachFieldDef(function(e){e.aggregate&&(r=!0)});var o={},l={};return r?(n.forEachFieldDef(function(e,t){e.aggregate?"count"===e.aggregate?(o["*"]=o["*"]||{},o["*"].count=u.vgField(e,{aggregate:"count"})):(o[e.field]=o[e.field]||{},o[e.field][e.aggregate]=u.vgField(e),s.isScaleChannel(t)&&"unaggregated"===n.scaleDomain(t)&&(o[e.field].min=u.vgField(e,{aggregate:"min"}),o[e.field].max=u.vgField(e,{aggregate:"max"}))):function(e,t,n){n.bin?(e[u.vgField(n,{})]=!0,e[u.vgField(n,{binSuffix:"end"})]=!0,d.binRequiresRange(n,t)&&(e[u.vgField(n,{binSuffix:"range"})]=!0)):e[u.vgField(n)]=!0}(l,t,e)}),c.keys(l).length+c.keys(o).length===0?null:new t(e,l,o)):null},t.makeFromTransform=function(e,n){for(var r={},o={},s=0,l=n.aggregate;s<l.length;s++)(p=l[s]).op&&("count"===p.op?(o["*"]=o["*"]||{},o["*"].count=p.as||u.vgField(p)):(o[p.field]=o[p.field]||{},o[p.field][p.op]=p.as||u.vgField(p)));for(var d=0,h=n.groupby||[];d<h.length;d++){var p;r[p=h[d]]=!0}return c.keys(r).length+c.keys(o).length===0?null:new t(e,r,o)},t.prototype.merge=function(e){c.differ(this.dimensions,e.dimensions)?l.debug("different dimensions, cannot merge"):(function(e,t){for(var f in t)if(t.hasOwnProperty(f)){var n=t[f];for(var r in n)n.hasOwnProperty(r)&&(f in e?e[f][r]=n[r]:e[f]={op:n[r]})}}(this.measures,e.measures),e.remove())},t.prototype.addDimensions=function(e){var t=this;e.forEach(function(f){return t.dimensions[f]=!0})},t.prototype.dependentFields=function(){var e={};return c.keys(this.dimensions).forEach(function(f){return e[f]=!0}),c.keys(this.measures).forEach(function(t){return e[t]=!0}),e},t.prototype.producedFields=function(){var e=this,t={};return c.keys(this.measures).forEach(function(n){c.keys(e.measures[n]).forEach(function(e){t[e+"_"+n]=!0})}),t},t.prototype.assemble=function(){for(var e=[],t=[],n=[],r=0,o=c.keys(this.measures);r<o.length;r++)for(var s=o[r],u=0,l=c.keys(this.measures[s]);u<l.length;u++){var d=l[u];n.push(this.measures[s][d]),e.push(d),t.push(s)}return{type:"aggregate",groupby:c.keys(this.dimensions),ops:e,fields:t,as:n}},t}(h.DataFlowNode)},w3wY:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.doc=function(e){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}}},"wE+S":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("xdLA"),o=n("KMAE"),s=n("rxHH"),u=n("rxHH"),l=n("zEzE"),c=n("Xq4m"),d=n("Xq4m");function h(e,t){var n=t.type;return d.contains([l.Type.ORDINAL,l.Type.NOMINAL],n)?void 0===e||u.hasDiscreteDomain(e):n===l.Type.TEMPORAL?d.contains([s.ScaleType.TIME,s.ScaleType.UTC,s.ScaleType.SEQUENTIAL,void 0],e):n!==l.Type.QUANTITATIVE||d.contains(t.bin?[s.ScaleType.BIN_LINEAR,s.ScaleType.BIN_ORDINAL,s.ScaleType.LINEAR]:[s.ScaleType.LOG,s.ScaleType.POW,s.ScaleType.SQRT,s.ScaleType.QUANTILE,s.ScaleType.QUANTIZE,s.ScaleType.LINEAR,s.ScaleType.SEQUENTIAL,void 0],e)}t.scaleType=function(e,t,n,u,l){var d=function(e,t,n,s){switch(t.type){case"nominal":case"ordinal":if(r.isColorChannel(e)||"discrete"===r.rangeType(e))return"shape"===e&&"ordinal"===t.type&&o.warn(o.message.discreteChannelCannotEncode(e,"ordinal")),"ordinal";if(c.contains(["x","y"],e)){if(c.contains(["rect","bar","rule"],n))return"band";if("bar"===n)return"band"}return"point";case"temporal":return r.isColorChannel(e)?"sequential":"discrete"===r.rangeType(e)?(o.warn(o.message.discreteChannelCannotEncode(e,"temporal")),"ordinal"):"time";case"quantitative":return r.isColorChannel(e)?t.bin?"bin-ordinal":"sequential":"discrete"===r.rangeType(e)?(o.warn(o.message.discreteChannelCannotEncode(e,"quantitative")),"ordinal"):t.bin&&"x"!==e&&"y"!==e?"bin-linear":"linear";case"latitude":case"longitude":case"geojson":return}throw new Error(o.message.invalidFieldType(t.type))}(t,n,u);return r.isScaleChannel(t)?void 0!==e?s.channelSupportScaleType(t,e)?h(e,n)?e:(o.warn(o.message.scaleTypeNotWorkWithFieldDef(e,d)),d):(o.warn(o.message.scaleTypeNotWorkWithChannel(t,e,d)),d):d:null},t.fieldDefMatchScaleType=h},wSd8:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DepthwiseConv2DProgram=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 strides = ivec2("+e.strideHeight+", "+e.strideWidth+");\n      const ivec2 pads = ivec2("+e.padInfo.top+", "+e.padInfo.left+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+t+";\n        int q = d2 - d1 * "+t+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TODO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+e.filterHeight+"; wR++) {\n          int xR = xRCorner + wR * "+e.dilationHeight+";\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+e.filterWidth+"; wC++) {\n            int xC = xCCorner + wC * "+e.dilationWidth+";\n\n            if (xC < 0 || xC >= "+e.inWidth+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}},wcX3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("/u4k");t.TransposeProgram=function(){return function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),i=0;i<n.length;i++)n[i]=e[t[i]];this.outputShape=n,this.rank=n.length;var o=r.getCoordsDataType(this.rank),s=function(e){var t=e.length;if(t>4)throw Error("Transpose for rank "+t+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=new Array(t),i=0;i<e.length;i++)r[e[i]]=n[i];return r.join()}(t);this.userCode="\n    void main() {\n      "+o+" resRC = getOutputCoords();\n      setOutput(getA("+s+"));\n    }\n    "}}()},wdBI:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("/u4k");t.PadProgram=function(){return function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(t,i){return t[0]+e[i]+t[1]});var o=e.length,s=r.getCoordsDataType(o),u=t.map(function(e){return e[0]}).join(","),l=t.map(function(t,i){return t[0]+e[i]}).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o);this.userCode=1!==o?"\n      "+s+" start = "+s+"("+u+");\n      "+s+" end = "+s+"("+l+");\n\n      void main() {\n        "+s+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+s+" coords = outC - start;\n          setOutput(getX("+c+"));\n        }\n      }\n    ":"\n        int start = "+u+";\n        int end = "+l+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "}}()},wjyt:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("v/P2"),u=n("3goy"),l=n("XFvI"),c=n("bDWH"),d=n("35G1");t.LogicalOps=function(){function e(){}return e.logicalNot=function(x){return l.assert("bool"===x.dtype,"Error Array must be of type bool."),s.ENV.engine.runKernel(function(e){return e.logicalNot(x)},{x:x})},e.logicalAnd=function(a,b){return l.assert("bool"===a.dtype&&"bool"===b.dtype,"Error Array must be of type bool."),c.assertAndGetBroadcastShape(a.shape,b.shape),s.ENV.engine.runKernel(function(e){return e.logicalAnd(a,b)},{a:a,b:b})},e.logicalOr=function(a,b){return l.assert("bool"===a.dtype&&"bool"===b.dtype,"Error Array must be of type bool."),c.assertAndGetBroadcastShape(a.shape,b.shape),s.ENV.engine.runKernel(function(e){return e.logicalOr(a,b)},{a:a,b:b})},e.logicalXor=function(a,b){return l.assert("bool"===a.dtype&&"bool"===b.dtype,"Error Array must be of type bool."),c.assertAndGetBroadcastShape(a.shape,b.shape),s.ENV.engine.runKernel(function(e){return e.logicalXor(a,b)},{a:a,b:b})},e.where=function(e,a,b){l.assert("bool"===e.dtype||"bool"===a.dtype||"bool"===b.dtype,"Error Array must be of type bool."),l.assertShapesMatch(a.shape,b.shape,"Error in where: "),1===e.rank?l.assert(e.shape[0]===a.shape[0],"The first dimension of `a` must match the size of `condition`."):l.assertShapesMatch(e.shape,b.shape,"Error in where: ");var t=u.upcastType(a.dtype,b.dtype);return s.ENV.engine.runKernel(function(n){return n.where(e,a,b,t)},{condition:e,a:a,b:b})},r([o.doc({heading:"Operations",subheading:"Logical"}),d.operation],e,"logicalNot",null),r([o.doc({heading:"Operations",subheading:"Logical"}),d.operation],e,"logicalAnd",null),r([o.doc({heading:"Operations",subheading:"Logical"}),d.operation],e,"logicalOr",null),r([o.doc({heading:"Operations",subheading:"Logical"}),d.operation],e,"logicalXor",null),r([o.doc({heading:"Operations",subheading:"Logical"}),d.operation],e,"where",null),e}()},x8nG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Bsgt"),o=n("KMAE"),s=n("rxHH"),u=n("kglw");t.default={has:function(e){return"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind},parse:function(e,t,n){var r=n.scales=[];n.project.forEach(function(t){var l=t.channel,c=e.getScaleComponent(l),d=c?c.get("type"):void 0;c&&s.hasContinuousDomain(d)&&!s.isBinScale(d)?(c.set("domainRaw",{signal:u.channelSignalName(n,l,"data")},!0),r.push(l)):o.warn(o.message.SCALE_BINDINGS_CONTINUOUS)})},topLevelSignals:function(e,t,n){if(!e.parent)return n;var r=t.scales.filter(function(e){return!n.filter(function(n){return n.name===u.channelSignalName(t,e,"data")}).length});return n.concat(r.map(function(e){return{name:u.channelSignalName(t,e,"data")}}))},signals:function(e,t,n){return e.parent&&t.scales.forEach(function(e){var r=n.filter(function(n){return n.name===u.channelSignalName(t,e,"data")})[0];r.push="outer",delete r.value,delete r.update}),n}},t.domain=function(e,t){return"domain("+r.stringValue(e.scaleName(t))+")"}},xHKr:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("v/P2"),u=n("XFvI"),l=n("35G1");function c(x){return null==x?null:0===x.rank?x.as1D():1===x.rank?x:2===x.rank?x.as4D(1,1,x.shape[0],x.shape[1]):3===x.rank?x.as4D(1,x.shape[0],x.shape[1],x.shape[2]):x}t.BatchNormOps=function(){function e(){}return e.batchNormalization2d=function(x,t,n,r,o,s){return void 0===r&&(r=.001),u.assert(2===x.rank,"Error in batchNormalization3D: x must be rank 3 but got rank "+x.rank+"."),u.assert(2===t.rank||1===t.rank,"Error in batchNormalization2D: mean must be rank 2 or rank 1 but got rank "+t.rank+"."),u.assert(2===n.rank||1===n.rank,"Error in batchNormalization2D: variance must be rank 2 or rank 1 but got rank "+n.rank+"."),null!=o&&u.assert(2===o.rank||1===o.rank,"Error in batchNormalization2D: scale must be rank 2 or rank 1 but got rank "+o.rank+"."),null!=s&&u.assert(2===s.rank||1===s.rank,"Error in batchNormalization2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."),e.batchNormalization(x,t,n,r,o,s)},e.batchNormalization3d=function(x,t,n,r,o,s){return void 0===r&&(r=.001),u.assert(3===x.rank,"Error in batchNormalization3D: x must be rank 3 but got rank "+x.rank+"."),u.assert(3===t.rank||1===t.rank,"Error in batchNormalization3D: mean must be rank 3 or rank 1 but got rank "+t.rank+"."),u.assert(3===n.rank||1===n.rank,"Error in batchNormalization3D: variance must be rank 3 or rank 1 but got rank "+n.rank+"."),null!=o&&u.assert(3===o.rank||1===o.rank,"Error in batchNormalization3D: scale must be rank 3 or rank 1 but got rank "+o.rank+"."),null!=s&&u.assert(3===s.rank||1===s.rank,"Error in batchNormalization3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."),e.batchNormalization(x,t,n,r,o,s)},e.batchNormalization4d=function(x,t,n,r,o,s){return void 0===r&&(r=.001),u.assert(4===x.rank,"Error in batchNormalization4D: x must be rank 4 but got rank "+x.rank+"."),u.assert(4===t.rank||1===t.rank,"Error in batchNormalization4D: mean must be rank 4 or rank 1 but got rank "+t.rank+"."),u.assert(4===n.rank||1===n.rank,"Error in batchNormalization4D: variance must be rank 4 or rank 1 but got rank "+n.rank+"."),null!=o&&u.assert(4===o.rank||1===o.rank,"Error in batchNormalization4D: scale must be rank 4 or rank 1 but got rank "+o.rank+"."),null!=s&&u.assert(4===s.rank||1===s.rank,"Error in batchNormalization4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."),e.batchNormalization(x,t,n,r,o,s)},e.batchNormalization=function(x,e,t,n,r,o){var u;return void 0===n&&(n=.001),u=0===x.rank||1===x.rank?x.as4D(1,1,1,x.size):2===x.rank?x.as4D(1,1,x.shape[0],x.shape[1]):3===x.rank?x.as4D(1,x.shape[0],x.shape[1],x.shape[2]):x,s.ENV.engine.runKernel(function(s){return s.batchNormalization4D(u,c(e),c(t),n,c(r),c(o))},{x:x,mean:e,variance:t}).reshape(x.shape)},r([l.operation],e,"batchNormalization2d",null),r([l.operation],e,"batchNormalization3d",null),r([l.operation],e,"batchNormalization4d",null),r([o.doc({heading:"Operations",subheading:"Normalization"})],e,"batchNormalization",null),e}()},xJJ0:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("v/P2"),s=n("V6aD"),u=n("m3RX"),l=n("dFrR");t.RMSPropOptimizer=function(e){function t(t,n,r,o){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===o&&(o=1e-8);var l=e.call(this)||this;return l.learningRate=t,l.accumulatedMeanSquares={},l.accumulatedMoments={},l.c=s.keep(u.scalar(t)),l.epsilon=s.keep(u.scalar(o)),l.decay=s.keep(u.scalar(n)),l.momentum=s.keep(u.scalar(r)),l.oneMinusDecay=s.keep(u.scalar(1-n)),l}return r(t,e),t.prototype.applyGradients=function(e){var t=this,n=function(n){var value=o.ENV.engine.registeredVariables[n];null==r.accumulatedMeanSquares[n]&&s.tidy(function(){t.accumulatedMeanSquares[n]=u.zerosLike(value).variable(!1)}),null==r.accumulatedMoments[n]&&s.tidy(function(){t.accumulatedMoments[n]=u.zerosLike(value).variable(!1)});var l=r.accumulatedMeanSquares[n],c=r.accumulatedMoments[n],d=e[n];s.tidy(function(){var e=t.decay.mul(l).add(t.oneMinusDecay.mul(d.square())),r=t.momentum.mul(c).add(t.c.mul(d).div(e.add(t.epsilon).sqrt()));t.accumulatedMeanSquares[n].assign(e),t.accumulatedMoments[n].assign(r);var o=value.sub(r);value.assign(o)})},r=this;for(var l in e)n(l)},t.prototype.dispose=function(){var e=this;this.c.dispose(),this.epsilon.dispose(),this.decay.dispose(),this.momentum.dispose(),this.oneMinusDecay.dispose(),null!=this.accumulatedMeanSquares&&Object.keys(this.accumulatedMeanSquares).forEach(function(t){return e.accumulatedMeanSquares[t].dispose()}),null!=this.accumulatedMoments&&Object.keys(this.accumulatedMoments).forEach(function(t){return e.accumulatedMoments[t].dispose()})},t}(l.Optimizer)},xPdO:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("5WUj"),s=n("qmZh"),u=n("lbmW"),l=n("DjcB"),c=n("yJL4"),d=n("TPCB"),h=n("Q1Fz"),p=n("np2E"),g=n("np2E"),m=function(e){function t(t){var n=e.call(this,t)||this;if(n.embeddings=null,n.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==t.batchInputShape&&null==t.inputShape){var r=null;null!=t.batchSize&&(r=t.batchSize),n.batchInputShape=null==t.inputLength?[r,null]:[r].concat(p.toList(t.inputLength))}return n.inputDim=t.inputDim,n.outputDim=t.outputDim,n.embeddingsInitializer=d.getInitializer(t.embeddingsInitializer||n.DEFAULT_EMBEDDINGS_INITIALIZER),n.embeddingsRegularizer=h.getRegularizer(t.embeddingsRegularizer),n.activityRegularizer=h.getRegularizer(t.activityRegularizer),n.embeddingsConstraint=u.getConstraint(t.embeddingsConstraint),n.maskZero=t.maskZero,n.inputLength=t.inputLength,n}return r(t,e),t.prototype.build=function(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},t.prototype.computeMask=function(e,t){throw new c.NotImplementedError("computeMask has not been implemented for Embedding yet")},t.prototype.computeOutputShape=function(e){if(e=p.getExactlyOneShape(e),null==this.inputLength)return e.concat([this.outputDim]);var t=p.toList(this.inputLength);if(t.length!==e.length-1)throw new c.ValueError('"inputLength" is '+this.inputLength+", but received input shape has shape "+e);for(var i=0,n=0,r=o.zip(t,e.slice(1));n<r.length;n++){var s=r[n],u=s[0],l=s[1];if(null!=u&&null!=l&&u!==l)throw new c.ValueError('"inputLength" is '+this.inputLength+", but received input shape has shape "+e);null==u&&(t[i]=l),i++}return[e[0]].concat(t,[this.outputDim])},t.prototype.call=function(e,t){this.invokeCallHook(e,t);var n=p.getExactlyOneTensor(e);"int32"!==s.dtype(n)&&(n=s.cast(n,"int32"));var r=s.gather(this.embeddings.read(),n.as1D());return s.reshape(r,g.getExactlyOneShape(this.computeOutputShape(n.shape)))},t.prototype.getConfig=function(){var t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:d.serializeInitializer(this.embeddingsInitializer),embeddingsRegularizer:h.serializeRegularizer(this.embeddingsRegularizer),activityRegularizer:h.serializeRegularizer(this.activityRegularizer),embeddingsConstraint:u.serializeConstraint(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(l.Layer);t.Embedding=m,p.ClassNameMap.register("Embedding",m)},xdLA:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var s,u=n("Xq4m");!function(e){e.ROW="row",e.COLUMN="column",e.X="x",e.Y="y",e.X2="x2",e.Y2="y2",e.LATITUDE="latitude",e.LONGITUDE="longitude",e.LATITUDE2="latitude2",e.LONGITUDE2="longitude2",e.COLOR="color",e.FILL="fill",e.STROKE="stroke",e.SHAPE="shape",e.SIZE="size",e.OPACITY="opacity",e.TEXT="text",e.ORDER="order",e.DETAIL="detail",e.KEY="key",e.TOOLTIP="tooltip",e.HREF="href"}(s=t.Channel||(t.Channel={})),t.X=s.X,t.Y=s.Y,t.X2=s.X2,t.Y2=s.Y2,t.LATITUDE=s.LATITUDE,t.LATITUDE2=s.LATITUDE2,t.LONGITUDE=s.LONGITUDE,t.LONGITUDE2=s.LONGITUDE2,t.ROW=s.ROW,t.COLUMN=s.COLUMN,t.SHAPE=s.SHAPE,t.SIZE=s.SIZE,t.COLOR=s.COLOR,t.FILL=s.FILL,t.STROKE=s.STROKE,t.TEXT=s.TEXT,t.DETAIL=s.DETAIL,t.KEY=s.KEY,t.ORDER=s.ORDER,t.OPACITY=s.OPACITY,t.TOOLTIP=s.TOOLTIP,t.HREF=s.HREF,t.GEOPOSITION_CHANNEL_INDEX={longitude:1,longitude2:1,latitude:1,latitude2:1},t.GEOPOSITION_CHANNELS=u.flagKeys(t.GEOPOSITION_CHANNEL_INDEX);var l=r({x:1,y:1,x2:1,y2:1},t.GEOPOSITION_CHANNEL_INDEX,{color:1,fill:1,stroke:1,opacity:1,size:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1});t.isColorChannel=function(e){return"color"===e||"fill"===e||"stroke"===e};var c=r({},l,{row:1,column:1});t.CHANNELS=u.flagKeys(c);var d=o(c,["order","detail"]);t.SINGLE_DEF_CHANNELS=u.flagKeys(d),t.isChannel=function(e){return!!c[e]},t.UNIT_CHANNELS=u.flagKeys(l);var h=o(l,["x","y","x2","y2","latitude","longitude","latitude2","longitude2"]);t.NONPOSITION_CHANNELS=u.flagKeys(h);var p={x:1,y:1};t.POSITION_SCALE_CHANNELS=u.flagKeys(p);var g=o(h,["text","tooltip","href","detail","key","order"]);t.NONPOSITION_SCALE_CHANNELS=u.flagKeys(g);var m=r({},p,g);function v(e){switch(e){case t.COLOR:case t.FILL:case t.STROKE:case t.DETAIL:case t.KEY:case t.TOOLTIP:case t.HREF:case t.ORDER:case t.OPACITY:case t.ROW:case t.COLUMN:return{point:!0,tick:!0,rule:!0,circle:!0,square:!0,bar:!0,rect:!0,line:!0,area:!0,text:!0,geoshape:!0};case t.X:case t.Y:case t.LATITUDE:case t.LONGITUDE:return{point:!0,tick:!0,rule:!0,circle:!0,square:!0,bar:!0,rect:!0,line:!0,area:!0,text:!0};case t.X2:case t.Y2:case t.LATITUDE2:case t.LONGITUDE2:return{rule:!0,bar:!0,rect:!0,area:!0};case t.SIZE:return{point:!0,tick:!0,rule:!0,circle:!0,square:!0,bar:!0,text:!0,line:!0};case t.SHAPE:return{point:!0,geoshape:!0};case t.TEXT:return{text:!0}}}t.SCALE_CHANNELS=u.flagKeys(m),t.isScaleChannel=function(e){return!!m[e]},t.supportMark=function(e,t){return t in v(e)},t.getSupportedMark=v,t.rangeType=function(e){switch(e){case t.X:case t.Y:case t.SIZE:case t.OPACITY:case t.X2:case t.Y2:return"continuous";case t.ROW:case t.COLUMN:case t.SHAPE:case t.TEXT:case t.TOOLTIP:case t.HREF:return"discrete";case t.COLOR:case t.FILL:case t.STROKE:return"flexible";case t.LATITUDE:case t.LONGITUDE:case t.LATITUDE2:case t.LONGITUDE2:case t.DETAIL:case t.KEY:case t.ORDER:return}throw new Error("rangeType not implemented for "+e)}},xn9R:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaxPool2DBackpropProgram=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(t-1-e.padInfo.top)+", "+(n-1-e.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+(t*n-1)+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+n+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}},xoEB:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var s=n("Bsgt"),u=n("Xq4m"),l=n("0N5v"),c=n("OMxB"),d=n("kglw"),h=n("GH2X");function p(e){return u.keys(e.component.scales).reduce(function(t,n){var s=e.component.scales[n];if(s.merged)return t;var u=s.combine(),l=u.domainRaw,c=u.range,p=u.name,m=u.type,v=o(u,["name","type","domainRaw","range"]);return c=g(c,p,e,n),l&&d.isRawSelectionDomain(l)&&(l=d.selectionScaleDomain(e,l)),t.push(r({name:p,type:m,domain:h.assembleDomain(e,n)},l?{domainRaw:l}:{},{range:c},v)),t},[])}function g(e,t,n,r){if("x"===r||"y"===r){if(l.isVgRangeStep(e))return{step:{signal:t+"_step"}};if(s.isArray(e)&&2===e.length){var o=e[0],u=e[1];if(0===o&&l.isVgSignalRef(u))return[0,{signal:n.getSizeName(u.signal)}];if(l.isVgSignalRef(o)&&0===u)return[{signal:n.getSizeName(o.signal)},0]}}return e}t.assembleScales=function e(t){return c.isLayerModel(t)||c.isConcatModel(t)||c.isRepeatModel(t)?t.children.reduce(function(t,n){return t.concat(e(n))},p(t)):p(t)},t.assembleScalesForModel=p,t.assembleScaleRange=g},xuXS:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version="0.8.0"},y72d:function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n("xdLA"),s=n("gqjM"),u=n("KMAE"),l=n("D6ZG"),c=n("rxHH"),d=n("dMOq");t.rect={vgMark:"rect",encodeEntry:function(e){return r({},d.baseEncodeEntry(e,{size:"ignore",orient:"ignore"}),function(e){var t=e.encoding.x,n=e.encoding.x2,h=e.getScaleComponent(o.X),p=h?h.get("type"):void 0;if(s.isFieldDef(t)&&t.bin&&!n)return d.binnedPosition(t,"x",e.scaleName("x"),0,h.get("reverse"));if(s.isFieldDef(t)&&h&&c.hasDiscreteDomain(p)){if(p===c.ScaleType.BAND)return d.bandPosition(t,"x",e);throw new Error(u.message.scaleTypeNotWorkWithMark(l.RECT,p))}return r({},d.pointPosition("x",e,"zeroOrMax"),d.pointPosition2(e,"zeroOrMin","x2"))}(e),function(e){var t=e.encoding.y,n=e.encoding.y2,h=e.getScaleComponent(o.Y),p=h?h.get("type"):void 0;if(s.isFieldDef(t)&&t.bin&&!n)return d.binnedPosition(t,"y",e.scaleName("y"),0,h.get("reverse"));if(s.isFieldDef(t)&&h&&c.hasDiscreteDomain(p)){if(p===c.ScaleType.BAND)return d.bandPosition(t,"y",e);throw new Error(u.message.scaleTypeNotWorkWithMark(l.RECT,p))}return r({},d.pointPosition("y",e,"zeroOrMax"),d.pointPosition2(e,"zeroOrMin","y2"))}(e))}}},"yI+w":function(e,t,n){"use strict";var r=n("TToO").__extends,o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n("Bsgt"),u=n("KMAE"),l=n("FgHA"),c=n("EOrY");t.LookupNode=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.transform=n,o.secondary=r,o}return r(t,e),t.make=function(e,n,r,o){var s=n.component.data.sources,u=new c.SourceNode(r.from.data),d=s[u.hash()];d||(s[u.hash()]=u,d=u);var h=n.getName("lookup_"+o),p=new l.OutputNode(d,h,"lookup",n.component.data.outputNodeRefCounts);return n.component.data.outputNodes[h]=p,new t(e,r,p.getSource())},t.prototype.producedFields=function(){return s.toSet(this.transform.from.fields||(this.transform.as instanceof Array?this.transform.as:[this.transform.as]))},t.prototype.assemble=function(){var e;if(this.transform.from.fields)e=o({values:this.transform.from.fields},this.transform.as?{as:this.transform.as instanceof Array?this.transform.as:[this.transform.as]}:{});else{var t=this.transform.as;s.isString(t)||(u.warn(u.message.NO_FIELDS_NEEDS_AS),t="_lookup"),e={as:[t]}}return o({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},e,this.transform.default?{default:this.transform.default}:{})},t}(l.DataFlowNode)},yJL4:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return r(t,e),t}(Error);t.AttributeError=o;var s=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return r(t,e),t}(Error);t.RuntimeError=s;var u=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return r(t,e),t}(Error);t.ValueError=u;var l=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return r(t,e),t}(Error);t.NotImplementedError=l;var c=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return r(t,e),t}(Error);t.AssertionError=c;var d=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return r(t,e),t}(Error);t.IndexError=d},yltK:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=null,o=n("XFvI"),s=n("v/P2");function u(e,t){var n,r=s.ENV.get("WEBGL_VERSION");if(2===r?n=e.getContext("webgl2",t):1===r&&(n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t)),0===r||null==n)throw new Error("This browser does not support WebGL.");return n}function l(e,t){var n=t();return d(e),n}t.createWebGLRenderingContext=function(e){var t=document.createElement("canvas");return t.width=1,t.height=1,u(t,e)},t.createWebGLRenderingContextFromCanvas=u,t.callAndCheck=l;var c=!1;function d(e){if(c){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+h(e,t))}}function h(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}t.enableDebugWebGLErrorChecking=function(e){c=e},t.checkWebGLError=d,t.getWebGLErrorMessage=h,t.getExtensionOrThrow=function(e,t){return _(e,function(){return e.getExtension(t)},'Extension "'+t+'" not supported on this browser.')},t.createVertexShader=function(e,t){var n=_(e,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(l(e,function(){return e.shaderSource(n,t)}),l(e,function(){return e.compileShader(n)}),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n},t.createFragmentShader=function(e,t){var n=_(e,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(l(e,function(){return e.shaderSource(n,t)}),l(e,function(){return e.compileShader(n)}),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw function(e,t){var n=p.exec(t);if(null==n)return console.log("Couldn't parse line number in error: "+t),void console.log(e);for(var r=+n[1],s=e.split("\n"),u=s.length.toString().length+2,l=s.map(function(e,t){return o.rightPad((t+1).toString(),u)+e}),c=0,i=0;i<l.length;i++)c=Math.max(l[i].length,c);var d=l.slice(0,r-1),h=l.slice(r-1,r),g=l.slice(r);console.log(d.join("\n")),console.log(t.split("\n")[0]),console.log("%c "+o.rightPad(h[0],c),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(g.join("\n"))}(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n};var p=/ERROR: [0-9]+:([0-9]+):/g;function g(e){return null!=r?r:r=l(e,function(){return e.getParameter(e.MAX_TEXTURE_SIZE)})}function m(e,t,n){w(e,n),l(e,function(){return e.activeTexture(e.TEXTURE0+n)}),l(e,function(){return e.bindTexture(e.TEXTURE_2D,t)})}function v(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function _(e,t,n){var r=l(e,function(){return t()});if(null==r)throw new Error(n);return r}function w(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}t.createProgram=function(e){return _(e,function(){return e.createProgram()},"Unable to create WebGLProgram.")},t.linkProgram=function(e,t){if(l(e,function(){return e.linkProgram(t)}),!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")},t.validateProgram=function(e,t){if(l(e,function(){return e.validateProgram(t)}),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")},t.createStaticVertexBuffer=function(e,t){var n=_(e,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return l(e,function(){return e.bindBuffer(e.ARRAY_BUFFER,n)}),l(e,function(){return e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)}),n},t.createStaticIndexBuffer=function(e,t){var n=_(e,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return l(e,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)}),l(e,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)}),n},t.queryMaxTextureSize=g,t.getChannelsPerTexture=function(){return s.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")&&2===s.ENV.get("WEBGL_VERSION")?1:4},t.createTexture=function(e){return _(e,function(){return e.createTexture()},"Unable to create WebGLTexture.")},t.validateTextureSize=function(e,t,n){var r=g(e);if(t<=0||n<=0){var o="["+t+"x"+n+"]";throw new Error("Requested texture size "+o+" is invalid.")}if(t>r||n>r)throw o="["+t+"x"+n+"]",new Error("Requested texture size "+o+" greater than WebGL maximum on this browser / GPU ["+r+"x"+r+"].")},t.createFramebuffer=function(e){return _(e,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")},t.bindVertexBufferToProgramAttribute=function(e,t,n,r,o,s,u){var c=e.getAttribLocation(t,n);-1!==c&&(l(e,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),l(e,function(){return e.vertexAttribPointer(c,o,e.FLOAT,!1,s,u)}),l(e,function(){return e.enableVertexAttribArray(c)}))},t.bindTextureUnit=m,t.unbindTextureUnit=function(e,t){w(e,t),l(e,function(){return e.activeTexture(e.TEXTURE0+t)}),l(e,function(){return e.bindTexture(e.TEXTURE_2D,null)})},t.getProgramUniformLocationOrThrow=function(e,t,n){return _(e,function(){return e.getUniformLocation(t,n)},'uniform "'+n+'" not present in program.')},t.getProgramUniformLocation=function(e,t,n){return e.getUniformLocation(t,n)},t.bindTextureToProgramUniformSampler=function(e,t,n,r,o){l(e,function(){return m(e,n,o)}),l(e,function(){return e.uniform1i(r,o)})},t.bindCanvasToFramebuffer=function(e){l(e,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),l(e,function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)}),l(e,function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)})},t.bindColorTextureToFramebuffer=function(e,t,n){l(e,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),l(e,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)})},t.unbindColorTextureFromFramebuffer=function(e,t){l(e,function(){return e.bindFramebuffer(e.FRAMEBUFFER,t)}),l(e,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})},t.validateFramebuffer=function(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+v(e,t))},t.getFramebufferErrorMessage=v,t.getTextureShapeFromLogicalShape=function(e,t){2!==t.length&&(t=o.squeezeShape(t).newShape);var n=g(e),r=o.sizeFromShape(t);return t.length<=1&&r<=n?[r,1]:2===t.length&&t[0]<=n&&t[1]<=n?t:3===t.length&&t[0]<=n&&t[1]*t[2]<=n?[t[0],t[1]*t[2]]:4===t.length&&t[0]<=n&&t[1]*t[2]*t[3]<=n?[t[0],t[1]*t[2]*t[3]]:o.sizeToSquarishShape(r)}},z2hB:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("v/P2"),u=n("XPNO"),l=n("jb1O"),c=n("XFvI"),d=n("DqkE"),h=n("SPTo"),p=n("35G1"),g=n("m3RX"),m=n("C5Mr");function v(e,t){if(null==t||"float32"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type $ {dtype}")}t.ArrayOps=function(){function e(){}return e.tensor=function(e,t,n){void 0===n&&(n="float32");var r=c.inferShape(e);return null!=t&&1!==r.length&&c.assertShapesMatch(t,r,"Error creating a new Tensor. Inferred shape ("+r+") does not match the provided shape ("+t+"). "),c.isTypedArray(e)||Array.isArray(e)||(e=[e]),u.Tensor.make(t=t||r,{values:function(a,e){return function(a,e){return a instanceof Float32Array&&"float32"===e||a instanceof Int32Array&&"int32"===e||a instanceof Uint8Array&&"bool"===e}(a,e)?a:(Array.isArray(a)&&(a=c.flatten(a)),c.copyTypedArray(a,e))}(e,n)},n)},e.scalar=function(value,t){if(void 0===t&&(t="float32"),c.isTypedArray(value)||Array.isArray(value))throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean)");return e.tensor(value,[],t)},e.tensor1d=function(t,n){void 0===n&&(n="float32");var r=c.inferShape(t);if(1!==r.length)throw new Error("Error creating a new Tensor1D: values must be a flat/TypedArray");return e.tensor(t,r,n)},e.tensor2d=function(t,n,r){void 0===r&&(r="float32");var o=c.inferShape(t);if(2!==o.length&&1!==o.length)throw new Error("Error creating a new Tensor2D: values must be number[][] or flat/TypedArray");return e.tensor(t,n=n||o,r)},e.tensor3d=function(t,n,r){void 0===r&&(r="float32");var o=c.inferShape(t);if(3!==o.length&&1!==o.length)throw new Error("Error creating a new Tensor3D: values must be number[][][]or flat/TypedArray");return e.tensor(t,n=n||o,r)},e.tensor4d=function(t,n,r){void 0===r&&(r="float32");var o=c.inferShape(t);if(4!==o.length&&1!==o.length)throw new Error("Error creating a new Tensor4D: values must be number[][][][]or flat/TypedArray");return e.tensor(t,n=n||o,r)},e.ones=function(e,t){void 0===t&&(t="float32");var n=function(e,t){for(var n=v(e,t),i=0;i<n.length;i++)n[i]=1;return n}(c.sizeFromShape(e),t);return u.Tensor.make(e,{values:n},t)},e.zeros=function(e,t){void 0===t&&(t="float32");var n=v(c.sizeFromShape(e),t);return u.Tensor.make(e,{values:n},t)},e.fill=function(e,value,t){void 0===t&&(t="float32");var n=c.getTypedArrayFromDType(t,c.sizeFromShape(e));return n.fill(value),u.Tensor.make(e,{values:n},t)},e.onesLike=function(x){return e.ones(x.shape,x.dtype)},e.zerosLike=function(x){return e.zeros(x.shape,x.dtype)},e.clone=function(x){return u.Tensor.make(x.shape,{dataId:x.dataId},x.dtype)},e.randomNormal=function(t,n,r,o,s){if(void 0===n&&(n=0),void 0===r&&(r=1),null!=o&&"bool"===o)throw new Error("Unsupported data type "+o);for(var u=new m.MPRandGauss(n,r,o,!1,s),l=e.buffer(t,o),i=0;i<l.values.length;i++)l.values[i]=u.nextValue();return l.toTensor()},e.truncatedNormal=function(t,n,r,o,s){if(void 0===n&&(n=0),void 0===r&&(r=1),null!=o&&"bool"===o)throw new Error("Unsupported data type "+o);for(var u=new m.MPRandGauss(n,r,o,!0,s),l=e.buffer(t,o),i=0;i<l.values.length;i++)l.values[i]=u.nextValue();return l.toTensor()},e.randomUniform=function(t,n,r,o){void 0===n&&(n=0),void 0===r&&(r=1),void 0===o&&(o="float32");for(var s=e.buffer(t,o),i=0;i<s.values.length;i++)s.values[i]=c.randUniform(n,r);return s.toTensor()},e.rand=function(e,t,n){var r=c.sizeFromShape(e),o=null;if(null==n||"float32"===n)o=new Float32Array(r);else if("int32"===n)o=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);o=new Uint8Array(r)}for(var i=0;i<r;i++)o[i]=t();return u.Tensor.make(e,{values:o},n)},e.multinomial=function(e,t,n,r){void 0===r&&(r=!1);var o=e.size,u=e.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(u>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+u);r||(e=g.softmax(e)),n=n||Math.random();var l=1===u?e.as2D(1,-1):e,c=s.ENV.engine.runKernel(function(e){return e.multinomial(l,t,n)},{prob2D:l});return 1===u?c.as1D():c},e.oneHot=function(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);return s.ENV.engine.runKernel(function(o){return o.oneHot(e,t,n,r)},{indices:e})},e.fromPixels=function(e,t){if(void 0===t&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");return s.ENV.engine.fromPixels(e,t)},e.reshape=function(x,e){return e=c.inferFromImplicitShape(e,x.size),c.assert(x.size===c.sizeFromShape(e),"new shape and old shape must have the same number of elements."),s.ENV.engine.runKernel(function(t){return t.reshape(x,e)},{x:x},function(e){return{x:function(){return e.reshape(x.shape)}}})},e.squeeze=function(x,t){return e.reshape(x,c.squeezeShape(x.shape,t).newShape)},e.cast=function(x,e){return s.ENV.engine.runKernel(function(t){return t.cast(x,e)},{x:x},function(e){return{x:function(){return e.clone()}}})},e.tile=function(x,t){return c.assert(x.rank===t.length,"Error in transpose: rank of input "+x.rank+" must match length of reps "+t+"."),s.ENV.engine.runKernel(function(e){return e.tile(x,t)},{x:x},function(n){return{x:function(){var r=e.zerosLike(x);if(1===x.rank)for(var i=0;i<t[0];++i)r=r.add(n.slice([i*x.shape[0]],[x.shape[0]]));else if(2===x.rank)for(i=0;i<t[0];++i)for(var j=0;j<t[1];++j)r=r.add(n.slice([i*x.shape[0],j*x.shape[1]],[x.shape[0],x.shape[1]]));else if(3===x.rank)for(i=0;i<t[0];++i)for(j=0;j<t[1];++j)for(var k=0;k<t[2];++k)r=r.add(n.slice([i*x.shape[0],j*x.shape[1],k*x.shape[2]],[x.shape[0],x.shape[1],x.shape[2]]));else{if(4!==x.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+x.rank+" tensors yet.");for(i=0;i<t[0];++i)for(j=0;j<t[1];++j)for(k=0;k<t[2];++k)for(var o=0;o<t[3];++o)r=r.add(n.slice([i*x.shape[0],j*x.shape[1],k*x.shape[2],o*x.shape[3]],[x.shape[0],x.shape[1],x.shape[2],x.shape[3]]))}return r}}})},e.gather=function(x,e,t){void 0===t&&(t=0);var n=d.parseAxisParam(t,x.shape);return s.ENV.engine.runKernel(function(t){return t.gather(x,e,n[0])},{x:x,indices:e})},e.pad1d=function(x,t,n){return void 0===n&&(n=0),c.assert(2===t.length,"Invalid number of paddings. Must be length of 2."),e.pad(x,[t],n)},e.pad2d=function(x,t,n){return void 0===n&&(n=0),c.assert(2===t.length&&2===t[0].length&&2===t[1].length,"Invalid number of paddings. Must be length of 2 each."),e.pad(x,t,n)},e.pad3d=function(x,t,n){return void 0===n&&(n=0),c.assert(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,"Invalid number of paddings. Must be length of 2 each."),e.pad(x,t,n)},e.pad4d=function(x,t,n){return void 0===n&&(n=0),c.assert(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,"Invalid number of paddings. Must be length of 2 each."),e.pad(x,t,n)},e.pad=function(x,e,t){if(void 0===t&&(t=0),0===x.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var n=e.map(function(e){return e[0]});return s.ENV.engine.runKernel(function(n){return n.pad(x,e,t)},{x:x},function(e){return{x:function(){return e.slice(n,x.shape)}}})},e.stack=function(e,t){void 0===t&&(t=0),c.assert(e.length>=2,"Pass at least two tensors to dl.stack");var n=e[0].shape,r=e[0].dtype;c.assert(t<=e[0].rank,"Axis must be <= rank of the tensor"),e.forEach(function(e){c.assertShapesMatch(n,e.shape,"All tensors passed to stack must have matching shapes")}),e.forEach(function(e){c.assert(r===e.dtype,"All tensors passed to stack must have matching dtypes")});var o=e.map(function(e){return e.expandDims(t)});return h.ConcatOps.concat(o,t)},e.expandDims=function(x,t){void 0===t&&(t=0),c.assert(t<=x.rank,"Axis must be <= rank of the tensor");var n=x.shape.slice();return n.splice(t,0,1),e.reshape(x,n)},e.linspace=function(t,n,r){if(0===r)throw new Error("Cannot request zero samples");var o=(n-t)/(r-1),s=v(r,"float32");s[0]=t;for(var i=1;i<s.length;i++)s[i]=s[i-1]+o;return e.tensor1d(s,"float32")},e.range=function(t,n,r,o){if(void 0===r&&(r=1),void 0===o&&(o="float32"),0===r)throw new Error("Cannot have a step of zero");if(t===n||t<n&&r<0||n<t&&r>1)return e.zeros([0],o);var s=v(Math.abs(Math.ceil((n-t)/r)),o);n<t&&1===r&&(r=-1),s[0]=t;for(var i=1;i<s.length;i++)s[i]=s[i-1]+r;return e.tensor1d(s,o)},e.buffer=function(e,t,n){return void 0===t&&(t="float32"),new u.TensorBuffer(e,t,n)},e.print=function(x,e){void 0===e&&(e=!1),console.log(l.tensorToString(x,e))},r([o.doc({heading:"Tensors",subheading:"Creation"})],e,"tensor",null),r([o.doc({heading:"Tensors",subheading:"Creation"})],e,"scalar",null),r([o.doc({heading:"Tensors",subheading:"Creation"})],e,"tensor1d",null),r([o.doc({heading:"Tensors",subheading:"Creation"})],e,"tensor2d",null),r([o.doc({heading:"Tensors",subheading:"Creation"})],e,"tensor3d",null),r([o.doc({heading:"Tensors",subheading:"Creation"})],e,"tensor4d",null),r([o.doc({heading:"Tensors",subheading:"Creation"}),p.operation],e,"ones",null),r([o.doc({heading:"Tensors",subheading:"Creation"}),p.operation],e,"zeros",null),r([o.doc({heading:"Tensors",subheading:"Creation"}),p.operation],e,"fill",null),r([o.doc({heading:"Tensors",subheading:"Creation"}),p.operation],e,"onesLike",null),r([o.doc({heading:"Tensors",subheading:"Creation"}),p.operation],e,"zerosLike",null),r([o.doc({heading:"Tensors",subheading:"Creation"}),p.operation],e,"clone",null),r([o.doc({heading:"Tensors",subheading:"Creation"}),p.operation],e,"randomNormal",null),r([o.doc({heading:"Tensors",subheading:"Creation"}),p.operation],e,"truncatedNormal",null),r([o.doc({heading:"Tensors",subheading:"Creation"}),p.operation],e,"randomUniform",null),r([p.operation],e,"rand",null),r([p.operation],e,"multinomial",null),r([o.doc({heading:"Tensors",subheading:"Creation"}),p.operation],e,"oneHot",null),r([o.doc({heading:"Tensors",subheading:"Creation"}),p.operation],e,"fromPixels",null),r([o.doc({heading:"Tensors",subheading:"Transformations"}),p.operation],e,"reshape",null),r([o.doc({heading:"Tensors",subheading:"Transformations"})],e,"squeeze",null),r([o.doc({heading:"Tensors",subheading:"Transformations"}),p.operation],e,"cast",null),r([o.doc({heading:"Tensors",subheading:"Slicing and Joining"}),p.operation],e,"tile",null),r([o.doc({heading:"Tensors",subheading:"Slicing and Joining"}),p.operation],e,"gather",null),r([o.doc({heading:"Tensors",subheading:"Transformations"}),p.operation],e,"pad",null),r([o.doc({heading:"Tensors",subheading:"Slicing and Joining"}),p.operation],e,"stack",null),r([o.doc({heading:"Tensors",subheading:"Transformations"}),p.operation],e,"expandDims",null),r([p.operation,o.doc({heading:"Tensors",subheading:"Creation"})],e,"linspace",null),r([p.operation,o.doc({heading:"Tensors",subheading:"Creation"})],e,"range",null),r([o.doc({heading:"Tensors",subheading:"Creation"})],e,"buffer",null),r([o.doc({heading:"Tensors",subheading:"Creation"})],e,"print",null),e}()},z89S:function(e,t,n){"use strict";var r=n("TToO").__extends;Object.defineProperty(t,"__esModule",{value:!0});var o=n("aIXu");t.LegendComponent=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(o.Split)},zEzE:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.QUANTITATIVE="quantitative",e.ORDINAL="ordinal",e.TEMPORAL="temporal",e.NOMINAL="nominal",e.LATITUDE="latitude",e.LONGITUDE="longitude",e.GEOJSON="geojson"}(r=t.Type||(t.Type={}));var o={quantitative:1,ordinal:1,temporal:1,nominal:1,latitude:1,longitude:1,geojson:1};t.isType=function(e){return!!o[e]},t.QUANTITATIVE=r.QUANTITATIVE,t.ORDINAL=r.ORDINAL,t.TEMPORAL=r.TEMPORAL,t.NOMINAL=r.NOMINAL,t.GEOJSON=r.GEOJSON,t.getFullName=function(e){if(e)switch(e=e.toLowerCase()){case"q":case t.QUANTITATIVE:return"quantitative";case"t":case t.TEMPORAL:return"temporal";case"o":case t.ORDINAL:return"ordinal";case"n":case t.NOMINAL:return"nominal";case r.LATITUDE:return"latitude";case r.LONGITUDE:return"longitude";case t.GEOJSON:return"geojson"}}},zSGG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("XSKZ"),o=n("xdLA"),s=n("3A6A"),u=n("kglw"),l=n("x8nG"),c="_translate_anchor",d="_translate_delta";function h(e,t,n,r,s){var h=t.name,p=l.default.has(t),g=s.filter(function(e){return e.name===u.channelSignalName(t,n,p?"data":"visual")})[0],m=h+c,v=h+d,_=e.getSizeSignalRef(r).signal,w=e.getScaleComponent(n),E=w.get("type"),O=m+".extent_"+n,S=(p?"log"===E?"panLog":"pow"===E?"panPow":"panLinear":"panLinear")+"("+O+", "+(p&&n===o.X?"-":"")+v+"."+n+" / "+(p?""+_:"span("+O+")")+(p&&"pow"===E?", "+(w.get("exponent")||1):"")+")";g.on.push({events:{signal:v},update:p?S:"clampRange("+S+", 0, "+_+")"})}t.default={has:function(e){return"interval"===e.type&&e.translate},signals:function(e,t,n){var p=t.name,g=l.default.has(t),m=p+c,v=u.positionalProjections(t),x=v.x,y=v.y,_=r.selector(t.translate,"scope");return g||(_=_.map(function(e){return e.between[0].markname=p+s.BRUSH,e})),n.push({name:m,value:{},on:[{events:_.map(function(e){return e.between[0]}),update:"{x: x(unit), y: y(unit)"+(null!==x?", extent_x: "+(g?l.domain(e,o.X):"slice("+u.channelSignalName(t,"x","visual")+")"):"")+(null!==y?", extent_y: "+(g?l.domain(e,o.Y):"slice("+u.channelSignalName(t,"y","visual")+")"):"")+"}"}]},{name:p+d,value:{},on:[{events:_,update:"{x: "+m+".x - x(unit), y: "+m+".y - y(unit)}"}]}),null!==x&&h(e,t,o.X,"width",n),null!==y&&h(e,t,o.Y,"height",n),n}}},zhZS:function(e,t,n){"use strict";var r=n("TToO").__decorate;Object.defineProperty(t,"__esModule",{value:!0});var o=n("w3wY"),s=n("v/P2"),u=n("XFvI"),l=n("35G1");t.MatmulOps=function(){function e(){}return e.matMul=function(a,b,e,t){void 0===e&&(e=!1),void 0===t&&(t=!1);var n=e?a.shape[0]:a.shape[1],r=t?b.shape[1]:b.shape[0];return u.assert(2===a.rank&&2===b.rank,"Error in matMul: inputs must be rank 2, got ranks "+a.rank+" and "+b.rank+"."),u.assert(n===r,"Error in matMul: inner shapes ("+n+") and ("+r+") of Tensors with shapes "+a.shape+" and "+b.shape+" and transposeA="+e+" and transposeB="+t+" must match."),s.ENV.engine.runKernel(function(n){return n.matMul(a,b,e,t)},{a:a,b:b},function(n){if(e||t)throw new Error("Backprop for transposed MatMul not yet implemented.");return{a:function(){return n.matMul(b.toFloat(),!1,!0)},b:function(){return a.toFloat().matMul(n,!0,!1)}}})},e.vectorTimesMatrix=function(e,t){return u.assert(1===e.rank,"Error in vectorTimesMatrix: first input must be rank 1, but got rank "+e.rank+"."),u.assert(2===t.rank,"Error in vectorTimesMatrix: second input must be rank 2, but got rank "+t.rank+"."),u.assert(e.size===t.shape[0],"Error in vectorTimesMatrix: size of vector ("+e.size+") must match first dimension of matrix ("+t.shape[0]+")"),e.as2D(1,-1).matMul(t).as1D()},e.matrixTimesVector=function(e,t){return u.assert(1===t.rank,"Error in matrixTimesVector: second input must rank 1, but got rank "+t.rank+"."),u.assert(2===e.rank,"Error in matrixTimesVector: first input must be a rank 2, but got rank "+e.rank+"."),u.assert(t.size===e.shape[1],"Error in matrixTimesVector: size of first rank 1 input "+t.size+" must match inner dimension of second rank 2 input, but got shape "+e.shape+"."),e.matMul(t.as2D(-1,1)).as1D()},e.dotProduct=function(e,t){return u.assert(1===e.rank&&1===t.rank,"Error in dotProduct: inputs must be rank 1, but got ranks "+e.rank+" and "+t.rank+"."),u.assert(e.size===t.size,"Error in dotProduct: size of inputs ("+e.size+") and ("+t.size+") must match."),e.as2D(1,-1).matMul(t.as2D(-1,1)).asScalar()},e.outerProduct=function(e,t){return u.assert(1===e.rank&&1===t.rank,"Error in outerProduct: inputs must be rank 1, but got ranks "+e.rank+" and "+t.rank+"."),e.as2D(-1,1).matMul(t.as2D(1,-1))},r([o.doc({heading:"Operations",subheading:"Matrices"}),l.operation],e,"matMul",null),r([l.operation],e,"vectorTimesMatrix",null),r([l.operation],e,"matrixTimesVector",null),r([l.operation],e,"dotProduct",null),r([o.doc({heading:"Operations",subheading:"Matrices"}),l.operation],e,"outerProduct",null),e}()}});